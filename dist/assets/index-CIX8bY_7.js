function rj(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function He(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sO(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var nj={exports:{}},Vd={},ij={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ec=Symbol.for("react.element"),oO=Symbol.for("react.portal"),lO=Symbol.for("react.fragment"),cO=Symbol.for("react.strict_mode"),uO=Symbol.for("react.profiler"),dO=Symbol.for("react.provider"),fO=Symbol.for("react.context"),hO=Symbol.for("react.forward_ref"),pO=Symbol.for("react.suspense"),mO=Symbol.for("react.memo"),gO=Symbol.for("react.lazy"),xv=Symbol.iterator;function yO(e){return e===null||typeof e!="object"?null:(e=xv&&e[xv]||e["@@iterator"],typeof e=="function"?e:null)}var aj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sj=Object.assign,oj={};function Rs(e,t,r){this.props=e,this.context=t,this.refs=oj,this.updater=r||aj}Rs.prototype.isReactComponent={};Rs.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Rs.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lj(){}lj.prototype=Rs.prototype;function ay(e,t,r){this.props=e,this.context=t,this.refs=oj,this.updater=r||aj}var sy=ay.prototype=new lj;sy.constructor=ay;sj(sy,Rs.prototype);sy.isPureReactComponent=!0;var bv=Array.isArray,cj=Object.prototype.hasOwnProperty,oy={current:null},uj={key:!0,ref:!0,__self:!0,__source:!0};function dj(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)cj.call(t,n)&&!uj.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:ec,type:e,key:a,ref:o,props:i,_owner:oy.current}}function vO(e,t){return{$$typeof:ec,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ly(e){return typeof e=="object"&&e!==null&&e.$$typeof===ec}function xO(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var wv=/\/+/g;function uh(e,t){return typeof e=="object"&&e!==null&&e.key!=null?xO(""+e.key):t.toString(36)}function ou(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ec:case oO:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+uh(o,0):n,bv(i)?(r="",e!=null&&(r=e.replace(wv,"$&/")+"/"),ou(i,t,r,"",function(u){return u})):i!=null&&(ly(i)&&(i=vO(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(wv,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",bv(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+uh(a,l);o+=ou(a,t,r,c,i)}else if(c=yO(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+uh(a,l++),o+=ou(a,t,r,c,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function xc(e,t,r){if(e==null)return e;var n=[],i=0;return ou(e,n,"","",function(a){return t.call(r,a,i++)}),n}function bO(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Jt={current:null},lu={transition:null},wO={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:lu,ReactCurrentOwner:oy};function fj(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:xc,forEach:function(e,t,r){xc(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return xc(e,function(){t++}),t},toArray:function(e){return xc(e,function(t){return t})||[]},only:function(e){if(!ly(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Rs;Ce.Fragment=lO;Ce.Profiler=uO;Ce.PureComponent=ay;Ce.StrictMode=cO;Ce.Suspense=pO;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wO;Ce.act=fj;Ce.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sj({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=oy.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)cj.call(t,c)&&!uj.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ec,type:e.type,key:i,ref:a,props:n,_owner:o}};Ce.createContext=function(e){return e={$$typeof:fO,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:dO,_context:e},e.Consumer=e};Ce.createElement=dj;Ce.createFactory=function(e){var t=dj.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:hO,render:e}};Ce.isValidElement=ly;Ce.lazy=function(e){return{$$typeof:gO,_payload:{_status:-1,_result:e},_init:bO}};Ce.memo=function(e,t){return{$$typeof:mO,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=lu.transition;lu.transition={};try{e()}finally{lu.transition=t}};Ce.unstable_act=fj;Ce.useCallback=function(e,t){return Jt.current.useCallback(e,t)};Ce.useContext=function(e){return Jt.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Jt.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Jt.current.useEffect(e,t)};Ce.useId=function(){return Jt.current.useId()};Ce.useImperativeHandle=function(e,t,r){return Jt.current.useImperativeHandle(e,t,r)};Ce.useInsertionEffect=function(e,t){return Jt.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Jt.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Jt.current.useMemo(e,t)};Ce.useReducer=function(e,t,r){return Jt.current.useReducer(e,t,r)};Ce.useRef=function(e){return Jt.current.useRef(e)};Ce.useState=function(e){return Jt.current.useState(e)};Ce.useSyncExternalStore=function(e,t,r){return Jt.current.useSyncExternalStore(e,t,r)};Ce.useTransition=function(){return Jt.current.useTransition()};Ce.version="18.3.1";ij.exports=Ce;var N=ij.exports;const z=He(N),_O=rj({__proto__:null,default:z},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jO=N,SO=Symbol.for("react.element"),NO=Symbol.for("react.fragment"),EO=Object.prototype.hasOwnProperty,AO=jO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,PO={key:!0,ref:!0,__self:!0,__source:!0};function hj(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)EO.call(t,n)&&!PO.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:SO,type:e,key:a,ref:o,props:i,_owner:AO.current}}Vd.Fragment=NO;Vd.jsx=hj;Vd.jsxs=hj;nj.exports=Vd;var s=nj.exports,Np={},pj={exports:{}},_r={},mj={exports:{}},gj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,D){var H=R.length;R.push(D);e:for(;0<H;){var Q=H-1>>>1,U=R[Q];if(0<i(U,D))R[Q]=D,R[H]=U,H=Q;else break e}}function r(R){return R.length===0?null:R[0]}function n(R){if(R.length===0)return null;var D=R[0],H=R.pop();if(H!==D){R[0]=H;e:for(var Q=0,U=R.length,G=U>>>1;Q<G;){var B=2*(Q+1)-1,me=R[B],ue=B+1,Ne=R[ue];if(0>i(me,H))ue<U&&0>i(Ne,me)?(R[Q]=Ne,R[ue]=H,Q=ue):(R[Q]=me,R[B]=H,Q=B);else if(ue<U&&0>i(Ne,H))R[Q]=Ne,R[ue]=H,Q=ue;else break e}}return D}function i(R,D){var H=R.sortIndex-D.sortIndex;return H!==0?H:R.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,y=!1,v=!1,m=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(R){for(var D=r(u);D!==null;){if(D.callback===null)n(u);else if(D.startTime<=R)n(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=r(u)}}function S(R){if(v=!1,g(R),!y)if(r(c)!==null)y=!0,I(w);else{var D=r(u);D!==null&&W(S,D.startTime-R)}}function w(R,D){y=!1,v&&(v=!1,x(E),E=-1),p=!0;var H=h;try{for(g(D),f=r(c);f!==null&&(!(f.expirationTime>D)||R&&!T());){var Q=f.callback;if(typeof Q=="function"){f.callback=null,h=f.priorityLevel;var U=Q(f.expirationTime<=D);D=e.unstable_now(),typeof U=="function"?f.callback=U:f===r(c)&&n(c),g(D)}else n(c);f=r(c)}if(f!==null)var G=!0;else{var B=r(u);B!==null&&W(S,B.startTime-D),G=!1}return G}finally{f=null,h=H,p=!1}}var j=!1,_=null,E=-1,A=5,P=-1;function T(){return!(e.unstable_now()-P<A)}function M(){if(_!==null){var R=e.unstable_now();P=R;var D=!0;try{D=_(!0,R)}finally{D?O():(j=!1,_=null)}}else j=!1}var O;if(typeof b=="function")O=function(){b(M)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,F=k.port2;k.port1.onmessage=M,O=function(){F.postMessage(null)}}else O=function(){m(M,0)};function I(R){_=R,j||(j=!0,O())}function W(R,D){E=m(function(){R(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){y||p||(y=!0,I(w))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(R){switch(h){case 1:case 2:case 3:var D=3;break;default:D=h}var H=h;h=D;try{return R()}finally{h=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,D){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var H=h;h=R;try{return D()}finally{h=H}},e.unstable_scheduleCallback=function(R,D,H){var Q=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Q+H:Q):H=Q,R){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=H+U,R={id:d++,callback:D,priorityLevel:R,startTime:H,expirationTime:U,sortIndex:-1},H>Q?(R.sortIndex=H,t(u,R),r(c)===null&&R===r(u)&&(v?(x(E),E=-1):v=!0,W(S,H-Q))):(R.sortIndex=U,t(c,R),y||p||(y=!0,I(w))),R},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(R){var D=h;return function(){var H=h;h=D;try{return R.apply(this,arguments)}finally{h=H}}}})(gj);mj.exports=gj;var OO=mj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CO=N,wr=OO;function ne(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var yj=new Set,Xo={};function da(e,t){is(e,t),is(e+"Capture",t)}function is(e,t){for(Xo[e]=t,e=0;e<t.length;e++)yj.add(t[e])}var In=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ep=Object.prototype.hasOwnProperty,TO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,_v={},jv={};function kO(e){return Ep.call(jv,e)?!0:Ep.call(_v,e)?!1:TO.test(e)?jv[e]=!0:(_v[e]=!0,!1)}function $O(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function IO(e,t,r,n){if(t===null||typeof t>"u"||$O(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Qt(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Lt[e]=new Qt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Lt[t]=new Qt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Lt[e]=new Qt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Lt[e]=new Qt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Lt[e]=new Qt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Lt[e]=new Qt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Lt[e]=new Qt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Lt[e]=new Qt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Lt[e]=new Qt(e,5,!1,e.toLowerCase(),null,!1,!1)});var cy=/[\-:]([a-z])/g;function uy(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(cy,uy);Lt[t]=new Qt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(cy,uy);Lt[t]=new Qt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(cy,uy);Lt[t]=new Qt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Lt[e]=new Qt(e,1,!1,e.toLowerCase(),null,!1,!1)});Lt.xlinkHref=new Qt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Lt[e]=new Qt(e,1,!1,e.toLowerCase(),null,!0,!0)});function dy(e,t,r,n){var i=Lt.hasOwnProperty(t)?Lt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(IO(t,r,i,n)&&(r=null),n||i===null?kO(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var qn=CO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bc=Symbol.for("react.element"),Ca=Symbol.for("react.portal"),Ta=Symbol.for("react.fragment"),fy=Symbol.for("react.strict_mode"),Ap=Symbol.for("react.profiler"),vj=Symbol.for("react.provider"),xj=Symbol.for("react.context"),hy=Symbol.for("react.forward_ref"),Pp=Symbol.for("react.suspense"),Op=Symbol.for("react.suspense_list"),py=Symbol.for("react.memo"),Yn=Symbol.for("react.lazy"),bj=Symbol.for("react.offscreen"),Sv=Symbol.iterator;function to(e){return e===null||typeof e!="object"?null:(e=Sv&&e[Sv]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,dh;function _o(e){if(dh===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);dh=t&&t[1]||""}return`
`+dh+e}var fh=!1;function hh(e,t){if(!e||fh)return"";fh=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,l=a.length-1;1<=o&&0<=l&&i[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==a[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{fh=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?_o(e):""}function MO(e){switch(e.tag){case 5:return _o(e.type);case 16:return _o("Lazy");case 13:return _o("Suspense");case 19:return _o("SuspenseList");case 0:case 2:case 15:return e=hh(e.type,!1),e;case 11:return e=hh(e.type.render,!1),e;case 1:return e=hh(e.type,!0),e;default:return""}}function Cp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ta:return"Fragment";case Ca:return"Portal";case Ap:return"Profiler";case fy:return"StrictMode";case Pp:return"Suspense";case Op:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case xj:return(e.displayName||"Context")+".Consumer";case vj:return(e._context.displayName||"Context")+".Provider";case hy:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case py:return t=e.displayName||null,t!==null?t:Cp(e.type)||"Memo";case Yn:t=e._payload,e=e._init;try{return Cp(e(t))}catch{}}return null}function RO(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cp(t);case 8:return t===fy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yi(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wj(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function DO(e){var t=wj(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wc(e){e._valueTracker||(e._valueTracker=DO(e))}function _j(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=wj(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Nu(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Tp(e,t){var r=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Nv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=yi(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jj(e,t){t=t.checked,t!=null&&dy(e,"checked",t,!1)}function kp(e,t){jj(e,t);var r=yi(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$p(e,t.type,r):t.hasOwnProperty("defaultValue")&&$p(e,t.type,yi(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ev(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function $p(e,t,r){(t!=="number"||Nu(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var jo=Array.isArray;function Ka(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+yi(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Ip(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ne(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Av(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ne(92));if(jo(r)){if(1<r.length)throw Error(ne(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:yi(r)}}function Sj(e,t){var r=yi(t.value),n=yi(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Pv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Nj(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Nj(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _c,Ej=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_c=_c||document.createElement("div"),_c.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_c.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Yo(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Co={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},LO=["Webkit","ms","Moz","O"];Object.keys(Co).forEach(function(e){LO.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Co[t]=Co[e]})});function Aj(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Co.hasOwnProperty(e)&&Co[e]?(""+t).trim():t+"px"}function Pj(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Aj(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var BO=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rp(e,t){if(t){if(BO[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ne(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ne(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ne(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ne(62))}}function Dp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lp=null;function my(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Bp=null,Xa=null,Ya=null;function Ov(e){if(e=nc(e)){if(typeof Bp!="function")throw Error(ne(280));var t=e.stateNode;t&&(t=Jd(t),Bp(e.stateNode,e.type,t))}}function Oj(e){Xa?Ya?Ya.push(e):Ya=[e]:Xa=e}function Cj(){if(Xa){var e=Xa,t=Ya;if(Ya=Xa=null,Ov(e),t)for(e=0;e<t.length;e++)Ov(t[e])}}function Tj(e,t){return e(t)}function kj(){}var ph=!1;function $j(e,t,r){if(ph)return e(t,r);ph=!0;try{return Tj(e,t,r)}finally{ph=!1,(Xa!==null||Ya!==null)&&(kj(),Cj())}}function Jo(e,t){var r=e.stateNode;if(r===null)return null;var n=Jd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ne(231,t,typeof r));return r}var Fp=!1;if(In)try{var ro={};Object.defineProperty(ro,"passive",{get:function(){Fp=!0}}),window.addEventListener("test",ro,ro),window.removeEventListener("test",ro,ro)}catch{Fp=!1}function FO(e,t,r,n,i,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var To=!1,Eu=null,Au=!1,qp=null,qO={onError:function(e){To=!0,Eu=e}};function UO(e,t,r,n,i,a,o,l,c){To=!1,Eu=null,FO.apply(qO,arguments)}function zO(e,t,r,n,i,a,o,l,c){if(UO.apply(this,arguments),To){if(To){var u=Eu;To=!1,Eu=null}else throw Error(ne(198));Au||(Au=!0,qp=u)}}function fa(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Ij(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Cv(e){if(fa(e)!==e)throw Error(ne(188))}function WO(e){var t=e.alternate;if(!t){if(t=fa(e),t===null)throw Error(ne(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Cv(i),e;if(a===n)return Cv(i),t;a=a.sibling}throw Error(ne(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=a;break}if(l===n){o=!0,n=i,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=i;break}if(l===n){o=!0,n=a,r=i;break}l=l.sibling}if(!o)throw Error(ne(189))}}if(r.alternate!==n)throw Error(ne(190))}if(r.tag!==3)throw Error(ne(188));return r.stateNode.current===r?e:t}function Mj(e){return e=WO(e),e!==null?Rj(e):null}function Rj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Rj(e);if(t!==null)return t;e=e.sibling}return null}var Dj=wr.unstable_scheduleCallback,Tv=wr.unstable_cancelCallback,HO=wr.unstable_shouldYield,VO=wr.unstable_requestPaint,ft=wr.unstable_now,GO=wr.unstable_getCurrentPriorityLevel,gy=wr.unstable_ImmediatePriority,Lj=wr.unstable_UserBlockingPriority,Pu=wr.unstable_NormalPriority,KO=wr.unstable_LowPriority,Bj=wr.unstable_IdlePriority,Gd=null,dn=null;function XO(e){if(dn&&typeof dn.onCommitFiberRoot=="function")try{dn.onCommitFiberRoot(Gd,e,void 0,(e.current.flags&128)===128)}catch{}}var Qr=Math.clz32?Math.clz32:QO,YO=Math.log,JO=Math.LN2;function QO(e){return e>>>=0,e===0?32:31-(YO(e)/JO|0)|0}var jc=64,Sc=4194304;function So(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ou(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=So(l):(a&=o,a!==0&&(n=So(a)))}else o=r&~i,o!==0?n=So(o):a!==0&&(n=So(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Qr(t),i=1<<r,n|=e[r],t&=~i;return n}function ZO(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eC(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Qr(a),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=ZO(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function Up(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Fj(){var e=jc;return jc<<=1,!(jc&4194240)&&(jc=64),e}function mh(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function tc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qr(t),e[t]=r}function tC(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Qr(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function yy(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Qr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var qe=0;function qj(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Uj,vy,zj,Wj,Hj,zp=!1,Nc=[],li=null,ci=null,ui=null,Qo=new Map,Zo=new Map,Zn=[],rC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kv(e,t){switch(e){case"focusin":case"focusout":li=null;break;case"dragenter":case"dragleave":ci=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":Qo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zo.delete(t.pointerId)}}function no(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=nc(t),t!==null&&vy(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function nC(e,t,r,n,i){switch(t){case"focusin":return li=no(li,e,t,r,n,i),!0;case"dragenter":return ci=no(ci,e,t,r,n,i),!0;case"mouseover":return ui=no(ui,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return Qo.set(a,no(Qo.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,Zo.set(a,no(Zo.get(a)||null,e,t,r,n,i)),!0}return!1}function Vj(e){var t=Hi(e.target);if(t!==null){var r=fa(t);if(r!==null){if(t=r.tag,t===13){if(t=Ij(r),t!==null){e.blockedOn=t,Hj(e.priority,function(){zj(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function cu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Wp(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Lp=n,r.target.dispatchEvent(n),Lp=null}else return t=nc(r),t!==null&&vy(t),e.blockedOn=r,!1;t.shift()}return!0}function $v(e,t,r){cu(e)&&r.delete(t)}function iC(){zp=!1,li!==null&&cu(li)&&(li=null),ci!==null&&cu(ci)&&(ci=null),ui!==null&&cu(ui)&&(ui=null),Qo.forEach($v),Zo.forEach($v)}function io(e,t){e.blockedOn===t&&(e.blockedOn=null,zp||(zp=!0,wr.unstable_scheduleCallback(wr.unstable_NormalPriority,iC)))}function el(e){function t(i){return io(i,e)}if(0<Nc.length){io(Nc[0],e);for(var r=1;r<Nc.length;r++){var n=Nc[r];n.blockedOn===e&&(n.blockedOn=null)}}for(li!==null&&io(li,e),ci!==null&&io(ci,e),ui!==null&&io(ui,e),Qo.forEach(t),Zo.forEach(t),r=0;r<Zn.length;r++)n=Zn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Zn.length&&(r=Zn[0],r.blockedOn===null);)Vj(r),r.blockedOn===null&&Zn.shift()}var Ja=qn.ReactCurrentBatchConfig,Cu=!0;function aC(e,t,r,n){var i=qe,a=Ja.transition;Ja.transition=null;try{qe=1,xy(e,t,r,n)}finally{qe=i,Ja.transition=a}}function sC(e,t,r,n){var i=qe,a=Ja.transition;Ja.transition=null;try{qe=4,xy(e,t,r,n)}finally{qe=i,Ja.transition=a}}function xy(e,t,r,n){if(Cu){var i=Wp(e,t,r,n);if(i===null)Nh(e,t,n,Tu,r),kv(e,n);else if(nC(i,e,t,r,n))n.stopPropagation();else if(kv(e,n),t&4&&-1<rC.indexOf(e)){for(;i!==null;){var a=nc(i);if(a!==null&&Uj(a),a=Wp(e,t,r,n),a===null&&Nh(e,t,n,Tu,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Nh(e,t,n,null,r)}}var Tu=null;function Wp(e,t,r,n){if(Tu=null,e=my(n),e=Hi(e),e!==null)if(t=fa(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Ij(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Tu=e,null}function Gj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(GO()){case gy:return 1;case Lj:return 4;case Pu:case KO:return 16;case Bj:return 536870912;default:return 16}default:return 16}}var ai=null,by=null,uu=null;function Kj(){if(uu)return uu;var e,t=by,r=t.length,n,i="value"in ai?ai.value:ai.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return uu=i.slice(e,1<n?1-n:void 0)}function du(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ec(){return!0}function Iv(){return!1}function jr(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ec:Iv,this.isPropagationStopped=Iv,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ec)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ec)},persist:function(){},isPersistent:Ec}),t}var Ds={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wy=jr(Ds),rc=ot({},Ds,{view:0,detail:0}),oC=jr(rc),gh,yh,ao,Kd=ot({},rc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_y,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ao&&(ao&&e.type==="mousemove"?(gh=e.screenX-ao.screenX,yh=e.screenY-ao.screenY):yh=gh=0,ao=e),gh)},movementY:function(e){return"movementY"in e?e.movementY:yh}}),Mv=jr(Kd),lC=ot({},Kd,{dataTransfer:0}),cC=jr(lC),uC=ot({},rc,{relatedTarget:0}),vh=jr(uC),dC=ot({},Ds,{animationName:0,elapsedTime:0,pseudoElement:0}),fC=jr(dC),hC=ot({},Ds,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),pC=jr(hC),mC=ot({},Ds,{data:0}),Rv=jr(mC),gC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xC(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=vC[e])?!!t[e]:!1}function _y(){return xC}var bC=ot({},rc,{key:function(e){if(e.key){var t=gC[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=du(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?yC[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_y,charCode:function(e){return e.type==="keypress"?du(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?du(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),wC=jr(bC),_C=ot({},Kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dv=jr(_C),jC=ot({},rc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_y}),SC=jr(jC),NC=ot({},Ds,{propertyName:0,elapsedTime:0,pseudoElement:0}),EC=jr(NC),AC=ot({},Kd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),PC=jr(AC),OC=[9,13,27,32],jy=In&&"CompositionEvent"in window,ko=null;In&&"documentMode"in document&&(ko=document.documentMode);var CC=In&&"TextEvent"in window&&!ko,Xj=In&&(!jy||ko&&8<ko&&11>=ko),Lv=" ",Bv=!1;function Yj(e,t){switch(e){case"keyup":return OC.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ka=!1;function TC(e,t){switch(e){case"compositionend":return Jj(t);case"keypress":return t.which!==32?null:(Bv=!0,Lv);case"textInput":return e=t.data,e===Lv&&Bv?null:e;default:return null}}function kC(e,t){if(ka)return e==="compositionend"||!jy&&Yj(e,t)?(e=Kj(),uu=by=ai=null,ka=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Xj&&t.locale!=="ko"?null:t.data;default:return null}}var $C={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!$C[e.type]:t==="textarea"}function Qj(e,t,r,n){Oj(n),t=ku(t,"onChange"),0<t.length&&(r=new wy("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var $o=null,tl=null;function IC(e){cS(e,0)}function Xd(e){var t=Ma(e);if(_j(t))return e}function MC(e,t){if(e==="change")return t}var Zj=!1;if(In){var xh;if(In){var bh="oninput"in document;if(!bh){var qv=document.createElement("div");qv.setAttribute("oninput","return;"),bh=typeof qv.oninput=="function"}xh=bh}else xh=!1;Zj=xh&&(!document.documentMode||9<document.documentMode)}function Uv(){$o&&($o.detachEvent("onpropertychange",eS),tl=$o=null)}function eS(e){if(e.propertyName==="value"&&Xd(tl)){var t=[];Qj(t,tl,e,my(e)),$j(IC,t)}}function RC(e,t,r){e==="focusin"?(Uv(),$o=t,tl=r,$o.attachEvent("onpropertychange",eS)):e==="focusout"&&Uv()}function DC(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xd(tl)}function LC(e,t){if(e==="click")return Xd(t)}function BC(e,t){if(e==="input"||e==="change")return Xd(t)}function FC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tn=typeof Object.is=="function"?Object.is:FC;function rl(e,t){if(tn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Ep.call(t,i)||!tn(e[i],t[i]))return!1}return!0}function zv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Wv(e,t){var r=zv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=zv(r)}}function tS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?tS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rS(){for(var e=window,t=Nu();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Nu(e.document)}return t}function Sy(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qC(e){var t=rS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&tS(r.ownerDocument.documentElement,r)){if(n!==null&&Sy(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=Wv(r,a);var o=Wv(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var UC=In&&"documentMode"in document&&11>=document.documentMode,$a=null,Hp=null,Io=null,Vp=!1;function Hv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vp||$a==null||$a!==Nu(n)||(n=$a,"selectionStart"in n&&Sy(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Io&&rl(Io,n)||(Io=n,n=ku(Hp,"onSelect"),0<n.length&&(t=new wy("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=$a)))}function Ac(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Ia={animationend:Ac("Animation","AnimationEnd"),animationiteration:Ac("Animation","AnimationIteration"),animationstart:Ac("Animation","AnimationStart"),transitionend:Ac("Transition","TransitionEnd")},wh={},nS={};In&&(nS=document.createElement("div").style,"AnimationEvent"in window||(delete Ia.animationend.animation,delete Ia.animationiteration.animation,delete Ia.animationstart.animation),"TransitionEvent"in window||delete Ia.transitionend.transition);function Yd(e){if(wh[e])return wh[e];if(!Ia[e])return e;var t=Ia[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in nS)return wh[e]=t[r];return e}var iS=Yd("animationend"),aS=Yd("animationiteration"),sS=Yd("animationstart"),oS=Yd("transitionend"),lS=new Map,Vv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function wi(e,t){lS.set(e,t),da(t,[e])}for(var _h=0;_h<Vv.length;_h++){var jh=Vv[_h],zC=jh.toLowerCase(),WC=jh[0].toUpperCase()+jh.slice(1);wi(zC,"on"+WC)}wi(iS,"onAnimationEnd");wi(aS,"onAnimationIteration");wi(sS,"onAnimationStart");wi("dblclick","onDoubleClick");wi("focusin","onFocus");wi("focusout","onBlur");wi(oS,"onTransitionEnd");is("onMouseEnter",["mouseout","mouseover"]);is("onMouseLeave",["mouseout","mouseover"]);is("onPointerEnter",["pointerout","pointerover"]);is("onPointerLeave",["pointerout","pointerover"]);da("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));da("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));da("onBeforeInput",["compositionend","keypress","textInput","paste"]);da("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));da("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));da("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var No="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HC=new Set("cancel close invalid load scroll toggle".split(" ").concat(No));function Gv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,zO(n,t,void 0,e),e.currentTarget=null}function cS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&i.isPropagationStopped())break e;Gv(i,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&i.isPropagationStopped())break e;Gv(i,l,u),a=c}}}if(Au)throw e=qp,Au=!1,qp=null,e}function Qe(e,t){var r=t[Jp];r===void 0&&(r=t[Jp]=new Set);var n=e+"__bubble";r.has(n)||(uS(t,e,2,!1),r.add(n))}function Sh(e,t,r){var n=0;t&&(n|=4),uS(r,e,n,t)}var Pc="_reactListening"+Math.random().toString(36).slice(2);function nl(e){if(!e[Pc]){e[Pc]=!0,yj.forEach(function(r){r!=="selectionchange"&&(HC.has(r)||Sh(r,!1,e),Sh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Pc]||(t[Pc]=!0,Sh("selectionchange",!1,t))}}function uS(e,t,r,n){switch(Gj(t)){case 1:var i=aC;break;case 4:i=sC;break;default:i=xy}r=i.bind(null,t,r,e),i=void 0,!Fp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Nh(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Hi(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}$j(function(){var u=a,d=my(r),f=[];e:{var h=lS.get(e);if(h!==void 0){var p=wy,y=e;switch(e){case"keypress":if(du(r)===0)break e;case"keydown":case"keyup":p=wC;break;case"focusin":y="focus",p=vh;break;case"focusout":y="blur",p=vh;break;case"beforeblur":case"afterblur":p=vh;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Mv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=cC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=SC;break;case iS:case aS:case sS:p=fC;break;case oS:p=EC;break;case"scroll":p=oC;break;case"wheel":p=PC;break;case"copy":case"cut":case"paste":p=pC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Dv}var v=(t&4)!==0,m=!v&&e==="scroll",x=v?h!==null?h+"Capture":null:h;v=[];for(var b=u,g;b!==null;){g=b;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,x!==null&&(S=Jo(b,x),S!=null&&v.push(il(b,S,g)))),m)break;b=b.return}0<v.length&&(h=new p(h,y,null,r,d),f.push({event:h,listeners:v}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Lp&&(y=r.relatedTarget||r.fromElement)&&(Hi(y)||y[Mn]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(y=r.relatedTarget||r.toElement,p=u,y=y?Hi(y):null,y!==null&&(m=fa(y),y!==m||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(v=Mv,S="onMouseLeave",x="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(v=Dv,S="onPointerLeave",x="onPointerEnter",b="pointer"),m=p==null?h:Ma(p),g=y==null?h:Ma(y),h=new v(S,b+"leave",p,r,d),h.target=m,h.relatedTarget=g,S=null,Hi(d)===u&&(v=new v(x,b+"enter",y,r,d),v.target=g,v.relatedTarget=m,S=v),m=S,p&&y)t:{for(v=p,x=y,b=0,g=v;g;g=xa(g))b++;for(g=0,S=x;S;S=xa(S))g++;for(;0<b-g;)v=xa(v),b--;for(;0<g-b;)x=xa(x),g--;for(;b--;){if(v===x||x!==null&&v===x.alternate)break t;v=xa(v),x=xa(x)}v=null}else v=null;p!==null&&Kv(f,h,p,v,!1),y!==null&&m!==null&&Kv(f,m,y,v,!0)}}e:{if(h=u?Ma(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var w=MC;else if(Fv(h))if(Zj)w=BC;else{w=DC;var j=RC}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=LC);if(w&&(w=w(e,u))){Qj(f,w,r,d);break e}j&&j(e,h,u),e==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&$p(h,"number",h.value)}switch(j=u?Ma(u):window,e){case"focusin":(Fv(j)||j.contentEditable==="true")&&($a=j,Hp=u,Io=null);break;case"focusout":Io=Hp=$a=null;break;case"mousedown":Vp=!0;break;case"contextmenu":case"mouseup":case"dragend":Vp=!1,Hv(f,r,d);break;case"selectionchange":if(UC)break;case"keydown":case"keyup":Hv(f,r,d)}var _;if(jy)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ka?Yj(e,r)&&(E="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(E="onCompositionStart");E&&(Xj&&r.locale!=="ko"&&(ka||E!=="onCompositionStart"?E==="onCompositionEnd"&&ka&&(_=Kj()):(ai=d,by="value"in ai?ai.value:ai.textContent,ka=!0)),j=ku(u,E),0<j.length&&(E=new Rv(E,e,null,r,d),f.push({event:E,listeners:j}),_?E.data=_:(_=Jj(r),_!==null&&(E.data=_)))),(_=CC?TC(e,r):kC(e,r))&&(u=ku(u,"onBeforeInput"),0<u.length&&(d=new Rv("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=_))}cS(f,t)})}function il(e,t,r){return{instance:e,listener:t,currentTarget:r}}function ku(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Jo(e,r),a!=null&&n.unshift(il(e,a,i)),a=Jo(e,t),a!=null&&n.push(il(e,a,i))),e=e.return}return n}function xa(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Kv(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Jo(r,a),c!=null&&o.unshift(il(r,c,l))):i||(c=Jo(r,a),c!=null&&o.push(il(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var VC=/\r\n?/g,GC=/\u0000|\uFFFD/g;function Xv(e){return(typeof e=="string"?e:""+e).replace(VC,`
`).replace(GC,"")}function Oc(e,t,r){if(t=Xv(t),Xv(e)!==t&&r)throw Error(ne(425))}function $u(){}var Gp=null,Kp=null;function Xp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Yp=typeof setTimeout=="function"?setTimeout:void 0,KC=typeof clearTimeout=="function"?clearTimeout:void 0,Yv=typeof Promise=="function"?Promise:void 0,XC=typeof queueMicrotask=="function"?queueMicrotask:typeof Yv<"u"?function(e){return Yv.resolve(null).then(e).catch(YC)}:Yp;function YC(e){setTimeout(function(){throw e})}function Eh(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),el(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);el(t)}function di(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ls=Math.random().toString(36).slice(2),on="__reactFiber$"+Ls,al="__reactProps$"+Ls,Mn="__reactContainer$"+Ls,Jp="__reactEvents$"+Ls,JC="__reactListeners$"+Ls,QC="__reactHandles$"+Ls;function Hi(e){var t=e[on];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Mn]||r[on]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jv(e);e!==null;){if(r=e[on])return r;e=Jv(e)}return t}e=r,r=e.parentNode}return null}function nc(e){return e=e[on]||e[Mn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ma(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ne(33))}function Jd(e){return e[al]||null}var Qp=[],Ra=-1;function _i(e){return{current:e}}function tt(e){0>Ra||(e.current=Qp[Ra],Qp[Ra]=null,Ra--)}function Ye(e,t){Ra++,Qp[Ra]=e.current,e.current=t}var vi={},Ht=_i(vi),sr=_i(!1),aa=vi;function as(e,t){var r=e.type.contextTypes;if(!r)return vi;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function or(e){return e=e.childContextTypes,e!=null}function Iu(){tt(sr),tt(Ht)}function Qv(e,t,r){if(Ht.current!==vi)throw Error(ne(168));Ye(Ht,t),Ye(sr,r)}function dS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(ne(108,RO(e)||"Unknown",i));return ot({},r,n)}function Mu(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vi,aa=Ht.current,Ye(Ht,e),Ye(sr,sr.current),!0}function Zv(e,t,r){var n=e.stateNode;if(!n)throw Error(ne(169));r?(e=dS(e,t,aa),n.__reactInternalMemoizedMergedChildContext=e,tt(sr),tt(Ht),Ye(Ht,e)):tt(sr),Ye(sr,r)}var jn=null,Qd=!1,Ah=!1;function fS(e){jn===null?jn=[e]:jn.push(e)}function ZC(e){Qd=!0,fS(e)}function ji(){if(!Ah&&jn!==null){Ah=!0;var e=0,t=qe;try{var r=jn;for(qe=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}jn=null,Qd=!1}catch(i){throw jn!==null&&(jn=jn.slice(e+1)),Dj(gy,ji),i}finally{qe=t,Ah=!1}}return null}var Da=[],La=0,Ru=null,Du=0,Pr=[],Or=0,sa=null,Sn=1,Nn="";function Mi(e,t){Da[La++]=Du,Da[La++]=Ru,Ru=e,Du=t}function hS(e,t,r){Pr[Or++]=Sn,Pr[Or++]=Nn,Pr[Or++]=sa,sa=e;var n=Sn;e=Nn;var i=32-Qr(n)-1;n&=~(1<<i),r+=1;var a=32-Qr(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Sn=1<<32-Qr(t)+i|r<<i|n,Nn=a+e}else Sn=1<<a|r<<i|n,Nn=e}function Ny(e){e.return!==null&&(Mi(e,1),hS(e,1,0))}function Ey(e){for(;e===Ru;)Ru=Da[--La],Da[La]=null,Du=Da[--La],Da[La]=null;for(;e===sa;)sa=Pr[--Or],Pr[Or]=null,Nn=Pr[--Or],Pr[Or]=null,Sn=Pr[--Or],Pr[Or]=null}var vr=null,yr=null,rt=!1,Yr=null;function pS(e,t){var r=kr(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ex(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vr=e,yr=di(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vr=e,yr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=sa!==null?{id:Sn,overflow:Nn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=kr(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,vr=e,yr=null,!0):!1;default:return!1}}function Zp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function em(e){if(rt){var t=yr;if(t){var r=t;if(!ex(e,t)){if(Zp(e))throw Error(ne(418));t=di(r.nextSibling);var n=vr;t&&ex(e,t)?pS(n,r):(e.flags=e.flags&-4097|2,rt=!1,vr=e)}}else{if(Zp(e))throw Error(ne(418));e.flags=e.flags&-4097|2,rt=!1,vr=e}}}function tx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vr=e}function Cc(e){if(e!==vr)return!1;if(!rt)return tx(e),rt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xp(e.type,e.memoizedProps)),t&&(t=yr)){if(Zp(e))throw mS(),Error(ne(418));for(;t;)pS(e,t),t=di(t.nextSibling)}if(tx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ne(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){yr=di(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}yr=null}}else yr=vr?di(e.stateNode.nextSibling):null;return!0}function mS(){for(var e=yr;e;)e=di(e.nextSibling)}function ss(){yr=vr=null,rt=!1}function Ay(e){Yr===null?Yr=[e]:Yr.push(e)}var eT=qn.ReactCurrentBatchConfig;function so(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ne(309));var n=r.stateNode}if(!n)throw Error(ne(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=i.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(ne(284));if(!r._owner)throw Error(ne(290,e))}return e}function Tc(e,t){throw e=Object.prototype.toString.call(t),Error(ne(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rx(e){var t=e._init;return t(e._payload)}function gS(e){function t(x,b){if(e){var g=x.deletions;g===null?(x.deletions=[b],x.flags|=16):g.push(b)}}function r(x,b){if(!e)return null;for(;b!==null;)t(x,b),b=b.sibling;return null}function n(x,b){for(x=new Map;b!==null;)b.key!==null?x.set(b.key,b):x.set(b.index,b),b=b.sibling;return x}function i(x,b){return x=mi(x,b),x.index=0,x.sibling=null,x}function a(x,b,g){return x.index=g,e?(g=x.alternate,g!==null?(g=g.index,g<b?(x.flags|=2,b):g):(x.flags|=2,b)):(x.flags|=1048576,b)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,b,g,S){return b===null||b.tag!==6?(b=Ih(g,x.mode,S),b.return=x,b):(b=i(b,g),b.return=x,b)}function c(x,b,g,S){var w=g.type;return w===Ta?d(x,b,g.props.children,S,g.key):b!==null&&(b.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Yn&&rx(w)===b.type)?(S=i(b,g.props),S.ref=so(x,b,g),S.return=x,S):(S=vu(g.type,g.key,g.props,null,x.mode,S),S.ref=so(x,b,g),S.return=x,S)}function u(x,b,g,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==g.containerInfo||b.stateNode.implementation!==g.implementation?(b=Mh(g,x.mode,S),b.return=x,b):(b=i(b,g.children||[]),b.return=x,b)}function d(x,b,g,S,w){return b===null||b.tag!==7?(b=Zi(g,x.mode,S,w),b.return=x,b):(b=i(b,g),b.return=x,b)}function f(x,b,g){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Ih(""+b,x.mode,g),b.return=x,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bc:return g=vu(b.type,b.key,b.props,null,x.mode,g),g.ref=so(x,null,b),g.return=x,g;case Ca:return b=Mh(b,x.mode,g),b.return=x,b;case Yn:var S=b._init;return f(x,S(b._payload),g)}if(jo(b)||to(b))return b=Zi(b,x.mode,g,null),b.return=x,b;Tc(x,b)}return null}function h(x,b,g,S){var w=b!==null?b.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return w!==null?null:l(x,b,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case bc:return g.key===w?c(x,b,g,S):null;case Ca:return g.key===w?u(x,b,g,S):null;case Yn:return w=g._init,h(x,b,w(g._payload),S)}if(jo(g)||to(g))return w!==null?null:d(x,b,g,S,null);Tc(x,g)}return null}function p(x,b,g,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(g)||null,l(b,x,""+S,w);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case bc:return x=x.get(S.key===null?g:S.key)||null,c(b,x,S,w);case Ca:return x=x.get(S.key===null?g:S.key)||null,u(b,x,S,w);case Yn:var j=S._init;return p(x,b,g,j(S._payload),w)}if(jo(S)||to(S))return x=x.get(g)||null,d(b,x,S,w,null);Tc(b,S)}return null}function y(x,b,g,S){for(var w=null,j=null,_=b,E=b=0,A=null;_!==null&&E<g.length;E++){_.index>E?(A=_,_=null):A=_.sibling;var P=h(x,_,g[E],S);if(P===null){_===null&&(_=A);break}e&&_&&P.alternate===null&&t(x,_),b=a(P,b,E),j===null?w=P:j.sibling=P,j=P,_=A}if(E===g.length)return r(x,_),rt&&Mi(x,E),w;if(_===null){for(;E<g.length;E++)_=f(x,g[E],S),_!==null&&(b=a(_,b,E),j===null?w=_:j.sibling=_,j=_);return rt&&Mi(x,E),w}for(_=n(x,_);E<g.length;E++)A=p(_,x,E,g[E],S),A!==null&&(e&&A.alternate!==null&&_.delete(A.key===null?E:A.key),b=a(A,b,E),j===null?w=A:j.sibling=A,j=A);return e&&_.forEach(function(T){return t(x,T)}),rt&&Mi(x,E),w}function v(x,b,g,S){var w=to(g);if(typeof w!="function")throw Error(ne(150));if(g=w.call(g),g==null)throw Error(ne(151));for(var j=w=null,_=b,E=b=0,A=null,P=g.next();_!==null&&!P.done;E++,P=g.next()){_.index>E?(A=_,_=null):A=_.sibling;var T=h(x,_,P.value,S);if(T===null){_===null&&(_=A);break}e&&_&&T.alternate===null&&t(x,_),b=a(T,b,E),j===null?w=T:j.sibling=T,j=T,_=A}if(P.done)return r(x,_),rt&&Mi(x,E),w;if(_===null){for(;!P.done;E++,P=g.next())P=f(x,P.value,S),P!==null&&(b=a(P,b,E),j===null?w=P:j.sibling=P,j=P);return rt&&Mi(x,E),w}for(_=n(x,_);!P.done;E++,P=g.next())P=p(_,x,E,P.value,S),P!==null&&(e&&P.alternate!==null&&_.delete(P.key===null?E:P.key),b=a(P,b,E),j===null?w=P:j.sibling=P,j=P);return e&&_.forEach(function(M){return t(x,M)}),rt&&Mi(x,E),w}function m(x,b,g,S){if(typeof g=="object"&&g!==null&&g.type===Ta&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case bc:e:{for(var w=g.key,j=b;j!==null;){if(j.key===w){if(w=g.type,w===Ta){if(j.tag===7){r(x,j.sibling),b=i(j,g.props.children),b.return=x,x=b;break e}}else if(j.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Yn&&rx(w)===j.type){r(x,j.sibling),b=i(j,g.props),b.ref=so(x,j,g),b.return=x,x=b;break e}r(x,j);break}else t(x,j);j=j.sibling}g.type===Ta?(b=Zi(g.props.children,x.mode,S,g.key),b.return=x,x=b):(S=vu(g.type,g.key,g.props,null,x.mode,S),S.ref=so(x,b,g),S.return=x,x=S)}return o(x);case Ca:e:{for(j=g.key;b!==null;){if(b.key===j)if(b.tag===4&&b.stateNode.containerInfo===g.containerInfo&&b.stateNode.implementation===g.implementation){r(x,b.sibling),b=i(b,g.children||[]),b.return=x,x=b;break e}else{r(x,b);break}else t(x,b);b=b.sibling}b=Mh(g,x.mode,S),b.return=x,x=b}return o(x);case Yn:return j=g._init,m(x,b,j(g._payload),S)}if(jo(g))return y(x,b,g,S);if(to(g))return v(x,b,g,S);Tc(x,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,b!==null&&b.tag===6?(r(x,b.sibling),b=i(b,g),b.return=x,x=b):(r(x,b),b=Ih(g,x.mode,S),b.return=x,x=b),o(x)):r(x,b)}return m}var os=gS(!0),yS=gS(!1),Lu=_i(null),Bu=null,Ba=null,Py=null;function Oy(){Py=Ba=Bu=null}function Cy(e){var t=Lu.current;tt(Lu),e._currentValue=t}function tm(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Qa(e,t){Bu=e,Py=Ba=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(tr=!0),e.firstContext=null)}function Rr(e){var t=e._currentValue;if(Py!==e)if(e={context:e,memoizedValue:t,next:null},Ba===null){if(Bu===null)throw Error(ne(308));Ba=e,Bu.dependencies={lanes:0,firstContext:e}}else Ba=Ba.next=e;return t}var Vi=null;function Ty(e){Vi===null?Vi=[e]:Vi.push(e)}function vS(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,Ty(t)):(r.next=i.next,i.next=r),t.interleaved=r,Rn(e,n)}function Rn(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Jn=!1;function ky(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function On(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fi(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Me&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Rn(e,r)}return i=n.interleaved,i===null?(t.next=t,Ty(n)):(t.next=i.next,i.next=t),n.interleaved=t,Rn(e,r)}function fu(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,yy(e,r)}}function nx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Fu(e,t,r,n){var i=e.updateQueue;Jn=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=i.baseState;o=0,d=u=c=null,l=a;do{var h=l.lane,p=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,v=l;switch(h=t,p=r,v.tag){case 1:if(y=v.payload,typeof y=="function"){f=y.call(p,f,h);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,h=typeof y=="function"?y.call(p,f,h):y,h==null)break e;f=ot({},f,h);break e;case 2:Jn=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);la|=o,e.lanes=o,e.memoizedState=f}}function ix(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(ne(191,i));i.call(n)}}}var ic={},fn=_i(ic),sl=_i(ic),ol=_i(ic);function Gi(e){if(e===ic)throw Error(ne(174));return e}function $y(e,t){switch(Ye(ol,t),Ye(sl,e),Ye(fn,ic),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mp(t,e)}tt(fn),Ye(fn,t)}function ls(){tt(fn),tt(sl),tt(ol)}function bS(e){Gi(ol.current);var t=Gi(fn.current),r=Mp(t,e.type);t!==r&&(Ye(sl,e),Ye(fn,r))}function Iy(e){sl.current===e&&(tt(fn),tt(sl))}var at=_i(0);function qu(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ph=[];function My(){for(var e=0;e<Ph.length;e++)Ph[e]._workInProgressVersionPrimary=null;Ph.length=0}var hu=qn.ReactCurrentDispatcher,Oh=qn.ReactCurrentBatchConfig,oa=0,st=null,jt=null,Ct=null,Uu=!1,Mo=!1,ll=0,tT=0;function Bt(){throw Error(ne(321))}function Ry(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!tn(e[r],t[r]))return!1;return!0}function Dy(e,t,r,n,i,a){if(oa=a,st=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,hu.current=e===null||e.memoizedState===null?aT:sT,e=r(n,i),Mo){a=0;do{if(Mo=!1,ll=0,25<=a)throw Error(ne(301));a+=1,Ct=jt=null,t.updateQueue=null,hu.current=oT,e=r(n,i)}while(Mo)}if(hu.current=zu,t=jt!==null&&jt.next!==null,oa=0,Ct=jt=st=null,Uu=!1,t)throw Error(ne(300));return e}function Ly(){var e=ll!==0;return ll=0,e}function an(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ct===null?st.memoizedState=Ct=e:Ct=Ct.next=e,Ct}function Dr(){if(jt===null){var e=st.alternate;e=e!==null?e.memoizedState:null}else e=jt.next;var t=Ct===null?st.memoizedState:Ct.next;if(t!==null)Ct=t,jt=e;else{if(e===null)throw Error(ne(310));jt=e,e={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},Ct===null?st.memoizedState=Ct=e:Ct=Ct.next=e}return Ct}function cl(e,t){return typeof t=="function"?t(e):t}function Ch(e){var t=Dr(),r=t.queue;if(r===null)throw Error(ne(311));r.lastRenderedReducer=e;var n=jt,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((oa&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,st.lanes|=d,la|=d}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,tn(n,t.memoizedState)||(tr=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,st.lanes|=a,la|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Th(e){var t=Dr(),r=t.queue;if(r===null)throw Error(ne(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);tn(a,t.memoizedState)||(tr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function wS(){}function _S(e,t){var r=st,n=Dr(),i=t(),a=!tn(n.memoizedState,i);if(a&&(n.memoizedState=i,tr=!0),n=n.queue,By(NS.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Ct!==null&&Ct.memoizedState.tag&1){if(r.flags|=2048,ul(9,SS.bind(null,r,n,i,t),void 0,null),Tt===null)throw Error(ne(349));oa&30||jS(r,t,i)}return i}function jS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function SS(e,t,r,n){t.value=r,t.getSnapshot=n,ES(t)&&AS(e)}function NS(e,t,r){return r(function(){ES(t)&&AS(e)})}function ES(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!tn(e,r)}catch{return!0}}function AS(e){var t=Rn(e,1);t!==null&&Zr(t,e,1,-1)}function ax(e){var t=an();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cl,lastRenderedState:e},t.queue=e,e=e.dispatch=iT.bind(null,st,e),[t.memoizedState,e]}function ul(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=st.updateQueue,t===null?(t={lastEffect:null,stores:null},st.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function PS(){return Dr().memoizedState}function pu(e,t,r,n){var i=an();st.flags|=e,i.memoizedState=ul(1|t,r,void 0,n===void 0?null:n)}function Zd(e,t,r,n){var i=Dr();n=n===void 0?null:n;var a=void 0;if(jt!==null){var o=jt.memoizedState;if(a=o.destroy,n!==null&&Ry(n,o.deps)){i.memoizedState=ul(t,r,a,n);return}}st.flags|=e,i.memoizedState=ul(1|t,r,a,n)}function sx(e,t){return pu(8390656,8,e,t)}function By(e,t){return Zd(2048,8,e,t)}function OS(e,t){return Zd(4,2,e,t)}function CS(e,t){return Zd(4,4,e,t)}function TS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function kS(e,t,r){return r=r!=null?r.concat([e]):null,Zd(4,4,TS.bind(null,t,e),r)}function Fy(){}function $S(e,t){var r=Dr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ry(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function IS(e,t){var r=Dr();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&Ry(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function MS(e,t,r){return oa&21?(tn(r,t)||(r=Fj(),st.lanes|=r,la|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,tr=!0),e.memoizedState=r)}function rT(e,t){var r=qe;qe=r!==0&&4>r?r:4,e(!0);var n=Oh.transition;Oh.transition={};try{e(!1),t()}finally{qe=r,Oh.transition=n}}function RS(){return Dr().memoizedState}function nT(e,t,r){var n=pi(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},DS(e))LS(t,r);else if(r=vS(e,t,r,n),r!==null){var i=Yt();Zr(r,e,n,i),BS(r,t,n)}}function iT(e,t,r){var n=pi(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(DS(e))LS(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,r);if(i.hasEagerState=!0,i.eagerState=l,tn(l,o)){var c=t.interleaved;c===null?(i.next=i,Ty(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=vS(e,t,i,n),r!==null&&(i=Yt(),Zr(r,e,n,i),BS(r,t,n))}}function DS(e){var t=e.alternate;return e===st||t!==null&&t===st}function LS(e,t){Mo=Uu=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function BS(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,yy(e,r)}}var zu={readContext:Rr,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},aT={readContext:Rr,useCallback:function(e,t){return an().memoizedState=[e,t===void 0?null:t],e},useContext:Rr,useEffect:sx,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,pu(4194308,4,TS.bind(null,t,e),r)},useLayoutEffect:function(e,t){return pu(4194308,4,e,t)},useInsertionEffect:function(e,t){return pu(4,2,e,t)},useMemo:function(e,t){var r=an();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=an();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=nT.bind(null,st,e),[n.memoizedState,e]},useRef:function(e){var t=an();return e={current:e},t.memoizedState=e},useState:ax,useDebugValue:Fy,useDeferredValue:function(e){return an().memoizedState=e},useTransition:function(){var e=ax(!1),t=e[0];return e=rT.bind(null,e[1]),an().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=st,i=an();if(rt){if(r===void 0)throw Error(ne(407));r=r()}else{if(r=t(),Tt===null)throw Error(ne(349));oa&30||jS(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,sx(NS.bind(null,n,a,e),[e]),n.flags|=2048,ul(9,SS.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=an(),t=Tt.identifierPrefix;if(rt){var r=Nn,n=Sn;r=(n&~(1<<32-Qr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ll++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=tT++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},sT={readContext:Rr,useCallback:$S,useContext:Rr,useEffect:By,useImperativeHandle:kS,useInsertionEffect:OS,useLayoutEffect:CS,useMemo:IS,useReducer:Ch,useRef:PS,useState:function(){return Ch(cl)},useDebugValue:Fy,useDeferredValue:function(e){var t=Dr();return MS(t,jt.memoizedState,e)},useTransition:function(){var e=Ch(cl)[0],t=Dr().memoizedState;return[e,t]},useMutableSource:wS,useSyncExternalStore:_S,useId:RS,unstable_isNewReconciler:!1},oT={readContext:Rr,useCallback:$S,useContext:Rr,useEffect:By,useImperativeHandle:kS,useInsertionEffect:OS,useLayoutEffect:CS,useMemo:IS,useReducer:Th,useRef:PS,useState:function(){return Th(cl)},useDebugValue:Fy,useDeferredValue:function(e){var t=Dr();return jt===null?t.memoizedState=e:MS(t,jt.memoizedState,e)},useTransition:function(){var e=Th(cl)[0],t=Dr().memoizedState;return[e,t]},useMutableSource:wS,useSyncExternalStore:_S,useId:RS,unstable_isNewReconciler:!1};function Vr(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function rm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:ot({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ef={isMounted:function(e){return(e=e._reactInternals)?fa(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Yt(),i=pi(e),a=On(n,i);a.payload=t,r!=null&&(a.callback=r),t=fi(e,a,i),t!==null&&(Zr(t,e,i,n),fu(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Yt(),i=pi(e),a=On(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=fi(e,a,i),t!==null&&(Zr(t,e,i,n),fu(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Yt(),n=pi(e),i=On(r,n);i.tag=2,t!=null&&(i.callback=t),t=fi(e,i,n),t!==null&&(Zr(t,e,n,r),fu(t,e,n))}};function ox(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!rl(r,n)||!rl(i,a):!0}function FS(e,t,r){var n=!1,i=vi,a=t.contextType;return typeof a=="object"&&a!==null?a=Rr(a):(i=or(t)?aa:Ht.current,n=t.contextTypes,a=(n=n!=null)?as(e,i):vi),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ef,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function lx(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ef.enqueueReplaceState(t,t.state,null)}function nm(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},ky(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Rr(a):(a=or(t)?aa:Ht.current,i.context=as(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(rm(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ef.enqueueReplaceState(i,i.state,null),Fu(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function cs(e,t){try{var r="",n=t;do r+=MO(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function kh(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function im(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var lT=typeof WeakMap=="function"?WeakMap:Map;function qS(e,t,r){r=On(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Hu||(Hu=!0,pm=n),im(e,t)},r}function US(e,t,r){r=On(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){im(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){im(e,t),typeof n!="function"&&(hi===null?hi=new Set([this]):hi.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function cx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new lT;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=_T.bind(null,e,t,r),t.then(e,e))}function ux(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dx(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=On(-1,1),t.tag=2,fi(r,t,1))),r.lanes|=1),e)}var cT=qn.ReactCurrentOwner,tr=!1;function Vt(e,t,r,n){t.child=e===null?yS(t,null,r,n):os(t,e.child,r,n)}function fx(e,t,r,n,i){r=r.render;var a=t.ref;return Qa(t,i),n=Dy(e,t,r,n,a,i),r=Ly(),e!==null&&!tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Dn(e,t,i)):(rt&&r&&Ny(t),t.flags|=1,Vt(e,t,n,i),t.child)}function hx(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!Ky(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,zS(e,t,a,n,i)):(e=vu(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:rl,r(o,n)&&e.ref===t.ref)return Dn(e,t,i)}return t.flags|=1,e=mi(a,n),e.ref=t.ref,e.return=t,t.child=e}function zS(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(rl(a,n)&&e.ref===t.ref)if(tr=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(tr=!0);else return t.lanes=e.lanes,Dn(e,t,i)}return am(e,t,r,n,i)}function WS(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(qa,fr),fr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ye(qa,fr),fr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Ye(qa,fr),fr|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ye(qa,fr),fr|=n;return Vt(e,t,i,r),t.child}function HS(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function am(e,t,r,n,i){var a=or(r)?aa:Ht.current;return a=as(t,a),Qa(t,i),r=Dy(e,t,r,n,a,i),n=Ly(),e!==null&&!tr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Dn(e,t,i)):(rt&&n&&Ny(t),t.flags|=1,Vt(e,t,r,i),t.child)}function px(e,t,r,n,i){if(or(r)){var a=!0;Mu(t)}else a=!1;if(Qa(t,i),t.stateNode===null)mu(e,t),FS(t,r,n),nm(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Rr(u):(u=or(r)?aa:Ht.current,u=as(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&lx(t,o,n,u),Jn=!1;var h=t.memoizedState;o.state=h,Fu(t,n,o,i),c=t.memoizedState,l!==n||h!==c||sr.current||Jn?(typeof d=="function"&&(rm(t,r,d,n),c=t.memoizedState),(l=Jn||ox(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,xS(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Vr(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Rr(c):(c=or(r)?aa:Ht.current,c=as(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&lx(t,o,n,c),Jn=!1,h=t.memoizedState,o.state=h,Fu(t,n,o,i);var y=t.memoizedState;l!==f||h!==y||sr.current||Jn?(typeof p=="function"&&(rm(t,r,p,n),y=t.memoizedState),(u=Jn||ox(t,r,u,n,h,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,y,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=y),o.props=n,o.state=y,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return sm(e,t,r,n,a,i)}function sm(e,t,r,n,i,a){HS(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&Zv(t,r,!1),Dn(e,t,a);n=t.stateNode,cT.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=os(t,e.child,null,a),t.child=os(t,null,l,a)):Vt(e,t,l,a),t.memoizedState=n.state,i&&Zv(t,r,!0),t.child}function VS(e){var t=e.stateNode;t.pendingContext?Qv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qv(e,t.context,!1),$y(e,t.containerInfo)}function mx(e,t,r,n,i){return ss(),Ay(i),t.flags|=256,Vt(e,t,r,n),t.child}var om={dehydrated:null,treeContext:null,retryLane:0};function lm(e){return{baseLanes:e,cachePool:null,transitions:null}}function GS(e,t,r){var n=t.pendingProps,i=at.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ye(at,i&1),e===null)return em(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=nf(o,n,0,null),e=Zi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=lm(r),t.memoizedState=om,e):qy(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return uT(e,t,o,n,l,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=mi(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?a=mi(l,a):(a=Zi(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?lm(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=om,n}return a=e.child,e=a.sibling,n=mi(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function qy(e,t){return t=nf({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function kc(e,t,r,n){return n!==null&&Ay(n),os(t,e.child,null,r),e=qy(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function uT(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=kh(Error(ne(422))),kc(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=nf({mode:"visible",children:n.children},i,0,null),a=Zi(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&os(t,e.child,null,o),t.child.memoizedState=lm(o),t.memoizedState=om,a);if(!(t.mode&1))return kc(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(ne(419)),n=kh(a,n,void 0),kc(e,t,o,n)}if(l=(o&e.childLanes)!==0,tr||l){if(n=Tt,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Rn(e,i),Zr(n,e,i,-1))}return Gy(),n=kh(Error(ne(421))),kc(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=jT.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,yr=di(i.nextSibling),vr=t,rt=!0,Yr=null,e!==null&&(Pr[Or++]=Sn,Pr[Or++]=Nn,Pr[Or++]=sa,Sn=e.id,Nn=e.overflow,sa=t),t=qy(t,n.children),t.flags|=4096,t)}function gx(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),tm(e.return,t,r)}function $h(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function KS(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Vt(e,t,n.children,r),n=at.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&gx(e,r,t);else if(e.tag===19)gx(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ye(at,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&qu(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),$h(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&qu(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}$h(t,!0,r,null,a);break;case"together":$h(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function mu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Dn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),la|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ne(153));if(t.child!==null){for(e=t.child,r=mi(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=mi(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function dT(e,t,r){switch(t.tag){case 3:VS(t),ss();break;case 5:bS(t);break;case 1:or(t.type)&&Mu(t);break;case 4:$y(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ye(Lu,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ye(at,at.current&1),t.flags|=128,null):r&t.child.childLanes?GS(e,t,r):(Ye(at,at.current&1),e=Dn(e,t,r),e!==null?e.sibling:null);Ye(at,at.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return KS(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ye(at,at.current),n)break;return null;case 22:case 23:return t.lanes=0,WS(e,t,r)}return Dn(e,t,r)}var XS,cm,YS,JS;XS=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};cm=function(){};YS=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Gi(fn.current);var a=null;switch(r){case"input":i=Tp(e,i),n=Tp(e,n),a=[];break;case"select":i=ot({},i,{value:void 0}),n=ot({},n,{value:void 0}),a=[];break;case"textarea":i=Ip(e,i),n=Ip(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=$u)}Rp(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Xo.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Xo.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Qe("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};JS=function(e,t,r,n){r!==n&&(t.flags|=4)};function oo(e,t){if(!rt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Ft(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function fT(e,t,r){var n=t.pendingProps;switch(Ey(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(t),null;case 1:return or(t.type)&&Iu(),Ft(t),null;case 3:return n=t.stateNode,ls(),tt(sr),tt(Ht),My(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Cc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yr!==null&&(ym(Yr),Yr=null))),cm(e,t),Ft(t),null;case 5:Iy(t);var i=Gi(ol.current);if(r=t.type,e!==null&&t.stateNode!=null)YS(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ne(166));return Ft(t),null}if(e=Gi(fn.current),Cc(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[on]=t,n[al]=a,e=(t.mode&1)!==0,r){case"dialog":Qe("cancel",n),Qe("close",n);break;case"iframe":case"object":case"embed":Qe("load",n);break;case"video":case"audio":for(i=0;i<No.length;i++)Qe(No[i],n);break;case"source":Qe("error",n);break;case"img":case"image":case"link":Qe("error",n),Qe("load",n);break;case"details":Qe("toggle",n);break;case"input":Nv(n,a),Qe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Qe("invalid",n);break;case"textarea":Av(n,a),Qe("invalid",n)}Rp(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Oc(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Oc(n.textContent,l,e),i=["children",""+l]):Xo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Qe("scroll",n)}switch(r){case"input":wc(n),Ev(n,a,!0);break;case"textarea":wc(n),Pv(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=$u)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Nj(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[on]=t,e[al]=n,XS(e,t,!1,!1),t.stateNode=e;e:{switch(o=Dp(r,n),r){case"dialog":Qe("cancel",e),Qe("close",e),i=n;break;case"iframe":case"object":case"embed":Qe("load",e),i=n;break;case"video":case"audio":for(i=0;i<No.length;i++)Qe(No[i],e);i=n;break;case"source":Qe("error",e),i=n;break;case"img":case"image":case"link":Qe("error",e),Qe("load",e),i=n;break;case"details":Qe("toggle",e),i=n;break;case"input":Nv(e,n),i=Tp(e,n),Qe("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=ot({},n,{value:void 0}),Qe("invalid",e);break;case"textarea":Av(e,n),i=Ip(e,n),Qe("invalid",e);break;default:i=n}Rp(r,i),l=i;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Pj(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ej(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Yo(e,c):typeof c=="number"&&Yo(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Xo.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Qe("scroll",e):c!=null&&dy(e,a,c,o))}switch(r){case"input":wc(e),Ev(e,n,!1);break;case"textarea":wc(e),Pv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+yi(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Ka(e,!!n.multiple,a,!1):n.defaultValue!=null&&Ka(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=$u)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ft(t),null;case 6:if(e&&t.stateNode!=null)JS(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ne(166));if(r=Gi(ol.current),Gi(fn.current),Cc(t)){if(n=t.stateNode,r=t.memoizedProps,n[on]=t,(a=n.nodeValue!==r)&&(e=vr,e!==null))switch(e.tag){case 3:Oc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Oc(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[on]=t,t.stateNode=n}return Ft(t),null;case 13:if(tt(at),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rt&&yr!==null&&t.mode&1&&!(t.flags&128))mS(),ss(),t.flags|=98560,a=!1;else if(a=Cc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ne(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ne(317));a[on]=t}else ss(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ft(t),a=!1}else Yr!==null&&(ym(Yr),Yr=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||at.current&1?Et===0&&(Et=3):Gy())),t.updateQueue!==null&&(t.flags|=4),Ft(t),null);case 4:return ls(),cm(e,t),e===null&&nl(t.stateNode.containerInfo),Ft(t),null;case 10:return Cy(t.type._context),Ft(t),null;case 17:return or(t.type)&&Iu(),Ft(t),null;case 19:if(tt(at),a=t.memoizedState,a===null)return Ft(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)oo(a,!1);else{if(Et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=qu(e),o!==null){for(t.flags|=128,oo(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ye(at,at.current&1|2),t.child}e=e.sibling}a.tail!==null&&ft()>us&&(t.flags|=128,n=!0,oo(a,!1),t.lanes=4194304)}else{if(!n)if(e=qu(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),oo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!rt)return Ft(t),null}else 2*ft()-a.renderingStartTime>us&&r!==1073741824&&(t.flags|=128,n=!0,oo(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=ft(),t.sibling=null,r=at.current,Ye(at,n?r&1|2:r&1),t):(Ft(t),null);case 22:case 23:return Vy(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?fr&1073741824&&(Ft(t),t.subtreeFlags&6&&(t.flags|=8192)):Ft(t),null;case 24:return null;case 25:return null}throw Error(ne(156,t.tag))}function hT(e,t){switch(Ey(t),t.tag){case 1:return or(t.type)&&Iu(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ls(),tt(sr),tt(Ht),My(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Iy(t),null;case 13:if(tt(at),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ne(340));ss()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tt(at),null;case 4:return ls(),null;case 10:return Cy(t.type._context),null;case 22:case 23:return Vy(),null;case 24:return null;default:return null}}var $c=!1,Ut=!1,pT=typeof WeakSet=="function"?WeakSet:Set,de=null;function Fa(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){lt(e,t,n)}else r.current=null}function um(e,t,r){try{r()}catch(n){lt(e,t,n)}}var yx=!1;function mT(e,t){if(Gp=Cu,e=rS(),Sy(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==a||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(l=o),h===a&&++d===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kp={focusedElem:e,selectionRange:r},Cu=!1,de=t;de!==null;)if(t=de,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,de=e;else for(;de!==null;){t=de;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,m=y.memoizedState,x=t.stateNode,b=x.getSnapshotBeforeUpdate(t.elementType===t.type?v:Vr(t.type,v),m);x.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ne(163))}}catch(S){lt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,de=e;break}de=t.return}return y=yx,yx=!1,y}function Ro(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&um(t,r,a)}i=i.next}while(i!==n)}}function tf(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function dm(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function QS(e){var t=e.alternate;t!==null&&(e.alternate=null,QS(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[on],delete t[al],delete t[Jp],delete t[JC],delete t[QC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ZS(e){return e.tag===5||e.tag===3||e.tag===4}function vx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ZS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=$u));else if(n!==4&&(e=e.child,e!==null))for(fm(e,t,r),e=e.sibling;e!==null;)fm(e,t,r),e=e.sibling}function hm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(hm(e,t,r),e=e.sibling;e!==null;)hm(e,t,r),e=e.sibling}var It=null,Kr=!1;function Kn(e,t,r){for(r=r.child;r!==null;)eN(e,t,r),r=r.sibling}function eN(e,t,r){if(dn&&typeof dn.onCommitFiberUnmount=="function")try{dn.onCommitFiberUnmount(Gd,r)}catch{}switch(r.tag){case 5:Ut||Fa(r,t);case 6:var n=It,i=Kr;It=null,Kn(e,t,r),It=n,Kr=i,It!==null&&(Kr?(e=It,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):It.removeChild(r.stateNode));break;case 18:It!==null&&(Kr?(e=It,r=r.stateNode,e.nodeType===8?Eh(e.parentNode,r):e.nodeType===1&&Eh(e,r),el(e)):Eh(It,r.stateNode));break;case 4:n=It,i=Kr,It=r.stateNode.containerInfo,Kr=!0,Kn(e,t,r),It=n,Kr=i;break;case 0:case 11:case 14:case 15:if(!Ut&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&um(r,t,o),i=i.next}while(i!==n)}Kn(e,t,r);break;case 1:if(!Ut&&(Fa(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){lt(r,t,l)}Kn(e,t,r);break;case 21:Kn(e,t,r);break;case 22:r.mode&1?(Ut=(n=Ut)||r.memoizedState!==null,Kn(e,t,r),Ut=n):Kn(e,t,r);break;default:Kn(e,t,r)}}function xx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new pT),t.forEach(function(n){var i=ST.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Ur(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:It=l.stateNode,Kr=!1;break e;case 3:It=l.stateNode.containerInfo,Kr=!0;break e;case 4:It=l.stateNode.containerInfo,Kr=!0;break e}l=l.return}if(It===null)throw Error(ne(160));eN(a,o,i),It=null,Kr=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){lt(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tN(t,e),t=t.sibling}function tN(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ur(t,e),nn(e),n&4){try{Ro(3,e,e.return),tf(3,e)}catch(v){lt(e,e.return,v)}try{Ro(5,e,e.return)}catch(v){lt(e,e.return,v)}}break;case 1:Ur(t,e),nn(e),n&512&&r!==null&&Fa(r,r.return);break;case 5:if(Ur(t,e),nn(e),n&512&&r!==null&&Fa(r,r.return),e.flags&32){var i=e.stateNode;try{Yo(i,"")}catch(v){lt(e,e.return,v)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&jj(i,a),Dp(l,o);var u=Dp(l,a);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?Pj(i,f):d==="dangerouslySetInnerHTML"?Ej(i,f):d==="children"?Yo(i,f):dy(i,d,f,u)}switch(l){case"input":kp(i,a);break;case"textarea":Sj(i,a);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Ka(i,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?Ka(i,!!a.multiple,a.defaultValue,!0):Ka(i,!!a.multiple,a.multiple?[]:"",!1))}i[al]=a}catch(v){lt(e,e.return,v)}}break;case 6:if(Ur(t,e),nn(e),n&4){if(e.stateNode===null)throw Error(ne(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(v){lt(e,e.return,v)}}break;case 3:if(Ur(t,e),nn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{el(t.containerInfo)}catch(v){lt(e,e.return,v)}break;case 4:Ur(t,e),nn(e);break;case 13:Ur(t,e),nn(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(Wy=ft())),n&4&&xx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ut=(u=Ut)||d,Ur(t,e),Ut=u):Ur(t,e),nn(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(de=e,d=e.child;d!==null;){for(f=de=d;de!==null;){switch(h=de,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ro(4,h,h.return);break;case 1:Fa(h,h.return);var y=h.stateNode;if(typeof y.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(v){lt(n,r,v)}}break;case 5:Fa(h,h.return);break;case 22:if(h.memoizedState!==null){wx(f);continue}}p!==null?(p.return=h,de=p):wx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Aj("display",o))}catch(v){lt(e,e.return,v)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){lt(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ur(t,e),nn(e),n&4&&xx(e);break;case 21:break;default:Ur(t,e),nn(e)}}function nn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ZS(r)){var n=r;break e}r=r.return}throw Error(ne(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Yo(i,""),n.flags&=-33);var a=vx(e);hm(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=vx(e);fm(e,l,o);break;default:throw Error(ne(161))}}catch(c){lt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function gT(e,t,r){de=e,rN(e)}function rN(e,t,r){for(var n=(e.mode&1)!==0;de!==null;){var i=de,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||$c;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Ut;l=$c;var u=Ut;if($c=o,(Ut=c)&&!u)for(de=i;de!==null;)o=de,c=o.child,o.tag===22&&o.memoizedState!==null?_x(i):c!==null?(c.return=o,de=c):_x(i);for(;a!==null;)de=a,rN(a),a=a.sibling;de=i,$c=l,Ut=u}bx(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,de=a):bx(e)}}function bx(e){for(;de!==null;){var t=de;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ut||tf(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ut)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Vr(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&ix(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ix(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&el(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ne(163))}Ut||t.flags&512&&dm(t)}catch(h){lt(t,t.return,h)}}if(t===e){de=null;break}if(r=t.sibling,r!==null){r.return=t.return,de=r;break}de=t.return}}function wx(e){for(;de!==null;){var t=de;if(t===e){de=null;break}var r=t.sibling;if(r!==null){r.return=t.return,de=r;break}de=t.return}}function _x(e){for(;de!==null;){var t=de;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{tf(4,t)}catch(c){lt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){lt(t,i,c)}}var a=t.return;try{dm(t)}catch(c){lt(t,a,c)}break;case 5:var o=t.return;try{dm(t)}catch(c){lt(t,o,c)}}}catch(c){lt(t,t.return,c)}if(t===e){de=null;break}var l=t.sibling;if(l!==null){l.return=t.return,de=l;break}de=t.return}}var yT=Math.ceil,Wu=qn.ReactCurrentDispatcher,Uy=qn.ReactCurrentOwner,Mr=qn.ReactCurrentBatchConfig,Me=0,Tt=null,gt=null,Dt=0,fr=0,qa=_i(0),Et=0,dl=null,la=0,rf=0,zy=0,Do=null,er=null,Wy=0,us=1/0,bn=null,Hu=!1,pm=null,hi=null,Ic=!1,si=null,Vu=0,Lo=0,mm=null,gu=-1,yu=0;function Yt(){return Me&6?ft():gu!==-1?gu:gu=ft()}function pi(e){return e.mode&1?Me&2&&Dt!==0?Dt&-Dt:eT.transition!==null?(yu===0&&(yu=Fj()),yu):(e=qe,e!==0||(e=window.event,e=e===void 0?16:Gj(e.type)),e):1}function Zr(e,t,r,n){if(50<Lo)throw Lo=0,mm=null,Error(ne(185));tc(e,r,n),(!(Me&2)||e!==Tt)&&(e===Tt&&(!(Me&2)&&(rf|=r),Et===4&&ei(e,Dt)),lr(e,n),r===1&&Me===0&&!(t.mode&1)&&(us=ft()+500,Qd&&ji()))}function lr(e,t){var r=e.callbackNode;eC(e,t);var n=Ou(e,e===Tt?Dt:0);if(n===0)r!==null&&Tv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Tv(r),t===1)e.tag===0?ZC(jx.bind(null,e)):fS(jx.bind(null,e)),XC(function(){!(Me&6)&&ji()}),r=null;else{switch(qj(n)){case 1:r=gy;break;case 4:r=Lj;break;case 16:r=Pu;break;case 536870912:r=Bj;break;default:r=Pu}r=uN(r,nN.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nN(e,t){if(gu=-1,yu=0,Me&6)throw Error(ne(327));var r=e.callbackNode;if(Za()&&e.callbackNode!==r)return null;var n=Ou(e,e===Tt?Dt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Gu(e,n);else{t=n;var i=Me;Me|=2;var a=aN();(Tt!==e||Dt!==t)&&(bn=null,us=ft()+500,Qi(e,t));do try{bT();break}catch(l){iN(e,l)}while(!0);Oy(),Wu.current=a,Me=i,gt!==null?t=0:(Tt=null,Dt=0,t=Et)}if(t!==0){if(t===2&&(i=Up(e),i!==0&&(n=i,t=gm(e,i))),t===1)throw r=dl,Qi(e,0),ei(e,n),lr(e,ft()),r;if(t===6)ei(e,n);else{if(i=e.current.alternate,!(n&30)&&!vT(i)&&(t=Gu(e,n),t===2&&(a=Up(e),a!==0&&(n=a,t=gm(e,a))),t===1))throw r=dl,Qi(e,0),ei(e,n),lr(e,ft()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(ne(345));case 2:Ri(e,er,bn);break;case 3:if(ei(e,n),(n&130023424)===n&&(t=Wy+500-ft(),10<t)){if(Ou(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Yt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Yp(Ri.bind(null,e,er,bn),t);break}Ri(e,er,bn);break;case 4:if(ei(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Qr(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=ft()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*yT(n/1960))-n,10<n){e.timeoutHandle=Yp(Ri.bind(null,e,er,bn),n);break}Ri(e,er,bn);break;case 5:Ri(e,er,bn);break;default:throw Error(ne(329))}}}return lr(e,ft()),e.callbackNode===r?nN.bind(null,e):null}function gm(e,t){var r=Do;return e.current.memoizedState.isDehydrated&&(Qi(e,t).flags|=256),e=Gu(e,t),e!==2&&(t=er,er=r,t!==null&&ym(t)),e}function ym(e){er===null?er=e:er.push.apply(er,e)}function vT(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!tn(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ei(e,t){for(t&=~zy,t&=~rf,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Qr(t),n=1<<r;e[r]=-1,t&=~n}}function jx(e){if(Me&6)throw Error(ne(327));Za();var t=Ou(e,0);if(!(t&1))return lr(e,ft()),null;var r=Gu(e,t);if(e.tag!==0&&r===2){var n=Up(e);n!==0&&(t=n,r=gm(e,n))}if(r===1)throw r=dl,Qi(e,0),ei(e,t),lr(e,ft()),r;if(r===6)throw Error(ne(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ri(e,er,bn),lr(e,ft()),null}function Hy(e,t){var r=Me;Me|=1;try{return e(t)}finally{Me=r,Me===0&&(us=ft()+500,Qd&&ji())}}function ca(e){si!==null&&si.tag===0&&!(Me&6)&&Za();var t=Me;Me|=1;var r=Mr.transition,n=qe;try{if(Mr.transition=null,qe=1,e)return e()}finally{qe=n,Mr.transition=r,Me=t,!(Me&6)&&ji()}}function Vy(){fr=qa.current,tt(qa)}function Qi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,KC(r)),gt!==null)for(r=gt.return;r!==null;){var n=r;switch(Ey(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Iu();break;case 3:ls(),tt(sr),tt(Ht),My();break;case 5:Iy(n);break;case 4:ls();break;case 13:tt(at);break;case 19:tt(at);break;case 10:Cy(n.type._context);break;case 22:case 23:Vy()}r=r.return}if(Tt=e,gt=e=mi(e.current,null),Dt=fr=t,Et=0,dl=null,zy=rf=la=0,er=Do=null,Vi!==null){for(t=0;t<Vi.length;t++)if(r=Vi[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}Vi=null}return e}function iN(e,t){do{var r=gt;try{if(Oy(),hu.current=zu,Uu){for(var n=st.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Uu=!1}if(oa=0,Ct=jt=st=null,Mo=!1,ll=0,Uy.current=null,r===null||r.return===null){Et=1,dl=t,gt=null;break}e:{var a=e,o=r.return,l=r,c=t;if(t=Dt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ux(o);if(p!==null){p.flags&=-257,dx(p,o,l,a,t),p.mode&1&&cx(a,u,t),t=p,c=u;var y=t.updateQueue;if(y===null){var v=new Set;v.add(c),t.updateQueue=v}else y.add(c);break e}else{if(!(t&1)){cx(a,u,t),Gy();break e}c=Error(ne(426))}}else if(rt&&l.mode&1){var m=ux(o);if(m!==null){!(m.flags&65536)&&(m.flags|=256),dx(m,o,l,a,t),Ay(cs(c,l));break e}}a=c=cs(c,l),Et!==4&&(Et=2),Do===null?Do=[a]:Do.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var x=qS(a,c,t);nx(a,x);break e;case 1:l=c;var b=a.type,g=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(hi===null||!hi.has(g)))){a.flags|=65536,t&=-t,a.lanes|=t;var S=US(a,l,t);nx(a,S);break e}}a=a.return}while(a!==null)}oN(r)}catch(w){t=w,gt===r&&r!==null&&(gt=r=r.return);continue}break}while(!0)}function aN(){var e=Wu.current;return Wu.current=zu,e===null?zu:e}function Gy(){(Et===0||Et===3||Et===2)&&(Et=4),Tt===null||!(la&268435455)&&!(rf&268435455)||ei(Tt,Dt)}function Gu(e,t){var r=Me;Me|=2;var n=aN();(Tt!==e||Dt!==t)&&(bn=null,Qi(e,t));do try{xT();break}catch(i){iN(e,i)}while(!0);if(Oy(),Me=r,Wu.current=n,gt!==null)throw Error(ne(261));return Tt=null,Dt=0,Et}function xT(){for(;gt!==null;)sN(gt)}function bT(){for(;gt!==null&&!HO();)sN(gt)}function sN(e){var t=cN(e.alternate,e,fr);e.memoizedProps=e.pendingProps,t===null?oN(e):gt=t,Uy.current=null}function oN(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=hT(r,t),r!==null){r.flags&=32767,gt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Et=6,gt=null;return}}else if(r=fT(r,t,fr),r!==null){gt=r;return}if(t=t.sibling,t!==null){gt=t;return}gt=t=e}while(t!==null);Et===0&&(Et=5)}function Ri(e,t,r){var n=qe,i=Mr.transition;try{Mr.transition=null,qe=1,wT(e,t,r,n)}finally{Mr.transition=i,qe=n}return null}function wT(e,t,r,n){do Za();while(si!==null);if(Me&6)throw Error(ne(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ne(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(tC(e,a),e===Tt&&(gt=Tt=null,Dt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ic||(Ic=!0,uN(Pu,function(){return Za(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Mr.transition,Mr.transition=null;var o=qe;qe=1;var l=Me;Me|=4,Uy.current=null,mT(e,r),tN(r,e),qC(Kp),Cu=!!Gp,Kp=Gp=null,e.current=r,gT(r),VO(),Me=l,qe=o,Mr.transition=a}else e.current=r;if(Ic&&(Ic=!1,si=e,Vu=i),a=e.pendingLanes,a===0&&(hi=null),XO(r.stateNode),lr(e,ft()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Hu)throw Hu=!1,e=pm,pm=null,e;return Vu&1&&e.tag!==0&&Za(),a=e.pendingLanes,a&1?e===mm?Lo++:(Lo=0,mm=e):Lo=0,ji(),null}function Za(){if(si!==null){var e=qj(Vu),t=Mr.transition,r=qe;try{if(Mr.transition=null,qe=16>e?16:e,si===null)var n=!1;else{if(e=si,si=null,Vu=0,Me&6)throw Error(ne(331));var i=Me;for(Me|=4,de=e.current;de!==null;){var a=de,o=a.child;if(de.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(de=u;de!==null;){var d=de;switch(d.tag){case 0:case 11:case 15:Ro(8,d,a)}var f=d.child;if(f!==null)f.return=d,de=f;else for(;de!==null;){d=de;var h=d.sibling,p=d.return;if(QS(d),d===u){de=null;break}if(h!==null){h.return=p,de=h;break}de=p}}}var y=a.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(v!==null)}}de=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,de=o;else e:for(;de!==null;){if(a=de,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ro(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,de=x;break e}de=a.return}}var b=e.current;for(de=b;de!==null;){o=de;var g=o.child;if(o.subtreeFlags&2064&&g!==null)g.return=o,de=g;else e:for(o=b;de!==null;){if(l=de,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:tf(9,l)}}catch(w){lt(l,l.return,w)}if(l===o){de=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,de=S;break e}de=l.return}}if(Me=i,ji(),dn&&typeof dn.onPostCommitFiberRoot=="function")try{dn.onPostCommitFiberRoot(Gd,e)}catch{}n=!0}return n}finally{qe=r,Mr.transition=t}}return!1}function Sx(e,t,r){t=cs(r,t),t=qS(e,t,1),e=fi(e,t,1),t=Yt(),e!==null&&(tc(e,1,t),lr(e,t))}function lt(e,t,r){if(e.tag===3)Sx(e,e,r);else for(;t!==null;){if(t.tag===3){Sx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(hi===null||!hi.has(n))){e=cs(r,e),e=US(t,e,1),t=fi(t,e,1),e=Yt(),t!==null&&(tc(t,1,e),lr(t,e));break}}t=t.return}}function _T(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Yt(),e.pingedLanes|=e.suspendedLanes&r,Tt===e&&(Dt&r)===r&&(Et===4||Et===3&&(Dt&130023424)===Dt&&500>ft()-Wy?Qi(e,0):zy|=r),lr(e,t)}function lN(e,t){t===0&&(e.mode&1?(t=Sc,Sc<<=1,!(Sc&130023424)&&(Sc=4194304)):t=1);var r=Yt();e=Rn(e,t),e!==null&&(tc(e,t,r),lr(e,r))}function jT(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lN(e,r)}function ST(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ne(314))}n!==null&&n.delete(t),lN(e,r)}var cN;cN=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||sr.current)tr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return tr=!1,dT(e,t,r);tr=!!(e.flags&131072)}else tr=!1,rt&&t.flags&1048576&&hS(t,Du,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;mu(e,t),e=t.pendingProps;var i=as(t,Ht.current);Qa(t,r),i=Dy(null,t,n,e,i,r);var a=Ly();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,or(n)?(a=!0,Mu(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ky(t),i.updater=ef,t.stateNode=i,i._reactInternals=t,nm(t,n,e,r),t=sm(null,t,n,!0,a,r)):(t.tag=0,rt&&a&&Ny(t),Vt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(mu(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=ET(n),e=Vr(n,e),i){case 0:t=am(null,t,n,e,r);break e;case 1:t=px(null,t,n,e,r);break e;case 11:t=fx(null,t,n,e,r);break e;case 14:t=hx(null,t,n,Vr(n.type,e),r);break e}throw Error(ne(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vr(n,i),am(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vr(n,i),px(e,t,n,i,r);case 3:e:{if(VS(t),e===null)throw Error(ne(387));n=t.pendingProps,a=t.memoizedState,i=a.element,xS(e,t),Fu(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=cs(Error(ne(423)),t),t=mx(e,t,n,r,i);break e}else if(n!==i){i=cs(Error(ne(424)),t),t=mx(e,t,n,r,i);break e}else for(yr=di(t.stateNode.containerInfo.firstChild),vr=t,rt=!0,Yr=null,r=yS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(ss(),n===i){t=Dn(e,t,r);break e}Vt(e,t,n,r)}t=t.child}return t;case 5:return bS(t),e===null&&em(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,Xp(n,i)?o=null:a!==null&&Xp(n,a)&&(t.flags|=32),HS(e,t),Vt(e,t,o,r),t.child;case 6:return e===null&&em(t),null;case 13:return GS(e,t,r);case 4:return $y(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=os(t,null,n,r):Vt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vr(n,i),fx(e,t,n,i,r);case 7:return Vt(e,t,t.pendingProps,r),t.child;case 8:return Vt(e,t,t.pendingProps.children,r),t.child;case 12:return Vt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Ye(Lu,n._currentValue),n._currentValue=o,a!==null)if(tn(a.value,o)){if(a.children===i.children&&!sr.current){t=Dn(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=On(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),tm(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ne(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),tm(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Vt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Qa(t,r),i=Rr(i),n=n(i),t.flags|=1,Vt(e,t,n,r),t.child;case 14:return n=t.type,i=Vr(n,t.pendingProps),i=Vr(n.type,i),hx(e,t,n,i,r);case 15:return zS(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Vr(n,i),mu(e,t),t.tag=1,or(n)?(e=!0,Mu(t)):e=!1,Qa(t,r),FS(t,n,i),nm(t,n,i,r),sm(null,t,n,!0,e,r);case 19:return KS(e,t,r);case 22:return WS(e,t,r)}throw Error(ne(156,t.tag))};function uN(e,t){return Dj(e,t)}function NT(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kr(e,t,r,n){return new NT(e,t,r,n)}function Ky(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ET(e){if(typeof e=="function")return Ky(e)?1:0;if(e!=null){if(e=e.$$typeof,e===hy)return 11;if(e===py)return 14}return 2}function mi(e,t){var r=e.alternate;return r===null?(r=kr(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function vu(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")Ky(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ta:return Zi(r.children,i,a,t);case fy:o=8,i|=8;break;case Ap:return e=kr(12,r,t,i|2),e.elementType=Ap,e.lanes=a,e;case Pp:return e=kr(13,r,t,i),e.elementType=Pp,e.lanes=a,e;case Op:return e=kr(19,r,t,i),e.elementType=Op,e.lanes=a,e;case bj:return nf(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case vj:o=10;break e;case xj:o=9;break e;case hy:o=11;break e;case py:o=14;break e;case Yn:o=16,n=null;break e}throw Error(ne(130,e==null?e:typeof e,""))}return t=kr(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function Zi(e,t,r,n){return e=kr(7,e,n,t),e.lanes=r,e}function nf(e,t,r,n){return e=kr(22,e,n,t),e.elementType=bj,e.lanes=r,e.stateNode={isHidden:!1},e}function Ih(e,t,r){return e=kr(6,e,null,t),e.lanes=r,e}function Mh(e,t,r){return t=kr(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function AT(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mh(0),this.expirationTimes=mh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mh(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xy(e,t,r,n,i,a,o,l,c){return e=new AT(e,t,r,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=kr(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},ky(a),e}function PT(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ca,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function dN(e){if(!e)return vi;e=e._reactInternals;e:{if(fa(e)!==e||e.tag!==1)throw Error(ne(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(or(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ne(171))}if(e.tag===1){var r=e.type;if(or(r))return dS(e,r,t)}return t}function fN(e,t,r,n,i,a,o,l,c){return e=Xy(r,n,!0,e,i,a,o,l,c),e.context=dN(null),r=e.current,n=Yt(),i=pi(r),a=On(n,i),a.callback=t??null,fi(r,a,i),e.current.lanes=i,tc(e,i,n),lr(e,n),e}function af(e,t,r,n){var i=t.current,a=Yt(),o=pi(i);return r=dN(r),t.context===null?t.context=r:t.pendingContext=r,t=On(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=fi(i,t,o),e!==null&&(Zr(e,i,o,a),fu(e,i,o)),o}function Ku(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Yy(e,t){Nx(e,t),(e=e.alternate)&&Nx(e,t)}function OT(){return null}var hN=typeof reportError=="function"?reportError:function(e){console.error(e)};function Jy(e){this._internalRoot=e}sf.prototype.render=Jy.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ne(409));af(e,t,null,null)};sf.prototype.unmount=Jy.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ca(function(){af(null,e,null,null)}),t[Mn]=null}};function sf(e){this._internalRoot=e}sf.prototype.unstable_scheduleHydration=function(e){if(e){var t=Wj();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Zn.length&&t!==0&&t<Zn[r].priority;r++);Zn.splice(r,0,e),r===0&&Vj(e)}};function Qy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function of(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ex(){}function CT(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var u=Ku(o);a.call(u)}}var o=fN(t,n,e,0,null,!1,!1,"",Ex);return e._reactRootContainer=o,e[Mn]=o.current,nl(e.nodeType===8?e.parentNode:e),ca(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=Ku(c);l.call(u)}}var c=Xy(e,0,!1,null,null,!1,!1,"",Ex);return e._reactRootContainer=c,e[Mn]=c.current,nl(e.nodeType===8?e.parentNode:e),ca(function(){af(t,c,r,n)}),c}function lf(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var l=i;i=function(){var c=Ku(o);l.call(c)}}af(t,o,e,i)}else o=CT(r,t,e,i,n);return Ku(o)}Uj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=So(t.pendingLanes);r!==0&&(yy(t,r|1),lr(t,ft()),!(Me&6)&&(us=ft()+500,ji()))}break;case 13:ca(function(){var n=Rn(e,1);if(n!==null){var i=Yt();Zr(n,e,1,i)}}),Yy(e,1)}};vy=function(e){if(e.tag===13){var t=Rn(e,134217728);if(t!==null){var r=Yt();Zr(t,e,134217728,r)}Yy(e,134217728)}};zj=function(e){if(e.tag===13){var t=pi(e),r=Rn(e,t);if(r!==null){var n=Yt();Zr(r,e,t,n)}Yy(e,t)}};Wj=function(){return qe};Hj=function(e,t){var r=qe;try{return qe=e,t()}finally{qe=r}};Bp=function(e,t,r){switch(t){case"input":if(kp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Jd(n);if(!i)throw Error(ne(90));_j(n),kp(n,i)}}}break;case"textarea":Sj(e,r);break;case"select":t=r.value,t!=null&&Ka(e,!!r.multiple,t,!1)}};Tj=Hy;kj=ca;var TT={usingClientEntryPoint:!1,Events:[nc,Ma,Jd,Oj,Cj,Hy]},lo={findFiberByHostInstance:Hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},kT={bundleType:lo.bundleType,version:lo.version,rendererPackageName:lo.rendererPackageName,rendererConfig:lo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Mj(e),e===null?null:e.stateNode},findFiberByHostInstance:lo.findFiberByHostInstance||OT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mc.isDisabled&&Mc.supportsFiber)try{Gd=Mc.inject(kT),dn=Mc}catch{}}_r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TT;_r.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qy(t))throw Error(ne(200));return PT(e,t,null,r)};_r.createRoot=function(e,t){if(!Qy(e))throw Error(ne(299));var r=!1,n="",i=hN;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Xy(e,1,!1,null,null,r,!1,n,i),e[Mn]=t.current,nl(e.nodeType===8?e.parentNode:e),new Jy(t)};_r.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ne(188)):(e=Object.keys(e).join(","),Error(ne(268,e)));return e=Mj(t),e=e===null?null:e.stateNode,e};_r.flushSync=function(e){return ca(e)};_r.hydrate=function(e,t,r){if(!of(t))throw Error(ne(200));return lf(null,e,t,!0,r)};_r.hydrateRoot=function(e,t,r){if(!Qy(e))throw Error(ne(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=hN;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=fN(t,null,e,1,r??null,i,!1,a,o),e[Mn]=t.current,nl(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new sf(t)};_r.render=function(e,t,r){if(!of(t))throw Error(ne(200));return lf(null,e,t,!1,r)};_r.unmountComponentAtNode=function(e){if(!of(e))throw Error(ne(40));return e._reactRootContainer?(ca(function(){lf(null,null,e,!1,function(){e._reactRootContainer=null,e[Mn]=null})}),!0):!1};_r.unstable_batchedUpdates=Hy;_r.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!of(r))throw Error(ne(200));if(e==null||e._reactInternals===void 0)throw Error(ne(38));return lf(e,t,r,!1,n)};_r.version="18.3.1-next-f1338f8080-20240426";function pN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pN)}catch(e){console.error(e)}}pN(),pj.exports=_r;var $T=pj.exports,Ax=$T;Np.createRoot=Ax.createRoot,Np.hydrateRoot=Ax.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fl(){return fl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fl.apply(this,arguments)}var oi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(oi||(oi={}));const Px="popstate";function IT(e){e===void 0&&(e={});function t(n,i){let{pathname:a,search:o,hash:l}=n.location;return vm("",{pathname:a,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:gN(i)}return RT(t,r,null,e)}function vt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function mN(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function MT(){return Math.random().toString(36).substr(2,8)}function Ox(e,t){return{usr:e.state,key:e.key,idx:t}}function vm(e,t,r,n){return r===void 0&&(r=null),fl({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Bs(t):t,{state:r,key:t&&t.key||n||MT()})}function gN(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Bs(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function RT(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,l=oi.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(fl({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=oi.Pop;let m=d(),x=m==null?null:m-u;u=m,c&&c({action:l,location:v.location,delta:x})}function h(m,x){l=oi.Push;let b=vm(v.location,m,x);u=d()+1;let g=Ox(b,u),S=v.createHref(b);try{o.pushState(g,"",S)}catch(w){if(w instanceof DOMException&&w.name==="DataCloneError")throw w;i.location.assign(S)}a&&c&&c({action:l,location:v.location,delta:1})}function p(m,x){l=oi.Replace;let b=vm(v.location,m,x);u=d();let g=Ox(b,u),S=v.createHref(b);o.replaceState(g,"",S),a&&c&&c({action:l,location:v.location,delta:0})}function y(m){let x=i.location.origin!=="null"?i.location.origin:i.location.href,b=typeof m=="string"?m:gN(m);return b=b.replace(/ $/,"%20"),vt(x,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,x)}let v={get action(){return l},get location(){return e(i,o)},listen(m){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(Px,f),c=m,()=>{i.removeEventListener(Px,f),c=null}},createHref(m){return t(i,m)},createURL:y,encodeLocation(m){let x=y(m);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:h,replace:p,go(m){return o.go(m)}};return v}var Cx;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Cx||(Cx={}));function DT(e,t,r){return r===void 0&&(r="/"),LT(e,t,r)}function LT(e,t,r,n){let i=typeof t=="string"?Bs(t):t,a=xN(i.pathname||"/",r);if(a==null)return null;let o=yN(e);BT(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=JT(a);l=KT(o[c],u)}return l}function yN(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(vt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=ea([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(vt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),yN(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:VT(u,a.index),routesMeta:d})};return e.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))i(a,o);else for(let c of vN(a.path))i(a,o,c)}),t}function vN(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=vN(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function BT(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:GT(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const FT=/^:[\w-]+$/,qT=3,UT=2,zT=1,WT=10,HT=-2,Tx=e=>e==="*";function VT(e,t){let r=e.split("/"),n=r.length;return r.some(Tx)&&(n+=HT),t&&(n+=UT),r.filter(i=>!Tx(i)).reduce((i,a)=>i+(FT.test(a)?qT:a===""?zT:WT),n)}function GT(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function KT(e,t,r){let{routesMeta:n}=e,i={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=XT({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:ea([a,f.pathname]),pathnameBase:tk(ea([a,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(a=ea([a,f.pathnameBase]))}return o}function XT(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=YT(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let v=l[f]||"";o=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const y=l[f];return p&&!y?u[h]=void 0:u[h]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:e}}function YT(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),mN(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function JT(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return mN(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function xN(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function QT(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Bs(e):e;return{pathname:r?r.startsWith("/")?r:ZT(r,t):t,search:rk(n),hash:nk(i)}}function ZT(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Rh(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function ek(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function bN(e,t){let r=ek(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function wN(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Bs(e):(i=fl({},e),vt(!i.pathname||!i.pathname.includes("?"),Rh("?","pathname","search",i)),vt(!i.pathname||!i.pathname.includes("#"),Rh("#","pathname","hash",i)),vt(!i.search||!i.search.includes("#"),Rh("#","search","hash",i)));let a=e===""||i.pathname==="",o=a?"/":i.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=QT(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ea=e=>e.join("/").replace(/\/\/+/g,"/"),tk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),rk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,nk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ik(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const _N=["post","put","patch","delete"];new Set(_N);const ak=["get",..._N];new Set(ak);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function hl(){return hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hl.apply(this,arguments)}const Zy=N.createContext(null),sk=N.createContext(null),ac=N.createContext(null),cf=N.createContext(null),ha=N.createContext({outlet:null,matches:[],isDataRoute:!1}),jN=N.createContext(null);function sc(){return N.useContext(cf)!=null}function oc(){return sc()||vt(!1),N.useContext(cf).location}function SN(e){N.useContext(ac).static||N.useLayoutEffect(e)}function uf(){let{isDataRoute:e}=N.useContext(ha);return e?xk():ok()}function ok(){sc()||vt(!1);let e=N.useContext(Zy),{basename:t,future:r,navigator:n}=N.useContext(ac),{matches:i}=N.useContext(ha),{pathname:a}=oc(),o=JSON.stringify(bN(i,r.v7_relativeSplatPath)),l=N.useRef(!1);return SN(()=>{l.current=!0}),N.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=wN(u,JSON.parse(o),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ea([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,a,e])}function lk(e,t){return ck(e,t)}function ck(e,t,r,n){sc()||vt(!1);let{navigator:i}=N.useContext(ac),{matches:a}=N.useContext(ha),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=oc(),d;if(t){var f;let m=typeof t=="string"?Bs(t):t;c==="/"||(f=m.pathname)!=null&&f.startsWith(c)||vt(!1),d=m}else d=u;let h=d.pathname||"/",p=h;if(c!=="/"){let m=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(m.length).join("/")}let y=DT(e,{pathname:p}),v=pk(y&&y.map(m=>Object.assign({},m,{params:Object.assign({},l,m.params),pathname:ea([c,i.encodeLocation?i.encodeLocation(m.pathname).pathname:m.pathname]),pathnameBase:m.pathnameBase==="/"?c:ea([c,i.encodeLocation?i.encodeLocation(m.pathnameBase).pathname:m.pathnameBase])})),a,r,n);return t&&v?N.createElement(cf.Provider,{value:{location:hl({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:oi.Pop}},v):v}function uk(){let e=vk(),t=ik(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},t),r?N.createElement("pre",{style:i},r):null,null)}const dk=N.createElement(uk,null);class fk extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?N.createElement(ha.Provider,{value:this.props.routeContext},N.createElement(jN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function hk(e){let{routeContext:t,match:r,children:n}=e,i=N.useContext(Zy);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),N.createElement(ha.Provider,{value:t},n)}function pk(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||vt(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=r,y=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||y){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,h)=>{let p,y=!1,v=null,m=null;r&&(p=l&&f.route.id?l[f.route.id]:void 0,v=f.route.errorElement||dk,c&&(u<0&&h===0?(bk("route-fallback"),y=!0,m=null):u===h&&(y=!0,m=f.route.hydrateFallbackElement||null)));let x=t.concat(o.slice(0,h+1)),b=()=>{let g;return p?g=v:y?g=m:f.route.Component?g=N.createElement(f.route.Component,null):f.route.element?g=f.route.element:g=d,N.createElement(hk,{match:f,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:g})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?N.createElement(fk,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:b(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):b()},null)}var NN=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(NN||{}),EN=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(EN||{});function mk(e){let t=N.useContext(Zy);return t||vt(!1),t}function gk(e){let t=N.useContext(sk);return t||vt(!1),t}function yk(e){let t=N.useContext(ha);return t||vt(!1),t}function AN(e){let t=yk(),r=t.matches[t.matches.length-1];return r.route.id||vt(!1),r.route.id}function vk(){var e;let t=N.useContext(jN),r=gk(),n=AN();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function xk(){let{router:e}=mk(NN.UseNavigateStable),t=AN(EN.UseNavigateStable),r=N.useRef(!1);return SN(()=>{r.current=!0}),N.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,hl({fromRouteId:t},a)))},[e,t])}const kx={};function bk(e,t,r){kx[e]||(kx[e]=!0)}function wk(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function PN(e){let{to:t,replace:r,state:n,relative:i}=e;sc()||vt(!1);let{future:a,static:o}=N.useContext(ac),{matches:l}=N.useContext(ha),{pathname:c}=oc(),u=uf(),d=wN(t,bN(l,a.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return N.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:i}),[u,f,i,r,n]),null}function xm(e){vt(!1)}function _k(e){let{basename:t="/",children:r=null,location:n,navigationType:i=oi.Pop,navigator:a,static:o=!1,future:l}=e;sc()&&vt(!1);let c=t.replace(/^\/*/,"/"),u=N.useMemo(()=>({basename:c,navigator:a,static:o,future:hl({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof n=="string"&&(n=Bs(n));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:y="default"}=n,v=N.useMemo(()=>{let m=xN(d,c);return m==null?null:{location:{pathname:m,search:f,hash:h,state:p,key:y},navigationType:i}},[c,d,f,h,p,y,i]);return v==null?null:N.createElement(ac.Provider,{value:u},N.createElement(cf.Provider,{children:r,value:v}))}function jk(e){let{children:t,location:r}=e;return lk(bm(t),r)}new Promise(()=>{});function bm(e,t){t===void 0&&(t=[]);let r=[];return N.Children.forEach(e,(n,i)=>{if(!N.isValidElement(n))return;let a=[...t,i];if(n.type===N.Fragment){r.push.apply(r,bm(n.props.children,a));return}n.type!==xm&&vt(!1),!n.props.index||!n.props.children||vt(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=bm(n.props.children,a)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Sk="6";try{window.__reactRouterVersion=Sk}catch{}const Nk="startTransition",$x=_O[Nk];function Ek(e){let{basename:t,children:r,future:n,window:i}=e,a=N.useRef();a.current==null&&(a.current=IT({window:i,v5Compat:!0}));let o=a.current,[l,c]=N.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=N.useCallback(f=>{u&&$x?$x(()=>c(f)):c(f)},[c,u]);return N.useLayoutEffect(()=>o.listen(d),[o,d]),N.useEffect(()=>wk(n),[n]),N.createElement(_k,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}var Ix;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ix||(Ix={}));var Mx;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Mx||(Mx={}));var wm=function(e,t){return wm=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},wm(e,t)};function ON(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");wm(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Xu=function(){return Xu=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},Xu.apply(this,arguments)};function Fs(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function CN(e,t,r,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function TN(e,t){return function(r,n){t(r,n,e)}}function kN(e,t,r,n,i,a){function o(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var l=n.kind,c=l==="getter"?"get":l==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,d=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),f,h=!1,p=r.length-1;p>=0;p--){var y={};for(var v in n)y[v]=v==="access"?{}:n[v];for(var v in n.access)y.access[v]=n.access[v];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(x||null))};var m=(0,r[p])(l==="accessor"?{get:d.get,set:d.set}:d[c],y);if(l==="accessor"){if(m===void 0)continue;if(m===null||typeof m!="object")throw new TypeError("Object expected");(f=o(m.get))&&(d.get=f),(f=o(m.set))&&(d.set=f),(f=o(m.init))&&i.unshift(f)}else(f=o(m))&&(l==="field"?i.unshift(f):d[c]=f)}u&&Object.defineProperty(u,n.name,d),h=!0}function $N(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function IN(e){return typeof e=="symbol"?e:"".concat(e)}function MN(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function RN(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function pe(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(d){try{u(n.next(d))}catch(f){o(f)}}function c(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?a(d.value):i(d.value).then(l,c)}u((n=n.apply(e,t||[])).next())})}function DN(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(u){return function(d){return c([u,d])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(d){u=[6,d],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var df=Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};function LN(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&df(t,e,r)}function Yu(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function e0(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){o={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function BN(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(e0(arguments[t]));return e}function FN(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var a=arguments[t],o=0,l=a.length;o<l;o++,i++)n[i]=a[o];return n}function qN(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function ds(e){return this instanceof ds?(this.v=e,this):new ds(e)}function UN(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,a=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(p){return function(y){return Promise.resolve(y).then(p,f)}}function l(p,y){n[p]&&(i[p]=function(v){return new Promise(function(m,x){a.push([p,v,m,x])>1||c(p,v)})},y&&(i[p]=y(i[p])))}function c(p,y){try{u(n[p](y))}catch(v){h(a[0][3],v)}}function u(p){p.value instanceof ds?Promise.resolve(p.value.v).then(d,f):h(a[0][2],p)}function d(p){c("next",p)}function f(p){c("throw",p)}function h(p,y){p(y),a.shift(),a.length&&c(a[0][0],a[0][1])}}function zN(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,a){t[i]=e[i]?function(o){return(r=!r)?{value:ds(e[i](o)),done:!1}:a?a(o):o}:a}}function WN(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Yu=="function"?Yu(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(o){return new Promise(function(l,c){o=e[a](o),i(l,c,o.done,o.value)})}}function i(a,o,l,c){Promise.resolve(c).then(function(u){a({value:u,done:l})},o)}}function HN(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var Ak=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t},_m=function(e){return _m=Object.getOwnPropertyNames||function(t){var r=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[r.length]=n);return r},_m(e)};function VN(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r=_m(e),n=0;n<r.length;n++)r[n]!=="default"&&df(t,e,r[n]);return Ak(t,e),t}function GN(e){return e&&e.__esModule?e:{default:e}}function KN(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function XN(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function YN(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function JN(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n,i;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if(typeof n!="function")throw new TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(a){return Promise.reject(a)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var Pk=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function QN(e){function t(a){e.error=e.hasError?new Pk(a,e.error,"An error was suppressed during disposal."):a,e.hasError=!0}var r,n=0;function i(){for(;r=e.stack.pop();)try{if(!r.async&&n===1)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(a).then(i,function(o){return t(o),i()})}else n|=1}catch(o){t(o)}if(n===1)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}return i()}function ZN(e,t){return typeof e=="string"&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,n,i,a,o){return n?t?".jsx":".js":i&&(!a||!o)?r:i+a+"."+o.toLowerCase()+"js"}):e}const Ok={__extends:ON,__assign:Xu,__rest:Fs,__decorate:CN,__param:TN,__esDecorate:kN,__runInitializers:$N,__propKey:IN,__setFunctionName:MN,__metadata:RN,__awaiter:pe,__generator:DN,__createBinding:df,__exportStar:LN,__values:Yu,__read:e0,__spread:BN,__spreadArrays:FN,__spreadArray:qN,__await:ds,__asyncGenerator:UN,__asyncDelegator:zN,__asyncValues:WN,__makeTemplateObject:HN,__importStar:VN,__importDefault:GN,__classPrivateFieldGet:KN,__classPrivateFieldSet:XN,__classPrivateFieldIn:YN,__addDisposableResource:JN,__disposeResources:QN,__rewriteRelativeImportExtension:ZN},Ck=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:JN,get __assign(){return Xu},__asyncDelegator:zN,__asyncGenerator:UN,__asyncValues:WN,__await:ds,__awaiter:pe,__classPrivateFieldGet:KN,__classPrivateFieldIn:YN,__classPrivateFieldSet:XN,__createBinding:df,__decorate:CN,__disposeResources:QN,__esDecorate:kN,__exportStar:LN,__extends:ON,__generator:DN,__importDefault:GN,__importStar:VN,__makeTemplateObject:HN,__metadata:RN,__param:TN,__propKey:IN,__read:e0,__rest:Fs,__rewriteRelativeImportExtension:ZN,__runInitializers:$N,__setFunctionName:MN,__spread:BN,__spreadArray:qN,__spreadArrays:FN,__values:Yu,default:Ok},Symbol.toStringTag,{value:"Module"})),Tk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class t0 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Rx extends t0{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Dx extends t0{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Lx extends t0{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jm||(jm={}));class kk{constructor(t,{headers:r={},customFetch:n,region:i=jm.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=Tk(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return pe(this,arguments,void 0,function*(r,n={}){var i;try{const{headers:a,method:o,body:l,signal:c}=n;let u={},{region:d}=n;d||(d=this.region);const f=new URL(`${this.url}/${r}`);d&&d!=="any"&&(u["x-region"]=d,f.searchParams.set("forceFunctionRegion",d));let h;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",h=l):typeof l=="string"?(u["Content-Type"]="text/plain",h=l):typeof FormData<"u"&&l instanceof FormData?h=l:(u["Content-Type"]="application/json",h=JSON.stringify(l)):h=l;const p=yield this.fetch(f.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),a),body:h,signal:c}).catch(x=>{throw x.name==="AbortError"?x:new Rx(x)}),y=p.headers.get("x-relay-error");if(y&&y==="true")throw new Dx(p);if(!p.ok)throw new Lx(p);let v=((i=p.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),m;return v==="application/json"?m=yield p.json():v==="application/octet-stream"||v==="application/pdf"?m=yield p.blob():v==="text/event-stream"?m=p:v==="multipart/form-data"?m=yield p.formData():m=yield p.text(),{data:m,error:null,response:p}}catch(a){return a instanceof Error&&a.name==="AbortError"?{data:null,error:new Rx(a)}:{data:null,error:a,response:a instanceof Lx||a instanceof Dx?a.context:void 0}}})}}var Gt={};const qs=sO(Ck);var Rc={},Dc={},Lc={},Bc={},Fc={},qc={},Bx;function eE(){if(Bx)return qc;Bx=1,Object.defineProperty(qc,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return qc.default=e,qc}var Fx;function tE(){if(Fx)return Fc;Fx=1,Object.defineProperty(Fc,"__esModule",{value:!0});const t=qs.__importDefault(eE());class r{constructor(i){var a,o;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(a=i.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=i.signal,this.isMaybeSingle=(o=i.isMaybeSingle)!==null&&o!==void 0?o:!1,i.fetch?this.fetch=i.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=new Headers(this.headers),this.headers.set(i,a),this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,f,h;let p=null,y=null,v=null,m=c.status,x=c.statusText;if(c.ok){if(this.method!=="HEAD"){const w=await c.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?y=w:y=JSON.parse(w))}const g=(d=this.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),S=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");g&&S&&S.length>1&&(v=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(y)&&(y.length>1?(p={code:"PGRST116",details:`Results contain ${y.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},y=null,v=null,m=406,x="Not Acceptable"):y.length===1?y=y[0]:y=null)}else{const g=await c.text();try{p=JSON.parse(g),Array.isArray(p)&&c.status===404&&(y=[],p=null,m=200,x="OK")}catch{c.status===404&&g===""?(m=204,x="No Content"):p={message:g}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,m=200,x="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:y,count:v,status:m,statusText:x}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,f;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}returns(){return this}overrideTypes(){return this}}return Fc.default=r,Fc}var qx;function rE(){if(qx)return Bc;qx=1,Object.defineProperty(Bc,"__esModule",{value:!0});const t=qs.__importDefault(tE());class r extends t.default{select(i){let a=!1;const o=(i??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.order`:"order",d=this.url.searchParams.get(u);return this.url.searchParams.set(u,`${d?`${d},`:""}${i}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${i}`),this.url.searchParams.set(u,`${a-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:u="text"}={}){var d;const f=[i?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),h=(d=this.headers.get("Accept"))!==null&&d!==void 0?d:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${u}; for="${h}"; options=${f};`),u==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return Bc.default=r,Bc}var Ux;function r0(){if(Ux)return Lc;Ux=1,Object.defineProperty(Lc,"__esModule",{value:!0});const t=qs.__importDefault(rE()),r=new RegExp("[,()]");class n extends t.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let u="";c==="plain"?u="pl":c==="phrase"?u="ph":c==="websearch"&&(u="w");const d=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${u}fts${d}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return Lc.default=n,Lc}var zx;function nE(){if(zx)return Dc;zx=1,Object.defineProperty(Dc,"__esModule",{value:!0});const t=qs.__importDefault(r0());class r{constructor(i,{headers:a={},schema:o,fetch:l}){this.url=i,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(i,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let u=!1;const d=(i??"*").split("").map(f=>/\s/.test(f)&&!u?"":(f==='"'&&(u=!u),f)).join("");return this.url.searchParams.set("select",d),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const u=i.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(u.length>0){const d=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new t.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var u;const d="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(f.length>0){const h=[...new Set(f)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}update(i,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:i}={}){var a;const o="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new t.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Dc.default=r,Dc}var Wx;function $k(){if(Wx)return Rc;Wx=1,Object.defineProperty(Rc,"__esModule",{value:!0});const e=qs,t=e.__importDefault(nE()),r=e.__importDefault(r0());class n{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new t.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:u}={}){var d;let f;const h=new URL(`${this.url}/rpc/${a}`);let p;l||c?(f=l?"HEAD":"GET",Object.entries(o).filter(([v,m])=>m!==void 0).map(([v,m])=>[v,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([v,m])=>{h.searchParams.append(v,m)})):(f="POST",p=o);const y=new Headers(this.headers);return u&&y.set("Prefer",`count=${u}`),new r.default({method:f,url:h,headers:y,schema:this.schemaName,body:p,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}}return Rc.default=n,Rc}Object.defineProperty(Gt,"__esModule",{value:!0});var iE=Gt.PostgrestError=pE=Gt.PostgrestBuilder=fE=Gt.PostgrestTransformBuilder=uE=Gt.PostgrestFilterBuilder=lE=Gt.PostgrestQueryBuilder=sE=Gt.PostgrestClient=void 0;const Us=qs,aE=Us.__importDefault($k());var sE=Gt.PostgrestClient=aE.default;const oE=Us.__importDefault(nE());var lE=Gt.PostgrestQueryBuilder=oE.default;const cE=Us.__importDefault(r0());var uE=Gt.PostgrestFilterBuilder=cE.default;const dE=Us.__importDefault(rE());var fE=Gt.PostgrestTransformBuilder=dE.default;const hE=Us.__importDefault(tE());var pE=Gt.PostgrestBuilder=hE.default;const mE=Us.__importDefault(eE());iE=Gt.PostgrestError=mE.default;var gE=Gt.default={PostgrestClient:aE.default,PostgrestQueryBuilder:oE.default,PostgrestFilterBuilder:cE.default,PostgrestTransformBuilder:dE.default,PostgrestBuilder:hE.default,PostgrestError:mE.default};const Ik=rj({__proto__:null,get PostgrestBuilder(){return pE},get PostgrestClient(){return sE},get PostgrestError(){return iE},get PostgrestFilterBuilder(){return uE},get PostgrestQueryBuilder(){return lE},get PostgrestTransformBuilder(){return fE},default:gE},[Gt]),{PostgrestClient:Mk,PostgrestQueryBuilder:rre,PostgrestFilterBuilder:nre,PostgrestTransformBuilder:ire,PostgrestBuilder:are,PostgrestError:sre}=gE||Ik;class Rk{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const Dk="2.80.0",Lk=`realtime-js/${Dk}`,Bk="1.0.0",Sm=1e4,Fk=1e3,qk=100;var Bo;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Bo||(Bo={}));var _t;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(_t||(_t={}));var Xr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Xr||(Xr={}));var Nm;(function(e){e.websocket="websocket"})(Nm||(Nm={}));var qi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(qi||(qi={}));class Uk{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(t.slice(o,o+i));o=o+i;const c=n.decode(t.slice(o,o+a));o=o+a;const u=JSON.parse(n.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class yE{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ge;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ge||(Ge={}));const Hx=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,o)=>(a[o]=zk(o,e,t,i),a),{}):{}},zk=(e,t,r,n)=>{const i=t.find(l=>l.name===e),a=i==null?void 0:i.type,o=r[e];return a&&!n.includes(a)?vE(a,o):Em(o)},vE=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Gk(t,r)}switch(e){case Ge.bool:return Wk(t);case Ge.float4:case Ge.float8:case Ge.int2:case Ge.int4:case Ge.int8:case Ge.numeric:case Ge.oid:return Hk(t);case Ge.json:case Ge.jsonb:return Vk(t);case Ge.timestamp:return Kk(t);case Ge.abstime:case Ge.date:case Ge.daterange:case Ge.int4range:case Ge.int8range:case Ge.money:case Ge.reltime:case Ge.text:case Ge.time:case Ge.timestamptz:case Ge.timetz:case Ge.tsrange:case Ge.tstzrange:return Em(t);default:return Em(t)}},Em=e=>e,Wk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Hk=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Vk=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Gk=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const o=e.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>vE(t,l))}return e},Kk=e=>typeof e=="string"?e.replace(" ","T"):e,xE=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Dh{constructor(t,r,n={},i=Sm){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Vx;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Vx||(Vx={}));class Fo{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Fo.syncState(this.state,i,a,o),this.pendingDiffs.forEach(c=>{this.state=Fo.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Fo.syncDiff(this.state,i,a,o),l())}),this.onJoin((i,a,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:o})}),this.onLeave((i,a,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const a=this.cloneDeep(t),o=this.transformState(r),l={},c={};return this.map(a,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const f=a[u];if(f){const h=d.map(m=>m.presence_ref),p=f.map(m=>m.presence_ref),y=d.filter(m=>p.indexOf(m.presence_ref)<0),v=f.filter(m=>h.indexOf(m.presence_ref)<0);y.length>0&&(l[u]=y),v.length>0&&(c[u]=v)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},n,i)}static syncDiff(t,r,n,i){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const f=t[l].map(p=>p.presence_ref),h=d.filter(p=>f.indexOf(p.presence_ref)<0);t[l].unshift(...h)}n(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[l]=u,i(l,u,c),u.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Gx;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Gx||(Gx={}));var qo;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(qo||(qo={}));var wn;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(wn||(wn={}));class n0{constructor(t,r={config:{}},n){var i,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=_t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Dh(this,Xr.join,this.params,this.timeout),this.rejoinTimer=new yE(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_t.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Xr.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Fo(this),this.broadcastEndpointURL=xE(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==_t.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&i!==void 0?i:[],d=!!this.bindings[qo.PRESENCE]&&this.bindings[qo.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(wn.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(wn.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var y;if(this.socket.setAuth(),p===void 0){t==null||t(wn.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,m=(y=v==null?void 0:v.length)!==null&&y!==void 0?y:0,x=[];for(let b=0;b<m;b++){const g=v[b],{filter:{event:S,schema:w,table:j,filter:_}}=g,E=p&&p[b];if(E&&E.event===S&&E.schema===w&&E.table===j&&E.filter===_)x.push(Object.assign(Object.assign({},g),{id:E.id}));else{this.unsubscribe(),this.state=_t.errored,t==null||t(wn.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(wn.SUBSCRIBED);return}}).receive("error",p=>{this.state=_t.errored,t==null||t(wn.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(wn.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===_t.joined&&t===qo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=_t.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Xr.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Dh(this,Xr.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=_t.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Dh(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>qk){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,a;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Xr;if(n&&[l,c,u,d].indexOf(o)>=0&&n!==this._joinRef())return;let h=this._onMessage(o,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var y,v,m;return((y=p.filter)===null||y===void 0?void 0:y.event)==="*"||((m=(v=p.filter)===null||v===void 0?void 0:v.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===o}).map(p=>p.callback(h,n)):(a=this.bindings[o])===null||a===void 0||a.filter(p=>{var y,v,m,x,b,g;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in p){const S=p.id,w=(y=p.filter)===null||y===void 0?void 0:y.event;return S&&((v=r.ids)===null||v===void 0?void 0:v.includes(S))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const S=(b=(x=p==null?void 0:p.filter)===null||x===void 0?void 0:x.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return S==="*"||S===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===o}).map(p=>{if(typeof h=="object"&&"ids"in h){const y=h.data,{schema:v,table:m,commit_timestamp:x,type:b,errors:g}=y;h=Object.assign(Object.assign({},{schema:v,table:m,commit_timestamp:x,eventType:b,new:{},old:{},errors:g}),this._getPayloadRecords(y))}p.callback(h,n)})}_isClosed(){return this.state===_t.closed}_isJoined(){return this.state===_t.joined}_isJoining(){return this.state===_t.joining}_isLeaving(){return this.state===_t.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&n0.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Xr.close,{},t)}_onError(t){this._on(Xr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_t.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Hx(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Hx(t.columns,t.old_record)),r}}const Lh=()=>{},Uc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Xk=[1e3,2e3,5e3,1e4],Yk=1e4,Jk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Qk{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Sm,this.transport=null,this.heartbeatIntervalMs=Uc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Lh,this.ref=0,this.reconnectTimer=null,this.logger=Lh,this.conn=null,this.sendBuffer=[],this.serializer=new Uk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Nm.websocket}`,this.httpEndpoint=xE(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Rk.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Bk}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Bo.connecting:return qi.Connecting;case Bo.open:return qi.Open;case Bo.closing:return qi.Closing;default:return qi.Closed}}isConnected(){return this.connectionState()===qi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new n0(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:i,ref:a}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Fk,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Uc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${i} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Xr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Jk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const i={access_token:r,version:Lk};r&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(Xr.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new yE(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Uc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,a,o,l,c,u,d;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Sm,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Uc.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Lh,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:f=>Xk[f-1]||Yk,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(f,h)=>h(JSON.stringify(f)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class i0 extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function it(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class Zk extends i0{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Am extends i0{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}const a0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),e$=()=>Response,Pm=e=>{if(Array.isArray(e))return e.map(r=>Pm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=Pm(n)}),t},t$=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Bh=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},r$=(e,t,r)=>pe(void 0,void 0,void 0,function*(){const n=yield e$();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{const a=e.status||500,o=(i==null?void 0:i.statusCode)||a+"";t(new Zk(Bh(i),a,o))}).catch(i=>{t(new Am(Bh(i),i))}):t(new Am(Bh(e),e))}),n$=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?i:(t$(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),Object.assign(Object.assign({},i),r))};function lc(e,t,r,n,i,a){return pe(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,n$(t,n,i,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>r$(c,l,n))})})}function pl(e,t,r,n){return pe(this,void 0,void 0,function*(){return lc(e,"GET",t,r,n)})}function Gr(e,t,r,n,i){return pe(this,void 0,void 0,function*(){return lc(e,"POST",t,n,i,r)})}function Om(e,t,r,n,i){return pe(this,void 0,void 0,function*(){return lc(e,"PUT",t,n,i,r)})}function i$(e,t,r,n){return pe(this,void 0,void 0,function*(){return lc(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function s0(e,t,r,n,i){return pe(this,void 0,void 0,function*(){return lc(e,"DELETE",t,n,i,r)})}class a${constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return pe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(it(t))return{data:null,error:t};throw t}})}}var bE;class s${constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[bE]="BlobDownloadBuilder",this.promise=null}asStream(){return new a$(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return pe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(it(t))return{data:null,error:t};throw t}})}}bE=Symbol.toStringTag;const o$={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class l${constructor(t,r={},n,i){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=a0(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,i){return pe(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Kx),i);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),i!=null&&i.headers&&(l=Object.assign(Object.assign({},l),i.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?Om:Gr)(this.fetch,`${this.url}/object/${d}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(it(a))return{data:null,error:a};throw a}})}upload(t,r,n){return pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return pe(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Kx.upsert},i),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield Om(this.fetch,l.toString(),c,{headers:d});return{data:{path:a,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(it(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return pe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const a=yield Gr(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new i0("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(it(n))return{data:null,error:n};throw n}})}update(t,r,n){return pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return pe(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(it(i))return{data:null,error:i};throw i}})}copy(t,r,n){return pe(this,void 0,void 0,function*(){try{return{data:{path:(yield Gr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(it(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return pe(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),a=yield Gr(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(it(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return pe(this,void 0,void 0,function*(){try{const i=yield Gr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(it(i))return{data:null,error:i};throw i}})}download(t,r){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"",l=this._getFinalPath(t),c=()=>pl(this.fetch,`${this.url}/${i}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new s$(c,this.shouldThrowOnError)}info(t){return pe(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield pl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Pm(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(it(n))return{data:null,error:n};throw n}})}exists(t){return pe(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield i$(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(it(n)&&n instanceof Am){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&i.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&i.push(c);let u=i.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(t){return pe(this,void 0,void 0,function*(){try{return{data:yield s0(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}list(t,r,n){return pe(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},o$),r),{prefix:t||""});return{data:yield Gr(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(it(i))return{data:null,error:i};throw i}})}listV2(t,r){return pe(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Gr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(it(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const wE="2.80.0",_E={"X-Client-Info":`storage-js/${wE}`};class c${constructor(t,r={},n,i){this.shouldThrowOnError=!1;const a=new URL(t);i!=null&&i.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_E),r),this.fetch=a0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return pe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(t);return{data:yield pl(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}getBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:yield pl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}createBucket(t){return pe(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield Gr(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(it(i))return{data:null,error:i};throw i}})}updateBucket(t,r){return pe(this,void 0,void 0,function*(){try{return{data:yield Om(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(it(n))return{data:null,error:n};throw n}})}emptyBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}deleteBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:yield s0(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(t){const r={};return t&&("limit"in t&&(r.limit=String(t.limit)),"offset"in t&&(r.offset=String(t.offset)),t.search&&(r.search=t.search),t.sortColumn&&(r.sortColumn=t.sortColumn),t.sortOrder&&(r.sortOrder=t.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class u${constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},_E),r),this.fetch=a0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:yield Gr(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}listBuckets(t){return pe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(t==null?void 0:t.limit)!==void 0&&r.set("limit",t.limit.toString()),(t==null?void 0:t.offset)!==void 0&&r.set("offset",t.offset.toString()),t!=null&&t.sortColumn&&r.set("sortColumn",t.sortColumn),t!=null&&t.sortOrder&&r.set("sortOrder",t.sortOrder),t!=null&&t.search&&r.set("search",t.search);const n=r.toString(),i=n?`${this.url}/bucket?${n}`:`${this.url}/bucket`;return{data:yield pl(this.fetch,i,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}deleteBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:yield s0(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(it(r))return{data:null,error:r};throw r}})}}const o0={"X-Client-Info":`storage-js/${wE}`,"Content-Type":"application/json"};class jE extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function hr(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}class Fh extends jE{constructor(t,r,n){super(t),this.name="StorageVectorsApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class d$ extends jE{constructor(t,r){super(t),this.name="StorageVectorsUnknownError",this.originalError=r}}var Xx;(function(e){e.InternalError="InternalError",e.S3VectorConflictException="S3VectorConflictException",e.S3VectorNotFoundException="S3VectorNotFoundException",e.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",e.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",e.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(Xx||(Xx={}));const l0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),f$=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Yx=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),h$=(e,t,r)=>pe(void 0,void 0,void 0,function*(){if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e.status||500,a=e;if(typeof a.json=="function")a.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||i+"";t(new Fh(Yx(o),i,l))}).catch(()=>{const o=i+"",l=a.statusText||`HTTP ${i} error`;t(new Fh(l,i,o))});else{const o=i+"",l=a.statusText||`HTTP ${i} error`;t(new Fh(l,i,o))}}else t(new d$(Yx(e),e))}),p$=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(f$(n)?(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,Object.assign(Object.assign({},i),r)):i};function m$(e,t,r,n,i,a){return pe(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(r,p$(t,n,i,a)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>h$(c,l,n))})})}function pr(e,t,r,n,i){return pe(this,void 0,void 0,function*(){return m$(e,"POST",t,n,i,r)})}class g${constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},o0),r),this.fetch=l0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}getIndex(t,r){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hr(n))return{data:null,error:n};throw n}})}listIndexes(t){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteIndex(t,r){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:r},{headers:this.headers}))||{},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(hr(n))return{data:null,error:n};throw n}})}}class y${constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},o0),r),this.fetch=l0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return pe(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield pr(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}getVectors(t){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}listVectors(t){return pe(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield pr(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}queryVectors(t){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteVectors(t){return pe(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield pr(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}}class v${constructor(t,r={},n){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},o0),r),this.fetch=l0(n)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}getBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}listBuckets(){return pe(this,arguments,void 0,function*(t={}){try{return{data:yield pr(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return pe(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(hr(r))return{data:null,error:r};throw r}})}}class x$ extends v${constructor(t,r={}){super(t,r.headers||{},r.fetch)}from(t){return new b$(this.url,this.headers,t,this.fetch)}}class b$ extends g${constructor(t,r,n,i){super(t,r,i),this.vectorBucketName=n}createIndex(t){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return pe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return pe(this,arguments,void 0,function*(r={}){return t.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return pe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return pe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new w$(this.url,this.headers,this.vectorBucketName,t,this.fetch)}}class w$ extends y${constructor(t,r,n,i,a){super(t,r,a),this.vectorBucketName=n,this.indexName=i}putVectors(t){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return pe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return pe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return pe(this,arguments,void 0,function*(r={}){return t.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return pe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return pe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class _$ extends c${constructor(t,r={},n,i){super(t,r,n,i)}from(t){return new l$(this.url,this.headers,t,this.fetch)}get vectors(){return new x$(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new u$(this.url+"/iceberg",this.headers,this.fetch)}}const j$="2.80.0";let Eo="";typeof Deno<"u"?Eo="deno":typeof document<"u"?Eo="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Eo="react-native":Eo="node";const S$={"X-Client-Info":`supabase-js-${Eo}/${j$}`},N$={headers:S$},E$={schema:"public"},A$={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},P$={},O$=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),C$=()=>Headers,T$=(e,t,r)=>{const n=O$(r),i=C$();return async(a,o)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new i(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:u}))}};function k$(e){return e.endsWith("/")?e:e+"/"}function $$(e,t){var r,n;const{db:i,auth:a,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),i),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function I$(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(k$(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const SE="2.80.0",Aa=30*1e3,Cm=3,qh=Cm*Aa,M$="http://localhost:9999",R$="supabase.auth.token",D$={"X-Client-Info":`gotrue-js/${SE}`},Tm="X-Supabase-Api-Version",NE={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},L$=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,B$=10*60*1e3;class ml extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ye(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class F$ extends ml{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function q$(e){return ye(e)&&e.name==="AuthApiError"}class Ui extends ml{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Si extends ml{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Wr extends Si{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function U$(e){return ye(e)&&e.name==="AuthSessionMissingError"}class ba extends Si{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class zc extends Si{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wc extends Si{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function z$(e){return ye(e)&&e.name==="AuthImplicitGrantRedirectError"}class Jx extends Si{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class km extends Si{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Uh(e){return ye(e)&&e.name==="AuthRetryableFetchError"}class Qx extends Si{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class $m extends Si{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ju="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zx=` 	
\r=`.split(""),W$=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Zx.length;t+=1)e[Zx[t].charCodeAt(0)]=-2;for(let t=0;t<Ju.length;t+=1)e[Ju[t].charCodeAt(0)]=t;return e})();function eb(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ju[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ju[n]),t.queuedBits-=6}}function EE(e,t,r){const n=W$[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function tb(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=o=>{G$(o,n,r)};for(let o=0;o<e.length;o+=1)EE(e.charCodeAt(o),i,a);return t.join("")}function H$(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function V$(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}H$(n,t)}}function G$(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function es(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)EE(e.charCodeAt(i),r,n);return new Uint8Array(t)}function K$(e){const t=[];return V$(e,r=>t.push(r)),new Uint8Array(t)}function Ki(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>eb(i,r,n)),eb(null,r,n),t.join("")}function X$(e){return Math.round(Date.now()/1e3)+e}function Y$(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const qt=()=>typeof window<"u"&&typeof document<"u",Ci={tested:!1,writable:!1},AE=()=>{if(!qt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ci.tested)return Ci.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ci.tested=!0,Ci.writable=!0}catch{Ci.tested=!0,Ci.writable=!1}return Ci.writable};function J$(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const PE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Q$=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Pa=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ti=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Xn=async(e,t)=>{await e.removeItem(t)};class ff{constructor(){this.promise=new ff.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ff.promiseConstructor=Promise;function zh(e){const t=e.split(".");if(t.length!==3)throw new $m("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!L$.test(t[n]))throw new $m("JWT not in base64url format");return{header:JSON.parse(tb(t[0])),payload:JSON.parse(tb(t[1])),signature:es(t[2]),raw:{header:t[0],payload:t[1]}}}async function Z$(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function eI(e,t){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await e(a);if(!t(a,null,o)){n(o);return}}catch(o){if(!t(a,o)){i(o);return}}})()})}function tI(e){return("0"+e.toString(16)).substr(-2)}function rI(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,tI).join("")}async function nI(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function iI(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await nI(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function wa(e,t,r=!1){const n=rI();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Pa(e,`${t}-code-verifier`,i);const a=await iI(n);return[a,n===a?"plain":"s256"]}const aI=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function sI(e){const t=e.headers.get(Tm);if(!t||!t.match(aI))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function oI(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function lI(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const cI=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function _a(e){if(!cI.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Wh(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function uI(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function rb(e){return JSON.parse(JSON.stringify(e))}const Di=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dI=[502,503,504];async function nb(e){var t;if(!Q$(e))throw new km(Di(e),0);if(dI.includes(e.status))throw new km(Di(e),e.status);let r;try{r=await e.json()}catch(a){throw new Ui(Di(a),a)}let n;const i=sI(e);if(i&&i.getTime()>=NE["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Qx(Di(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Wr}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Qx(Di(r),e.status,r.weak_password.reasons);throw new F$(Di(r),e.status||500,n)}const fI=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function _e(e,t,r,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[Tm]||(a[Tm]=NE["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await hI(e,t,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function hI(e,t,r,n,i,a){const o=fI(t,n,i,a);let l;try{l=await e(r,Object.assign({},o))}catch(c){throw console.error(c),new km(Di(c),0)}if(l.ok||await nb(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await nb(c)}}function Hr(e){var t;let r=null;gI(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=X$(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function ib(e){const t=Hr(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function ti(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function pI(e){return{data:e,error:null}}function mI(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e,o=Fs(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function ab(e){return e}function gI(e){return e.access_token&&e.refresh_token&&e.expires_in}const Hh=["global","local","others"];class yI{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=PE(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Hh[0]){if(Hh.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Hh.join(", ")}`);try{return await _e(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ye(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await _e(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ti})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Fs(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await _e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:mI,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ye(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:ti})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await _e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:ab});if(d.error)throw d.error;const f=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(y.split(";")[1].split("=")[1]);u[`${m}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(ye(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){_a(t);try{return await _e(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:ti})}catch(r){if(ye(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){_a(t);try{return await _e(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:ti})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){_a(t);try{return await _e(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:ti})}catch(n){if(ye(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){_a(t.userId);try{const{data:r,error:n}=await _e(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _deleteFactor(t){_a(t.userId),_a(t.id);try{return{data:await _e(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:ab});if(d.error)throw d.error;const f=await d.json(),h=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,p=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(y=>{const v=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(y.split(";")[1].split("=")[1]);u[`${m}Page`]=v}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(ye(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await _e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await _e(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ye(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await _e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ye(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await _e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ye(r))return{data:null,error:r};throw r}}}function sb(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const ja={debug:!!(globalThis&&AE()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class OE extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class vI extends OE{}async function xI(e,t,r){ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ja.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw ja.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new vI(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ja.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function bI(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function CE(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function wI(e){return parseInt(e,16)}function _I(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function jI(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:u,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=CE(e.address),y=d?`${d}://${n}`:n,v=e.statement?`${e.statement}
`:"",m=`${y} wants you to sign in with your Ethereum account:
${p}

${v}`;let x=`URI: ${f}
Version: ${h}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(i&&(x+=`
Expiration Time: ${i.toISOString()}`),l&&(x+=`
Not Before: ${l.toISOString()}`),c&&(x+=`
Request ID: ${c}`),u){let b=`
Resources:`;for(const g of u){if(!g||typeof g!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${g}`);b+=`
- ${g}`}x+=b}return`${m}
${x}`}class pt extends Error{constructor({message:t,code:r,cause:n,name:i}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Qu extends pt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function SI({error:e,options:t}){var r,n,i;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new pt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new pt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new pt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new pt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new pt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new pt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new pt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new pt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(TE(o)){if(a.rp.id!==o)return new pt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new pt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new pt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function NI({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new pt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new pt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(TE(n)){if(r.rpId!==n)return new pt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new pt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new pt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new pt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class EI{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const AI=new EI;function PI(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Fs(e,["challenge","user","excludeCredentials"]),a=es(t).buffer,o=Object.assign(Object.assign({},r),{id:es(r.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:a,user:o});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:es(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function OI(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Fs(e,["challenge","allowCredentials"]),i=es(t).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:es(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function CI(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Ki(new Uint8Array(e.response.attestationObject)),clientDataJSON:Ki(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function TI(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Ki(new Uint8Array(i.authenticatorData)),clientDataJSON:Ki(new Uint8Array(i.clientDataJSON)),signature:Ki(new Uint8Array(i.signature)),userHandle:i.userHandle?Ki(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function TE(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function ob(){var e,t;return!!(qt()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function kI(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Qu("Browser returned unexpected credential type",t)}:{data:null,error:new Qu("Empty credential response",t)}}catch(t){return{data:null,error:SI({error:t,options:e})}}}async function $I(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Qu("Browser returned unexpected credential type",t)}:{data:null,error:new Qu("Empty credential response",t)}}catch(t){return{data:null,error:NI({error:t,options:e})}}}const II={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},MI={userVerification:"preferred",hints:["security-key"]};function Zu(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const a in i){const o=i[a];if(o!==void 0)if(Array.isArray(o))n[a]=o;else if(r(o))n[a]=o;else if(t(o)){const l=n[a];t(l)?n[a]=Zu(l,o):n[a]=Zu(o)}else n[a]=o}return n}function RI(e,t){return Zu(II,e,t||{})}function DI(e,t){return Zu(MI,e,t||{})}class LI{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const c=i??AI.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:u}=o.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(o.webauthn.type){case"create":{const u=RI(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await kI({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=DI(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await $I(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(o){return ye(o)?{data:null,error:o}:{data:null,error:new Ui("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}},a){if(!r)return{data:null,error:new ml("rpId is required for WebAuthn authentication")};try{if(!ob())return{data:null,error:new Ui("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(o){return ye(o)?{data:null,error:o}:{data:null,error:new Ui("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i},a){if(!r)return{data:null,error:new ml("rpId is required for WebAuthn registration")};try{if(!ob())return{data:null,error:new Ui("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(o){return ye(o)?{data:null,error:o}:{data:null,error:new Ui("Unexpected error in register",o)}}}}bI();const BI={url:M$,storageKey:R$,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:D$,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function lb(e,t,r){return await r()}const Sa={};class gl{get jwks(){var t,r;return(r=(t=Sa[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Sa[this.storageKey]=Object.assign(Object.assign({},Sa[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Sa[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Sa[this.storageKey]=Object.assign(Object.assign({},Sa[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},BI),t);if(this.storageKey=a.storageKey,this.instanceID=(r=gl.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,gl.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&qt()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new yI({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=PE(a.fetch),this.lock=a.lock||lb,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:qt()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=xI:this.lock=lb,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new LI(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:AE()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sb(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=sb(this.memoryStorage)),qt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${SE}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(qt()&&(r=J$(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),qt()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),z$(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ye(r)?this._returnResult({error:r}):this._returnResult({error:new Ui("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:Hr}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(ye(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,i;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let p=null,y=null;this.flowType==="pkce"&&([p,y]=await wa(this.storage,this.storageKey)),a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:y},xform:Hr})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await _e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Hr})}else throw new zc("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(ye(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:o,options:l}=t;r=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ib})}else if("phone"in t){const{phone:a,password:o,options:l}=t;r=await _e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ib})}else throw new zc("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new ba;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ye(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,a,o,l,c,u,d,f,h;let p,y;if("message"in t)p=t.message,y=t.signature;else{const{chain:v,wallet:m,statement:x,options:b}=t;let g;if(qt())if(typeof m=="object")g=m;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")g=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=m}const S=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href),w=await g.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!w||w.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const j=CE(w[0]);let _=(n=b==null?void 0:b.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!_){const A=await g.request({method:"eth_chainId"});_=wI(A)}const E={domain:S.host,address:j,statement:x,uri:S.href,version:"1",chainId:_,nonce:(i=b==null?void 0:b.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(a=b==null?void 0:b.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=b==null?void 0:b.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=b==null?void 0:b.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=b==null?void 0:b.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=b==null?void 0:b.signInWithEthereum)===null||d===void 0?void 0:d.resources};p=jI(E),y=await g.request({method:"personal_sign",params:[_I(p),j]})}try{const{data:v,error:m}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:y},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Hr});if(m)throw m;if(!v||!v.session||!v.user){const x=new ba;return this._returnResult({data:{user:null,session:null},error:x})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:m})}catch(v){if(ye(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(t){var r,n,i,a,o,l,c,u,d,f,h,p;let y,v;if("message"in t)y=t.message,v=t.signature;else{const{chain:m,wallet:x,statement:b,options:g}=t;let S;if(qt())if(typeof x=="object")S=x;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))S=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=x}const w=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const j=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:w.host,uri:w.href}),b?{statement:b}:null));let _;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")_=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)_=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)y=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),v=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${w.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...b?["",b,""]:[""],"Version: 1",`URI: ${w.href}`,`Issued At: ${(i=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((f=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...g.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const j=await S.signMessage(new TextEncoder().encode(y),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=j}}try{const{data:m,error:x}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:Ki(v)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Hr});if(x)throw x;if(!m||!m.session||!m.user){const b=new ba;return this._returnResult({data:{user:null,session:null},error:b})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:x})}catch(m){if(ye(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async _exchangeCodeForSession(t){const r=await Ti(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:a,error:o}=await _e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Hr});if(await Xn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new ba;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:o})}catch(a){if(ye(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:a,nonce:o}=t,l=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Hr}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new ba;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(ye(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,a,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await wa(this.storage,this.storageKey));const{error:f}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await _e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=c==null?void 0:c.data)!==null&&i!==void 0?i:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new zc("You must provide either an email or phone number.")}catch(l){if(ye(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,n;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await _e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:Hr});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(i){if(ye(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i;try{let a=null,o=null;this.flowType==="pkce"&&([a,o]=await wa(this.storage,this.storageKey));const l=await _e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:pI});return this._returnResult(l)}catch(a){if(ye(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Wr;const{error:i}=await _e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(ye(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:o}=await _e(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:o,error:l}=await _e(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new zc("You must provide either an email or phone number and a type")}catch(r){if(ye(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ti(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<qh:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Ti(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Wh()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=uI(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:ti}):await this._useSession(async r=>{var n,i,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Wr}:await _e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:ti})})}catch(r){if(ye(r))return U$(r)&&(await this._removeSession(),await Xn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new Wr;const o=i.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await wa(this.storage,this.storageKey));const{data:u,error:d}=await _e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:ti});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(ye(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Wr;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:o}=zh(t.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(ye(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Wr;const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ye(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!qt())throw new Wc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Jx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Jx("No code detected.");const{data:b,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!o||!u)throw new Wc("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(l);let h=d+f;c&&(h=parseInt(c));const p=h-d;p*1e3<=Aa&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${f}s`);const y=h-f;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,h,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,h,d);const{data:v,error:m}=await this._getUser(a);if(m)throw m;const x={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:f,expires_at:h,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(n){if(ye(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ti(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({error:a});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(q$(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Xn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Y$(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await wa(this.storage,this.storageKey,!0));try{return await _e(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(ye(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var o,l,c,u,d;const{data:f,error:h}=a;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await _e(this.fetch,"GET",p,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(i)throw i;return qt()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ye(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:a}}=r;if(i)throw i;const{options:o,provider:l,token:c,access_token:u,nonce:d}=t,f=await _e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Hr}),{data:h,error:p}=f;return p?this._returnResult({data:{user:null,session:null},error:p}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new ba}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:p}))}catch(i){if(ye(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:o}=r;if(o)throw o;return await _e(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await eI(async i=>(i>0&&await Z$(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await _e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Hr})),(i,a)=>{const o=200*Math.pow(2,i);return a&&Uh(a)&&Date.now()+o-n<Aa})}catch(n){if(this._debug(r,"error",n),ye(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),qt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Ti(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Ti(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Pa(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Wh()}else if(i&&!i.user&&!i.user){const o=await Ti(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(i.user=o.user,await Xn(this.storage,this.storageKey+"-user"),await Pa(this.storage,this.storageKey,i)):i.user=Wh()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<qh;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${qh}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Uh(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(i.access_token);!l&&(o!=null&&o.user)?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Wr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new ff;const{data:a,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!a.session)throw new Wr;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(i,"error",a),ye(a)){const o={data:null,error:a};return Uh(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Pa(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const a=rb(i);await Pa(this.storage,this.storageKey,a)}else{const i=rb(r);await Pa(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await Xn(this.storage,this.storageKey),await Xn(this.storage,this.storageKey+"-code-verifier"),await Xn(this.storage,this.storageKey+"-user"),this.userStorage&&await Xn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Aa);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Aa);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Aa}ms, refresh threshold is ${Cm} ticks`),i<=Cm&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof OE)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await wa(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?this._returnResult({data:null,error:a}):await _e(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await _e(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((i=c==null?void 0:c.totp)===null||i===void 0)&&i.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?CI(t.webauthn.credential_response):TI(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await _e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const o=await _e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:PI(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:OI(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:i}=await this.getSession();if(i)return this._returnResult({data:null,error:i});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=zh(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await _e(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Wr})})}catch(r){if(ye(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Wr});const o=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&qt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new Wr});const o=await _e(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&qt()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(l=>l.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===t),n&&this.jwks_cached_at+B$>i)return n;const{data:a,error:o}=await _e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(l=>l.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:y}=await this.getSession();if(y||!p.session)return this._returnResult({data:null,error:y});n=p.session.access_token}const{header:i,payload:a,signature:o,raw:{header:l,payload:c}}=zh(n);r!=null&&r.allowExpired||oI(a.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:a,header:i,signature:o},error:null}}const d=lI(i.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,o,K$(`${l}.${c}`)))throw new $m("Invalid JWT signature");return{data:{claims:a,header:i,signature:o},error:null}}catch(n){if(ye(n))return this._returnResult({data:null,error:n});throw n}}}gl.nextInstanceID={};const FI=gl;class qI extends FI{constructor(t){super(t)}}class UI{constructor(t,r,n){var i,a,o;this.supabaseUrl=t,this.supabaseKey=r;const l=I$(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:E$,realtime:P$,auth:Object.assign(Object.assign({},A$),{storageKey:c}),global:N$},d=$$(n??{},u);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=d.auth)!==null&&o!==void 0?o:{},this.headers,d.global.fetch),this.fetch=T$(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Mk(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new _$(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new kk(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var t,r;if(this.accessToken)return await this.accessToken();const{data:n}=await this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:a,storageKey:o,flowType:l,lock:c,debug:u,throwOnError:d},f,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new qI({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),f),storageKey:o,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,userStorage:a,flowType:l,lock:c,debug:u,throwOnError:d,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new Qk(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const zI=(e,t,r)=>new UI(e,t,r);function WI(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}WI()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const HI="https://ynoxsibapzatlxhmredp.supabase.co",VI="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inlub3hzaWJhcHphdGx4aG1yZWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI0NTQ5OTcsImV4cCI6MjA3ODAzMDk5N30.39C4_sEXIeplYHBYPEGa-_pnan-1SHM6cgNJ-FrtsvU",V=zI(HI,VI,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"}});let Im=null;function GI(){Im=V.auth.onAuthStateChange((e,t)=>{e==="SIGNED_OUT"?console.log(" Utilisateur dconnect"):e==="TOKEN_REFRESHED"?console.log(" Token actualis"):e==="USER_UPDATED"?console.log(" Utilisateur mis  jour"):e==="SIGNED_IN"&&console.log(" Utilisateur connect")})}function KI(){Im&&Im()}const ie={PROSPECTS:"prospects",INSTALLATIONS:"installations",ABONNEMENTS:"abonnements",PAIEMENTS:"paiements",INTERVENTIONS:"interventions",USERS:"users",APPLICATIONS:"applications",HISTORIQUE_ACTIONS:"prospect_history"},cb={SUPER_ADMIN:"super_admin",ADMIN:"admin",TECHNICIEN:"technicien",COMMERCIAL:"commercial",SUPPORT:"support"},ta={super_admin:{label:"Super Administrateur",canManageUsers:!0,canManageRoles:!0,canManageApplications:!0,canViewAll:!0,canEditAll:!0,canDeleteAll:!0,allPages:!0},admin:{label:"Administrateur",canManageUsers:!0,canManageRoles:!1,canManageApplications:!0,canViewAll:!0,canEditAll:!0,canDeleteAll:!0,allPages:!0},technicien:{label:"Technicien",canManageUsers:!1,canManageRoles:!1,canManageApplications:!1,canViewAll:!1,canEditAll:!1,canDeleteAll:!1,allPages:!1,defaultPages:["dashboard","installations","abonnements","support","missions"]},commercial:{label:"Commercial",canManageUsers:!1,canManageRoles:!1,canManageApplications:!1,canViewAll:!1,canEditAll:!1,canDeleteAll:!1,allPages:!1,defaultPages:["dashboard","prospects","clients","installations","abonnements","paiements","alertes","missions"]},support:{label:"Support",canManageUsers:!1,canManageRoles:!1,canManageApplications:!1,canViewAll:!1,canEditAll:!1,canDeleteAll:!1,allPages:!1,defaultPages:["dashboard","support","missions","clients"]}},Ee={DASHBOARD:"dashboard",PROSPECTS:"prospects",CLIENTS:"clients",INSTALLATIONS:"installations",ABONNEMENTS:"abonnements",PAIEMENTS:"paiements",SUPPORT:"support",MISSIONS:"missions",ALERTES:"alertes",APPLICATIONS:"applications",UTILISATEURS:"utilisateurs"},co={prospects:{label:" Prospects",icon:"",permissions:["create","edit","delete"]},clients:{label:" Clients",icon:"",permissions:["create","edit","delete"]},installations:{label:" Installations",icon:"",permissions:["create","edit","delete"]},abonnements:{label:" Abonnements",icon:"",permissions:["create","edit","delete"]},paiements:{label:" Paiements",icon:"",permissions:["create","edit","delete"]},support:{label:" Support",icon:"",permissions:["view","create","edit","delete"]},missions:{label:" Missions",icon:"",permissions:["create","edit","delete","close","validate"]},alertes:{label:" Alertes",icon:"",permissions:["create","edit","delete"]},applications:{label:" Applications",icon:"",permissions:["create","edit","delete"]}},XI={view:" Consulter",create:" Crer",edit:" Modifier",delete:" Supprimer",close:" Clturer",validate:" Valider"},Zt={async signIn(e,t){try{const{data:r,error:n}=await V.rpc("verify_user_password",{p_email:e.toLowerCase(),p_password:t});if(n)throw console.error("Erreur vrification mot de passe:",n),new Error("Email ou mot de passe incorrect");if(!r||r.length===0)throw console.warn("Utilisateur non trouv:",e),new Error("Email ou mot de passe incorrect");const i=r[0];if(!i.is_valid)throw console.warn("Mot de passe incorrect pour:",e),new Error("Email ou mot de passe incorrect");try{await V.rpc("update_last_login",{p_email:e.toLowerCase()})}catch(c){console.warn("Note: update_last_login choue (non-bloquant):",c)}const a={id:i.user_id,email:i.email,nom:i.nom,role:i.role,pages_visibles:[]},{data:o,error:l}=await V.from("users").select("pages_visibles").eq("id",i.user_id).single();return!l&&o&&(a.pages_visibles=o.pages_visibles||[]),console.log(" Connexion russie (authentification locale):",{email:e,role:a.role}),localStorage.setItem("currentUser",JSON.stringify(a)),{user:{id:i.user_id},profile:a}}catch(r){throw console.error(" Erreur de connexion:",r),r}},async signOut(){try{localStorage.removeItem("currentUser"),console.log(" Dconnexion russie")}catch(e){throw console.error("Erreur de dconnexion:",e),e}},async getCurrentUser(){try{const e=localStorage.getItem("currentUser");if(!e)return console.log(" Pas d'utilisateur en session"),null;try{const t=JSON.parse(e);return console.log(" Utilisateur rcupr du localStorage:",t.email),t}catch(t){console.warn(" Erreur parsing localStorage:",t);try{const{data:{user:r},error:n}=await V.auth.getUser();if(!n&&r)return console.log(" Utilisateur rcupr depuis Supabase"),{user:r,profile:{id:r.id,email:r.email}}}catch{console.warn(" Impossible de rcuprer depuis Supabase")}return null}}catch(e){return console.error("Erreur critique rcupration utilisateur:",e),null}},hasPageAccess(e,t){if(!e)return!1;const r=e.role||"commercial",n=ta[r];return n?n.allPages?!0:(e.pages_visibles||[]).includes(t):(console.warn(`Rle inconnu: ${r}`),!1)},hasPermission(e,t){if(!e)return!1;const r=e.role||"commercial",n=ta[r];return n?n[t]===!0:(console.warn(`Rle inconnu: ${r}`),!1)},canManageUsers(e){return this.hasPermission(e,"canManageUsers")},canManageRoles(e){return this.hasPermission(e,"canManageRoles")},canManageApplications(e){return this.hasPermission(e,"canManageApplications")},canViewAll(e){return this.hasPermission(e,"canViewAll")},canEditAll(e){return this.hasPermission(e,"canEditAll")},canDeleteAll(e){return this.hasPermission(e,"canDeleteAll")},getDefaultPages(e){const t=ta[e];return t!=null&&t.allPages?["dashboard","prospects","clients","installations","abonnements","paiements","support","applications","utilisateurs"]:(t==null?void 0:t.defaultPages)||[]}},kE=N.createContext(null),YI=({children:e})=>{const[t,r]=N.useState(null),[n,i]=N.useState(null),[a,o]=N.useState(!0);N.useEffect(()=>(l(),GI(),()=>{KI()}),[]);const l=async()=>{try{const g=await Zt.getCurrentUser();g&&(r(g.user),i(g.profile))}catch(g){console.error("Erreur vrification utilisateur:",g)}finally{o(!1)}},b={user:t,profile:n,loading:a,signIn:async(g,S)=>{try{const{user:w,profile:j}=await Zt.signIn(g,S);return r(w),i(j),console.log(" Connexion russie:",{email:g,role:j==null?void 0:j.role}),{user:w,profile:j}}catch(w){throw console.error(" Erreur de connexion:",w),r(null),i(null),w}},signOut:async()=>{await Zt.signOut(),r(null),i(null)},hasAccess:g=>Zt.hasPageAccess(n,g),canManageUsers:()=>Zt.canManageUsers(n),canManageRoles:()=>Zt.canManageRoles(n),canManageApplications:()=>Zt.canManageApplications(n),canViewAll:()=>Zt.canViewAll(n),canEditAll:()=>Zt.canEditAll(n),canDeleteAll:()=>Zt.canDeleteAll(n),hasPermission:g=>Zt.hasPermission(n,g),isAuthenticated:!!t};return s.jsx(kE.Provider,{value:b,children:e})},dt=()=>{const e=N.useContext(kE);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},$E=N.createContext(null),JI=({children:e})=>{const[t,r]=N.useState([]),[n,i]=N.useState(!0),a=u=>{const d=Date.now();r(h=>[...h,{...u,id:d}]);const f=u.duration||(u.type==="error"?8e3:5e3);setTimeout(()=>{o(d)},f)},o=u=>{r(d=>d.filter(f=>f.id!==u))},c={notifications:t,addNotification:a,removeNotification:o,sidebarOpen:n,setSidebarOpen:i,toggleSidebar:()=>{i(u=>!u)}};return s.jsx($E.Provider,{value:c,children:e})},cr=()=>{const e=N.useContext($E);if(!e)throw new Error("useApp must be used within AppProvider");return e};var QI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ZI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),eM=(e,t)=>{const r=N.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:a=2,absoluteStrokeWidth:o,children:l,...c},u)=>N.createElement("svg",{ref:u,...QI,width:i,height:i,stroke:n,strokeWidth:o?Number(a)*24/Number(i):a,className:`lucide lucide-${ZI(e)}`,...c},[...t.map(([d,f])=>N.createElement(d,f)),...(Array.isArray(l)?l:[l])||[]]));return r.displayName=`${e}`,r};var ge=eM;const Vh=ge("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),xt=ge("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),fs=ge("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),tM=ge("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),rM=ge("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ed=ge("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Mm=ge("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]),zi=ge("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Uo=ge("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),xr=ge("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),zt=ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),nM=ge("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),ln=ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),ri=ge("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),zs=ge("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Hc=ge("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),Ua=ge("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),yl=ge("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),iM=ge("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),vl=ge("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),aM=ge("FileCheck",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),xu=ge("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),uo=ge("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),Gh=ge("Gift",[["polyline",{points:"20 12 20 22 4 22 4 12",key:"nda8fc"}],["rect",{width:"20",height:"5",x:"2",y:"7",key:"wkgdzj"}],["line",{x1:"12",x2:"12",y1:"22",y2:"7",key:"1n8zgp"}],["path",{d:"M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z",key:"zighg4"}],["path",{d:"M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z",key:"1pa5tk"}]]),sM=ge("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),oM=ge("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),lM=ge("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),cM=ge("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]),uM=ge("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),xi=ge("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),dM=ge("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),fM=ge("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),c0=ge("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Cn=ge("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),IE=ge("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),hM=ge("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),u0=ge("Package",[["path",{d:"M16.5 9.4 7.55 4.24",key:"10qotr"}],["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),br=ge("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),bu=ge("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),ME=ge("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),Un=ge("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),hs=ge("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),RE=ge("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),hf=ge("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),pM=ge("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Rm=ge("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),fo=ge("Snowflake",[["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"m20 16-4-4 4-4",key:"rquw4f"}],["path",{d:"m4 8 4 4-4 4",key:"12s3z9"}],["path",{d:"m16 4-4 4-4-4",key:"1tumq1"}],["path",{d:"m8 20 4-4 4 4",key:"9p200w"}]]),mM=ge("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),ni=ge("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),wu=ge("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]),rr=ge("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),gM=ge("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),cn=ge("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),d0=ge("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),xl=ge("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),yM=ge("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Lr=ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),bl=ge("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),vM=()=>{const[e,t]=N.useState(""),[r,n]=N.useState(""),[i,a]=N.useState(""),[o,l]=N.useState(!1),{signIn:c}=dt(),u=async d=>{var f,h,p,y;d.preventDefault(),a(""),l(!0);try{await c(e,r)}catch(v){v.code==="AUTH_NOT_INITIALIZED"?a(v.message):(f=v.message)!=null&&f.includes("Email ou mot de passe incorrect")?a(" Email ou mot de passe incorrect"):(h=v.message)!=null&&h.includes("Email not confirmed")?a(" Veuillez confirmer votre adresse email"):(p=v.message)!=null&&p.includes("rate limit")?a(" Trop de tentatives. Veuillez ressayer dans un moment."):(y=v.message)!=null&&y.includes("not found")?a(" Cet utilisateur n'existe pas"):a(v.message||" Erreur de connexion")}finally{l(!1)}};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary to-secondary flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsx("div",{className:"bg-primary w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-4",children:s.jsx("span",{className:"text-white text-3xl font-bold",children:"A2S"})}),s.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"A2S Gestion"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Connectez-vous  votre compte"})]}),s.jsxs("form",{onSubmit:u,className:"space-y-6",children:[i&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm whitespace-pre-wrap",children:i}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),s.jsx("input",{type:"email",value:e,onChange:d=>t(d.target.value),className:"input-field",placeholder:"votre@email.com",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mot de passe"}),s.jsx("input",{type:"password",value:r,onChange:d=>n(d.target.value),className:"input-field",placeholder:"",required:!0})]}),s.jsx("button",{type:"submit",disabled:o,className:"w-full btn-primary py-3 flex items-center justify-center gap-2",children:o?s.jsx("span",{children:"Connexion en cours..."}):s.jsxs(s.Fragment,{children:[s.jsx(dM,{size:20}),s.jsx("span",{children:"Se connecter"})]})})]}),s.jsx("div",{className:"mt-8 text-center text-sm text-gray-600",children:s.jsx("p",{children:" 2025 SARL A2S - Tous droits rservs"})})]})})},xM=({children:e,requiredPage:t})=>{const{isAuthenticated:r,loading:n,hasAccess:i,profile:a}=dt();return n?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):r?t&&!i(t)?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:s.jsxs("div",{className:"max-w-md w-full text-center bg-white rounded-lg shadow p-8",children:[s.jsx(xt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:" Accs Refus"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Vous n'avez pas accs  cette page."}),s.jsxs("p",{className:"text-sm text-gray-500 mb-6",children:[s.jsx("strong",{children:"Rle actuel:"})," ",(a==null?void 0:a.role)||"Non dfini"]}),s.jsx("p",{className:"text-xs text-gray-400 mb-6",children:"Demandez  un administrateur pour accorder l'accs  cette page."}),s.jsx("a",{href:"/",className:"inline-block bg-primary text-white px-6 py-2 rounded-lg font-medium hover:opacity-90 transition-opacity",children:"Retour au Tableau de Bord"})]})}):e:s.jsx(PN,{to:"/login",replace:!0})},St=e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"",DE=e=>e?new Date(e).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"",Nt=e=>!e&&e!==0?"0 DA":new Intl.NumberFormat("fr-DZ",{style:"decimal",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)+" DA",bM=(e,t)=>{const r=Math.max(0,e-t);return r===e?{code:0,statut:"AUCUN PAIEMENT",couleur:"bg-red-100 text-red-700",badge:"bg-red-500 text-white",icon:"",pourcentage:0}:r>0?{code:1,statut:"PARTIELLEMENT PAY",couleur:"bg-orange-100 text-orange-700",badge:"bg-orange-500 text-white",icon:"",pourcentage:Math.round(t/e*100)}:{code:2,statut:"TOTALEMENT PAY",couleur:"bg-green-100 text-green-700",badge:"bg-green-500 text-white",icon:"",pourcentage:100}},En=(e,t)=>bM(e,t),Ao=e=>{if(!e)return 0;const t=new Date,n=new Date(e)-t;return Math.ceil(n/(1e3*60*60*24))},wM=e=>({actif:"badge-success",prospect:"badge-info",inactif:"badge-danger",en_cours:"badge-warning",terminee:"badge-success",en_alerte:"badge-warning",expire:"badge-danger",cloturee:"badge-success",normale:"badge-info",haute:"badge-danger"})[e]||"badge-info",_u=e=>({actif:"Actif",prospect:"Prospect",inactif:"Inactif",en_cours:"En Cours",terminee:"Termine",en_alerte:"En Alerte",expire:"Expir",cloturee:"Clture",normale:"Normale",haute:"Haute",sur_site:"Sur Site",a_distance:" Distance",maintenance:"Maintenance",formation:"Formation",autre:"Autre",especes:"Espces",virement:"Virement",cheque:"Chque",acquisition:"Acquisition",abonnement:"Abonnement"})[e]||e,LE=e=>{if(!e)return"";const t=e.split(" ");return t.length===1?t[0].charAt(0).toUpperCase():(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase()},Kh=({currentPage:e,onPageChange:t})=>{const{profile:r,signOut:n,hasAccess:i}=dt(),{sidebarOpen:a,toggleSidebar:o}=cr(),c=[{id:Ee.DASHBOARD,label:"Tableau de Bord",icon:cM},{id:Ee.PROSPECTS,label:"Prospects",icon:ni},{id:Ee.CLIENTS,label:"Clients",icon:xl},{id:Ee.INSTALLATIONS,label:"Installations",icon:iM},{id:Ee.ABONNEMENTS,label:"Abonnements",icon:xr},{id:Ee.PAIEMENTS,label:"Paiements",icon:Ua},{id:Ee.SUPPORT,label:" Support",icon:sM},{id:Ee.MISSIONS,label:" Missions",icon:zt},{id:Ee.APPLICATIONS,label:"Applications",icon:u0},{id:Ee.UTILISATEURS,label:"Utilisateurs",icon:xl}].filter(d=>i(d.id)),u=async()=>{try{await n()}catch(d){console.error("Erreur dconnexion:",d)}};return s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:o,className:"lg:hidden fixed top-4 left-4 z-50 bg-primary text-white p-2 rounded-lg shadow-lg",children:a?s.jsx(Lr,{size:24}):s.jsx(IE,{size:24})}),a&&s.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-30",onClick:o}),s.jsxs("aside",{className:`
          fixed lg:static inset-y-0 left-0 z-40
          w-64 bg-primary text-white
          transform transition-transform duration-300 ease-in-out
          ${a?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          flex flex-col
        `,children:[s.jsx("div",{className:"p-6 border-b border-primary-light",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"bg-white w-12 h-12 rounded-xl flex items-center justify-center",children:s.jsx("span",{className:"text-primary text-xl font-bold",children:"A2S"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold",children:"A2S Gestion"}),s.jsx("p",{className:"text-sm text-blue-200",children:r==null?void 0:r.role})]})]})}),s.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:c.map(d=>{const f=d.icon,h=e===d.id;return s.jsxs("button",{onClick:()=>{t(d.id),window.innerWidth<1024&&o()},className:`
                  w-full flex items-center gap-3 px-6 py-3 
                  transition-colors duration-200
                  ${h?"bg-white bg-opacity-20 border-l-4 border-white":"hover:bg-white hover:bg-opacity-10"}
                `,children:[s.jsx(f,{size:20}),s.jsx("span",{className:"font-medium",children:d.label})]},d.id)})}),s.jsxs("div",{className:"p-4 border-t border-primary-light",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("div",{className:"w-10 h-10 rounded-full bg-white text-primary flex items-center justify-center font-bold",children:LE((r==null?void 0:r.nom)||"User")}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-medium truncate",children:r==null?void 0:r.nom}),s.jsx("p",{className:"text-sm text-blue-200 truncate",children:"Utilisateur"})]})]}),s.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-white bg-opacity-10 hover:bg-opacity-20 rounded-lg transition-colors",children:[s.jsx(fM,{size:18}),s.jsx("span",{children:"Dconnexion"})]})]})]})]})},mt={async getAll(){try{const{data:e,error:t}=await V.from(ie.PROSPECTS).select("*");if(t)throw t;return(e||[]).sort((n,i)=>new Date(i.created_at)-new Date(n.created_at))}catch(e){throw console.error("Erreur rcupration prospects:",e),e}},async getById(e){try{const{data:t,error:r}=await V.from(ie.PROSPECTS).select("*").eq("id",e).single();if(r)throw r;return t}catch(t){throw console.error("Erreur rcupration prospect:",t),t}},async create(e){try{const t=["GROSSISTE PHARM","GROSSISTE PARA","PARA SUPER GROS","LABO PROD","AUTRE"],r=e.secteur&&t.includes(e.secteur)?e.secteur:"AUTRE",n={raison_sociale:e.raison_sociale||"",contact:e.contact||"",secteur:r,telephone:e.telephone||"",email:e.email||"",wilaya:e.wilaya||"",ville:e.ville||"",adresse:e.adresse||"",forme_juridique:e.forme_juridique||"",temperature:e.temperature||"froid",statut:"prospect",created_by:e.created_by||null},{data:i,error:a}=await V.from(ie.PROSPECTS).insert([n]).select();if(a)throw a;const o=i&&i.length>0?i[0]:n;if(e.commercial_assigned&&e.commercial_assigned.trim())try{await V.from(ie.PROSPECTS).update({commercial_assigned:e.commercial_assigned}).eq("id",o.id)}catch(l){console.warn(" Commercial non assign:",l)}try{const l=JSON.stringify([{action:"creation",details:"Prospect cr",created_at:new Date().toISOString(),created_by:e.created_by||"system"}]);await V.from(ie.PROSPECTS).update({historique_actions:l}).eq("id",o.id)}catch(l){console.warn(" Historique non disponible - Excutez la migration SQL:",l.message)}return o}catch(t){throw console.error("Erreur cration prospect:",t),t}},async update(e,t){try{const r=["GROSSISTE PHARM","GROSSISTE PARA","PARA SUPER GROS","LABO PROD","AUTRE"],n=t.secteur&&r.includes(t.secteur)?t.secteur:"AUTRE",i={raison_sociale:t.raison_sociale||"",contact:t.contact||"",secteur:n,telephone:t.telephone||"",email:t.email||"",wilaya:t.wilaya||"",ville:t.ville||"",adresse:t.adresse||"",forme_juridique:t.forme_juridique||"",temperature:t.temperature||"froid"},{data:a,error:o}=await V.from(ie.PROSPECTS).update(i).eq("id",e).select();if(o)throw o;if(t.commercial_assigned&&t.commercial_assigned.trim())try{await V.from(ie.PROSPECTS).update({commercial_assigned:t.commercial_assigned}).eq("id",e)}catch(l){console.warn(" Commercial non assign:",l)}return await this.addHistorique(e,"modification","Prospect modifi"),a&&a.length>0?a[0]:i}catch(r){throw console.error("Erreur mise  jour prospect:",r),r}},async updateTemperature(e,t){try{const{data:r,error:n}=await V.from(ie.PROSPECTS).update({temperature:t}).eq("id",e).select();if(n)throw n;const i=t.toUpperCase();return await this.addHistorique(e,"temperature_change",`Intrt du prospect pass  : ${i}`,{temperature:t}),r&&r.length>0?r[0]:null}catch(r){throw console.error("Erreur mise  jour temprature:",r),r}},async delete(e){try{const{error:t}=await V.from(ie.PROSPECTS).delete().eq("id",e);if(t)throw t;return!0}catch(t){throw console.error("Erreur suppression prospect:",t),t}},async convertToClient(e){try{await this.addHistorique(e,"conversion","Converti en client actif");const{data:t,error:r}=await V.from(ie.PROSPECTS).update({statut:"actif"}).eq("id",e).select();if(r)throw r;return t&&t.length>0?t[0]:{id:e,statut:"actif"}}catch(t){throw console.error("Erreur conversion prospect:",t),t}},async addHistorique(e,t,r,n={}){try{const{data:i,error:a}=await V.from(ie.PROSPECTS).select("statut, historique_actions, temperature").eq("id",e).single();if(a)throw a;const o=this._getAutomatedTemperature(t,(i==null?void 0:i.temperature)||"froid");if(o!==(i==null?void 0:i.temperature)&&(console.log(` Automatisation : Temprature passe de ${i==null?void 0:i.temperature}  ${o} via l'action ${t}`),await V.from(ie.PROSPECTS).update({temperature:o}).eq("id",e)),i&&i.statut==="actif"&&!["abonnement_acquisition","abonnement_auto_renew","installation","conversion"].includes(t)){console.log(` Action '${t}' skippe aprs conversion - Client actif uniquement`);return}const l=new Date().toISOString(),c={action:t,details:r,created_at:l,...n};let u=[];try{u=i.historique_actions?JSON.parse(i.historique_actions):[]}catch{u=[]}u.push(c),await V.from(ie.PROSPECTS).update({historique_actions:JSON.stringify(u)}).eq("id",e),console.log(" Tentative insertion prospect_history:",{action:t,metadata:n}),t==="installation"&&(console.log(" Passage automatique du prospect en statut ACTIF (Client)..."),await V.from("prospects").update({statut:"actif"}).eq("id",e));const d={prospect_id:e,type_action:t,description:r,application:n.application||null,chef_mission:n.chef_mission?String(n.chef_mission):null,date_debut:n.date_debut||null,date_fin:n.date_fin||null,conversion:n.conversion||"non",anciens_logiciels:n.anciens_logiciels||[],created_at:l};console.log(" Donnes  insrer:",d);const f={...d,action:t},{data:h,error:p}=await V.from("prospect_history").insert([f]).select();p?(console.error(" Erreur CRITIQUE insertion prospect_history:",p),console.error("Message:",p.message),console.error("Dtails:",p.details)):console.log(" Succs insertion prospect_history:",h)}catch(i){console.error(" Erreur GLOBALE addHistorique:",i),this._addHistoriqueLocalStorage(e,t,r,n)}},async deleteAction(e,t){try{if(console.log(" Dbut suppression action:",{prospectId:e,actionId:t.id,action:t.action}),t.id){console.log(" Suppression de la table prospect_history (ID:",t.id,")");const{error:r}=await V.from("prospect_history").delete().eq("id",t.id);if(r)throw r}try{if(!e)throw new Error("ID prospect manquant pour le nettoyage JSON");const r=await this._getHistoriqueJSON(e),n=r.length,i=new Date(t.created_at).getTime(),a=r.filter(o=>{const l=new Date(o.created_at).getTime(),c=o.action===t.action||o.action===t.type_action,u=Math.abs(l-i)<1e4,d=o.details===t.details||o.details===t.description||o.description===t.details||o.description===t.description||!o.details&&!t.description;return!(c&&(u||d))});if(a.length!==n){console.log(` Nettoyage JSON legacy: ${n-a.length} entre(s) retire(s)`);const{error:o}=await V.from(ie.PROSPECTS).update({historique_actions:JSON.stringify(a)}).eq("id",e);if(o)throw o}else console.log(" Aucune entre correspondante trouve dans le JSON legacy.")}catch(r){console.warn(" Erreur nettoyage JSON:",r.message)}return(t.action==="installation"||t.type_action==="installation")&&await this.checkAndFixProspectStatus(e),!0}catch(r){throw console.error(" Erreur suppression action:",r),r}},async checkAndFixProspectStatus(e){try{if(!e)return;console.log(" Vrification du reliquat d'installations pour le statut...");const{data:t}=await V.from("prospect_history").select("id").eq("prospect_id",e).eq("type_action","installation"),r=(await this._getHistoriqueJSON(e)).filter(i=>i.action==="installation"),n=((t==null?void 0:t.length)||0)+r.length;return n===0?(console.log(" Plus d'installation trouve. Retour au statut PROSPECT."),await V.from("prospects").update({statut:"prospect"}).eq("id",e),"prospect"):(console.log(` Il reste encore ${n} installation(s).`),"actif")}catch(t){console.error(" Erreur checkAndFixProspectStatus:",t)}},_addHistoriqueLocalStorage(e,t,r,n={}){try{const i=`prospect_history_${e}`,a=localStorage.getItem(i);let o=a?JSON.parse(a):[];o.push({action:t,details:r,created_at:new Date().toISOString(),...n}),localStorage.setItem(i,JSON.stringify(o)),console.log(" Historique enregistr dans LocalStorage (temporaire)")}catch(i){console.error(" Impossible d'enregistrer dans LocalStorage:",i)}},async getHistorique(e){try{const t=await this._getHistoriqueJSON(e),{data:r,error:n}=await V.from("prospect_history").select("*").eq("prospect_id",e);if(n)return console.warn(" Erreur rcupration prospect_history:",n.message),t;if(!r||r.length===0)return t;const i=r.map(a=>({...a,action:a.type_action||a.action}));return t.forEach(a=>{const o=new Date(a.created_at).getTime();i.find(c=>{const u=new Date(c.created_at).getTime(),d=c.action===a.action||c.type_action===a.action,f=Math.abs(u-o)<3e4,h=c.description&&a.details&&c.description===a.details||c.details&&a.details&&c.details===a.details||c.description&&a.description&&c.description===a.description;return d&&(f||h)})||i.push(a)}),i.sort((a,o)=>new Date(o.created_at)-new Date(a.created_at))}catch(t){return console.warn(" Erreur globale historique:",t),this._getHistoriqueJSON(e)}},async _getHistoriqueJSON(e){try{const{data:t,error:r}=await V.from(ie.PROSPECTS).select("historique_actions").eq("id",e).single();if(r)return[];try{return(t.historique_actions?JSON.parse(t.historique_actions):[]).sort((i,a)=>new Date(a.created_at)-new Date(i.created_at))}catch{return[]}}catch{return[]}},_getHistoriqueLocalStorage(e){try{const t=`prospect_history_${e}`,r=localStorage.getItem(t);return r?JSON.parse(r).sort((i,a)=>new Date(a.created_at)-new Date(i.created_at)):[]}catch(t){return console.error(" Impossible de lire LocalStorage:",t),[]}},async getStats(){try{const{data:e,error:t}=await V.from(ie.PROSPECTS).select("statut, temperature");if(t)throw t;return{total:e.length,prospects:e.filter(n=>n.statut==="prospect").length,actifs:e.filter(n=>n.statut==="actif").length,inactifs:e.filter(n=>n.statut==="inactif").length,temperature:{froid:e.filter(n=>n.temperature==="froid").length,tiede:e.filter(n=>n.temperature==="tiede").length,chaud:e.filter(n=>n.temperature==="chaud").length,brulant:e.filter(n=>n.temperature==="brulant").length}}}catch(e){throw console.error("Erreur statistiques prospects:",e),e}},async getGlobalRecentActivities(e=10){try{const{data:t,error:r}=await V.from("prospect_history").select(`
          *,
          prospect: prospects(raison_sociale)
        `).order("created_at",{ascending:!1}).limit(e);if(r)throw r;return t||[]}catch(t){return console.error("Erreur historiques globaux:",t),[]}},_getAutomatedTemperature(e,t="froid"){const n={installation:"brulant",contrat_signe:"brulant",demo:"brulant",offre_envoyee:"brulant",rdv:"chaud",visite:"chaud",negociation:"chaud",appel:"tiede",email:"tiede",suivi:"tiede",relance:"tiede",creation:"froid"}[e];if(!n)return t;const i={froid:0,tiede:1,chaud:2,brulant:3},a=i[t]||0,o=i[n]||0;return e==="creation"||o>a?n:t},async migrateLegacyProspects(){try{const{data:e,error:t}=await V.from("prospects").select("id").is("created_at",null);if(t)throw t;if(!e||e.length===0)return{count:0};const r=e.map(l=>l.id),n="2025-12-31T23:59:59.000Z",{error:i}=await V.from("prospects").update({created_at:n,temperature:"acquis"}).in("id",r);if(i)throw i;const a=r.map(l=>({prospect_id:l,action:"acquis",type_action:"acquis",description:"Importation initiale : Client historique (Archives 2025)",created_at:n})),{error:o}=await V.from("prospect_history").insert(a);return o&&console.warn("Erreur mineure : Historique non cr,",o),{count:r.length}}catch(e){throw console.error("Erreur migration:",e),e}}},Kt={async getAll(){try{const{data:e,error:t}=await V.from(ie.ABONNEMENTS).select("*").order("date_fin",{ascending:!0});if(t)throw t;const r=new Date;r.setHours(0,0,0,0);const n=new Date;return n.setDate(n.getDate()+30),n.setHours(0,0,0,0),await Promise.all(e.map(async a=>{const o=new Date(a.date_fin);o.setHours(0,0,0,0);let l=a.statut;o<r?l="expire":o<=n?l="en_alerte":l="actif",a.statut!==l&&await V.from(ie.ABONNEMENTS).update({statut:l}).eq("id",a.id);let c={};if(a.installation_id){const{data:u}=await V.from(ie.INSTALLATIONS).select("*").eq("id",a.installation_id).single();if(u){const{data:d}=await V.from(ie.PROSPECTS).select("raison_sociale, contact, telephone, email").eq("id",u.client_id).single();c={...u,client:d||{}}}}return{...a,statut:l,installation:c}}))}catch(e){throw console.error("Erreur rcupration abonnements:",e),e}},async createFromInstallation(e,t=null){try{const{data:r,error:n}=await V.from(ie.ABONNEMENTS).select("id").eq("installation_id",e).in("statut",["actif","en_alerte"]);if(n)throw n;if(r&&r.length>0)throw new Error("Un abonnement actif ou en alerte existe dj pour cette installation.");const{data:i,error:a}=await V.from(ie.INSTALLATIONS).select("date_installation, montant_abonnement").eq("id",e).single();if(a)throw a;const o=new Date(i.date_installation),l=new Date(o);l.setFullYear(l.getFullYear()+1);const c=new Date;c.setHours(0,0,0,0);const u=new Date(c);u.setDate(u.getDate()+30);let d="actif";l<c?d="expire":l<=u&&(d="en_alerte");const f={installation_id:e,date_debut:o.toISOString().split("T")[0],date_fin:l.toISOString().split("T")[0],statut:d};t?f.montant=parseFloat(t):i.montant_abonnement&&(f.montant=parseFloat(i.montant_abonnement));const{error:h}=await V.from(ie.ABONNEMENTS).insert([f]);if(h)throw h;try{const{data:p}=await V.from(ie.INSTALLATIONS).select("client_id, application_installee, montant, type").eq("id",e).single();if(p){let y=p.montant;if(p.type&&p.type.toLowerCase()==="acquisition")try{const{data:v}=await V.from("applications").select("prix_abonnement, prix").eq("nom",p.application_installee).single();v&&v.prix_abonnement&&(y=v.prix_abonnement,console.log(` Montant abonnement: ${y} DA (prix_abonnement de l'application)`))}catch{console.warn(" Impossible de rcuprer le prix abonnement de l'application")}await mt.addHistorique(p.client_id,"abonnement_acquisition",`Abonnement cr pour ${p.application_installee} (Type: ${p.type||"standard"})`,{installation_id:e,application:p.application_installee,date_debut:o.toISOString().split("T")[0],date_fin:l.toISOString().split("T")[0],montant:y,type:p.type,statut:d}),console.log(` Abonnement enregistr dans l'historique du prospect/client ${p.client_id}`)}}catch(p){console.warn(" Impossible d'enregistrer l'abonnement dans l'historique:",p)}return console.log(` Abonnement cr: Installation ${e}, Statut: ${d}, Fin: ${l.toISOString().split("T")[0]}`),{success:!0,installationId:e,statut:d}}catch(r){throw console.error("Erreur cration abonnement:",r),r}},async create(e){try{const{data:t,error:r}=await V.from(ie.ABONNEMENTS).insert([{installation_id:e.installation_id,date_debut:e.date_debut,date_fin:e.date_fin,statut:e.statut||"actif"}]).select().single();if(r)throw r;return t}catch(t){throw console.error("Erreur cration abonnement:",t),t}},async hasPaiements(e){try{return!1}catch(t){return console.error("Erreur vrification paiements:",t),!1}},async hasActiveAbonnement(e){try{const{data:t,error:r}=await V.from(ie.ABONNEMENTS).select("id",{count:"exact",head:!0}).eq("installation_id",e).in("statut",["actif","en_alerte"]);if(r)throw r;return t&&t.length>0}catch(t){return console.error("Erreur vrification abonnement actif:",t),!1}},async update(e,t){try{if(await this.hasPaiements(e))throw new Error("Impossible de modifier : cet abonnement a des paiements associs");const{data:n,error:i}=await V.from(ie.ABONNEMENTS).update(t).eq("id",e).select().single();if(i)throw i;return n}catch(r){throw console.error("Erreur mise  jour abonnement:",r),r}},async delete(e){try{if(await this.hasPaiements(e))throw new Error("Impossible de supprimer : cet abonnement a des paiements associs");const{error:r}=await V.from(ie.ABONNEMENTS).delete().eq("id",e);if(r)throw r;return!0}catch(t){throw console.error("Erreur suppression abonnement:",t),t}},async renouveler(e){try{const{data:t,error:r}=await V.from(ie.ABONNEMENTS).select("*").eq("id",e).single();if(r)throw r;const{data:n,error:i}=await V.from(ie.ABONNEMENTS).select("id").eq("installation_id",t.installation_id).in("statut",["actif","en_alerte"]).neq("id",e);if(i)throw i;if(n&&n.length>0)throw new Error("Un abonnement actif ou en alerte existe dj pour cette installation. Veuillez supprimer ou modifier l'abonnement existant.");const{error:a}=await V.from(ie.ABONNEMENTS).update({statut:"expire"}).eq("id",e);if(a)throw a;const o=new Date(t.date_fin),l=new Date(o);l.setFullYear(l.getFullYear()+1);const{data:c,error:u}=await V.from(ie.ABONNEMENTS).insert([{installation_id:t.installation_id,date_debut:o.toISOString(),date_fin:l.toISOString(),statut:"actif"}]).select().single();if(u)throw u;return c}catch(t){throw console.error("Erreur renouvellement abonnement:",t),t}},async checkAlertes(){try{const e=new Date;e.setHours(0,0,0,0);const t=new Date;t.setDate(t.getDate()+30),t.setHours(23,59,59,999);const{data:r,error:n}=await V.from(ie.ABONNEMENTS).select("*").in("statut",["actif","en_alerte"]).order("date_fin",{ascending:!0});if(n)throw n;return(await Promise.all(r.map(async a=>{const o=new Date(a.date_fin);o.setHours(0,0,0,0);let l=a.statut;o<e?(l="expire",await V.from(ie.ABONNEMENTS).update({statut:"expire"}).eq("id",a.id)):o<=t?(l="en_alerte",await V.from(ie.ABONNEMENTS).update({statut:"en_alerte"}).eq("id",a.id)):(l="actif",await V.from(ie.ABONNEMENTS).update({statut:"actif"}).eq("id",a.id));let c={};if(a.installation_id){const{data:u}=await V.from(ie.INSTALLATIONS).select("*").eq("id",a.installation_id).single();if(u){const{data:d}=await V.from(ie.PROSPECTS).select("raison_sociale, contact, telephone, email").eq("id",u.client_id).single();c={...u,client:d||{}}}}return{...a,statut:l,installation:c}}))).filter(a=>a.statut==="en_alerte")}catch(e){throw console.error("Erreur vrification alertes:",e),e}},async getStats(){try{const{data:e,error:t}=await V.from(ie.ABONNEMENTS).select("statut");if(t)throw t;return{total:e.length,actifs:e.filter(n=>n.statut==="actif").length,enAlerte:e.filter(n=>n.statut==="en_alerte").length,expires:e.filter(n=>n.statut==="expire").length}}catch(e){throw console.error("Erreur statistiques abonnements:",e),e}}},_M=({onClose:e})=>{const[t,r]=N.useState([]),[n,i]=N.useState(!0),[a,o]=N.useState(null);N.useEffect(()=>{l()},[]);const l=async()=>{try{i(!0);const f=await Kt.checkAlertes();r(f)}catch(f){console.error("Erreur chargement alertes:",f)}finally{i(!1)}},c=async f=>{try{o(f),await Kt.renouveler(f),await l()}catch(h){console.error("Erreur renouvellement:",h),alert("Erreur lors du renouvellement")}finally{o(null)}};if(n)return s.jsx("div",{className:"fixed top-4 right-4 bg-white rounded-xl shadow-2xl p-6 w-96 z-50 border border-gray-200",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-purple-500 mx-auto"}),s.jsx("p",{className:"text-gray-600 mt-3 text-sm",children:"Vrification des abonnements..."})]})});if(t.length===0)return null;const u=t.filter(f=>Ao(f.date_fin)<0),d=t.filter(f=>Ao(f.date_fin)>=0);return s.jsxs("div",{className:"fixed top-4 right-4 bg-white rounded-xl shadow-2xl w-[420px] z-50 max-h-[85vh] overflow-hidden border border-gray-200",children:[s.jsxs("div",{className:"bg-gradient-to-r from-red-500 via-orange-500 to-amber-500 text-white p-5 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center",children:s.jsx(ed,{size:24,className:"animate-pulse"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-lg",children:"Alertes Abonnements"}),s.jsxs("p",{className:"text-sm opacity-90",children:[u.length," expir(s)  ",d.length," proche(s)"]})]})]}),e&&s.jsx("button",{onClick:e,className:"text-white hover:bg-white/20 p-2 rounded-lg transition-all",children:s.jsx(Lr,{size:20})})]}),s.jsxs("div",{className:"overflow-y-auto max-h-[calc(85vh-80px)]",children:[u.length>0&&s.jsxs("div",{className:"p-4 bg-red-50 border-b-2 border-red-200",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(fs,{size:18,className:"text-red-600"}),s.jsxs("h4",{className:"font-bold text-red-800 text-sm uppercase",children:["Expirs (",u.length,")"]})]}),s.jsx("div",{className:"space-y-3",children:u.map(f=>{const h=Math.abs(Ao(f.date_fin));return s.jsx(ub,{alerte:f,isExpired:!0,jours:h,renewing:a,onRenouveler:c},f.id)})})]}),d.length>0&&s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(zs,{size:18,className:"text-orange-600"}),s.jsxs("h4",{className:"font-bold text-orange-800 text-sm uppercase",children:["Expirent bientt (",d.length,")"]})]}),s.jsx("div",{className:"space-y-3",children:d.map(f=>{const h=Ao(f.date_fin);return s.jsx(ub,{alerte:f,isExpired:!1,jours:h,renewing:a,onRenouveler:c},f.id)})})]})]})]})},ub=({alerte:e,isExpired:t,jours:r,renewing:n,onRenouveler:i})=>{var a,o,l,c,u,d,f;return s.jsxs("div",{className:`border-l-4 rounded-lg p-4 transition-all hover:shadow-md ${t?"bg-white border-red-500 shadow-sm":"bg-white border-orange-500 shadow-sm"}`,children:[s.jsxs("div",{className:"mb-3",children:[s.jsx("h5",{className:"font-bold text-gray-800 text-sm mb-1",children:((o=(a=e.installation)==null?void 0:a.client)==null?void 0:o.raison_sociale)||"Client inconnu"}),s.jsx("p",{className:"text-xs text-gray-600 font-medium",children:((l=e.installation)==null?void 0:l.application_installee)||"Application inconnue"})]}),s.jsxs("div",{className:"space-y-2 mb-3",children:[s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsx("span",{className:"text-gray-600",children:"Date d'expiration:"}),s.jsx("span",{className:`font-semibold ${t?"text-red-600":"text-orange-600"}`,children:St(e.date_fin)})]}),s.jsx("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-bold ${t?"bg-red-100 text-red-700":"bg-orange-100 text-orange-700"}`,children:t?s.jsxs(s.Fragment,{children:[s.jsx(fs,{size:12}),"EXPIR depuis ",r," jour",r>1?"s":""]}):s.jsxs(s.Fragment,{children:[s.jsx(zs,{size:12}),r," jour",r>1?"s":""," restant",r>1?"s":""]})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>i(e.id),disabled:n===e.id,className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-xs font-semibold transition-all ${t?"bg-red-600 hover:bg-red-700 text-white disabled:bg-red-400":"bg-orange-600 hover:bg-orange-700 text-white disabled:bg-orange-400"}`,children:n===e.id?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}),"Renouvellement..."]}):s.jsxs(s.Fragment,{children:[s.jsx(hs,{size:14}),"Renouveler"]})}),((u=(c=e.installation)==null?void 0:c.client)==null?void 0:u.telephone)&&s.jsx("a",{href:`tel:${e.installation.client.telephone}`,className:"p-2 bg-green-100 text-green-600 rounded-lg hover:bg-green-200 transition-colors",title:"Appeler le client",children:s.jsx(bu,{size:16})}),((f=(d=e.installation)==null?void 0:d.client)==null?void 0:f.email)&&s.jsx("a",{href:`mailto:${e.installation.client.email}`,className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200 transition-colors",title:"Envoyer un email",children:s.jsx(c0,{size:16})})]})]})},Xh=({title:e,subtitle:t})=>{const{toggleSidebar:r}=cr(),[n,i]=N.useState(!1);return s.jsxs(s.Fragment,{children:[s.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:r,className:"lg:hidden text-gray-600 hover:text-gray-800",children:s.jsx(IE,{size:24})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:e}),t&&s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"hidden md:flex items-center gap-2 bg-gray-100 px-4 py-2 rounded-lg",children:[s.jsx(hf,{size:20,className:"text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher...",className:"bg-transparent outline-none text-sm w-64"})]}),s.jsxs("button",{onClick:()=>i(!n),className:"relative p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[s.jsx(ed,{size:22}),s.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]})]})]})}),n&&s.jsx(_M,{onClose:()=>i(!1)})]})},Yh=()=>{const{notifications:e,removeNotification:t}=cr(),r=a=>{switch(a){case"error":return s.jsx(xt,{className:"w-5 h-5"});case"success":return s.jsx(zt,{className:"w-5 h-5"});case"warning":return s.jsx(fs,{className:"w-5 h-5"});case"info":default:return s.jsx(lM,{className:"w-5 h-5"})}},n=a=>{switch(a){case"error":return"bg-red-50 border-red-200 text-red-800";case"success":return"bg-green-50 border-green-200 text-green-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"info":default:return"bg-blue-50 border-blue-200 text-blue-800"}},i=a=>{switch(a){case"error":return"text-red-500";case"success":return"text-green-500";case"warning":return"text-yellow-500";case"info":default:return"text-blue-500"}};return s.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2 max-w-md",children:e.map(a=>s.jsxs("div",{className:`flex gap-3 p-4 rounded-lg border ${n(a.type)} shadow-lg animate-slideIn`,children:[s.jsx("div",{className:`flex-shrink-0 ${i(a.type)}`,children:r(a.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[a.title&&s.jsx("h3",{className:"font-semibold mb-1",children:a.title}),s.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:a.message})]}),s.jsx("button",{onClick:()=>t(a.id),className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Fermer",children:s.jsx(Lr,{className:"w-5 h-5"})})]},a.id))})};function BE(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=BE(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Re(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=BE(e))&&(n&&(n+=" "),n+=t);return n}var jM=Array.isArray,ur=jM,SM=typeof vc=="object"&&vc&&vc.Object===Object&&vc,FE=SM,NM=FE,EM=typeof self=="object"&&self&&self.Object===Object&&self,AM=NM||EM||Function("return this")(),yn=AM,PM=yn,OM=PM.Symbol,cc=OM,db=cc,qE=Object.prototype,CM=qE.hasOwnProperty,TM=qE.toString,ho=db?db.toStringTag:void 0;function kM(e){var t=CM.call(e,ho),r=e[ho];try{e[ho]=void 0;var n=!0}catch{}var i=TM.call(e);return n&&(t?e[ho]=r:delete e[ho]),i}var $M=kM,IM=Object.prototype,MM=IM.toString;function RM(e){return MM.call(e)}var DM=RM,fb=cc,LM=$M,BM=DM,FM="[object Null]",qM="[object Undefined]",hb=fb?fb.toStringTag:void 0;function UM(e){return e==null?e===void 0?qM:FM:hb&&hb in Object(e)?LM(e):BM(e)}var zn=UM;function zM(e){return e!=null&&typeof e=="object"}var Wn=zM,WM=zn,HM=Wn,VM="[object Symbol]";function GM(e){return typeof e=="symbol"||HM(e)&&WM(e)==VM}var Ws=GM,KM=ur,XM=Ws,YM=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,JM=/^\w*$/;function QM(e,t){if(KM(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||XM(e)?!0:JM.test(e)||!YM.test(e)||t!=null&&e in Object(t)}var f0=QM;function ZM(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Ni=ZM;const Hs=He(Ni);var eR=zn,tR=Ni,rR="[object AsyncFunction]",nR="[object Function]",iR="[object GeneratorFunction]",aR="[object Proxy]";function sR(e){if(!tR(e))return!1;var t=eR(e);return t==nR||t==iR||t==rR||t==aR}var h0=sR;const Oe=He(h0);var oR=yn,lR=oR["__core-js_shared__"],cR=lR,Jh=cR,pb=function(){var e=/[^.]+$/.exec(Jh&&Jh.keys&&Jh.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function uR(e){return!!pb&&pb in e}var dR=uR,fR=Function.prototype,hR=fR.toString;function pR(e){if(e!=null){try{return hR.call(e)}catch{}try{return e+""}catch{}}return""}var UE=pR,mR=h0,gR=dR,yR=Ni,vR=UE,xR=/[\\^$.*+?()[\]{}|]/g,bR=/^\[object .+?Constructor\]$/,wR=Function.prototype,_R=Object.prototype,jR=wR.toString,SR=_R.hasOwnProperty,NR=RegExp("^"+jR.call(SR).replace(xR,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ER(e){if(!yR(e)||gR(e))return!1;var t=mR(e)?NR:bR;return t.test(vR(e))}var AR=ER;function PR(e,t){return e==null?void 0:e[t]}var OR=PR,CR=AR,TR=OR;function kR(e,t){var r=TR(e,t);return CR(r)?r:void 0}var pa=kR,$R=pa,IR=$R(Object,"create"),pf=IR,mb=pf;function MR(){this.__data__=mb?mb(null):{},this.size=0}var RR=MR;function DR(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var LR=DR,BR=pf,FR="__lodash_hash_undefined__",qR=Object.prototype,UR=qR.hasOwnProperty;function zR(e){var t=this.__data__;if(BR){var r=t[e];return r===FR?void 0:r}return UR.call(t,e)?t[e]:void 0}var WR=zR,HR=pf,VR=Object.prototype,GR=VR.hasOwnProperty;function KR(e){var t=this.__data__;return HR?t[e]!==void 0:GR.call(t,e)}var XR=KR,YR=pf,JR="__lodash_hash_undefined__";function QR(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=YR&&t===void 0?JR:t,this}var ZR=QR,e3=RR,t3=LR,r3=WR,n3=XR,i3=ZR;function Vs(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Vs.prototype.clear=e3;Vs.prototype.delete=t3;Vs.prototype.get=r3;Vs.prototype.has=n3;Vs.prototype.set=i3;var a3=Vs;function s3(){this.__data__=[],this.size=0}var o3=s3;function l3(e,t){return e===t||e!==e&&t!==t}var p0=l3,c3=p0;function u3(e,t){for(var r=e.length;r--;)if(c3(e[r][0],t))return r;return-1}var mf=u3,d3=mf,f3=Array.prototype,h3=f3.splice;function p3(e){var t=this.__data__,r=d3(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():h3.call(t,r,1),--this.size,!0}var m3=p3,g3=mf;function y3(e){var t=this.__data__,r=g3(t,e);return r<0?void 0:t[r][1]}var v3=y3,x3=mf;function b3(e){return x3(this.__data__,e)>-1}var w3=b3,_3=mf;function j3(e,t){var r=this.__data__,n=_3(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var S3=j3,N3=o3,E3=m3,A3=v3,P3=w3,O3=S3;function Gs(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gs.prototype.clear=N3;Gs.prototype.delete=E3;Gs.prototype.get=A3;Gs.prototype.has=P3;Gs.prototype.set=O3;var gf=Gs,C3=pa,T3=yn,k3=C3(T3,"Map"),m0=k3,gb=a3,$3=gf,I3=m0;function M3(){this.size=0,this.__data__={hash:new gb,map:new(I3||$3),string:new gb}}var R3=M3;function D3(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var L3=D3,B3=L3;function F3(e,t){var r=e.__data__;return B3(t)?r[typeof t=="string"?"string":"hash"]:r.map}var yf=F3,q3=yf;function U3(e){var t=q3(this,e).delete(e);return this.size-=t?1:0,t}var z3=U3,W3=yf;function H3(e){return W3(this,e).get(e)}var V3=H3,G3=yf;function K3(e){return G3(this,e).has(e)}var X3=K3,Y3=yf;function J3(e,t){var r=Y3(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var Q3=J3,Z3=R3,eD=z3,tD=V3,rD=X3,nD=Q3;function Ks(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ks.prototype.clear=Z3;Ks.prototype.delete=eD;Ks.prototype.get=tD;Ks.prototype.has=rD;Ks.prototype.set=nD;var g0=Ks,zE=g0,iD="Expected a function";function y0(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(iD);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(y0.Cache||zE),r}y0.Cache=zE;var WE=y0;const aD=He(WE);var sD=WE,oD=500;function lD(e){var t=sD(e,function(n){return r.size===oD&&r.clear(),n}),r=t.cache;return t}var cD=lD,uD=cD,dD=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fD=/\\(\\)?/g,hD=uD(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(dD,function(r,n,i,a){t.push(i?a.replace(fD,"$1"):n||r)}),t}),pD=hD;function mD(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var v0=mD,yb=cc,gD=v0,yD=ur,vD=Ws,vb=yb?yb.prototype:void 0,xb=vb?vb.toString:void 0;function HE(e){if(typeof e=="string")return e;if(yD(e))return gD(e,HE)+"";if(vD(e))return xb?xb.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var xD=HE,bD=xD;function wD(e){return e==null?"":bD(e)}var VE=wD,_D=ur,jD=f0,SD=pD,ND=VE;function ED(e,t){return _D(e)?e:jD(e,t)?[e]:SD(ND(e))}var GE=ED,AD=Ws;function PD(e){if(typeof e=="string"||AD(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var vf=PD,OD=GE,CD=vf;function TD(e,t){t=OD(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[CD(t[r++])];return r&&r==n?e:void 0}var x0=TD,kD=x0;function $D(e,t,r){var n=e==null?void 0:kD(e,t);return n===void 0?r:n}var KE=$D;const en=He(KE);function ID(e){return e==null}var MD=ID;const ke=He(MD);var RD=zn,DD=ur,LD=Wn,BD="[object String]";function FD(e){return typeof e=="string"||!DD(e)&&LD(e)&&RD(e)==BD}var qD=FD;const uc=He(qD);var XE={exports:{}},Ue={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b0=Symbol.for("react.element"),w0=Symbol.for("react.portal"),xf=Symbol.for("react.fragment"),bf=Symbol.for("react.strict_mode"),wf=Symbol.for("react.profiler"),_f=Symbol.for("react.provider"),jf=Symbol.for("react.context"),UD=Symbol.for("react.server_context"),Sf=Symbol.for("react.forward_ref"),Nf=Symbol.for("react.suspense"),Ef=Symbol.for("react.suspense_list"),Af=Symbol.for("react.memo"),Pf=Symbol.for("react.lazy"),zD=Symbol.for("react.offscreen"),YE;YE=Symbol.for("react.module.reference");function Fr(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case b0:switch(e=e.type,e){case xf:case wf:case bf:case Nf:case Ef:return e;default:switch(e=e&&e.$$typeof,e){case UD:case jf:case Sf:case Pf:case Af:case _f:return e;default:return t}}case w0:return t}}}Ue.ContextConsumer=jf;Ue.ContextProvider=_f;Ue.Element=b0;Ue.ForwardRef=Sf;Ue.Fragment=xf;Ue.Lazy=Pf;Ue.Memo=Af;Ue.Portal=w0;Ue.Profiler=wf;Ue.StrictMode=bf;Ue.Suspense=Nf;Ue.SuspenseList=Ef;Ue.isAsyncMode=function(){return!1};Ue.isConcurrentMode=function(){return!1};Ue.isContextConsumer=function(e){return Fr(e)===jf};Ue.isContextProvider=function(e){return Fr(e)===_f};Ue.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===b0};Ue.isForwardRef=function(e){return Fr(e)===Sf};Ue.isFragment=function(e){return Fr(e)===xf};Ue.isLazy=function(e){return Fr(e)===Pf};Ue.isMemo=function(e){return Fr(e)===Af};Ue.isPortal=function(e){return Fr(e)===w0};Ue.isProfiler=function(e){return Fr(e)===wf};Ue.isStrictMode=function(e){return Fr(e)===bf};Ue.isSuspense=function(e){return Fr(e)===Nf};Ue.isSuspenseList=function(e){return Fr(e)===Ef};Ue.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===xf||e===wf||e===bf||e===Nf||e===Ef||e===zD||typeof e=="object"&&e!==null&&(e.$$typeof===Pf||e.$$typeof===Af||e.$$typeof===_f||e.$$typeof===jf||e.$$typeof===Sf||e.$$typeof===YE||e.getModuleId!==void 0)};Ue.typeOf=Fr;XE.exports=Ue;var WD=XE.exports,HD=zn,VD=Wn,GD="[object Number]";function KD(e){return typeof e=="number"||VD(e)&&HD(e)==GD}var JE=KD;const XD=He(JE);var YD=JE;function JD(e){return YD(e)&&e!=+e}var QD=JD;const dc=He(QD);var $r=function(t){return t===0?0:t>0?1:-1},Xi=function(t){return uc(t)&&t.indexOf("%")===t.length-1},ce=function(t){return XD(t)&&!dc(t)},At=function(t){return ce(t)||uc(t)},ZD=0,Of=function(t){var r=++ZD;return"".concat(t||"").concat(r)},nr=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ce(t)&&!uc(t))return n;var a;if(Xi(t)){var o=t.indexOf("%");a=r*parseFloat(t.slice(0,o))/100}else a=+t;return dc(a)&&(a=n),i&&a>r&&(a=r),a},Oa=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},e4=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},i=0;i<r;i++)if(!n[t[i]])n[t[i]]=!0;else return!0;return!1},bb=function(t,r){return ce(t)&&ce(r)?function(n){return t+n*(r-t)}:function(){return r}};function Dm(e,t,r){return!e||!e.length?null:e.find(function(n){return n&&(typeof t=="function"?t(n):en(n,t))===r})}function Lm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function Bm(e){"@babel/helpers - typeof";return Bm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bm(e)}var t4=["viewBox","children"],r4=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],wb=["points","pathLength"],Qh={svg:t4,polygon:wb,polyline:wb},_0=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],td=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(N.isValidElement(t)&&(n=t.props),!Hs(n))return null;var i={};return Object.keys(n).forEach(function(a){_0.includes(a)&&(i[a]=r||function(o){return n[a](n,o)})}),i},n4=function(t,r,n){return function(i){return t(r,n,i),null}},Cf=function(t,r,n){if(!Hs(t)||Bm(t)!=="object")return null;var i=null;return Object.keys(t).forEach(function(a){var o=t[a];_0.includes(a)&&typeof o=="function"&&(i||(i={}),i[a]=n4(o,r,n))}),i},i4=["children"],a4=["children"];function _b(e,t){if(e==null)return{};var r=s4(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s4(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var jb={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Tn=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},Sb=null,Zh=null,j0=function e(t){if(t===Sb&&Array.isArray(Zh))return Zh;var r=[];return N.Children.forEach(t,function(n){ke(n)||(WD.isFragment(n)?r=r.concat(e(n.props.children)):r.push(n))}),Zh=r,Sb=t,r};function hn(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(i){return Tn(i)}):n=[Tn(t)],j0(e).forEach(function(i){var a=en(i,"type.displayName")||en(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}function Ar(e,t){var r=hn(e,t);return r&&r[0]}var Nb=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,i=r.height;return!(!ce(n)||n<=0||!ce(i)||i<=0)},o4=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],l4=function(t){return t&&t.type&&uc(t.type)&&o4.indexOf(t.type)>=0},c4=function(t,r,n,i){var a,o=(a=Qh==null?void 0:Qh[i])!==null&&a!==void 0?a:[];return r.startsWith("data-")||!Oe(t)&&(i&&o.includes(r)||r4.includes(r))||n&&_0.includes(r)},Ae=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var i=t;if(N.isValidElement(t)&&(i=t.props),!Hs(i))return null;var a={};return Object.keys(i).forEach(function(o){var l;c4((l=i)===null||l===void 0?void 0:l[o],o,r,n)&&(a[o]=i[o])}),a},Fm=function e(t,r){if(t===r)return!0;var n=N.Children.count(t);if(n!==N.Children.count(r))return!1;if(n===0)return!0;if(n===1)return Eb(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var i=0;i<n;i++){var a=t[i],o=r[i];if(Array.isArray(a)||Array.isArray(o)){if(!e(a,o))return!1}else if(!Eb(a,o))return!1}return!0},Eb=function(t,r){if(ke(t)&&ke(r))return!0;if(!ke(t)&&!ke(r)){var n=t.props||{},i=n.children,a=_b(n,i4),o=r.props||{},l=o.children,c=_b(o,a4);return i&&l?Lm(a,c)&&Fm(i,l):!i&&!l?Lm(a,c):!1}return!1},Ab=function(t,r){var n=[],i={};return j0(t).forEach(function(a,o){if(l4(a))n.push(a);else if(a){var l=Tn(a.type),c=r[l]||{},u=c.handler,d=c.once;if(u&&(!d||!i[l])){var f=u(a,l,o);n.push(f),i[l]=!0}}}),n},u4=function(t){var r=t&&t.type;return r&&jb[r]?jb[r]:null},d4=function(t,r){return j0(r).indexOf(t)},f4=["children","width","height","viewBox","className","style","title","desc"];function qm(){return qm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qm.apply(this,arguments)}function h4(e,t){if(e==null)return{};var r=p4(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function p4(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function Um(e){var t=e.children,r=e.width,n=e.height,i=e.viewBox,a=e.className,o=e.style,l=e.title,c=e.desc,u=h4(e,f4),d=i||{width:r,height:n,x:0,y:0},f=Re("recharts-surface",a);return z.createElement("svg",qm({},Ae(u,!0,"svg"),{className:f,width:r,height:n,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),z.createElement("title",null,l),z.createElement("desc",null,c),t)}var m4=["children","className"];function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zm.apply(this,arguments)}function g4(e,t){if(e==null)return{};var r=y4(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function y4(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var ut=z.forwardRef(function(e,t){var r=e.children,n=e.className,i=g4(e,m4),a=Re("recharts-layer",n);return z.createElement("g",zm({className:a},Ae(i,!0),{ref:t}),r)}),kn=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function v4(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+t];return a}var x4=v4,b4=x4;function w4(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:b4(e,t,r)}var _4=w4,j4="\\ud800-\\udfff",S4="\\u0300-\\u036f",N4="\\ufe20-\\ufe2f",E4="\\u20d0-\\u20ff",A4=S4+N4+E4,P4="\\ufe0e\\ufe0f",O4="\\u200d",C4=RegExp("["+O4+j4+A4+P4+"]");function T4(e){return C4.test(e)}var QE=T4;function k4(e){return e.split("")}var $4=k4,ZE="\\ud800-\\udfff",I4="\\u0300-\\u036f",M4="\\ufe20-\\ufe2f",R4="\\u20d0-\\u20ff",D4=I4+M4+R4,L4="\\ufe0e\\ufe0f",B4="["+ZE+"]",Wm="["+D4+"]",Hm="\\ud83c[\\udffb-\\udfff]",F4="(?:"+Wm+"|"+Hm+")",eA="[^"+ZE+"]",tA="(?:\\ud83c[\\udde6-\\uddff]){2}",rA="[\\ud800-\\udbff][\\udc00-\\udfff]",q4="\\u200d",nA=F4+"?",iA="["+L4+"]?",U4="(?:"+q4+"(?:"+[eA,tA,rA].join("|")+")"+iA+nA+")*",z4=iA+nA+U4,W4="(?:"+[eA+Wm+"?",Wm,tA,rA,B4].join("|")+")",H4=RegExp(Hm+"(?="+Hm+")|"+W4+z4,"g");function V4(e){return e.match(H4)||[]}var G4=V4,K4=$4,X4=QE,Y4=G4;function J4(e){return X4(e)?Y4(e):K4(e)}var Q4=J4,Z4=_4,e5=QE,t5=Q4,r5=VE;function n5(e){return function(t){t=r5(t);var r=e5(t)?t5(t):void 0,n=r?r[0]:t.charAt(0),i=r?Z4(r,1).join(""):t.slice(1);return n[e]()+i}}var i5=n5,a5=i5,s5=a5("toUpperCase"),o5=s5;const Tf=He(o5);function Xe(e){return function(){return e}}const aA=Math.cos,rd=Math.sin,rn=Math.sqrt,nd=Math.PI,kf=2*nd,Vm=Math.PI,Gm=2*Vm,Li=1e-6,l5=Gm-Li;function sA(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function c5(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return sA;const r=10**t;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class u5{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?sA:c5(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,l=this._y1,c=n-t,u=i-r,d=o-t,f=l-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Li)if(!(Math.abs(f*c-u*d)>Li)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,y=i-l,v=c*c+u*u,m=p*p+y*y,x=Math.sqrt(v),b=Math.sqrt(h),g=a*Math.tan((Vm-Math.acos((v+h-m)/(2*x*b)))/2),S=g/b,w=g/x;Math.abs(S-1)>Li&&this._append`L${t+S*d},${r+S*f}`,this._append`A${a},${a},0,0,${+(f*p>d*y)},${this._x1=t+w*c},${this._y1=r+w*u}`}}arc(t,r,n,i,a,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=t+l,d=r+c,f=1^o,h=o?i-a:a-i;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Li||Math.abs(this._y1-d)>Li)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%Gm+Gm),h>l5?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>Li&&this._append`A${n},${n},0,${+(h>=Vm)},${f},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function S0(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new u5(t)}function N0(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function oA(e){this._context=e}oA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function $f(e){return new oA(e)}function lA(e){return e[0]}function cA(e){return e[1]}function uA(e,t){var r=Xe(!0),n=null,i=$f,a=null,o=S0(l);e=typeof e=="function"?e:e===void 0?lA:Xe(e),t=typeof t=="function"?t:t===void 0?cA:Xe(t);function l(c){var u,d=(c=N0(c)).length,f,h=!1,p;for(n==null&&(a=i(p=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(f,u,c),+t(f,u,c));if(p)return a=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Xe(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Xe(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Xe(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(a=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=a=null:a=i(n=c),l):n},l}function Vc(e,t,r){var n=null,i=Xe(!0),a=null,o=$f,l=null,c=S0(u);e=typeof e=="function"?e:e===void 0?lA:Xe(+e),t=typeof t=="function"?t:Xe(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?cA:Xe(+r);function u(f){var h,p,y,v=(f=N0(f)).length,m,x=!1,b,g=new Array(v),S=new Array(v);for(a==null&&(l=o(b=c())),h=0;h<=v;++h){if(!(h<v&&i(m=f[h],h,f))===x)if(x=!x)p=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=h-1;y>=p;--y)l.point(g[y],S[y]);l.lineEnd(),l.areaEnd()}x&&(g[h]=+e(m,h,f),S[h]=+t(m,h,f),l.point(n?+n(m,h,f):g[h],r?+r(m,h,f):S[h]))}if(b)return l=null,b+""||null}function d(){return uA().defined(i).curve(o).context(a)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Xe(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Xe(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Xe(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Xe(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Xe(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Xe(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:Xe(!!f),u):i},u.curve=function(f){return arguments.length?(o=f,a!=null&&(l=o(a)),u):o},u.context=function(f){return arguments.length?(f==null?a=l=null:l=o(a=f),u):a},u}class dA{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function d5(e){return new dA(e,!0)}function f5(e){return new dA(e,!1)}const E0={draw(e,t){const r=rn(t/nd);e.moveTo(r,0),e.arc(0,0,r,0,kf)}},h5={draw(e,t){const r=rn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},fA=rn(1/3),p5=fA*2,m5={draw(e,t){const r=rn(t/p5),n=r*fA;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},g5={draw(e,t){const r=rn(t),n=-r/2;e.rect(n,n,r,r)}},y5=.8908130915292852,hA=rd(nd/10)/rd(7*nd/10),v5=rd(kf/10)*hA,x5=-aA(kf/10)*hA,b5={draw(e,t){const r=rn(t*y5),n=v5*r,i=x5*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){const o=kf*a/5,l=aA(o),c=rd(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*i,c*n+l*i)}e.closePath()}},ep=rn(3),w5={draw(e,t){const r=-rn(t/(ep*3));e.moveTo(0,r*2),e.lineTo(-ep*r,-r),e.lineTo(ep*r,-r),e.closePath()}},Sr=-.5,Nr=rn(3)/2,Km=1/rn(12),_5=(Km/2+1)*3,j5={draw(e,t){const r=rn(t/_5),n=r/2,i=r*Km,a=n,o=r*Km+r,l=-a,c=o;e.moveTo(n,i),e.lineTo(a,o),e.lineTo(l,c),e.lineTo(Sr*n-Nr*i,Nr*n+Sr*i),e.lineTo(Sr*a-Nr*o,Nr*a+Sr*o),e.lineTo(Sr*l-Nr*c,Nr*l+Sr*c),e.lineTo(Sr*n+Nr*i,Sr*i-Nr*n),e.lineTo(Sr*a+Nr*o,Sr*o-Nr*a),e.lineTo(Sr*l+Nr*c,Sr*c-Nr*l),e.closePath()}};function S5(e,t){let r=null,n=S0(i);e=typeof e=="function"?e:Xe(e||E0),t=typeof t=="function"?t:Xe(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:Xe(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:Xe(+a),i):t},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function id(){}function ad(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function pA(e){this._context=e}pA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ad(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ad(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function N5(e){return new pA(e)}function mA(e){this._context=e}mA.prototype={areaStart:id,areaEnd:id,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:ad(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function E5(e){return new mA(e)}function gA(e){this._context=e}gA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ad(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function A5(e){return new gA(e)}function yA(e){this._context=e}yA.prototype={areaStart:id,areaEnd:id,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function P5(e){return new yA(e)}function Pb(e){return e<0?-1:1}function Ob(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),l=(a*i+o*n)/(n+i);return(Pb(a)+Pb(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(l))||0}function Cb(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function tp(e,t,r){var n=e._x0,i=e._y0,a=e._x1,o=e._y1,l=(a-n)/3;e._context.bezierCurveTo(n+l,i+l*t,a-l,o-l*r,a,o)}function sd(e){this._context=e}sd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tp(this,this._t0,Cb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,tp(this,Cb(this,r=Ob(this,e,t)),r);break;default:tp(this,this._t0,r=Ob(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function vA(e){this._context=new xA(e)}(vA.prototype=Object.create(sd.prototype)).point=function(e,t){sd.prototype.point.call(this,t,e)};function xA(e){this._context=e}xA.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function O5(e){return new sd(e)}function C5(e){return new vA(e)}function bA(e){this._context=e}bA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Tb(e),i=Tb(t),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Tb(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function T5(e){return new bA(e)}function If(e,t){this._context=e,this._t=t}If.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function k5(e){return new If(e,.5)}function $5(e){return new If(e,0)}function I5(e){return new If(e,1)}function ps(e,t){if((o=e.length)>1)for(var r=1,n,i,a=e[t[0]],o,l=a.length;r<o;++r)for(i=a,a=e[t[r]],n=0;n<l;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Xm(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function M5(e,t){return e[t]}function R5(e){const t=[];return t.key=e,t}function D5(){var e=Xe([]),t=Xm,r=ps,n=M5;function i(a){var o=Array.from(e.apply(this,arguments),R5),l,c=o.length,u=-1,d;for(const f of a)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,a)]).data=f;for(l=0,d=N0(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Xe(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Xe(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?Xm:typeof a=="function"?a:Xe(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a??ps,i):r},i}function L5(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}ps(e,t)}}function B5(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}ps(e,t)}}function F5(e,t){if(!(!((o=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],f=d[n][1]||0,h=d[n-1][1]||0,p=(f-h)/2,y=0;y<l;++y){var v=e[t[y]],m=v[n][1]||0,x=v[n-1][1]||0;p+=m-x}c+=f,u+=p*f}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,ps(e,t)}}function wl(e){"@babel/helpers - typeof";return wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wl(e)}var q5=["type","size","sizeType"];function Ym(){return Ym=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ym.apply(this,arguments)}function kb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $b(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kb(Object(r),!0).forEach(function(n){U5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U5(e,t,r){return t=z5(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z5(e){var t=W5(e,"string");return wl(t)=="symbol"?t:t+""}function W5(e,t){if(wl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(wl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H5(e,t){if(e==null)return{};var r=V5(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function V5(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var wA={symbolCircle:E0,symbolCross:h5,symbolDiamond:m5,symbolSquare:g5,symbolStar:b5,symbolTriangle:w5,symbolWye:j5},G5=Math.PI/180,K5=function(t){var r="symbol".concat(Tf(t));return wA[r]||E0},X5=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var i=18*G5;return 1.25*t*t*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Y5=function(t,r){wA["symbol".concat(Tf(t))]=r},A0=function(t){var r=t.type,n=r===void 0?"circle":r,i=t.size,a=i===void 0?64:i,o=t.sizeType,l=o===void 0?"area":o,c=H5(t,q5),u=$b($b({},c),{},{type:n,size:a,sizeType:l}),d=function(){var m=K5(n),x=S5().type(m).size(X5(a,l,n));return x()},f=u.className,h=u.cx,p=u.cy,y=Ae(u,!0);return h===+h&&p===+p&&a===+a?z.createElement("path",Ym({},y,{className:Re("recharts-symbols",f),transform:"translate(".concat(h,", ").concat(p,")"),d:d()})):null};A0.registerSymbol=Y5;function ms(e){"@babel/helpers - typeof";return ms=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ms(e)}function Jm(){return Jm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jm.apply(this,arguments)}function Ib(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function J5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ib(Object(r),!0).forEach(function(n){_l(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ib(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q5(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Z5(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jA(n.key),n)}}function eL(e,t,r){return t&&Z5(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tL(e,t,r){return t=od(t),rL(e,_A()?Reflect.construct(t,r||[],od(e).constructor):t.apply(e,r))}function rL(e,t){if(t&&(ms(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nL(e)}function nL(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _A(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_A=function(){return!!e})()}function od(e){return od=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},od(e)}function iL(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qm(e,t)}function Qm(e,t){return Qm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qm(e,t)}function _l(e,t,r){return t=jA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jA(e){var t=aL(e,"string");return ms(t)=="symbol"?t:t+""}function aL(e,t){if(ms(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ms(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Er=32,P0=function(e){function t(){return Q5(this,t),tL(this,t,arguments)}return iL(t,e),eL(t,[{key:"renderIcon",value:function(n){var i=this.props.inactiveColor,a=Er/2,o=Er/6,l=Er/3,c=n.inactive?i:n.color;if(n.type==="plainline")return z.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:a,x2:Er,y2:a,className:"recharts-legend-icon"});if(n.type==="line")return z.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(a,`
            H`).concat(Er,"M").concat(2*l,",").concat(a,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(a),className:"recharts-legend-icon"});if(n.type==="rect")return z.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Er/8,"h").concat(Er,"v").concat(Er*3/4,"h").concat(-Er,"z"),className:"recharts-legend-icon"});if(z.isValidElement(n.legendIcon)){var u=J5({},n);return delete u.legendIcon,z.cloneElement(n.legendIcon,u)}return z.createElement(A0,{fill:c,cx:a,cy:a,size:Er,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,i=this.props,a=i.payload,o=i.iconSize,l=i.layout,c=i.formatter,u=i.inactiveColor,d={x:0,y:0,width:Er,height:Er},f={display:l==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return a.map(function(p,y){var v=p.formatter||c,m=Re(_l(_l({"recharts-legend-item":!0},"legend-item-".concat(y),!0),"inactive",p.inactive));if(p.type==="none")return null;var x=Oe(p.value)?null:p.value;kn(!Oe(p.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var b=p.inactive?u:p.color;return z.createElement("li",Jm({className:m,style:f,key:"legend-item-".concat(y)},Cf(n.props,p,y)),z.createElement(Um,{width:o,height:o,viewBox:d,style:h},n.renderIcon(p)),z.createElement("span",{className:"recharts-legend-item-text",style:{color:b}},v?v(x,p,y):x))})}},{key:"render",value:function(){var n=this.props,i=n.payload,a=n.layout,o=n.align;if(!i||!i.length)return null;var l={padding:0,margin:0,textAlign:a==="horizontal"?o:"left"};return z.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(N.PureComponent);_l(P0,"displayName","Legend");_l(P0,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var sL=gf;function oL(){this.__data__=new sL,this.size=0}var lL=oL;function cL(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var uL=cL;function dL(e){return this.__data__.get(e)}var fL=dL;function hL(e){return this.__data__.has(e)}var pL=hL,mL=gf,gL=m0,yL=g0,vL=200;function xL(e,t){var r=this.__data__;if(r instanceof mL){var n=r.__data__;if(!gL||n.length<vL-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new yL(n)}return r.set(e,t),this.size=r.size,this}var bL=xL,wL=gf,_L=lL,jL=uL,SL=fL,NL=pL,EL=bL;function Xs(e){var t=this.__data__=new wL(e);this.size=t.size}Xs.prototype.clear=_L;Xs.prototype.delete=jL;Xs.prototype.get=SL;Xs.prototype.has=NL;Xs.prototype.set=EL;var SA=Xs,AL="__lodash_hash_undefined__";function PL(e){return this.__data__.set(e,AL),this}var OL=PL;function CL(e){return this.__data__.has(e)}var TL=CL,kL=g0,$L=OL,IL=TL;function ld(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new kL;++t<r;)this.add(e[t])}ld.prototype.add=ld.prototype.push=$L;ld.prototype.has=IL;var NA=ld;function ML(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var EA=ML;function RL(e,t){return e.has(t)}var AA=RL,DL=NA,LL=EA,BL=AA,FL=1,qL=2;function UL(e,t,r,n,i,a){var o=r&FL,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var u=a.get(e),d=a.get(t);if(u&&d)return u==t&&d==e;var f=-1,h=!0,p=r&qL?new DL:void 0;for(a.set(e,t),a.set(t,e);++f<l;){var y=e[f],v=t[f];if(n)var m=o?n(v,y,f,t,e,a):n(y,v,f,e,t,a);if(m!==void 0){if(m)continue;h=!1;break}if(p){if(!LL(t,function(x,b){if(!BL(p,b)&&(y===x||i(y,x,r,n,a)))return p.push(b)})){h=!1;break}}else if(!(y===v||i(y,v,r,n,a))){h=!1;break}}return a.delete(e),a.delete(t),h}var PA=UL,zL=yn,WL=zL.Uint8Array,HL=WL;function VL(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var GL=VL;function KL(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var O0=KL,Mb=cc,Rb=HL,XL=p0,YL=PA,JL=GL,QL=O0,ZL=1,e6=2,t6="[object Boolean]",r6="[object Date]",n6="[object Error]",i6="[object Map]",a6="[object Number]",s6="[object RegExp]",o6="[object Set]",l6="[object String]",c6="[object Symbol]",u6="[object ArrayBuffer]",d6="[object DataView]",Db=Mb?Mb.prototype:void 0,rp=Db?Db.valueOf:void 0;function f6(e,t,r,n,i,a,o){switch(r){case d6:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case u6:return!(e.byteLength!=t.byteLength||!a(new Rb(e),new Rb(t)));case t6:case r6:case a6:return XL(+e,+t);case n6:return e.name==t.name&&e.message==t.message;case s6:case l6:return e==t+"";case i6:var l=JL;case o6:var c=n&ZL;if(l||(l=QL),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;n|=e6,o.set(e,t);var d=YL(l(e),l(t),n,i,a,o);return o.delete(e),d;case c6:if(rp)return rp.call(e)==rp.call(t)}return!1}var h6=f6;function p6(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var OA=p6,m6=OA,g6=ur;function y6(e,t,r){var n=t(e);return g6(e)?n:m6(n,r(e))}var v6=y6;function x6(e,t){for(var r=-1,n=e==null?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}var b6=x6;function w6(){return[]}var _6=w6,j6=b6,S6=_6,N6=Object.prototype,E6=N6.propertyIsEnumerable,Lb=Object.getOwnPropertySymbols,A6=Lb?function(e){return e==null?[]:(e=Object(e),j6(Lb(e),function(t){return E6.call(e,t)}))}:S6,P6=A6;function O6(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var C6=O6,T6=zn,k6=Wn,$6="[object Arguments]";function I6(e){return k6(e)&&T6(e)==$6}var M6=I6,Bb=M6,R6=Wn,CA=Object.prototype,D6=CA.hasOwnProperty,L6=CA.propertyIsEnumerable,B6=Bb(function(){return arguments}())?Bb:function(e){return R6(e)&&D6.call(e,"callee")&&!L6.call(e,"callee")},C0=B6,cd={exports:{}};function F6(){return!1}var q6=F6;cd.exports;(function(e,t){var r=yn,n=q6,i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,o=a&&a.exports===i,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||n;e.exports=u})(cd,cd.exports);var TA=cd.exports,U6=9007199254740991,z6=/^(?:0|[1-9]\d*)$/;function W6(e,t){var r=typeof e;return t=t??U6,!!t&&(r=="number"||r!="symbol"&&z6.test(e))&&e>-1&&e%1==0&&e<t}var T0=W6,H6=9007199254740991;function V6(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=H6}var k0=V6,G6=zn,K6=k0,X6=Wn,Y6="[object Arguments]",J6="[object Array]",Q6="[object Boolean]",Z6="[object Date]",e8="[object Error]",t8="[object Function]",r8="[object Map]",n8="[object Number]",i8="[object Object]",a8="[object RegExp]",s8="[object Set]",o8="[object String]",l8="[object WeakMap]",c8="[object ArrayBuffer]",u8="[object DataView]",d8="[object Float32Array]",f8="[object Float64Array]",h8="[object Int8Array]",p8="[object Int16Array]",m8="[object Int32Array]",g8="[object Uint8Array]",y8="[object Uint8ClampedArray]",v8="[object Uint16Array]",x8="[object Uint32Array]",Ze={};Ze[d8]=Ze[f8]=Ze[h8]=Ze[p8]=Ze[m8]=Ze[g8]=Ze[y8]=Ze[v8]=Ze[x8]=!0;Ze[Y6]=Ze[J6]=Ze[c8]=Ze[Q6]=Ze[u8]=Ze[Z6]=Ze[e8]=Ze[t8]=Ze[r8]=Ze[n8]=Ze[i8]=Ze[a8]=Ze[s8]=Ze[o8]=Ze[l8]=!1;function b8(e){return X6(e)&&K6(e.length)&&!!Ze[G6(e)]}var w8=b8;function _8(e){return function(t){return e(t)}}var kA=_8,ud={exports:{}};ud.exports;(function(e,t){var r=FE,n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,o=a&&r.process,l=function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(ud,ud.exports);var j8=ud.exports,S8=w8,N8=kA,Fb=j8,qb=Fb&&Fb.isTypedArray,E8=qb?N8(qb):S8,$A=E8,A8=C6,P8=C0,O8=ur,C8=TA,T8=T0,k8=$A,$8=Object.prototype,I8=$8.hasOwnProperty;function M8(e,t){var r=O8(e),n=!r&&P8(e),i=!r&&!n&&C8(e),a=!r&&!n&&!i&&k8(e),o=r||n||i||a,l=o?A8(e.length,String):[],c=l.length;for(var u in e)(t||I8.call(e,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||T8(u,c)))&&l.push(u);return l}var R8=M8,D8=Object.prototype;function L8(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||D8;return e===r}var B8=L8;function F8(e,t){return function(r){return e(t(r))}}var IA=F8,q8=IA,U8=q8(Object.keys,Object),z8=U8,W8=B8,H8=z8,V8=Object.prototype,G8=V8.hasOwnProperty;function K8(e){if(!W8(e))return H8(e);var t=[];for(var r in Object(e))G8.call(e,r)&&r!="constructor"&&t.push(r);return t}var X8=K8,Y8=h0,J8=k0;function Q8(e){return e!=null&&J8(e.length)&&!Y8(e)}var Mf=Q8,Z8=R8,eB=X8,tB=Mf;function rB(e){return tB(e)?Z8(e):eB(e)}var $0=rB,nB=v6,iB=P6,aB=$0;function sB(e){return nB(e,aB,iB)}var oB=sB,Ub=oB,lB=1,cB=Object.prototype,uB=cB.hasOwnProperty;function dB(e,t,r,n,i,a){var o=r&lB,l=Ub(e),c=l.length,u=Ub(t),d=u.length;if(c!=d&&!o)return!1;for(var f=c;f--;){var h=l[f];if(!(o?h in t:uB.call(t,h)))return!1}var p=a.get(e),y=a.get(t);if(p&&y)return p==t&&y==e;var v=!0;a.set(e,t),a.set(t,e);for(var m=o;++f<c;){h=l[f];var x=e[h],b=t[h];if(n)var g=o?n(b,x,h,t,e,a):n(x,b,h,e,t,a);if(!(g===void 0?x===b||i(x,b,r,n,a):g)){v=!1;break}m||(m=h=="constructor")}if(v&&!m){var S=e.constructor,w=t.constructor;S!=w&&"constructor"in e&&"constructor"in t&&!(typeof S=="function"&&S instanceof S&&typeof w=="function"&&w instanceof w)&&(v=!1)}return a.delete(e),a.delete(t),v}var fB=dB,hB=pa,pB=yn,mB=hB(pB,"DataView"),gB=mB,yB=pa,vB=yn,xB=yB(vB,"Promise"),bB=xB,wB=pa,_B=yn,jB=wB(_B,"Set"),MA=jB,SB=pa,NB=yn,EB=SB(NB,"WeakMap"),AB=EB,Zm=gB,eg=m0,tg=bB,rg=MA,ng=AB,RA=zn,Ys=UE,zb="[object Map]",PB="[object Object]",Wb="[object Promise]",Hb="[object Set]",Vb="[object WeakMap]",Gb="[object DataView]",OB=Ys(Zm),CB=Ys(eg),TB=Ys(tg),kB=Ys(rg),$B=Ys(ng),Bi=RA;(Zm&&Bi(new Zm(new ArrayBuffer(1)))!=Gb||eg&&Bi(new eg)!=zb||tg&&Bi(tg.resolve())!=Wb||rg&&Bi(new rg)!=Hb||ng&&Bi(new ng)!=Vb)&&(Bi=function(e){var t=RA(e),r=t==PB?e.constructor:void 0,n=r?Ys(r):"";if(n)switch(n){case OB:return Gb;case CB:return zb;case TB:return Wb;case kB:return Hb;case $B:return Vb}return t});var IB=Bi,np=SA,MB=PA,RB=h6,DB=fB,Kb=IB,Xb=ur,Yb=TA,LB=$A,BB=1,Jb="[object Arguments]",Qb="[object Array]",Gc="[object Object]",FB=Object.prototype,Zb=FB.hasOwnProperty;function qB(e,t,r,n,i,a){var o=Xb(e),l=Xb(t),c=o?Qb:Kb(e),u=l?Qb:Kb(t);c=c==Jb?Gc:c,u=u==Jb?Gc:u;var d=c==Gc,f=u==Gc,h=c==u;if(h&&Yb(e)){if(!Yb(t))return!1;o=!0,d=!1}if(h&&!d)return a||(a=new np),o||LB(e)?MB(e,t,r,n,i,a):RB(e,t,c,r,n,i,a);if(!(r&BB)){var p=d&&Zb.call(e,"__wrapped__"),y=f&&Zb.call(t,"__wrapped__");if(p||y){var v=p?e.value():e,m=y?t.value():t;return a||(a=new np),i(v,m,r,n,a)}}return h?(a||(a=new np),DB(e,t,r,n,i,a)):!1}var UB=qB,zB=UB,ew=Wn;function DA(e,t,r,n,i){return e===t?!0:e==null||t==null||!ew(e)&&!ew(t)?e!==e&&t!==t:zB(e,t,r,n,DA,i)}var I0=DA,WB=SA,HB=I0,VB=1,GB=2;function KB(e,t,r,n){var i=r.length,a=i,o=!n;if(e==null)return!a;for(e=Object(e);i--;){var l=r[i];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<a;){l=r[i];var c=l[0],u=e[c],d=l[1];if(o&&l[2]){if(u===void 0&&!(c in e))return!1}else{var f=new WB;if(n)var h=n(u,d,c,e,t,f);if(!(h===void 0?HB(d,u,VB|GB,n,f):h))return!1}}return!0}var XB=KB,YB=Ni;function JB(e){return e===e&&!YB(e)}var LA=JB,QB=LA,ZB=$0;function eF(e){for(var t=ZB(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,QB(i)]}return t}var tF=eF;function rF(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var BA=rF,nF=XB,iF=tF,aF=BA;function sF(e){var t=iF(e);return t.length==1&&t[0][2]?aF(t[0][0],t[0][1]):function(r){return r===e||nF(r,e,t)}}var oF=sF;function lF(e,t){return e!=null&&t in Object(e)}var cF=lF,uF=GE,dF=C0,fF=ur,hF=T0,pF=k0,mF=vf;function gF(e,t,r){t=uF(t,e);for(var n=-1,i=t.length,a=!1;++n<i;){var o=mF(t[n]);if(!(a=e!=null&&r(e,o)))break;e=e[o]}return a||++n!=i?a:(i=e==null?0:e.length,!!i&&pF(i)&&hF(o,i)&&(fF(e)||dF(e)))}var yF=gF,vF=cF,xF=yF;function bF(e,t){return e!=null&&xF(e,t,vF)}var wF=bF,_F=I0,jF=KE,SF=wF,NF=f0,EF=LA,AF=BA,PF=vf,OF=1,CF=2;function TF(e,t){return NF(e)&&EF(t)?AF(PF(e),t):function(r){var n=jF(r,e);return n===void 0&&n===t?SF(r,e):_F(t,n,OF|CF)}}var kF=TF;function $F(e){return e}var Js=$F;function IF(e){return function(t){return t==null?void 0:t[e]}}var MF=IF,RF=x0;function DF(e){return function(t){return RF(t,e)}}var LF=DF,BF=MF,FF=LF,qF=f0,UF=vf;function zF(e){return qF(e)?BF(UF(e)):FF(e)}var WF=zF,HF=oF,VF=kF,GF=Js,KF=ur,XF=WF;function YF(e){return typeof e=="function"?e:e==null?GF:typeof e=="object"?KF(e)?VF(e[0],e[1]):HF(e):XF(e)}var Ei=YF;function JF(e,t,r,n){for(var i=e.length,a=r+(n?1:-1);n?a--:++a<i;)if(t(e[a],a,e))return a;return-1}var QF=JF;function ZF(e){return e!==e}var eq=ZF;function tq(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}var rq=tq,nq=QF,iq=eq,aq=rq;function sq(e,t,r){return t===t?aq(e,t,r):nq(e,iq,r)}var oq=sq,lq=oq;function cq(e,t){var r=e==null?0:e.length;return!!r&&lq(e,t,0)>-1}var uq=cq;function dq(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var fq=dq;function hq(){}var pq=hq,ip=MA,mq=pq,gq=O0,yq=1/0,vq=ip&&1/gq(new ip([,-0]))[1]==yq?function(e){return new ip(e)}:mq,xq=vq,bq=NA,wq=uq,_q=fq,jq=AA,Sq=xq,Nq=O0,Eq=200;function Aq(e,t,r){var n=-1,i=wq,a=e.length,o=!0,l=[],c=l;if(r)o=!1,i=_q;else if(a>=Eq){var u=t?null:Sq(e);if(u)return Nq(u);o=!1,i=jq,c=new bq}else c=t?[]:l;e:for(;++n<a;){var d=e[n],f=t?t(d):d;if(d=r||d!==0?d:0,o&&f===f){for(var h=c.length;h--;)if(c[h]===f)continue e;t&&c.push(f),l.push(d)}else i(c,f,r)||(c!==l&&c.push(f),l.push(d))}return l}var Pq=Aq,Oq=Ei,Cq=Pq;function Tq(e,t){return e&&e.length?Cq(e,Oq(t)):[]}var kq=Tq;const tw=He(kq);function FA(e,t,r){return t===!0?tw(e,r):Oe(t)?tw(e,t):e}function gs(e){"@babel/helpers - typeof";return gs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gs(e)}var $q=["ref"];function rw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rw(Object(r),!0).forEach(function(n){Rf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Iq(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,UA(n.key),n)}}function Mq(e,t,r){return t&&nw(e.prototype,t),r&&nw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rq(e,t,r){return t=dd(t),Dq(e,qA()?Reflect.construct(t,r||[],dd(e).constructor):t.apply(e,r))}function Dq(e,t){if(t&&(gs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lq(e)}function Lq(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function qA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qA=function(){return!!e})()}function dd(e){return dd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},dd(e)}function Bq(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ig(e,t)}function ig(e,t){return ig=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ig(e,t)}function Rf(e,t,r){return t=UA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UA(e){var t=Fq(e,"string");return gs(t)=="symbol"?t:t+""}function Fq(e,t){if(gs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function qq(e,t){if(e==null)return{};var r=Uq(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Uq(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function zq(e){return e.value}function Wq(e,t){if(z.isValidElement(e))return z.cloneElement(e,t);if(typeof e=="function")return z.createElement(e,t);t.ref;var r=qq(t,$q);return z.createElement(P0,r)}var iw=1,ts=function(e){function t(){var r;Iq(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=Rq(this,t,[].concat(i)),Rf(r,"lastBoundingBox",{width:-1,height:-1}),r}return Bq(t,e),Mq(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>iw||Math.abs(i.height-this.lastBoundingBox.height)>iw)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,n&&n(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?xn({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var i=this.props,a=i.layout,o=i.align,l=i.verticalAlign,c=i.margin,u=i.chartWidth,d=i.chartHeight,f,h;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&a==="vertical"){var p=this.getBBoxSnapshot();f={left:((u||0)-p.width)/2}}else f=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var y=this.getBBoxSnapshot();h={top:((d||0)-y.height)/2}}else h=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return xn(xn({},f),h)}},{key:"render",value:function(){var n=this,i=this.props,a=i.content,o=i.width,l=i.height,c=i.wrapperStyle,u=i.payloadUniqBy,d=i.payload,f=xn(xn({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return z.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:function(p){n.wrapperNode=p}},Wq(a,xn(xn({},this.props),{},{payload:FA(d,u,zq)})))}}],[{key:"getWithHeight",value:function(n,i){var a=xn(xn({},this.defaultProps),n.props),o=a.layout;return o==="vertical"&&ce(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||i}:null}}])}(N.PureComponent);Rf(ts,"displayName","Legend");Rf(ts,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var aw=cc,Hq=C0,Vq=ur,sw=aw?aw.isConcatSpreadable:void 0;function Gq(e){return Vq(e)||Hq(e)||!!(sw&&e&&e[sw])}var Kq=Gq,Xq=OA,Yq=Kq;function zA(e,t,r,n,i){var a=-1,o=e.length;for(r||(r=Yq),i||(i=[]);++a<o;){var l=e[a];t>0&&r(l)?t>1?zA(l,t-1,r,n,i):Xq(i,l):n||(i[i.length]=l)}return i}var WA=zA;function Jq(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),l=o.length;l--;){var c=o[e?l:++i];if(r(a[c],c,a)===!1)break}return t}}var Qq=Jq,Zq=Qq,eU=Zq(),tU=eU,rU=tU,nU=$0;function iU(e,t){return e&&rU(e,t,nU)}var HA=iU,aU=Mf;function sU(e,t){return function(r,n){if(r==null)return r;if(!aU(r))return e(r,n);for(var i=r.length,a=t?i:-1,o=Object(r);(t?a--:++a<i)&&n(o[a],a,o)!==!1;);return r}}var oU=sU,lU=HA,cU=oU,uU=cU(lU),M0=uU,dU=M0,fU=Mf;function hU(e,t){var r=-1,n=fU(e)?Array(e.length):[];return dU(e,function(i,a,o){n[++r]=t(i,a,o)}),n}var VA=hU;function pU(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var mU=pU,ow=Ws;function gU(e,t){if(e!==t){var r=e!==void 0,n=e===null,i=e===e,a=ow(e),o=t!==void 0,l=t===null,c=t===t,u=ow(t);if(!l&&!u&&!a&&e>t||a&&o&&c&&!l&&!u||n&&o&&c||!r&&c||!i)return 1;if(!n&&!a&&!u&&e<t||u&&r&&i&&!n&&!a||l&&r&&i||!o&&i||!c)return-1}return 0}var yU=gU,vU=yU;function xU(e,t,r){for(var n=-1,i=e.criteria,a=t.criteria,o=i.length,l=r.length;++n<o;){var c=vU(i[n],a[n]);if(c){if(n>=l)return c;var u=r[n];return c*(u=="desc"?-1:1)}}return e.index-t.index}var bU=xU,ap=v0,wU=x0,_U=Ei,jU=VA,SU=mU,NU=kA,EU=bU,AU=Js,PU=ur;function OU(e,t,r){t.length?t=ap(t,function(a){return PU(a)?function(o){return wU(o,a.length===1?a[0]:a)}:a}):t=[AU];var n=-1;t=ap(t,NU(_U));var i=jU(e,function(a,o,l){var c=ap(t,function(u){return u(a)});return{criteria:c,index:++n,value:a}});return SU(i,function(a,o){return EU(a,o,r)})}var CU=OU;function TU(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var kU=TU,$U=kU,lw=Math.max;function IU(e,t,r){return t=lw(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,a=lw(n.length-t,0),o=Array(a);++i<a;)o[i]=n[t+i];i=-1;for(var l=Array(t+1);++i<t;)l[i]=n[i];return l[t]=r(o),$U(e,this,l)}}var MU=IU;function RU(e){return function(){return e}}var DU=RU,LU=pa,BU=function(){try{var e=LU(Object,"defineProperty");return e({},"",{}),e}catch{}}(),GA=BU,FU=DU,cw=GA,qU=Js,UU=cw?function(e,t){return cw(e,"toString",{configurable:!0,enumerable:!1,value:FU(t),writable:!0})}:qU,zU=UU,WU=800,HU=16,VU=Date.now;function GU(e){var t=0,r=0;return function(){var n=VU(),i=HU-(n-r);if(r=n,i>0){if(++t>=WU)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var KU=GU,XU=zU,YU=KU,JU=YU(XU),QU=JU,ZU=Js,ez=MU,tz=QU;function rz(e,t){return tz(ez(e,t,ZU),e+"")}var nz=rz,iz=p0,az=Mf,sz=T0,oz=Ni;function lz(e,t,r){if(!oz(r))return!1;var n=typeof t;return(n=="number"?az(r)&&sz(t,r.length):n=="string"&&t in r)?iz(r[t],e):!1}var Df=lz,cz=WA,uz=CU,dz=nz,uw=Df,fz=dz(function(e,t){if(e==null)return[];var r=t.length;return r>1&&uw(e,t[0],t[1])?t=[]:r>2&&uw(t[0],t[1],t[2])&&(t=[t[0]]),uz(e,cz(t,1),[])}),hz=fz;const R0=He(hz);function jl(e){"@babel/helpers - typeof";return jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jl(e)}function ag(){return ag=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ag.apply(this,arguments)}function pz(e,t){return vz(e)||yz(e,t)||gz(e,t)||mz()}function mz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gz(e,t){if(e){if(typeof e=="string")return dw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dw(e,t)}}function dw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function yz(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function vz(e){if(Array.isArray(e))return e}function fw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function sp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fw(Object(r),!0).forEach(function(n){xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xz(e,t,r){return t=bz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bz(e){var t=wz(e,"string");return jl(t)=="symbol"?t:t+""}function wz(e,t){if(jl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _z(e){return Array.isArray(e)&&At(e[0])&&At(e[1])?e.join(" ~ "):e}var jz=function(t){var r=t.separator,n=r===void 0?" : ":r,i=t.contentStyle,a=i===void 0?{}:i,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,f=t.formatter,h=t.itemSorter,p=t.wrapperClassName,y=t.labelClassName,v=t.label,m=t.labelFormatter,x=t.accessibilityLayer,b=x===void 0?!1:x,g=function(){if(d&&d.length){var M={padding:0,margin:0},O=(h?R0(d,h):d).map(function(k,F){if(k.type==="none")return null;var I=sp({display:"block",paddingTop:4,paddingBottom:4,color:k.color||"#000"},l),W=k.formatter||f||_z,R=k.value,D=k.name,H=R,Q=D;if(W&&H!=null&&Q!=null){var U=W(R,D,k,F,d);if(Array.isArray(U)){var G=pz(U,2);H=G[0],Q=G[1]}else H=U}return z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(F),style:I},At(Q)?z.createElement("span",{className:"recharts-tooltip-item-name"},Q):null,At(Q)?z.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,z.createElement("span",{className:"recharts-tooltip-item-value"},H),z.createElement("span",{className:"recharts-tooltip-item-unit"},k.unit||""))});return z.createElement("ul",{className:"recharts-tooltip-item-list",style:M},O)}return null},S=sp({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},a),w=sp({margin:0},u),j=!ke(v),_=j?v:"",E=Re("recharts-default-tooltip",p),A=Re("recharts-tooltip-label",y);j&&m&&d!==void 0&&d!==null&&(_=m(v,d));var P=b?{role:"status","aria-live":"assertive"}:{};return z.createElement("div",ag({className:E,style:S},P),z.createElement("p",{className:A,style:w},z.isValidElement(_)?_:"".concat(_)),g())};function Sl(e){"@babel/helpers - typeof";return Sl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sl(e)}function Kc(e,t,r){return t=Sz(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Sz(e){var t=Nz(e,"string");return Sl(t)=="symbol"?t:t+""}function Nz(e,t){if(Sl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var po="recharts-tooltip-wrapper",Ez={visibility:"hidden"};function Az(e){var t=e.coordinate,r=e.translateX,n=e.translateY;return Re(po,Kc(Kc(Kc(Kc({},"".concat(po,"-right"),ce(r)&&t&&ce(t.x)&&r>=t.x),"".concat(po,"-left"),ce(r)&&t&&ce(t.x)&&r<t.x),"".concat(po,"-bottom"),ce(n)&&t&&ce(t.y)&&n>=t.y),"".concat(po,"-top"),ce(n)&&t&&ce(t.y)&&n<t.y))}function hw(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.key,i=e.offsetTopLeft,a=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(a&&ce(a[n]))return a[n];var d=r[n]-l-i,f=r[n]+i;if(t[n])return o[n]?d:f;if(o[n]){var h=d,p=c[n];return h<p?Math.max(f,c[n]):Math.max(d,c[n])}var y=f+l,v=c[n]+u;return y>v?Math.max(d,c[n]):Math.max(f,c[n])}function Pz(e){var t=e.translateX,r=e.translateY,n=e.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Oz(e){var t=e.allowEscapeViewBox,r=e.coordinate,n=e.offsetTopLeft,i=e.position,a=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,u,d,f;return o.height>0&&o.width>0&&r?(d=hw({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=hw({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=Pz({translateX:d,translateY:f,useTranslate3d:l})):u=Ez,{cssProperties:u,cssClasses:Az({translateX:d,translateY:f,coordinate:r})}}function ys(e){"@babel/helpers - typeof";return ys=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ys(e)}function pw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pw(Object(r),!0).forEach(function(n){og(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XA(n.key),n)}}function kz(e,t,r){return t&&Tz(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $z(e,t,r){return t=fd(t),Iz(e,KA()?Reflect.construct(t,r||[],fd(e).constructor):t.apply(e,r))}function Iz(e,t){if(t&&(ys(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Mz(e)}function Mz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(KA=function(){return!!e})()}function fd(e){return fd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fd(e)}function Rz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sg(e,t)}function sg(e,t){return sg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},sg(e,t)}function og(e,t,r){return t=XA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XA(e){var t=Dz(e,"string");return ys(t)=="symbol"?t:t+""}function Dz(e,t){if(ys(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ys(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gw=1,Lz=function(e){function t(){var r;Cz(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return r=$z(this,t,[].concat(i)),og(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),og(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,u,d;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=r.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),r}return Rz(t,e),kz(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>gw||Math.abs(n.height-this.state.lastBoundingBox.height)>gw)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,i=this.props,a=i.active,o=i.allowEscapeViewBox,l=i.animationDuration,c=i.animationEasing,u=i.children,d=i.coordinate,f=i.hasPayload,h=i.isAnimationActive,p=i.offset,y=i.position,v=i.reverseDirection,m=i.useTranslate3d,x=i.viewBox,b=i.wrapperStyle,g=Oz({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:p,position:y,reverseDirection:v,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:x}),S=g.cssClasses,w=g.cssProperties,j=mw(mw({transition:h&&a?"transform ".concat(l,"ms ").concat(c):void 0},w),{},{pointerEvents:"none",visibility:!this.state.dismissed&&a&&f?"visible":"hidden",position:"absolute",top:0,left:0},b);return z.createElement("div",{tabIndex:-1,className:S,style:j,ref:function(E){n.wrapperNode=E}},u)}}])}(N.PureComponent),Bz=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Lf={isSsr:Bz()};function vs(e){"@babel/helpers - typeof";return vs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vs(e)}function yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yw(Object(r),!0).forEach(function(n){D0(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qz(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,JA(n.key),n)}}function Uz(e,t,r){return t&&qz(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function zz(e,t,r){return t=hd(t),Wz(e,YA()?Reflect.construct(t,r||[],hd(e).constructor):t.apply(e,r))}function Wz(e,t){if(t&&(vs(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hz(e)}function Hz(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YA(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YA=function(){return!!e})()}function hd(e){return hd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},hd(e)}function Vz(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lg(e,t)}function lg(e,t){return lg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},lg(e,t)}function D0(e,t,r){return t=JA(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JA(e){var t=Gz(e,"string");return vs(t)=="symbol"?t:t+""}function Gz(e,t){if(vs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Kz(e){return e.dataKey}function Xz(e,t){return z.isValidElement(e)?z.cloneElement(e,t):typeof e=="function"?z.createElement(e,t):z.createElement(jz,t)}var sn=function(e){function t(){return Fz(this,t),zz(this,t,arguments)}return Vz(t,e),Uz(t,[{key:"render",value:function(){var n=this,i=this.props,a=i.active,o=i.allowEscapeViewBox,l=i.animationDuration,c=i.animationEasing,u=i.content,d=i.coordinate,f=i.filterNull,h=i.isAnimationActive,p=i.offset,y=i.payload,v=i.payloadUniqBy,m=i.position,x=i.reverseDirection,b=i.useTranslate3d,g=i.viewBox,S=i.wrapperStyle,w=y??[];f&&w.length&&(w=FA(y.filter(function(_){return _.value!=null&&(_.hide!==!0||n.props.includeHidden)}),v,Kz));var j=w.length>0;return z.createElement(Lz,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:h,active:a,coordinate:d,hasPayload:j,offset:p,position:m,reverseDirection:x,useTranslate3d:b,viewBox:g,wrapperStyle:S},Xz(u,vw(vw({},this.props),{},{payload:w})))}}])}(N.PureComponent);D0(sn,"displayName","Tooltip");D0(sn,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Lf.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Yz=yn,Jz=function(){return Yz.Date.now()},Qz=Jz,Zz=/\s/;function e7(e){for(var t=e.length;t--&&Zz.test(e.charAt(t)););return t}var t7=e7,r7=t7,n7=/^\s+/;function i7(e){return e&&e.slice(0,r7(e)+1).replace(n7,"")}var a7=i7,s7=a7,xw=Ni,o7=Ws,bw=NaN,l7=/^[-+]0x[0-9a-f]+$/i,c7=/^0b[01]+$/i,u7=/^0o[0-7]+$/i,d7=parseInt;function f7(e){if(typeof e=="number")return e;if(o7(e))return bw;if(xw(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=xw(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=s7(e);var r=c7.test(e);return r||u7.test(e)?d7(e.slice(2),r?2:8):l7.test(e)?bw:+e}var QA=f7,h7=Ni,op=Qz,ww=QA,p7="Expected a function",m7=Math.max,g7=Math.min;function y7(e,t,r){var n,i,a,o,l,c,u=0,d=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(p7);t=ww(t)||0,h7(r)&&(d=!!r.leading,f="maxWait"in r,a=f?m7(ww(r.maxWait)||0,t):a,h="trailing"in r?!!r.trailing:h);function p(j){var _=n,E=i;return n=i=void 0,u=j,o=e.apply(E,_),o}function y(j){return u=j,l=setTimeout(x,t),d?p(j):o}function v(j){var _=j-c,E=j-u,A=t-_;return f?g7(A,a-E):A}function m(j){var _=j-c,E=j-u;return c===void 0||_>=t||_<0||f&&E>=a}function x(){var j=op();if(m(j))return b(j);l=setTimeout(x,v(j))}function b(j){return l=void 0,h&&n?p(j):(n=i=void 0,o)}function g(){l!==void 0&&clearTimeout(l),u=0,n=c=i=l=void 0}function S(){return l===void 0?o:b(op())}function w(){var j=op(),_=m(j);if(n=arguments,i=this,c=j,_){if(l===void 0)return y(c);if(f)return clearTimeout(l),l=setTimeout(x,t),p(c)}return l===void 0&&(l=setTimeout(x,t)),o}return w.cancel=g,w.flush=S,w}var v7=y7,x7=v7,b7=Ni,w7="Expected a function";function _7(e,t,r){var n=!0,i=!0;if(typeof e!="function")throw new TypeError(w7);return b7(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),x7(e,t,{leading:n,maxWait:t,trailing:i})}var j7=_7;const ZA=He(j7);function Nl(e){"@babel/helpers - typeof";return Nl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nl(e)}function _w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Xc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_w(Object(r),!0).forEach(function(n){S7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_w(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S7(e,t,r){return t=N7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N7(e){var t=E7(e,"string");return Nl(t)=="symbol"?t:t+""}function E7(e,t){if(Nl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A7(e,t){return T7(e)||C7(e,t)||O7(e,t)||P7()}function P7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function O7(e,t){if(e){if(typeof e=="string")return jw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jw(e,t)}}function jw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function T7(e){if(Array.isArray(e))return e}var k7=N.forwardRef(function(e,t){var r=e.aspect,n=e.initialDimension,i=n===void 0?{width:-1,height:-1}:n,a=e.width,o=a===void 0?"100%":a,l=e.height,c=l===void 0?"100%":l,u=e.minWidth,d=u===void 0?0:u,f=e.minHeight,h=e.maxHeight,p=e.children,y=e.debounce,v=y===void 0?0:y,m=e.id,x=e.className,b=e.onResize,g=e.style,S=g===void 0?{}:g,w=N.useRef(null),j=N.useRef();j.current=b,N.useImperativeHandle(t,function(){return Object.defineProperty(w.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),w.current},configurable:!0})});var _=N.useState({containerWidth:i.width,containerHeight:i.height}),E=A7(_,2),A=E[0],P=E[1],T=N.useCallback(function(O,k){P(function(F){var I=Math.round(O),W=Math.round(k);return F.containerWidth===I&&F.containerHeight===W?F:{containerWidth:I,containerHeight:W}})},[]);N.useEffect(function(){var O=function(D){var H,Q=D[0].contentRect,U=Q.width,G=Q.height;T(U,G),(H=j.current)===null||H===void 0||H.call(j,U,G)};v>0&&(O=ZA(O,v,{trailing:!0,leading:!1}));var k=new ResizeObserver(O),F=w.current.getBoundingClientRect(),I=F.width,W=F.height;return T(I,W),k.observe(w.current),function(){k.disconnect()}},[T,v]);var M=N.useMemo(function(){var O=A.containerWidth,k=A.containerHeight;if(O<0||k<0)return null;kn(Xi(o)||Xi(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),kn(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=Xi(o)?O:o,I=Xi(c)?k:c;r&&r>0&&(F?I=F/r:I&&(F=I*r),h&&I>h&&(I=h)),kn(F>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,I,o,c,d,f,r);var W=!Array.isArray(p)&&Tn(p.type).endsWith("Chart");return z.Children.map(p,function(R){return z.isValidElement(R)?N.cloneElement(R,Xc({width:F,height:I},W?{style:Xc({height:"100%",width:"100%",maxHeight:I,maxWidth:F},R.props.style)}:{})):R})},[r,p,c,h,f,d,A,o]);return z.createElement("div",{id:m?"".concat(m):void 0,className:Re("recharts-responsive-container",x),style:Xc(Xc({},S),{},{width:o,height:c,minWidth:d,minHeight:f,maxHeight:h}),ref:w},M)}),L0=function(t){return null};L0.displayName="Cell";function El(e){"@babel/helpers - typeof";return El=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},El(e)}function Sw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sw(Object(r),!0).forEach(function(n){$7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $7(e,t,r){return t=I7(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I7(e){var t=M7(e,"string");return El(t)=="symbol"?t:t+""}function M7(e,t){if(El(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(El(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Na={widthCache:{},cacheCount:0},R7=2e3,D7={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Nw="recharts_measurement_span";function L7(e){var t=cg({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var Ew=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Lf.isSsr)return{width:0,height:0};var n=L7(r),i=JSON.stringify({text:t,copyStyle:n});if(Na.widthCache[i])return Na.widthCache[i];try{var a=document.getElementById(Nw);a||(a=document.createElement("span"),a.setAttribute("id",Nw),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));var o=cg(cg({},D7),n);Object.assign(a.style,o),a.textContent="".concat(t);var l=a.getBoundingClientRect(),c={width:l.width,height:l.height};return Na.widthCache[i]=c,++Na.cacheCount>R7&&(Na.cacheCount=0,Na.widthCache={}),c}catch{return{width:0,height:0}}},B7=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Al(e){"@babel/helpers - typeof";return Al=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Al(e)}function pd(e,t){return z7(e)||U7(e,t)||q7(e,t)||F7()}function F7(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function q7(e,t){if(e){if(typeof e=="string")return Aw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Aw(e,t)}}function Aw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function U7(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function z7(e){if(Array.isArray(e))return e}function W7(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,V7(n.key),n)}}function H7(e,t,r){return t&&Pw(e.prototype,t),r&&Pw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function V7(e){var t=G7(e,"string");return Al(t)=="symbol"?t:t+""}function G7(e,t){if(Al(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Al(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Ow=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Cw=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,K7=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,X7=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,e2={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Y7=Object.keys(e2),za="NaN";function J7(e,t){return e*e2[t]}var Yc=function(){function e(t,r){W7(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!K7.test(r)&&(this.num=NaN,this.unit=""),Y7.includes(r)&&(this.num=J7(t,r),this.unit="px")}return H7(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,i=(n=X7.exec(r))!==null&&n!==void 0?n:[],a=pd(i,3),o=a[1],l=a[2];return new e(parseFloat(o),l??"")}}])}();function t2(e){if(e.includes(za))return za;for(var t=e;t.includes("*")||t.includes("/");){var r,n=(r=Ow.exec(t))!==null&&r!==void 0?r:[],i=pd(n,4),a=i[1],o=i[2],l=i[3],c=Yc.parse(a??""),u=Yc.parse(l??""),d=o==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return za;t=t.replace(Ow,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,h=(f=Cw.exec(t))!==null&&f!==void 0?f:[],p=pd(h,4),y=p[1],v=p[2],m=p[3],x=Yc.parse(y??""),b=Yc.parse(m??""),g=v==="+"?x.add(b):x.subtract(b);if(g.isNaN())return za;t=t.replace(Cw,g.toString())}return t}var Tw=/\(([^()]*)\)/;function Q7(e){for(var t=e;t.includes("(");){var r=Tw.exec(t),n=pd(r,2),i=n[1];t=t.replace(Tw,t2(i))}return t}function Z7(e){var t=e.replace(/\s+/g,"");return t=Q7(t),t=t2(t),t}function e9(e){try{return Z7(e)}catch{return za}}function lp(e){var t=e9(e.slice(5,-1));return t===za?"":t}var t9=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],r9=["dx","dy","angle","className","breakAll"];function ug(){return ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ug.apply(this,arguments)}function kw(e,t){if(e==null)return{};var r=n9(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function n9(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function $w(e,t){return o9(e)||s9(e,t)||a9(e,t)||i9()}function i9(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a9(e,t){if(e){if(typeof e=="string")return Iw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Iw(e,t)}}function Iw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s9(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function o9(e){if(Array.isArray(e))return e}var r2=/[ \f\n\r\t\v\u2028\u2029]+/,n2=function(t){var r=t.children,n=t.breakAll,i=t.style;try{var a=[];ke(r)||(n?a=r.toString().split(""):a=r.toString().split(r2));var o=a.map(function(c){return{word:c,width:Ew(c,i).width}}),l=n?0:Ew("",i).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},l9=function(t,r,n,i,a){var o=t.maxLines,l=t.children,c=t.style,u=t.breakAll,d=ce(o),f=l,h=function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return F.reduce(function(I,W){var R=W.word,D=W.width,H=I[I.length-1];if(H&&(i==null||a||H.width+D+n<Number(i)))H.words.push(R),H.width+=D+n;else{var Q={words:[R],width:D};I.push(Q)}return I},[])},p=h(r),y=function(F){return F.reduce(function(I,W){return I.width>W.width?I:W})};if(!d)return p;for(var v="",m=function(F){var I=f.slice(0,F),W=n2({breakAll:u,style:c,children:I+v}).wordsWithComputedWidth,R=h(W),D=R.length>o||y(R).width>Number(i);return[D,R]},x=0,b=f.length-1,g=0,S;x<=b&&g<=f.length-1;){var w=Math.floor((x+b)/2),j=w-1,_=m(j),E=$w(_,2),A=E[0],P=E[1],T=m(w),M=$w(T,1),O=M[0];if(!A&&!O&&(x=w+1),A&&O&&(b=w-1),!A&&O){S=P;break}g++}return S||p},Mw=function(t){var r=ke(t)?[]:t.toString().split(r2);return[{words:r}]},c9=function(t){var r=t.width,n=t.scaleToFit,i=t.children,a=t.style,o=t.breakAll,l=t.maxLines;if((r||n)&&!Lf.isSsr){var c,u,d=n2({breakAll:o,children:i,style:a});if(d){var f=d.wordsWithComputedWidth,h=d.spaceWidth;c=f,u=h}else return Mw(i);return l9({breakAll:o,children:i,maxLines:l,style:a},c,u,r,n)}return Mw(i)},Rw="#808080",xs=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,a=i===void 0?0:i,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,f=d===void 0?!1:d,h=t.textAnchor,p=h===void 0?"start":h,y=t.verticalAnchor,v=y===void 0?"end":y,m=t.fill,x=m===void 0?Rw:m,b=kw(t,t9),g=N.useMemo(function(){return c9({breakAll:b.breakAll,children:b.children,maxLines:b.maxLines,scaleToFit:f,style:b.style,width:b.width})},[b.breakAll,b.children,b.maxLines,f,b.style,b.width]),S=b.dx,w=b.dy,j=b.angle,_=b.className,E=b.breakAll,A=kw(b,r9);if(!At(n)||!At(a))return null;var P=n+(ce(S)?S:0),T=a+(ce(w)?w:0),M;switch(v){case"start":M=lp("calc(".concat(u,")"));break;case"middle":M=lp("calc(".concat((g.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:M=lp("calc(".concat(g.length-1," * -").concat(l,")"));break}var O=[];if(f){var k=g[0].width,F=b.width;O.push("scale(".concat((ce(F)?F/k:1)/k,")"))}return j&&O.push("rotate(".concat(j,", ").concat(P,", ").concat(T,")")),O.length&&(A.transform=O.join(" ")),z.createElement("text",ug({},Ae(A,!0),{x:P,y:T,className:Re("recharts-text",_),textAnchor:p,fill:x.includes("url")?Rw:x}),g.map(function(I,W){var R=I.words.join(E?"":" ");return z.createElement("tspan",{x:P,dy:W===0?M:l,key:"".concat(R,"-").concat(W)},R)}))};function gi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function u9(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function B0(e){let t,r,n;e.length!==2?(t=gi,r=(l,c)=>gi(e(l),c),n=(l,c)=>e(l)-c):(t=e===gi||e===u9?e:d9,r=e,n=e);function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=i(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:i,center:o,right:a}}function d9(){return 0}function i2(e){return e===null?NaN:+e}function*f9(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const h9=B0(gi),fc=h9.right;B0(i2).center;class Dw extends Map{constructor(t,r=g9){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(Lw(this,t))}has(t){return super.has(Lw(this,t))}set(t,r){return super.set(p9(this,t),r)}delete(t){return super.delete(m9(this,t))}}function Lw({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function p9({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function m9({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function g9(e){return e!==null&&typeof e=="object"?e.valueOf():e}function y9(e=gi){if(e===gi)return a2;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function a2(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const v9=Math.sqrt(50),x9=Math.sqrt(10),b9=Math.sqrt(2);function md(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=v9?10:a>=x9?5:a>=b9?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?md(e,t,r*2):[l,c,u]}function dg(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,a,o]=n?md(t,e,r):md(e,t,r);if(!(a>=i))return[];const l=a-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(a-u)/-o;else for(let u=0;u<l;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function fg(e,t,r){return t=+t,e=+e,r=+r,md(e,t,r)[2]}function hg(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?fg(t,e,r):fg(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function Bw(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Fw(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function s2(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?a2:y9(i);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+h)),y=Math.min(n,Math.floor(t+(c-u)*f/c+h));s2(e,t,p,y,i)}const a=e[t];let o=r,l=n;for(mo(e,r,t),i(e[n],a)>0&&mo(e,r,n);o<l;){for(mo(e,o,l),++o,--l;i(e[o],a)<0;)++o;for(;i(e[l],a)>0;)--l}i(e[r],a)===0?mo(e,r,l):(++l,mo(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function mo(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function w9(e,t,r){if(e=Float64Array.from(f9(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return Fw(e);if(t>=1)return Bw(e);var n,i=(n-1)*t,a=Math.floor(i),o=Bw(s2(e,a).subarray(0,a+1)),l=Fw(e.subarray(a+1));return o+(l-o)*(i-a)}}function _9(e,t,r=i2){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),l=+r(e[a+1],a+1,e);return o+(l-o)*(i-a)}}function j9(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function qr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Hn(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const pg=Symbol("implicit");function F0(){var e=new Dw,t=[],r=[],n=pg;function i(a){let o=e.get(a);if(o===void 0){if(n!==pg)return n;e.set(a,o=t.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Dw;for(const o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return F0(t,r).unknown(n)},qr.apply(i,arguments),i}function Pl(){var e=F0().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,p=i<n,y=p?i:n,v=p?n:i;a=(v-y)/Math.max(1,h-c+u*2),l&&(a=Math.floor(a)),y+=(v-y-a*(h-c))*d,o=a*(1-c),l&&(y=Math.round(y),o=Math.round(o));var m=j9(h).map(function(x){return y+a*x});return r(p?m.reverse():m)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,f()):[n,i]},e.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return Pl(t(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(d)},qr.apply(f(),arguments)}function o2(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return o2(t())},e}function zo(){return o2(Pl.apply(null,arguments).paddingInner(1))}function q0(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function l2(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function hc(){}var Ol=.7,gd=1/Ol,rs="\\s*([+-]?\\d+)\\s*",Cl="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",pn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",S9=/^#([0-9a-f]{3,8})$/,N9=new RegExp(`^rgb\\(${rs},${rs},${rs}\\)$`),E9=new RegExp(`^rgb\\(${pn},${pn},${pn}\\)$`),A9=new RegExp(`^rgba\\(${rs},${rs},${rs},${Cl}\\)$`),P9=new RegExp(`^rgba\\(${pn},${pn},${pn},${Cl}\\)$`),O9=new RegExp(`^hsl\\(${Cl},${pn},${pn}\\)$`),C9=new RegExp(`^hsla\\(${Cl},${pn},${pn},${Cl}\\)$`),qw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};q0(hc,Tl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Uw,formatHex:Uw,formatHex8:T9,formatHsl:k9,formatRgb:zw,toString:zw});function Uw(){return this.rgb().formatHex()}function T9(){return this.rgb().formatHex8()}function k9(){return c2(this).formatHsl()}function zw(){return this.rgb().formatRgb()}function Tl(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=S9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Ww(t):r===3?new ir(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Jc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Jc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=N9.exec(e))?new ir(t[1],t[2],t[3],1):(t=E9.exec(e))?new ir(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=A9.exec(e))?Jc(t[1],t[2],t[3],t[4]):(t=P9.exec(e))?Jc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=O9.exec(e))?Gw(t[1],t[2]/100,t[3]/100,1):(t=C9.exec(e))?Gw(t[1],t[2]/100,t[3]/100,t[4]):qw.hasOwnProperty(e)?Ww(qw[e]):e==="transparent"?new ir(NaN,NaN,NaN,0):null}function Ww(e){return new ir(e>>16&255,e>>8&255,e&255,1)}function Jc(e,t,r,n){return n<=0&&(e=t=r=NaN),new ir(e,t,r,n)}function $9(e){return e instanceof hc||(e=Tl(e)),e?(e=e.rgb(),new ir(e.r,e.g,e.b,e.opacity)):new ir}function mg(e,t,r,n){return arguments.length===1?$9(e):new ir(e,t,r,n??1)}function ir(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}q0(ir,mg,l2(hc,{brighter(e){return e=e==null?gd:Math.pow(gd,e),new ir(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ol:Math.pow(Ol,e),new ir(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ir(ra(this.r),ra(this.g),ra(this.b),yd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hw,formatHex:Hw,formatHex8:I9,formatRgb:Vw,toString:Vw}));function Hw(){return`#${Yi(this.r)}${Yi(this.g)}${Yi(this.b)}`}function I9(){return`#${Yi(this.r)}${Yi(this.g)}${Yi(this.b)}${Yi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Vw(){const e=yd(this.opacity);return`${e===1?"rgb(":"rgba("}${ra(this.r)}, ${ra(this.g)}, ${ra(this.b)}${e===1?")":`, ${e})`}`}function yd(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ra(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Yi(e){return e=ra(e),(e<16?"0":"")+e.toString(16)}function Gw(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Jr(e,t,r,n)}function c2(e){if(e instanceof Jr)return new Jr(e.h,e.s,e.l,e.opacity);if(e instanceof hc||(e=Tl(e)),!e)return new Jr;if(e instanceof Jr)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,l=a-i,c=(a+i)/2;return l?(t===a?o=(r-n)/l+(r<n)*6:r===a?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?a+i:2-a-i,o*=60):l=c>0&&c<1?0:o,new Jr(o,l,c,e.opacity)}function M9(e,t,r,n){return arguments.length===1?c2(e):new Jr(e,t,r,n??1)}function Jr(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}q0(Jr,M9,l2(hc,{brighter(e){return e=e==null?gd:Math.pow(gd,e),new Jr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ol:Math.pow(Ol,e),new Jr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new ir(cp(e>=240?e-240:e+120,i,n),cp(e,i,n),cp(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Jr(Kw(this.h),Qc(this.s),Qc(this.l),yd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=yd(this.opacity);return`${e===1?"hsl(":"hsla("}${Kw(this.h)}, ${Qc(this.s)*100}%, ${Qc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Kw(e){return e=(e||0)%360,e<0?e+360:e}function Qc(e){return Math.max(0,Math.min(1,e||0))}function cp(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const U0=e=>()=>e;function R9(e,t){return function(r){return e+r*t}}function D9(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function L9(e){return(e=+e)==1?u2:function(t,r){return r-t?D9(t,r,e):U0(isNaN(t)?r:t)}}function u2(e,t){var r=t-e;return r?R9(e,r):U0(isNaN(e)?t:e)}const Xw=function e(t){var r=L9(t);function n(i,a){var o=r((i=mg(i)).r,(a=mg(a)).r),l=r(i.g,a.g),c=r(i.b,a.b),u=u2(i.opacity,a.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function B9(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function F9(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function q9(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=Qs(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(l){for(o=0;o<n;++o)a[o]=i[o](l);return a}}function U9(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function vd(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function z9(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Qs(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var gg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,up=new RegExp(gg.source,"g");function W9(e){return function(){return e}}function H9(e){return function(t){return e(t)+""}}function V9(e,t){var r=gg.lastIndex=up.lastIndex=0,n,i,a,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=gg.exec(e))&&(i=up.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:vd(n,i)})),r=up.lastIndex;return r<t.length&&(a=t.slice(r),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?H9(c[0].x):W9(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function Qs(e,t){var r=typeof t,n;return t==null||r==="boolean"?U0(t):(r==="number"?vd:r==="string"?(n=Tl(t))?(t=n,Xw):V9:t instanceof Tl?Xw:t instanceof Date?U9:F9(t)?B9:Array.isArray(t)?q9:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?z9:vd)(e,t)}function z0(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function G9(e,t){t===void 0&&(t=e,e=Qs);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[l](o-l)}}function K9(e){return function(){return e}}function xd(e){return+e}var Yw=[0,1];function Xt(e){return e}function yg(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:K9(isNaN(t)?NaN:.5)}function X9(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function Y9(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=yg(i,n),a=r(o,a)):(n=yg(n,i),a=r(a,o)),function(l){return a(n(l))}}function J9(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=yg(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(l){var c=fc(e,l,1,n)-1;return a[c](i[c](l))}}function pc(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Bf(){var e=Yw,t=Yw,r=Qs,n,i,a,o=Xt,l,c,u;function d(){var h=Math.min(e.length,t.length);return o!==Xt&&(o=X9(e[0],e[h-1])),l=h>2?J9:Y9,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?a:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(i((u||(u=l(t,e.map(n),vd)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,xd),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=z0,d()},f.clamp=function(h){return arguments.length?(o=h?!0:Xt,d()):o!==Xt},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(a=h,f):a},function(h,p){return n=h,i=p,d()}}function W0(){return Bf()(Xt,Xt)}function Q9(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function bd(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function bs(e){return e=bd(Math.abs(e)),e?e[1]:NaN}function Z9(e,t){return function(r,n){for(var i=r.length,a=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return a.reverse().join(t)}}function eW(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var tW=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kl(e){if(!(t=tW.exec(e)))throw new Error("invalid format: "+e);var t;return new H0({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}kl.prototype=H0.prototype;function H0(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}H0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function rW(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var d2;function nW(e,t){var r=bd(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(d2=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+bd(e,Math.max(0,t+a-1))[0]}function Jw(e,t){var r=bd(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const Qw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Q9,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Jw(e*100,t),r:Jw,s:nW,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Zw(e){return e}var e_=Array.prototype.map,t_=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function iW(e){var t=e.grouping===void 0||e.thousands===void 0?Zw:Z9(e_.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?Zw:eW(e_.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=kl(f);var h=f.fill,p=f.align,y=f.sign,v=f.symbol,m=f.zero,x=f.width,b=f.comma,g=f.precision,S=f.trim,w=f.type;w==="n"?(b=!0,w="g"):Qw[w]||(g===void 0&&(g=12),S=!0,w="g"),(m||h==="0"&&p==="=")&&(m=!0,h="0",p="=");var j=v==="$"?r:v==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",_=v==="$"?n:/[%p]/.test(w)?o:"",E=Qw[w],A=/[defgprs%]/.test(w);g=g===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function P(T){var M=j,O=_,k,F,I;if(w==="c")O=E(T)+O,T="";else{T=+T;var W=T<0||1/T<0;if(T=isNaN(T)?c:E(Math.abs(T),g),S&&(T=rW(T)),W&&+T==0&&y!=="+"&&(W=!1),M=(W?y==="("?y:l:y==="-"||y==="("?"":y)+M,O=(w==="s"?t_[8+d2/3]:"")+O+(W&&y==="("?")":""),A){for(k=-1,F=T.length;++k<F;)if(I=T.charCodeAt(k),48>I||I>57){O=(I===46?i+T.slice(k+1):T.slice(k))+O,T=T.slice(0,k);break}}}b&&!m&&(T=t(T,1/0));var R=M.length+T.length+O.length,D=R<x?new Array(x-R+1).join(h):"";switch(b&&m&&(T=t(D+T,D.length?x-O.length:1/0),D=""),p){case"<":T=M+T+O+D;break;case"=":T=M+D+T+O;break;case"^":T=D.slice(0,R=D.length>>1)+M+T+O+D.slice(R);break;default:T=D+M+T+O;break}return a(T)}return P.toString=function(){return f+""},P}function d(f,h){var p=u((f=kl(f),f.type="f",f)),y=Math.max(-8,Math.min(8,Math.floor(bs(h)/3)))*3,v=Math.pow(10,-y),m=t_[8+y/3];return function(x){return p(v*x)+m}}return{format:u,formatPrefix:d}}var Zc,V0,f2;aW({thousands:",",grouping:[3],currency:["$",""]});function aW(e){return Zc=iW(e),V0=Zc.format,f2=Zc.formatPrefix,Zc}function sW(e){return Math.max(0,-bs(Math.abs(e)))}function oW(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bs(t)/3)))*3-bs(Math.abs(e)))}function lW(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,bs(t)-bs(e))+1}function h2(e,t,r,n){var i=hg(e,t,r),a;switch(n=kl(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=oW(i,o))&&(n.precision=a),f2(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=lW(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=sW(i))&&(n.precision=a-(n.type==="%")*2);break}}return V0(n)}function Ai(e){var t=e.domain;return e.ticks=function(r){var n=t();return dg(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return h2(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],l=n[a],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=i,i=a,a=u);d-- >0;){if(u=fg(o,l,r),u===c)return n[i]=o,n[a]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function wd(){var e=W0();return e.copy=function(){return pc(e,wd())},qr.apply(e,arguments),Ai(e)}function p2(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,xd),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return p2(e).unknown(t)},e=arguments.length?Array.from(e,xd):[0,1],Ai(r)}function m2(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}function r_(e){return Math.log(e)}function n_(e){return Math.exp(e)}function cW(e){return-Math.log(-e)}function uW(e){return-Math.exp(-e)}function dW(e){return isFinite(e)?+("1e"+e):e<0?0:e}function fW(e){return e===10?dW:e===Math.E?Math.exp:t=>Math.pow(e,t)}function hW(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function i_(e){return(t,r)=>-e(-t,r)}function G0(e){const t=e(r_,n_),r=t.domain;let n=10,i,a;function o(){return i=hW(n),a=fW(n),r()[0]<0?(i=i_(i),a=i_(a),e(cW,uW)):e(r_,n_),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=i(u),p=i(d),y,v;const m=l==null?10:+l;let x=[];if(!(n%1)&&p-h<m){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(y=1;y<n;++y)if(v=h<0?y/a(-h):y*a(h),!(v<u)){if(v>d)break;x.push(v)}}else for(;h<=p;++h)for(y=n-1;y>=1;--y)if(v=h>0?y/a(-h):y*a(h),!(v<u)){if(v>d)break;x.push(v)}x.length*2<m&&(x=dg(u,d,m))}else x=dg(h,p,Math.min(p-h,m)).map(a);return f?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=kl(c)).precision==null&&(c.trim=!0),c=V0(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/a(Math.round(i(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(m2(r(),{floor:l=>a(Math.floor(i(l))),ceil:l=>a(Math.ceil(i(l)))})),t}function g2(){const e=G0(Bf()).domain([1,10]);return e.copy=()=>pc(e,g2()).base(e.base()),qr.apply(e,arguments),e}function a_(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function s_(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function K0(e){var t=1,r=e(a_(t),s_(t));return r.constant=function(n){return arguments.length?e(a_(t=+n),s_(t)):t},Ai(r)}function y2(){var e=K0(Bf());return e.copy=function(){return pc(e,y2()).constant(e.constant())},qr.apply(e,arguments)}function o_(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function pW(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function mW(e){return e<0?-e*e:e*e}function X0(e){var t=e(Xt,Xt),r=1;function n(){return r===1?e(Xt,Xt):r===.5?e(pW,mW):e(o_(r),o_(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Ai(t)}function Y0(){var e=X0(Bf());return e.copy=function(){return pc(e,Y0()).exponent(e.exponent())},qr.apply(e,arguments),e}function gW(){return Y0.apply(null,arguments).exponent(.5)}function l_(e){return Math.sign(e)*e*e}function yW(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function v2(){var e=W0(),t=[0,1],r=!1,n;function i(a){var o=yW(e(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return e.invert(l_(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,xd)).map(l_)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return v2(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},qr.apply(i,arguments),Ai(i)}function x2(){var e=[],t=[],r=[],n;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=_9(e,o/l);return a}function a(o){return o==null||isNaN(o=+o)?n:t[fc(r,o)]}return a.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(gi),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return x2().domain(e).range(t).unknown(n)},qr.apply(a,arguments)}function b2(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(c){return c!=null&&c<=c?i[fc(n,c,0,r)]:a}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(a=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return b2().domain([e,t]).range(i).unknown(a)},qr.apply(Ai(o),arguments)}function w2(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[fc(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return w2().domain(e).range(t).unknown(r)},qr.apply(i,arguments)}const dp=new Date,fp=new Date;function Pt(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const o=i(a),l=i.ceil(a);return a-o<l-a?o:l},i.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,l)=>{const c=[];if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<o)||!(l>0))return c;let u;do c.push(u=new Date(+a)),t(a,l),e(a);while(u<a&&a<o);return c},i.filter=a=>Pt(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!a(o););else for(;--l>=0;)for(;t(o,1),!a(o););}),r&&(i.count=(a,o)=>(dp.setTime(+a),fp.setTime(+o),e(dp),e(fp),Math.floor(r(dp,fp))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}const _d=Pt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);_d.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Pt(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):_d);_d.range;const An=1e3,Ir=An*60,Pn=Ir*60,Ln=Pn*24,J0=Ln*7,c_=Ln*30,hp=Ln*365,Ji=Pt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*An)},(e,t)=>(t-e)/An,e=>e.getUTCSeconds());Ji.range;const Q0=Pt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*An)},(e,t)=>{e.setTime(+e+t*Ir)},(e,t)=>(t-e)/Ir,e=>e.getMinutes());Q0.range;const Z0=Pt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ir)},(e,t)=>(t-e)/Ir,e=>e.getUTCMinutes());Z0.range;const ev=Pt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*An-e.getMinutes()*Ir)},(e,t)=>{e.setTime(+e+t*Pn)},(e,t)=>(t-e)/Pn,e=>e.getHours());ev.range;const tv=Pt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Pn)},(e,t)=>(t-e)/Pn,e=>e.getUTCHours());tv.range;const mc=Pt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ir)/Ln,e=>e.getDate()-1);mc.range;const Ff=Pt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ln,e=>e.getUTCDate()-1);Ff.range;const _2=Pt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ln,e=>Math.floor(e/Ln));_2.range;function ma(e){return Pt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ir)/J0)}const qf=ma(0),jd=ma(1),vW=ma(2),xW=ma(3),ws=ma(4),bW=ma(5),wW=ma(6);qf.range;jd.range;vW.range;xW.range;ws.range;bW.range;wW.range;function ga(e){return Pt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/J0)}const Uf=ga(0),Sd=ga(1),_W=ga(2),jW=ga(3),_s=ga(4),SW=ga(5),NW=ga(6);Uf.range;Sd.range;_W.range;jW.range;_s.range;SW.range;NW.range;const rv=Pt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());rv.range;const nv=Pt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());nv.range;const Bn=Pt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Pt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Bn.range;const Fn=Pt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Fn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Pt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Fn.range;function j2(e,t,r,n,i,a){const o=[[Ji,1,An],[Ji,5,5*An],[Ji,15,15*An],[Ji,30,30*An],[a,1,Ir],[a,5,5*Ir],[a,15,15*Ir],[a,30,30*Ir],[i,1,Pn],[i,3,3*Pn],[i,6,6*Pn],[i,12,12*Pn],[n,1,Ln],[n,2,2*Ln],[r,1,J0],[t,1,c_],[t,3,3*c_],[e,1,hp]];function l(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),y=p?p.range(u,+d+1):[];return h?y.reverse():y}function c(u,d,f){const h=Math.abs(d-u)/f,p=B0(([,,m])=>m).right(o,h);if(p===o.length)return e.every(hg(u/hp,d/hp,f));if(p===0)return _d.every(Math.max(hg(u,d,f),1));const[y,v]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return y.every(v)}return[l,c]}const[EW,AW]=j2(Fn,nv,Uf,_2,tv,Z0),[PW,OW]=j2(Bn,rv,qf,mc,ev,Q0);function pp(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function mp(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function go(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function CW(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=yo(i),d=vo(i),f=yo(a),h=vo(a),p=yo(o),y=vo(o),v=yo(l),m=vo(l),x=yo(c),b=vo(c),g={a:W,A:R,b:D,B:H,c:null,d:m_,e:m_,f:ZW,g:cH,G:dH,H:YW,I:JW,j:QW,L:S2,m:eH,M:tH,p:Q,q:U,Q:v_,s:x_,S:rH,u:nH,U:iH,V:aH,w:sH,W:oH,x:null,X:null,y:lH,Y:uH,Z:fH,"%":y_},S={a:G,A:B,b:me,B:ue,c:null,d:g_,e:g_,f:gH,g:EH,G:PH,H:hH,I:pH,j:mH,L:E2,m:yH,M:vH,p:Ne,q:ve,Q:v_,s:x_,S:xH,u:bH,U:wH,V:_H,w:jH,W:SH,x:null,X:null,y:NH,Y:AH,Z:OH,"%":y_},w={a:P,A:T,b:M,B:O,c:k,d:h_,e:h_,f:VW,g:f_,G:d_,H:p_,I:p_,j:UW,L:HW,m:qW,M:zW,p:A,q:FW,Q:KW,s:XW,S:WW,u:MW,U:RW,V:DW,w:IW,W:LW,x:F,X:I,y:f_,Y:d_,Z:BW,"%":GW};g.x=j(r,g),g.X=j(n,g),g.c=j(t,g),S.x=j(r,S),S.X=j(n,S),S.c=j(t,S);function j(Y,Z){return function(te){var L=[],ae=-1,oe=0,le=Y.length,he,Se,$e;for(te instanceof Date||(te=new Date(+te));++ae<le;)Y.charCodeAt(ae)===37&&(L.push(Y.slice(oe,ae)),(Se=u_[he=Y.charAt(++ae)])!=null?he=Y.charAt(++ae):Se=he==="e"?" ":"0",($e=Z[he])&&(he=$e(te,Se)),L.push(he),oe=ae+1);return L.push(Y.slice(oe,ae)),L.join("")}}function _(Y,Z){return function(te){var L=go(1900,void 0,1),ae=E(L,Y,te+="",0),oe,le;if(ae!=te.length)return null;if("Q"in L)return new Date(L.Q);if("s"in L)return new Date(L.s*1e3+("L"in L?L.L:0));if(Z&&!("Z"in L)&&(L.Z=0),"p"in L&&(L.H=L.H%12+L.p*12),L.m===void 0&&(L.m="q"in L?L.q:0),"V"in L){if(L.V<1||L.V>53)return null;"w"in L||(L.w=1),"Z"in L?(oe=mp(go(L.y,0,1)),le=oe.getUTCDay(),oe=le>4||le===0?Sd.ceil(oe):Sd(oe),oe=Ff.offset(oe,(L.V-1)*7),L.y=oe.getUTCFullYear(),L.m=oe.getUTCMonth(),L.d=oe.getUTCDate()+(L.w+6)%7):(oe=pp(go(L.y,0,1)),le=oe.getDay(),oe=le>4||le===0?jd.ceil(oe):jd(oe),oe=mc.offset(oe,(L.V-1)*7),L.y=oe.getFullYear(),L.m=oe.getMonth(),L.d=oe.getDate()+(L.w+6)%7)}else("W"in L||"U"in L)&&("w"in L||(L.w="u"in L?L.u%7:"W"in L?1:0),le="Z"in L?mp(go(L.y,0,1)).getUTCDay():pp(go(L.y,0,1)).getDay(),L.m=0,L.d="W"in L?(L.w+6)%7+L.W*7-(le+5)%7:L.w+L.U*7-(le+6)%7);return"Z"in L?(L.H+=L.Z/100|0,L.M+=L.Z%100,mp(L)):pp(L)}}function E(Y,Z,te,L){for(var ae=0,oe=Z.length,le=te.length,he,Se;ae<oe;){if(L>=le)return-1;if(he=Z.charCodeAt(ae++),he===37){if(he=Z.charAt(ae++),Se=w[he in u_?Z.charAt(ae++):he],!Se||(L=Se(Y,te,L))<0)return-1}else if(he!=te.charCodeAt(L++))return-1}return L}function A(Y,Z,te){var L=u.exec(Z.slice(te));return L?(Y.p=d.get(L[0].toLowerCase()),te+L[0].length):-1}function P(Y,Z,te){var L=p.exec(Z.slice(te));return L?(Y.w=y.get(L[0].toLowerCase()),te+L[0].length):-1}function T(Y,Z,te){var L=f.exec(Z.slice(te));return L?(Y.w=h.get(L[0].toLowerCase()),te+L[0].length):-1}function M(Y,Z,te){var L=x.exec(Z.slice(te));return L?(Y.m=b.get(L[0].toLowerCase()),te+L[0].length):-1}function O(Y,Z,te){var L=v.exec(Z.slice(te));return L?(Y.m=m.get(L[0].toLowerCase()),te+L[0].length):-1}function k(Y,Z,te){return E(Y,t,Z,te)}function F(Y,Z,te){return E(Y,r,Z,te)}function I(Y,Z,te){return E(Y,n,Z,te)}function W(Y){return o[Y.getDay()]}function R(Y){return a[Y.getDay()]}function D(Y){return c[Y.getMonth()]}function H(Y){return l[Y.getMonth()]}function Q(Y){return i[+(Y.getHours()>=12)]}function U(Y){return 1+~~(Y.getMonth()/3)}function G(Y){return o[Y.getUTCDay()]}function B(Y){return a[Y.getUTCDay()]}function me(Y){return c[Y.getUTCMonth()]}function ue(Y){return l[Y.getUTCMonth()]}function Ne(Y){return i[+(Y.getUTCHours()>=12)]}function ve(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var Z=j(Y+="",g);return Z.toString=function(){return Y},Z},parse:function(Y){var Z=_(Y+="",!1);return Z.toString=function(){return Y},Z},utcFormat:function(Y){var Z=j(Y+="",S);return Z.toString=function(){return Y},Z},utcParse:function(Y){var Z=_(Y+="",!0);return Z.toString=function(){return Y},Z}}}var u_={"-":"",_:" ",0:"0"},kt=/^\s*\d+/,TW=/^%/,kW=/[\\^$*+?|[\]().{}]/g;function De(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function $W(e){return e.replace(kW,"\\$&")}function yo(e){return new RegExp("^(?:"+e.map($W).join("|")+")","i")}function vo(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function IW(e,t,r){var n=kt.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function MW(e,t,r){var n=kt.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function RW(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function DW(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function LW(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function d_(e,t,r){var n=kt.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function f_(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function BW(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function FW(e,t,r){var n=kt.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function qW(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function h_(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function UW(e,t,r){var n=kt.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function p_(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function zW(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function WW(e,t,r){var n=kt.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function HW(e,t,r){var n=kt.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function VW(e,t,r){var n=kt.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function GW(e,t,r){var n=TW.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function KW(e,t,r){var n=kt.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function XW(e,t,r){var n=kt.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function m_(e,t){return De(e.getDate(),t,2)}function YW(e,t){return De(e.getHours(),t,2)}function JW(e,t){return De(e.getHours()%12||12,t,2)}function QW(e,t){return De(1+mc.count(Bn(e),e),t,3)}function S2(e,t){return De(e.getMilliseconds(),t,3)}function ZW(e,t){return S2(e,t)+"000"}function eH(e,t){return De(e.getMonth()+1,t,2)}function tH(e,t){return De(e.getMinutes(),t,2)}function rH(e,t){return De(e.getSeconds(),t,2)}function nH(e){var t=e.getDay();return t===0?7:t}function iH(e,t){return De(qf.count(Bn(e)-1,e),t,2)}function N2(e){var t=e.getDay();return t>=4||t===0?ws(e):ws.ceil(e)}function aH(e,t){return e=N2(e),De(ws.count(Bn(e),e)+(Bn(e).getDay()===4),t,2)}function sH(e){return e.getDay()}function oH(e,t){return De(jd.count(Bn(e)-1,e),t,2)}function lH(e,t){return De(e.getFullYear()%100,t,2)}function cH(e,t){return e=N2(e),De(e.getFullYear()%100,t,2)}function uH(e,t){return De(e.getFullYear()%1e4,t,4)}function dH(e,t){var r=e.getDay();return e=r>=4||r===0?ws(e):ws.ceil(e),De(e.getFullYear()%1e4,t,4)}function fH(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+De(t/60|0,"0",2)+De(t%60,"0",2)}function g_(e,t){return De(e.getUTCDate(),t,2)}function hH(e,t){return De(e.getUTCHours(),t,2)}function pH(e,t){return De(e.getUTCHours()%12||12,t,2)}function mH(e,t){return De(1+Ff.count(Fn(e),e),t,3)}function E2(e,t){return De(e.getUTCMilliseconds(),t,3)}function gH(e,t){return E2(e,t)+"000"}function yH(e,t){return De(e.getUTCMonth()+1,t,2)}function vH(e,t){return De(e.getUTCMinutes(),t,2)}function xH(e,t){return De(e.getUTCSeconds(),t,2)}function bH(e){var t=e.getUTCDay();return t===0?7:t}function wH(e,t){return De(Uf.count(Fn(e)-1,e),t,2)}function A2(e){var t=e.getUTCDay();return t>=4||t===0?_s(e):_s.ceil(e)}function _H(e,t){return e=A2(e),De(_s.count(Fn(e),e)+(Fn(e).getUTCDay()===4),t,2)}function jH(e){return e.getUTCDay()}function SH(e,t){return De(Sd.count(Fn(e)-1,e),t,2)}function NH(e,t){return De(e.getUTCFullYear()%100,t,2)}function EH(e,t){return e=A2(e),De(e.getUTCFullYear()%100,t,2)}function AH(e,t){return De(e.getUTCFullYear()%1e4,t,4)}function PH(e,t){var r=e.getUTCDay();return e=r>=4||r===0?_s(e):_s.ceil(e),De(e.getUTCFullYear()%1e4,t,4)}function OH(){return"+0000"}function y_(){return"%"}function v_(e){return+e}function x_(e){return Math.floor(+e/1e3)}var Ea,P2,O2;CH({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function CH(e){return Ea=CW(e),P2=Ea.format,Ea.parse,O2=Ea.utcFormat,Ea.utcParse,Ea}function TH(e){return new Date(e)}function kH(e){return e instanceof Date?+e:+new Date(+e)}function iv(e,t,r,n,i,a,o,l,c,u){var d=W0(),f=d.invert,h=d.domain,p=u(".%L"),y=u(":%S"),v=u("%I:%M"),m=u("%I %p"),x=u("%a %d"),b=u("%b %d"),g=u("%B"),S=u("%Y");function w(j){return(c(j)<j?p:l(j)<j?y:o(j)<j?v:a(j)<j?m:n(j)<j?i(j)<j?x:b:r(j)<j?g:S)(j)}return d.invert=function(j){return new Date(f(j))},d.domain=function(j){return arguments.length?h(Array.from(j,kH)):h().map(TH)},d.ticks=function(j){var _=h();return e(_[0],_[_.length-1],j??10)},d.tickFormat=function(j,_){return _==null?w:u(_)},d.nice=function(j){var _=h();return(!j||typeof j.range!="function")&&(j=t(_[0],_[_.length-1],j??10)),j?h(m2(_,j)):d},d.copy=function(){return pc(d,iv(e,t,r,n,i,a,o,l,c,u))},d}function $H(){return qr.apply(iv(PW,OW,Bn,rv,qf,mc,ev,Q0,Ji,P2).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IH(){return qr.apply(iv(EW,AW,Fn,nv,Uf,Ff,tv,Z0,Ji,O2).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function zf(){var e=0,t=1,r,n,i,a,o=Xt,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(i===0?.5:(f=(a(f)-r)*i,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var p,y;return arguments.length?([p,y]=h,o=f(p,y),u):[o(0),o(1)]}}return u.range=d(Qs),u.rangeRound=d(z0),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return a=f,r=f(e),n=f(t),i=r===n?0:1/(n-r),u}}function Pi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function C2(){var e=Ai(zf()(Xt));return e.copy=function(){return Pi(e,C2())},Hn.apply(e,arguments)}function T2(){var e=G0(zf()).domain([1,10]);return e.copy=function(){return Pi(e,T2()).base(e.base())},Hn.apply(e,arguments)}function k2(){var e=K0(zf());return e.copy=function(){return Pi(e,k2()).constant(e.constant())},Hn.apply(e,arguments)}function av(){var e=X0(zf());return e.copy=function(){return Pi(e,av()).exponent(e.exponent())},Hn.apply(e,arguments)}function MH(){return av.apply(null,arguments).exponent(.5)}function $2(){var e=[],t=Xt;function r(n){if(n!=null&&!isNaN(n=+n))return t((fc(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(gi),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>w9(e,a/n))},r.copy=function(){return $2(t).domain(e)},Hn.apply(r,arguments)}function Wf(){var e=0,t=.5,r=1,n=1,i,a,o,l,c,u=Xt,d,f=!1,h;function p(v){return isNaN(v=+v)?h:(v=.5+((v=+d(v))-a)*(n*v<n*a?l:c),u(f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,i=d(e=+e),a=d(t=+t),o=d(r=+r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(u=v,p):u};function y(v){return function(m){var x,b,g;return arguments.length?([x,b,g]=m,u=G9(v,[x,b,g]),p):[u(0),u(.5),u(1)]}}return p.range=y(Qs),p.rangeRound=y(z0),p.unknown=function(v){return arguments.length?(h=v,p):h},function(v){return d=v,i=v(e),a=v(t),o=v(r),l=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),n=a<i?-1:1,p}}function I2(){var e=Ai(Wf()(Xt));return e.copy=function(){return Pi(e,I2())},Hn.apply(e,arguments)}function M2(){var e=G0(Wf()).domain([.1,1,10]);return e.copy=function(){return Pi(e,M2()).base(e.base())},Hn.apply(e,arguments)}function R2(){var e=K0(Wf());return e.copy=function(){return Pi(e,R2()).constant(e.constant())},Hn.apply(e,arguments)}function sv(){var e=X0(Wf());return e.copy=function(){return Pi(e,sv()).exponent(e.exponent())},Hn.apply(e,arguments)}function RH(){return sv.apply(null,arguments).exponent(.5)}const b_=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Pl,scaleDiverging:I2,scaleDivergingLog:M2,scaleDivergingPow:sv,scaleDivergingSqrt:RH,scaleDivergingSymlog:R2,scaleIdentity:p2,scaleImplicit:pg,scaleLinear:wd,scaleLog:g2,scaleOrdinal:F0,scalePoint:zo,scalePow:Y0,scaleQuantile:x2,scaleQuantize:b2,scaleRadial:v2,scaleSequential:C2,scaleSequentialLog:T2,scaleSequentialPow:av,scaleSequentialQuantile:$2,scaleSequentialSqrt:MH,scaleSequentialSymlog:k2,scaleSqrt:gW,scaleSymlog:y2,scaleThreshold:w2,scaleTime:$H,scaleUtc:IH,tickFormat:h2},Symbol.toStringTag,{value:"Module"}));var DH=Ws;function LH(e,t,r){for(var n=-1,i=e.length;++n<i;){var a=e[n],o=t(a);if(o!=null&&(l===void 0?o===o&&!DH(o):r(o,l)))var l=o,c=a}return c}var Hf=LH;function BH(e,t){return e>t}var D2=BH,FH=Hf,qH=D2,UH=Js;function zH(e){return e&&e.length?FH(e,UH,qH):void 0}var WH=zH;const Vf=He(WH);function HH(e,t){return e<t}var L2=HH,VH=Hf,GH=L2,KH=Js;function XH(e){return e&&e.length?VH(e,KH,GH):void 0}var YH=XH;const Gf=He(YH);var JH=v0,QH=Ei,ZH=VA,eV=ur;function tV(e,t){var r=eV(e)?JH:ZH;return r(e,QH(t))}var rV=tV,nV=WA,iV=rV;function aV(e,t){return nV(iV(e,t),1)}var sV=aV;const oV=He(sV);var lV=I0;function cV(e,t){return lV(e,t)}var uV=cV;const ov=He(uV);var Zs=1e9,dV={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},cv,nt=!0,Br="[DecimalError] ",na=Br+"Invalid argument: ",lv=Br+"Exponent out of range: ",eo=Math.floor,Fi=Math.pow,fV=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,mr,Ot=1e7,et=7,B2=9007199254740991,Nd=eo(B2/et),fe={};fe.absoluteValue=fe.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};fe.comparedTo=fe.cmp=function(e){var t,r,n,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};fe.decimalPlaces=fe.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*et;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};fe.dividedBy=fe.div=function(e){return $n(this,new this.constructor(e))};fe.dividedToIntegerBy=fe.idiv=function(e){var t=this,r=t.constructor;return Ve($n(t,new r(e),0,1),r.precision)};fe.equals=fe.eq=function(e){return!this.cmp(e)};fe.exponent=function(){return bt(this)};fe.greaterThan=fe.gt=function(e){return this.cmp(e)>0};fe.greaterThanOrEqualTo=fe.gte=function(e){return this.cmp(e)>=0};fe.isInteger=fe.isint=function(){return this.e>this.d.length-2};fe.isNegative=fe.isneg=function(){return this.s<0};fe.isPositive=fe.ispos=function(){return this.s>0};fe.isZero=function(){return this.s===0};fe.lessThan=fe.lt=function(e){return this.cmp(e)<0};fe.lessThanOrEqualTo=fe.lte=function(e){return this.cmp(e)<1};fe.logarithm=fe.log=function(e){var t,r=this,n=r.constructor,i=n.precision,a=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(mr))throw Error(Br+"NaN");if(r.s<1)throw Error(Br+(r.s?"NaN":"-Infinity"));return r.eq(mr)?new n(0):(nt=!1,t=$n($l(r,a),$l(e,a),a),nt=!0,Ve(t,i))};fe.minus=fe.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?U2(t,e):F2(t,(e.s=-e.s,e))};fe.modulo=fe.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Br+"NaN");return r.s?(nt=!1,t=$n(r,e,0,1).times(e),nt=!0,r.minus(t)):Ve(new n(r),i)};fe.naturalExponential=fe.exp=function(){return q2(this)};fe.naturalLogarithm=fe.ln=function(){return $l(this)};fe.negated=fe.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};fe.plus=fe.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?F2(t,e):U2(t,(e.s=-e.s,e))};fe.precision=fe.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(na+e);if(t=bt(i)+1,n=i.d.length-1,r=n*et+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};fe.squareRoot=fe.sqrt=function(){var e,t,r,n,i,a,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Br+"NaN")}for(e=bt(l),nt=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=un(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=eo((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(a=n,n=a.plus($n(l,a,o+2)).times(.5),un(a.d).slice(0,o)===(t=un(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(Ve(a,r+1,0),a.times(a).eq(l)){n=a;break}}else if(t!="9999")break;o+=4}return nt=!0,Ve(n,r)};fe.times=fe.mul=function(e){var t,r,n,i,a,o,l,c,u,d=this,f=d.constructor,h=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=p.length,c<u&&(a=h,h=p,p=a,o=c,c=u,u=o),a=[],o=c+u,n=o;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)l=a[i]+p[n]*h[i-n-1]+t,a[i--]=l%Ot|0,t=l/Ot|0;a[i]=(a[i]+t)%Ot|0}for(;!a[--o];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,nt?Ve(e,f.precision):e};fe.toDecimalPlaces=fe.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(gn(e,0,Zs),t===void 0?t=n.rounding:gn(t,0,8),Ve(r,e+bt(r)+1,t))};fe.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=ua(n,!0):(gn(e,0,Zs),t===void 0?t=i.rounding:gn(t,0,8),n=Ve(new i(n),e+1,t),r=ua(n,!0,e+1)),r};fe.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?ua(i):(gn(e,0,Zs),t===void 0?t=a.rounding:gn(t,0,8),n=Ve(new a(i),e+bt(i)+1,t),r=ua(n.abs(),!1,e+bt(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};fe.toInteger=fe.toint=function(){var e=this,t=e.constructor;return Ve(new t(e),bt(e)+1,t.rounding)};fe.toNumber=function(){return+this};fe.toPower=fe.pow=function(e){var t,r,n,i,a,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(mr);if(l=new c(l),!l.s){if(e.s<1)throw Error(Br+"Infinity");return l}if(l.eq(mr))return l;if(n=c.precision,e.eq(mr))return Ve(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,a=l.s,o){if((r=d<0?-d:d)<=B2){for(i=new c(mr),t=Math.ceil(n/et+4),nt=!1;r%2&&(i=i.times(l),__(i.d,t)),r=eo(r/2),r!==0;)l=l.times(l),__(l.d,t);return nt=!0,e.s<0?new c(mr).div(i):Ve(i,n)}}else if(a<0)throw Error(Br+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,nt=!1,i=e.times($l(l,n+u)),nt=!0,i=q2(i),i.s=a,i};fe.toPrecision=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?(r=bt(i),n=ua(i,r<=a.toExpNeg||r>=a.toExpPos)):(gn(e,1,Zs),t===void 0?t=a.rounding:gn(t,0,8),i=Ve(new a(i),e,t),r=bt(i),n=ua(i,e<=r||r<=a.toExpNeg,e)),n};fe.toSignificantDigits=fe.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(gn(e,1,Zs),t===void 0?t=n.rounding:gn(t,0,8)),Ve(new n(r),e,t)};fe.toString=fe.valueOf=fe.val=fe.toJSON=fe[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=bt(e),r=e.constructor;return ua(e,t<=r.toExpNeg||t>=r.toExpPos)};function F2(e,t){var r,n,i,a,o,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),nt?Ve(t,f):t;if(c=e.d,u=t.d,o=e.e,i=t.e,c=c.slice(),a=o-i,a){for(a<0?(n=c,a=-a,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(f/et),l=o>l?o+1:l+1,a>l&&(a=l,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(l=c.length,a=u.length,l-a<0&&(a=l,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/Ot|0,c[a]%=Ot;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=i,nt?Ve(t,f):t}function gn(e,t,r){if(e!==~~e||e<t||e>r)throw Error(na+e)}function un(e){var t,r,n,i=e.length-1,a="",o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)n=e[t]+"",r=et-n.length,r&&(a+=Qn(r)),a+=n;o=e[t],n=o+"",r=et-n.length,r&&(a+=Qn(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}var $n=function(){function e(n,i){var a,o=0,l=n.length;for(n=n.slice();l--;)a=n[l]*i+o,n[l]=a%Ot|0,o=a/Ot|0;return o&&n.unshift(o),n}function t(n,i,a,o){var l,c;if(a!=o)c=a>o?1:-1;else for(l=c=0;l<a;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,a){for(var o=0;a--;)n[a]-=o,o=n[a]<i[a]?1:0,n[a]=o*Ot+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o){var l,c,u,d,f,h,p,y,v,m,x,b,g,S,w,j,_,E,A=n.constructor,P=n.s==i.s?1:-1,T=n.d,M=i.d;if(!n.s)return new A(n);if(!i.s)throw Error(Br+"Division by zero");for(c=n.e-i.e,_=M.length,w=T.length,p=new A(P),y=p.d=[],u=0;M[u]==(T[u]||0);)++u;if(M[u]>(T[u]||0)&&--c,a==null?b=a=A.precision:o?b=a+(bt(n)-bt(i))+1:b=a,b<0)return new A(0);if(b=b/et+2|0,u=0,_==1)for(d=0,M=M[0],b++;(u<w||d)&&b--;u++)g=d*Ot+(T[u]||0),y[u]=g/M|0,d=g%M|0;else{for(d=Ot/(M[0]+1)|0,d>1&&(M=e(M,d),T=e(T,d),_=M.length,w=T.length),S=_,v=T.slice(0,_),m=v.length;m<_;)v[m++]=0;E=M.slice(),E.unshift(0),j=M[0],M[1]>=Ot/2&&++j;do d=0,l=t(M,v,_,m),l<0?(x=v[0],_!=m&&(x=x*Ot+(v[1]||0)),d=x/j|0,d>1?(d>=Ot&&(d=Ot-1),f=e(M,d),h=f.length,m=v.length,l=t(f,v,h,m),l==1&&(d--,r(f,_<h?E:M,h))):(d==0&&(l=d=1),f=M.slice()),h=f.length,h<m&&f.unshift(0),r(v,f,m),l==-1&&(m=v.length,l=t(M,v,_,m),l<1&&(d++,r(v,_<m?E:M,m))),m=v.length):l===0&&(d++,v=[0]),y[u++]=d,l&&v[0]?v[m++]=T[S]||0:(v=[T[S]],m=1);while((S++<w||v[0]!==void 0)&&b--)}return y[0]||y.shift(),p.e=c,Ve(p,o?a+bt(p)+1:a)}}();function q2(e,t){var r,n,i,a,o,l,c=0,u=0,d=e.constructor,f=d.precision;if(bt(e)>16)throw Error(lv+bt(e));if(!e.s)return new d(mr);for(nt=!1,l=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Fi(2,u))/Math.LN10*2+5|0,l+=n,r=i=a=new d(mr),d.precision=l;;){if(i=Ve(i.times(e),l),r=r.times(++c),o=a.plus($n(i,r,l)),un(o.d).slice(0,l)===un(a.d).slice(0,l)){for(;u--;)a=Ve(a.times(a),l);return d.precision=f,t==null?(nt=!0,Ve(a,f)):a}a=o}}function bt(e){for(var t=e.e*et,r=e.d[0];r>=10;r/=10)t++;return t}function gp(e,t,r){if(t>e.LN10.sd())throw nt=!0,r&&(e.precision=r),Error(Br+"LN10 precision limit exceeded");return Ve(new e(e.LN10),t)}function Qn(e){for(var t="";e--;)t+="0";return t}function $l(e,t){var r,n,i,a,o,l,c,u,d,f=1,h=10,p=e,y=p.d,v=p.constructor,m=v.precision;if(p.s<1)throw Error(Br+(p.s?"NaN":"-Infinity"));if(p.eq(mr))return new v(0);if(t==null?(nt=!1,u=m):u=t,p.eq(10))return t==null&&(nt=!0),gp(v,u);if(u+=h,v.precision=u,r=un(y),n=r.charAt(0),a=bt(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=un(p.d),n=r.charAt(0),f++;a=bt(p),n>1?(p=new v("0."+r),a++):p=new v(n+"."+r.slice(1))}else return c=gp(v,u+2,m).times(a+""),p=$l(new v(n+"."+r.slice(1)),u-h).plus(c),v.precision=m,t==null?(nt=!0,Ve(p,m)):p;for(l=o=p=$n(p.minus(mr),p.plus(mr),u),d=Ve(p.times(p),u),i=3;;){if(o=Ve(o.times(d),u),c=l.plus($n(o,new v(i),u)),un(c.d).slice(0,u)===un(l.d).slice(0,u))return l=l.times(2),a!==0&&(l=l.plus(gp(v,u+2,m).times(a+""))),l=$n(l,new v(f),u),v.precision=m,t==null?(nt=!0,Ve(l,m)):l;l=c,i+=2}}function w_(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=eo(r/et),e.d=[],n=(r+1)%et,r<0&&(n+=et),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=et;n<i;)e.d.push(+t.slice(n,n+=et));t=t.slice(n),n=et-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),nt&&(e.e>Nd||e.e<-Nd))throw Error(lv+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ve(e,t,r){var n,i,a,o,l,c,u,d,f=e.d;for(o=1,a=f[0];a>=10;a/=10)o++;if(n=t-o,n<0)n+=et,i=t,u=f[d=0];else{if(d=Math.ceil((n+1)/et),a=f.length,d>=a)return e;for(u=a=f[d],o=1;a>=10;a/=10)o++;n%=et,i=n-et+o}if(r!==void 0&&(a=Fi(10,o-i-1),l=u/a%10|0,c=t<0||f[d+1]!==void 0||u%a,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/Fi(10,o-i):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(a=bt(e),f.length=1,t=t-a-1,f[0]=Fi(10,(et-t%et)%et),e.e=eo(-t/et)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,a=1,d--):(f.length=d+1,a=Fi(10,et-n),f[d]=i>0?(u/Fi(10,o-i)%Fi(10,i)|0)*a:0),c)for(;;)if(d==0){(f[0]+=a)==Ot&&(f[0]=1,++e.e);break}else{if(f[d]+=a,f[d]!=Ot)break;f[d--]=0,a=1}for(n=f.length;f[--n]===0;)f.pop();if(nt&&(e.e>Nd||e.e<-Nd))throw Error(lv+bt(e));return e}function U2(e,t){var r,n,i,a,o,l,c,u,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),nt?Ve(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),i=Math.max(Math.ceil(p/et),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=f.length,d=i<l,d&&(l=i),i=0;i<l;i++)if(c[i]!=f[i]){d=c[i]<f[i];break}o=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,i=f.length-l;i>0;--i)c[l++]=0;for(i=f.length;i>o;){if(c[--i]<f[i]){for(a=i;a&&c[--a]===0;)c[a]=Ot-1;--c[a],c[i]+=Ot}c[i]-=f[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,nt?Ve(t,p):t):new h(0)}function ua(e,t,r){var n,i=bt(e),a=un(e.d),o=a.length;return t?(r&&(n=r-o)>0?a=a.charAt(0)+"."+a.slice(1)+Qn(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+Qn(-i-1)+a,r&&(n=r-o)>0&&(a+=Qn(n))):i>=o?(a+=Qn(i+1-o),r&&(n=r-i-1)>0&&(a=a+"."+Qn(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(a+="."),a+=Qn(n))),e.s<0?"-"+a:a}function __(e,t){if(e.length>t)return e.length=t,!0}function z2(e){var t,r,n;function i(a){var o=this;if(!(o instanceof i))return new i(a);if(o.constructor=i,a instanceof i){o.s=a.s,o.e=a.e,o.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(na+a);if(a>0)o.s=1;else if(a<0)a=-a,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(a===~~a&&a<1e7){o.e=0,o.d=[a];return}return w_(o,a.toString())}else if(typeof a!="string")throw Error(na+a);if(a.charCodeAt(0)===45?(a=a.slice(1),o.s=-1):o.s=1,fV.test(a))w_(o,a);else throw Error(na+a)}if(i.prototype=fe,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=z2,i.config=i.set=hV,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function hV(e){if(!e||typeof e!="object")throw Error(Br+"Object expected");var t,r,n,i=["precision",1,Zs,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(eo(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(na+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(na+r+": "+n);return this}var cv=z2(dV);mr=new cv(1);const We=cv;function pV(e){return vV(e)||yV(e)||gV(e)||mV()}function mV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gV(e,t){if(e){if(typeof e=="string")return vg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vg(e,t)}}function yV(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function vV(e){if(Array.isArray(e))return vg(e)}function vg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var xV=function(t){return t},W2={},H2=function(t){return t===W2},j_=function(t){return function r(){return arguments.length===0||arguments.length===1&&H2(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},bV=function e(t,r){return t===1?r:j_(function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var o=i.filter(function(l){return l!==W2}).length;return o>=t?r.apply(void 0,i):e(t-o,j_(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=i.map(function(f){return H2(f)?c.shift():f});return r.apply(void 0,pV(d).concat(c))}))})},Kf=function(t){return bV(t.length,t)},xg=function(t,r){for(var n=[],i=t;i<r;++i)n[i-t]=i;return n},wV=Kf(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),_V=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return xV;var i=r.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce(function(l,c){return c(l)},a.apply(void 0,arguments))}},bg=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},V2=function(t){var r=null,n=null;return function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return r&&a.every(function(l,c){return l===r[c]})||(r=a,n=t.apply(void 0,a)),n}};function jV(e){var t;return e===0?t=1:t=Math.floor(new We(e).abs().log(10).toNumber())+1,t}function SV(e,t,r){for(var n=new We(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var NV=Kf(function(e,t,r){var n=+e,i=+t;return n+r*(i-n)}),EV=Kf(function(e,t,r){var n=t-+e;return n=n||1/0,(r-e)/n}),AV=Kf(function(e,t,r){var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});const Xf={rangeStep:SV,getDigitCount:jV,interpolateNumber:NV,uninterpolateNumber:EV,uninterpolateTruncation:AV};function wg(e){return CV(e)||OV(e)||G2(e)||PV()}function PV(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OV(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function CV(e){if(Array.isArray(e))return _g(e)}function Il(e,t){return $V(e)||kV(e,t)||G2(e,t)||TV()}function TV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G2(e,t){if(e){if(typeof e=="string")return _g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _g(e,t)}}function _g(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function kV(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],n=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){i=!0,a=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(i)throw a}}return r}}function $V(e){if(Array.isArray(e))return e}function K2(e){var t=Il(e,2),r=t[0],n=t[1],i=r,a=n;return r>n&&(i=n,a=r),[i,a]}function X2(e,t,r){if(e.lte(0))return new We(0);var n=Xf.getDigitCount(e.toNumber()),i=new We(10).pow(n),a=e.div(i),o=n!==1?.05:.1,l=new We(Math.ceil(a.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return t?c:new We(Math.ceil(c))}function IV(e,t,r){var n=1,i=new We(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new We(10).pow(Xf.getDigitCount(e)-1),i=new We(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new We(Math.floor(e)))}else e===0?i=new We(Math.floor((t-1)/2)):r||(i=new We(Math.floor(e)));var o=Math.floor((t-1)/2),l=_V(wV(function(c){return i.add(new We(c-o).mul(n)).toNumber()}),xg);return l(0,t)}function Y2(e,t,r,n){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new We(0),tickMin:new We(0),tickMax:new We(0)};var a=X2(new We(t).sub(e).div(r-1),n,i),o;e<=0&&t>=0?o=new We(0):(o=new We(e).add(t).div(2),o=o.sub(new We(o).mod(a)));var l=Math.ceil(o.sub(e).div(a).toNumber()),c=Math.ceil(new We(t).sub(o).div(a).toNumber()),u=l+c+1;return u>r?Y2(e,t,r,n,i+1):(u<r&&(c=t>0?c+(r-u):c,l=t>0?l:l+(r-u)),{step:a,tickMin:o.sub(new We(l).mul(a)),tickMax:o.add(new We(c).mul(a))})}function MV(e){var t=Il(e,2),r=t[0],n=t[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),l=K2([r,n]),c=Il(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var f=d===1/0?[u].concat(wg(xg(0,i-1).map(function(){return 1/0}))):[].concat(wg(xg(0,i-1).map(function(){return-1/0})),[d]);return r>n?bg(f):f}if(u===d)return IV(u,i,a);var h=Y2(u,d,o,a),p=h.step,y=h.tickMin,v=h.tickMax,m=Xf.rangeStep(y,v.add(new We(.1).mul(p)),p);return r>n?bg(m):m}function RV(e,t){var r=Il(e,2),n=r[0],i=r[1],a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=K2([n,i]),l=Il(o,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[n,i];if(c===u)return[c];var d=Math.max(t,2),f=X2(new We(u).sub(c).div(d-1),a,0),h=[].concat(wg(Xf.rangeStep(new We(c),new We(u).sub(new We(.99).mul(f)),f)),[u]);return n>i?bg(h):h}var DV=V2(MV),LV=V2(RV),BV="Invariant failed";function js(e,t){throw new Error(BV)}var FV=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Ss(e){"@babel/helpers - typeof";return Ss=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ss(e)}function Ed(){return Ed=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ed.apply(this,arguments)}function qV(e,t){return HV(e)||WV(e,t)||zV(e,t)||UV()}function UV(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zV(e,t){if(e){if(typeof e=="string")return S_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S_(e,t)}}function S_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function WV(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function HV(e){if(Array.isArray(e))return e}function VV(e,t){if(e==null)return{};var r=GV(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function GV(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function KV(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function XV(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Z2(n.key),n)}}function YV(e,t,r){return t&&XV(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function JV(e,t,r){return t=Ad(t),QV(e,J2()?Reflect.construct(t,r||[],Ad(e).constructor):t.apply(e,r))}function QV(e,t){if(t&&(Ss(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZV(e)}function ZV(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J2(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(J2=function(){return!!e})()}function Ad(e){return Ad=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ad(e)}function eG(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&jg(e,t)}function jg(e,t){return jg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},jg(e,t)}function Q2(e,t,r){return t=Z2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z2(e){var t=tG(e,"string");return Ss(t)=="symbol"?t:t+""}function tG(e,t){if(Ss(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ss(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var uv=function(e){function t(){return KV(this,t),JV(this,t,arguments)}return eG(t,e),YV(t,[{key:"render",value:function(){var n=this.props,i=n.offset,a=n.layout,o=n.width,l=n.dataKey,c=n.data,u=n.dataPointFormatter,d=n.xAxis,f=n.yAxis,h=VV(n,FV),p=Ae(h,!1);this.props.direction==="x"&&d.type!=="number"&&js();var y=c.map(function(v){var m=u(v,l),x=m.x,b=m.y,g=m.value,S=m.errorVal;if(!S)return null;var w=[],j,_;if(Array.isArray(S)){var E=qV(S,2);j=E[0],_=E[1]}else j=_=S;if(a==="vertical"){var A=d.scale,P=b+i,T=P+o,M=P-o,O=A(g-j),k=A(g+_);w.push({x1:k,y1:T,x2:k,y2:M}),w.push({x1:O,y1:P,x2:k,y2:P}),w.push({x1:O,y1:T,x2:O,y2:M})}else if(a==="horizontal"){var F=f.scale,I=x+i,W=I-o,R=I+o,D=F(g-j),H=F(g+_);w.push({x1:W,y1:H,x2:R,y2:H}),w.push({x1:I,y1:D,x2:I,y2:H}),w.push({x1:W,y1:D,x2:R,y2:D})}return z.createElement(ut,Ed({className:"recharts-errorBar",key:"bar-".concat(w.map(function(Q){return"".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))},p),w.map(function(Q){return z.createElement("line",Ed({},Q,{key:"line-".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))}))});return z.createElement(ut,{className:"recharts-errorBars"},y)}}])}(z.Component);Q2(uv,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});Q2(uv,"displayName","ErrorBar");function Ml(e){"@babel/helpers - typeof";return Ml=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ml(e)}function N_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N_(Object(r),!0).forEach(function(n){rG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rG(e,t,r){return t=nG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nG(e){var t=iG(e,"string");return Ml(t)=="symbol"?t:t+""}function iG(e,t){if(Ml(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ml(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eP=function(t){var r=t.children,n=t.formattedGraphicalItems,i=t.legendWidth,a=t.legendContent,o=Ar(r,ts);if(!o)return null;var l=ts.defaultProps,c=l!==void 0?ki(ki({},l),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:a==="children"?u=(n||[]).reduce(function(d,f){var h=f.item,p=f.props,y=p.sectors||p.data||[];return d.concat(y.map(function(v){return{type:o.props.iconType||h.props.legendType,value:v.name,color:v.fill,payload:v}}))},[]):u=(n||[]).map(function(d){var f=d.item,h=f.type.defaultProps,p=h!==void 0?ki(ki({},h),f.props):{},y=p.dataKey,v=p.name,m=p.legendType,x=p.hide;return{inactive:x,dataKey:y,type:c.iconType||m||"square",color:dv(f),value:v||y,payload:p}}),ki(ki(ki({},c),ts.getWithHeight(o,i)),{},{payload:u,item:o})};function Rl(e){"@babel/helpers - typeof";return Rl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rl(e)}function E_(e){return lG(e)||oG(e)||sG(e)||aG()}function aG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sG(e,t){if(e){if(typeof e=="string")return Sg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Sg(e,t)}}function oG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lG(e){if(Array.isArray(e))return Sg(e)}function Sg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function A_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A_(Object(r),!0).forEach(function(n){ns(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ns(e,t,r){return t=cG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cG(e){var t=uG(e,"string");return Rl(t)=="symbol"?t:t+""}function uG(e,t){if(Rl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Rl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gr(e,t,r){return ke(e)||ke(t)?r:At(t)?en(e,t,r):Oe(t)?t(e):r}function Wo(e,t,r,n){var i=oV(e,function(l){return gr(l,t)});if(r==="number"){var a=i.filter(function(l){return ce(l)||parseFloat(l)});return a.length?[Gf(a),Vf(a)]:[1/0,-1/0]}var o=n?i.filter(function(l){return!ke(l)}):i;return o.map(function(l){return At(l)||l instanceof Date?l:""})}var dG=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(a&&a.axisType==="angleAxis"&&Math.abs(Math.abs(a.range[1]-a.range[0])-360)<=1e-6)for(var c=a.range,u=0;u<l;u++){var d=u>0?i[u-1].coordinate:i[l-1].coordinate,f=i[u].coordinate,h=u>=l-1?i[0].coordinate:i[u+1].coordinate,p=void 0;if($r(f-d)!==$r(h-f)){var y=[];if($r(h-f)===$r(c[1]-c[0])){p=h;var v=f+c[1]-c[0];y[0]=Math.min(v,(v+d)/2),y[1]=Math.max(v,(v+d)/2)}else{p=d;var m=h+c[1]-c[0];y[0]=Math.min(f,(m+f)/2),y[1]=Math.max(f,(m+f)/2)}var x=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(t>x[0]&&t<=x[1]||t>=y[0]&&t<=y[1]){o=i[u].index;break}}else{var b=Math.min(d,h),g=Math.max(d,h);if(t>(b+f)/2&&t<=(g+f)/2){o=i[u].index;break}}}else for(var S=0;S<l;S++)if(S===0&&t<=(n[S].coordinate+n[S+1].coordinate)/2||S>0&&S<l-1&&t>(n[S].coordinate+n[S-1].coordinate)/2&&t<=(n[S].coordinate+n[S+1].coordinate)/2||S===l-1&&t>(n[S].coordinate+n[S-1].coordinate)/2){o=n[S].index;break}return o},dv=function(t){var r,n=t,i=n.type.displayName,a=(r=t.type)!==null&&r!==void 0&&r.defaultProps?ct(ct({},t.type.defaultProps),t.props):t.props,o=a.stroke,l=a.fill,c;switch(i){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},fG=function(t){var r=t.barSize,n=t.totalSize,i=t.stackGroups,a=i===void 0?{}:i;if(!a)return{};for(var o={},l=Object.keys(a),c=0,u=l.length;c<u;c++)for(var d=a[l[c]].stackGroups,f=Object.keys(d),h=0,p=f.length;h<p;h++){var y=d[f[h]],v=y.items,m=y.cateAxisId,x=v.filter(function(_){return Tn(_.type).indexOf("Bar")>=0});if(x&&x.length){var b=x[0].type.defaultProps,g=b!==void 0?ct(ct({},b),x[0].props):x[0].props,S=g.barSize,w=g[m];o[w]||(o[w]=[]);var j=ke(S)?r:S;o[w].push({item:x[0],stackList:x.slice(1),barSize:ke(j)?void 0:nr(j,n,0)})}}return o},hG=function(t){var r=t.barGap,n=t.barCategoryGap,i=t.bandSize,a=t.sizeList,o=a===void 0?[]:a,l=t.maxBarSize,c=o.length;if(c<1)return null;var u=nr(r,i,0,!0),d,f=[];if(o[0].barSize===+o[0].barSize){var h=!1,p=i/c,y=o.reduce(function(S,w){return S+w.barSize||0},0);y+=(c-1)*u,y>=i&&(y-=(c-1)*u,u=0),y>=i&&p>0&&(h=!0,p*=.9,y=c*p);var v=(i-y)/2>>0,m={offset:v-u,size:0};d=o.reduce(function(S,w){var j={item:w.item,position:{offset:m.offset+m.size+u,size:h?p:w.barSize}},_=[].concat(E_(S),[j]);return m=_[_.length-1].position,w.stackList&&w.stackList.length&&w.stackList.forEach(function(E){_.push({item:E,position:m})}),_},f)}else{var x=nr(n,i,0,!0);i-2*x-(c-1)*u<=0&&(u=0);var b=(i-2*x-(c-1)*u)/c;b>1&&(b>>=0);var g=l===+l?Math.min(b,l):b;d=o.reduce(function(S,w,j){var _=[].concat(E_(S),[{item:w.item,position:{offset:x+(b+u)*j+(b-g)/2,size:g}}]);return w.stackList&&w.stackList.length&&w.stackList.forEach(function(E){_.push({item:E,position:_[_.length-1].position})}),_},f)}return d},pG=function(t,r,n,i){var a=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),u=eP({children:a,legendWidth:c});if(u){var d=i||{},f=d.width,h=d.height,p=u.align,y=u.verticalAlign,v=u.layout;if((v==="vertical"||v==="horizontal"&&y==="middle")&&p!=="center"&&ce(t[p]))return ct(ct({},t),{},ns({},p,t[p]+(f||0)));if((v==="horizontal"||v==="vertical"&&p==="center")&&y!=="middle"&&ce(t[y]))return ct(ct({},t),{},ns({},y,t[y]+(h||0)))}return t},mG=function(t,r,n){return ke(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},tP=function(t,r,n,i,a){var o=r.props.children,l=hn(o,uv).filter(function(u){return mG(i,a,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var f=gr(d,n);if(ke(f))return u;var h=Array.isArray(f)?[Gf(f),Vf(f)]:[f,f],p=c.reduce(function(y,v){var m=gr(d,v,0),x=h[0]-Math.abs(Array.isArray(m)?m[0]:m),b=h[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(x,y[0]),Math.max(b,y[1])]},[1/0,-1/0]);return[Math.min(p[0],u[0]),Math.max(p[1],u[1])]},[1/0,-1/0])}return null},gG=function(t,r,n,i,a){var o=r.map(function(l){return tP(t,l,n,a,i)}).filter(function(l){return!ke(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},rP=function(t,r,n,i,a){var o=r.map(function(c){var u=c.props.dataKey;return n==="number"&&u&&tP(t,c,u,i)||Wo(t,u,n,a)});if(n==="number")return o.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,u){for(var d=0,f=u.length;d<f;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},nP=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},Po=function(t,r,n){if(!t)return null;var i=t.scale,a=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?i.bandwidth()/2:2,u=(r||n)&&o==="category"&&i.bandwidth?i.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?$r(l[0]-l[1])*2*u:u,r&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(f){var h=a?a.indexOf(f):f;return{coordinate:i(h)+u,value:f,offset:u}});return d.filter(function(f){return!dc(f.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(f,h){return{coordinate:i(f)+u,value:f,index:h,offset:u}}):i.ticks&&!n?i.ticks(t.tickCount).map(function(f){return{coordinate:i(f)+u,value:f,offset:u}}):i.domain().map(function(f,h){return{coordinate:i(f)+u,value:a?a[f]:f,index:h,offset:u}})},yp=new WeakMap,eu=function(t,r){if(typeof r!="function")return t;yp.has(t)||yp.set(t,new WeakMap);var n=yp.get(t);if(n.has(r))return n.get(r);var i=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,i),i},yG=function(t,r,n){var i=t.scale,a=t.type,o=t.layout,l=t.axisType;if(i==="auto")return o==="radial"&&l==="radiusAxis"?{scale:Pl(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:wd(),realScaleType:"linear"}:a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0)?{scale:zo(),realScaleType:"point"}:a==="category"?{scale:Pl(),realScaleType:"band"}:{scale:wd(),realScaleType:"linear"};if(uc(i)){var c="scale".concat(Tf(i));return{scale:(b_[c]||zo)(),realScaleType:b_[c]?c:"point"}}return Oe(i)?{scale:i}:{scale:zo(),realScaleType:"point"}},P_=1e-4,vG=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,i=t.range(),a=Math.min(i[0],i[1])-P_,o=Math.max(i[0],i[1])+P_,l=t(r[0]),c=t(r[n-1]);(l<a||l>o||c<a||c>o)&&t.domain([r[0],r[n-1]])}},xG=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var a=0,o=0,l=0;l<r;++l){var c=dc(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=a,t[l][n][1]=a+c,a=t[l][n][1]):(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1])}},bG=function(t){var r=t.length;if(!(r<=0))for(var n=0,i=t[0].length;n<i;++n)for(var a=0,o=0;o<r;++o){var l=dc(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=a,t[o][n][1]=a+l,a=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},wG={sign:xG,expand:L5,none:ps,silhouette:B5,wiggle:F5,positive:bG},_G=function(t,r,n){var i=r.map(function(l){return l.props.dataKey}),a=wG[n],o=D5().keys(i).value(function(l,c){return+gr(l,c,0)}).order(Xm).offset(a);return o(t)},jG=function(t,r,n,i,a,o){if(!t)return null;var l=o?r.reverse():r,c={},u=l.reduce(function(f,h){var p,y=(p=h.type)!==null&&p!==void 0&&p.defaultProps?ct(ct({},h.type.defaultProps),h.props):h.props,v=y.stackId,m=y.hide;if(m)return f;var x=y[n],b=f[x]||{hasStack:!1,stackGroups:{}};if(At(v)){var g=b.stackGroups[v]||{numericAxisId:n,cateAxisId:i,items:[]};g.items.push(h),b.hasStack=!0,b.stackGroups[v]=g}else b.stackGroups[Of("_stackId_")]={numericAxisId:n,cateAxisId:i,items:[h]};return ct(ct({},f),{},ns({},x,b))},c),d={};return Object.keys(u).reduce(function(f,h){var p=u[h];if(p.hasStack){var y={};p.stackGroups=Object.keys(p.stackGroups).reduce(function(v,m){var x=p.stackGroups[m];return ct(ct({},v),{},ns({},m,{numericAxisId:n,cateAxisId:i,items:x.items,stackedData:_G(t,x.items,a)}))},y)}return ct(ct({},f),{},ns({},h,p))},d)},SG=function(t,r){var n=r.realScaleType,i=r.type,a=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(a&&i==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=DV(u,a,l);return t.domain([Gf(d),Vf(d)]),{niceTicks:d}}if(a&&i==="number"){var f=t.domain(),h=LV(f,a,l);return{niceTicks:h}}return null},NG=function(t,r){var n,i=(n=t.type)!==null&&n!==void 0&&n.defaultProps?ct(ct({},t.type.defaultProps),t.props):t.props,a=i.stackId;if(At(a)){var o=r[a];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},EG=function(t){return t.reduce(function(r,n){return[Gf(n.concat([r[0]]).filter(ce)),Vf(n.concat([r[1]]).filter(ce))]},[1/0,-1/0])},iP=function(t,r,n){return Object.keys(t).reduce(function(i,a){var o=t[a],l=o.stackedData,c=l.reduce(function(u,d){var f=EG(d.slice(r,n+1));return[Math.min(u[0],f[0]),Math.max(u[1],f[1])]},[1/0,-1/0]);return[Math.min(c[0],i[0]),Math.max(c[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},O_=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,C_=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ng=function(t,r,n){if(Oe(t))return t(r,n);if(!Array.isArray(t))return r;var i=[];if(ce(t[0]))i[0]=n?t[0]:Math.min(t[0],r[0]);else if(O_.test(t[0])){var a=+O_.exec(t[0])[1];i[0]=r[0]-a}else Oe(t[0])?i[0]=t[0](r[0]):i[0]=r[0];if(ce(t[1]))i[1]=n?t[1]:Math.max(t[1],r[1]);else if(C_.test(t[1])){var o=+C_.exec(t[1])[1];i[1]=r[1]+o}else Oe(t[1])?i[1]=t[1](r[1]):i[1]=r[1];return i},Eg=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var i=t.scale.bandwidth();if(!n||i>0)return i}if(t&&r&&r.length>=2){for(var a=R0(r,function(f){return f.coordinate}),o=1/0,l=1,c=a.length;l<c;l++){var u=a[l],d=a[l-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},T_=function(t,r,n){return!t||!t.length||ov(t,en(n,"type.defaultProps.domain"))?r:t},AG=function(t,r){var n=t.type.defaultProps?ct(ct({},t.type.defaultProps),t.props):t.props,i=n.dataKey,a=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,u=n.chartType,d=n.hide;return ct(ct({},Ae(t,!1)),{},{dataKey:i,unit:o,formatter:l,name:a||i,color:dv(t),value:gr(r,i),type:c,payload:r,chartType:u,hide:d})};function Dl(e){"@babel/helpers - typeof";return Dl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dl(e)}function k_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k_(Object(r),!0).forEach(function(n){aP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aP(e,t,r){return t=PG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PG(e){var t=OG(e,"string");return Dl(t)=="symbol"?t:t+""}function OG(e,t){if(Dl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Dl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CG(e,t){return IG(e)||$G(e,t)||kG(e,t)||TG()}function TG(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kG(e,t){if(e){if(typeof e=="string")return $_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $_(e,t)}}function $_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function $G(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function IG(e){if(Array.isArray(e))return e}var Pd=Math.PI/180,MG=function(t){return t*180/Math.PI},Je=function(t,r,n,i){return{x:t+Math.cos(-Pd*i)*n,y:r+Math.sin(-Pd*i)*n}},sP=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},RG=function(t,r,n,i,a){var o=t.width,l=t.height,c=t.startAngle,u=t.endAngle,d=nr(t.cx,o,o/2),f=nr(t.cy,l,l/2),h=sP(o,l,n),p=nr(t.innerRadius,h,0),y=nr(t.outerRadius,h,h*.8),v=Object.keys(r);return v.reduce(function(m,x){var b=r[x],g=b.domain,S=b.reversed,w;if(ke(b.range))i==="angleAxis"?w=[c,u]:i==="radiusAxis"&&(w=[p,y]),S&&(w=[w[1],w[0]]);else{w=b.range;var j=w,_=CG(j,2);c=_[0],u=_[1]}var E=yG(b,a),A=E.realScaleType,P=E.scale;P.domain(g).range(w),vG(P);var T=SG(P,_n(_n({},b),{},{realScaleType:A})),M=_n(_n(_n({},b),T),{},{range:w,radius:y,realScaleType:A,scale:P,cx:d,cy:f,innerRadius:p,outerRadius:y,startAngle:c,endAngle:u});return _n(_n({},m),{},aP({},x,M))},{})},DG=function(t,r){var n=t.x,i=t.y,a=r.x,o=r.y;return Math.sqrt(Math.pow(n-a,2)+Math.pow(i-o,2))},LG=function(t,r){var n=t.x,i=t.y,a=r.cx,o=r.cy,l=DG({x:n,y:i},{x:a,y:o});if(l<=0)return{radius:l};var c=(n-a)/l,u=Math.acos(c);return i>o&&(u=2*Math.PI-u),{radius:l,angle:MG(u),angleInRadian:u}},BG=function(t){var r=t.startAngle,n=t.endAngle,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return{startAngle:r-o*360,endAngle:n-o*360}},FG=function(t,r){var n=r.startAngle,i=r.endAngle,a=Math.floor(n/360),o=Math.floor(i/360),l=Math.min(a,o);return t+l*360},I_=function(t,r){var n=t.x,i=t.y,a=LG({x:n,y:i},r),o=a.radius,l=a.angle,c=r.innerRadius,u=r.outerRadius;if(o<c||o>u)return!1;if(o===0)return!0;var d=BG(r),f=d.startAngle,h=d.endAngle,p=l,y;if(f<=h){for(;p>h;)p-=360;for(;p<f;)p+=360;y=p>=f&&p<=h}else{for(;p>f;)p-=360;for(;p<h;)p+=360;y=p>=h&&p<=f}return y?_n(_n({},r),{},{radius:o,angle:FG(p,r)}):null},oP=function(t){return!N.isValidElement(t)&&!Oe(t)&&typeof t!="boolean"?t.className:""};function Ll(e){"@babel/helpers - typeof";return Ll=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ll(e)}var qG=["offset"];function UG(e){return VG(e)||HG(e)||WG(e)||zG()}function zG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WG(e,t){if(e){if(typeof e=="string")return Ag(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ag(e,t)}}function HG(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VG(e){if(Array.isArray(e))return Ag(e)}function Ag(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function GG(e,t){if(e==null)return{};var r=KG(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function KG(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function M_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?M_(Object(r),!0).forEach(function(n){XG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XG(e,t,r){return t=YG(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YG(e){var t=JG(e,"string");return Ll(t)=="symbol"?t:t+""}function JG(e,t){if(Ll(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ll(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bl(){return Bl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bl.apply(this,arguments)}var QG=function(t){var r=t.value,n=t.formatter,i=ke(t.children)?r:t.children;return Oe(n)?n(i):i},ZG=function(t,r){var n=$r(r-t),i=Math.min(Math.abs(r-t),360);return n*i},eK=function(t,r,n){var i=t.position,a=t.viewBox,o=t.offset,l=t.className,c=a,u=c.cx,d=c.cy,f=c.innerRadius,h=c.outerRadius,p=c.startAngle,y=c.endAngle,v=c.clockWise,m=(f+h)/2,x=ZG(p,y),b=x>=0?1:-1,g,S;i==="insideStart"?(g=p+b*o,S=v):i==="insideEnd"?(g=y-b*o,S=!v):i==="end"&&(g=y+b*o,S=v),S=x<=0?S:!S;var w=Je(u,d,m,g),j=Je(u,d,m,g+(S?1:-1)*359),_="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(S?0:1,`,
    `).concat(j.x,",").concat(j.y),E=ke(t.id)?Of("recharts-radial-line-"):t.id;return z.createElement("text",Bl({},n,{dominantBaseline:"central",className:Re("recharts-radial-bar-label",l)}),z.createElement("defs",null,z.createElement("path",{id:E,d:_})),z.createElement("textPath",{xlinkHref:"#".concat(E)},r))},tK=function(t){var r=t.viewBox,n=t.offset,i=t.position,a=r,o=a.cx,l=a.cy,c=a.innerRadius,u=a.outerRadius,d=a.startAngle,f=a.endAngle,h=(d+f)/2;if(i==="outside"){var p=Je(o,l,u+n,h),y=p.x,v=p.y;return{x:y,y:v,textAnchor:y>=o?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var m=(c+u)/2,x=Je(o,l,m,h),b=x.x,g=x.y;return{x:b,y:g,textAnchor:"middle",verticalAnchor:"middle"}},rK=function(t){var r=t.viewBox,n=t.parentViewBox,i=t.offset,a=t.position,o=r,l=o.x,c=o.y,u=o.width,d=o.height,f=d>=0?1:-1,h=f*i,p=f>0?"end":"start",y=f>0?"start":"end",v=u>=0?1:-1,m=v*i,x=v>0?"end":"start",b=v>0?"start":"end";if(a==="top"){var g={x:l+u/2,y:c-f*i,textAnchor:"middle",verticalAnchor:p};return wt(wt({},g),n?{height:Math.max(c-n.y,0),width:u}:{})}if(a==="bottom"){var S={x:l+u/2,y:c+d+h,textAnchor:"middle",verticalAnchor:y};return wt(wt({},S),n?{height:Math.max(n.y+n.height-(c+d),0),width:u}:{})}if(a==="left"){var w={x:l-m,y:c+d/2,textAnchor:x,verticalAnchor:"middle"};return wt(wt({},w),n?{width:Math.max(w.x-n.x,0),height:d}:{})}if(a==="right"){var j={x:l+u+m,y:c+d/2,textAnchor:b,verticalAnchor:"middle"};return wt(wt({},j),n?{width:Math.max(n.x+n.width-j.x,0),height:d}:{})}var _=n?{width:u,height:d}:{};return a==="insideLeft"?wt({x:l+m,y:c+d/2,textAnchor:b,verticalAnchor:"middle"},_):a==="insideRight"?wt({x:l+u-m,y:c+d/2,textAnchor:x,verticalAnchor:"middle"},_):a==="insideTop"?wt({x:l+u/2,y:c+h,textAnchor:"middle",verticalAnchor:y},_):a==="insideBottom"?wt({x:l+u/2,y:c+d-h,textAnchor:"middle",verticalAnchor:p},_):a==="insideTopLeft"?wt({x:l+m,y:c+h,textAnchor:b,verticalAnchor:y},_):a==="insideTopRight"?wt({x:l+u-m,y:c+h,textAnchor:x,verticalAnchor:y},_):a==="insideBottomLeft"?wt({x:l+m,y:c+d-h,textAnchor:b,verticalAnchor:p},_):a==="insideBottomRight"?wt({x:l+u-m,y:c+d-h,textAnchor:x,verticalAnchor:p},_):Hs(a)&&(ce(a.x)||Xi(a.x))&&(ce(a.y)||Xi(a.y))?wt({x:l+nr(a.x,u),y:c+nr(a.y,d),textAnchor:"end",verticalAnchor:"end"},_):wt({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},_)},nK=function(t){return"cx"in t&&ce(t.cx)};function Rt(e){var t=e.offset,r=t===void 0?5:t,n=GG(e,qG),i=wt({offset:r},n),a=i.viewBox,o=i.position,l=i.value,c=i.children,u=i.content,d=i.className,f=d===void 0?"":d,h=i.textBreakAll;if(!a||ke(l)&&ke(c)&&!N.isValidElement(u)&&!Oe(u))return null;if(N.isValidElement(u))return N.cloneElement(u,i);var p;if(Oe(u)){if(p=N.createElement(u,i),N.isValidElement(p))return p}else p=QG(i);var y=nK(a),v=Ae(i,!0);if(y&&(o==="insideStart"||o==="insideEnd"||o==="end"))return eK(i,p,v);var m=y?tK(i):rK(i);return z.createElement(xs,Bl({className:Re("recharts-label",f)},v,m,{breakAll:h}),p)}Rt.displayName="Label";var lP=function(t){var r=t.cx,n=t.cy,i=t.angle,a=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,f=t.x,h=t.y,p=t.top,y=t.left,v=t.width,m=t.height,x=t.clockWise,b=t.labelViewBox;if(b)return b;if(ce(v)&&ce(m)){if(ce(f)&&ce(h))return{x:f,y:h,width:v,height:m};if(ce(p)&&ce(y))return{x:p,y,width:v,height:m}}return ce(f)&&ce(h)?{x:f,y:h,width:0,height:0}:ce(r)&&ce(n)?{cx:r,cy:n,startAngle:a||i||0,endAngle:o||i||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},iK=function(t,r){return t?t===!0?z.createElement(Rt,{key:"label-implicit",viewBox:r}):At(t)?z.createElement(Rt,{key:"label-implicit",viewBox:r,value:t}):N.isValidElement(t)?t.type===Rt?N.cloneElement(t,{key:"label-implicit",viewBox:r}):z.createElement(Rt,{key:"label-implicit",content:t,viewBox:r}):Oe(t)?z.createElement(Rt,{key:"label-implicit",content:t,viewBox:r}):Hs(t)?z.createElement(Rt,Bl({viewBox:r},t,{key:"label-implicit"})):null:null},aK=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var i=t.children,a=lP(t),o=hn(i,Rt).map(function(c,u){return N.cloneElement(c,{viewBox:r||a,key:"label-".concat(u)})});if(!n)return o;var l=iK(t.label,r||a);return[l].concat(UG(o))};Rt.parseViewBox=lP;Rt.renderCallByParent=aK;function sK(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var oK=sK;const lK=He(oK);function Fl(e){"@babel/helpers - typeof";return Fl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fl(e)}var cK=["valueAccessor"],uK=["data","dataKey","clockWise","id","textBreakAll"];function dK(e){return mK(e)||pK(e)||hK(e)||fK()}function fK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hK(e,t){if(e){if(typeof e=="string")return Pg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pg(e,t)}}function pK(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function mK(e){if(Array.isArray(e))return Pg(e)}function Pg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Od(){return Od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Od.apply(this,arguments)}function R_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function D_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R_(Object(r),!0).forEach(function(n){gK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gK(e,t,r){return t=yK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yK(e){var t=vK(e,"string");return Fl(t)=="symbol"?t:t+""}function vK(e,t){if(Fl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Fl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function L_(e,t){if(e==null)return{};var r=xK(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function xK(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var bK=function(t){return Array.isArray(t.value)?lK(t.value):t.value};function ia(e){var t=e.valueAccessor,r=t===void 0?bK:t,n=L_(e,cK),i=n.data,a=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,u=L_(n,uK);return!i||!i.length?null:z.createElement(ut,{className:"recharts-label-list"},i.map(function(d,f){var h=ke(a)?r(d,f):gr(d&&d.payload,a),p=ke(l)?{}:{id:"".concat(l,"-").concat(f)};return z.createElement(Rt,Od({},Ae(d,!0),u,p,{parentViewBox:d.parentViewBox,value:h,textBreakAll:c,viewBox:Rt.parseViewBox(ke(o)?d:D_(D_({},d),{},{clockWise:o})),key:"label-".concat(f),index:f}))}))}ia.displayName="LabelList";function wK(e,t){return e?e===!0?z.createElement(ia,{key:"labelList-implicit",data:t}):z.isValidElement(e)||Oe(e)?z.createElement(ia,{key:"labelList-implicit",data:t,content:e}):Hs(e)?z.createElement(ia,Od({data:t},e,{key:"labelList-implicit"})):null:null}function _K(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var n=e.children,i=hn(n,ia).map(function(o,l){return N.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return i;var a=wK(e.label,t);return[a].concat(dK(i))}ia.renderCallByParent=_K;function ql(e){"@babel/helpers - typeof";return ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ql(e)}function Og(){return Og=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Og.apply(this,arguments)}function B_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function F_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(r),!0).forEach(function(n){jK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jK(e,t,r){return t=SK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SK(e){var t=NK(e,"string");return ql(t)=="symbol"?t:t+""}function NK(e,t){if(ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EK=function(t,r){var n=$r(r-t),i=Math.min(Math.abs(r-t),359.999);return n*i},tu=function(t){var r=t.cx,n=t.cy,i=t.radius,a=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(l?1:-1)+i,f=Math.asin(c/d)/Pd,h=u?a:a+o*f,p=Je(r,n,d,h),y=Je(r,n,i,h),v=u?a-o*f:a,m=Je(r,n,d*Math.cos(f*Pd),v);return{center:p,circleTangency:y,lineTangency:m,theta:f}},cP=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,a=t.outerRadius,o=t.startAngle,l=t.endAngle,c=EK(o,l),u=o+c,d=Je(r,n,a,o),f=Je(r,n,a,u),h="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>u),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(i>0){var p=Je(r,n,i,o),y=Je(r,n,i,u);h+="L ".concat(y.x,",").concat(y.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=u),`,
            `).concat(p.x,",").concat(p.y," Z")}else h+="L ".concat(r,",").concat(n," Z");return h},AK=function(t){var r=t.cx,n=t.cy,i=t.innerRadius,a=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,f=$r(d-u),h=tu({cx:r,cy:n,radius:a,angle:u,sign:f,cornerRadius:o,cornerIsExternal:c}),p=h.circleTangency,y=h.lineTangency,v=h.theta,m=tu({cx:r,cy:n,radius:a,angle:d,sign:-f,cornerRadius:o,cornerIsExternal:c}),x=m.circleTangency,b=m.lineTangency,g=m.theta,S=c?Math.abs(u-d):Math.abs(u-d)-v-g;if(S<0)return l?"M ".concat(y.x,",").concat(y.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):cP({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:u,endAngle:d});var w="M ".concat(y.x,",").concat(y.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(S>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
  `);if(i>0){var j=tu({cx:r,cy:n,radius:i,angle:u,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),_=j.circleTangency,E=j.lineTangency,A=j.theta,P=tu({cx:r,cy:n,radius:i,angle:d,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),T=P.circleTangency,M=P.lineTangency,O=P.theta,k=c?Math.abs(u-d):Math.abs(u-d)-A-O;if(k<0&&o===0)return"".concat(w,"L").concat(r,",").concat(n,"Z");w+="L".concat(M.x,",").concat(M.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(T.x,",").concat(T.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(k>180),",").concat(+(f>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(E.x,",").concat(E.y,"Z")}else w+="L".concat(r,",").concat(n,"Z");return w},PK={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},uP=function(t){var r=F_(F_({},PK),t),n=r.cx,i=r.cy,a=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,u=r.cornerIsExternal,d=r.startAngle,f=r.endAngle,h=r.className;if(o<a||d===f)return null;var p=Re("recharts-sector",h),y=o-a,v=nr(l,y,0,!0),m;return v>0&&Math.abs(d-f)<360?m=AK({cx:n,cy:i,innerRadius:a,outerRadius:o,cornerRadius:Math.min(v,y/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:f}):m=cP({cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:d,endAngle:f}),z.createElement("path",Og({},Ae(r,!0),{className:p,d:m,role:"img"}))};function Ul(e){"@babel/helpers - typeof";return Ul=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ul(e)}function Cg(){return Cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cg.apply(this,arguments)}function q_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function U_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q_(Object(r),!0).forEach(function(n){OK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OK(e,t,r){return t=CK(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CK(e){var t=TK(e,"string");return Ul(t)=="symbol"?t:t+""}function TK(e,t){if(Ul(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ul(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z_={curveBasisClosed:E5,curveBasisOpen:A5,curveBasis:N5,curveBumpX:d5,curveBumpY:f5,curveLinearClosed:P5,curveLinear:$f,curveMonotoneX:O5,curveMonotoneY:C5,curveNatural:T5,curveStep:k5,curveStepAfter:I5,curveStepBefore:$5},ru=function(t){return t.x===+t.x&&t.y===+t.y},xo=function(t){return t.x},bo=function(t){return t.y},kK=function(t,r){if(Oe(t))return t;var n="curve".concat(Tf(t));return(n==="curveMonotone"||n==="curveBump")&&r?z_["".concat(n).concat(r==="vertical"?"Y":"X")]:z_[n]||$f},$K=function(t){var r=t.type,n=r===void 0?"linear":r,i=t.points,a=i===void 0?[]:i,o=t.baseLine,l=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=kK(n,l),f=u?a.filter(function(v){return ru(v)}):a,h;if(Array.isArray(o)){var p=u?o.filter(function(v){return ru(v)}):o,y=f.map(function(v,m){return U_(U_({},v),{},{base:p[m]})});return l==="vertical"?h=Vc().y(bo).x1(xo).x0(function(v){return v.base.x}):h=Vc().x(xo).y1(bo).y0(function(v){return v.base.y}),h.defined(ru).curve(d),h(y)}return l==="vertical"&&ce(o)?h=Vc().y(bo).x1(xo).x0(o):ce(o)?h=Vc().x(xo).y1(bo).y0(o):h=uA().x(xo).y(bo),h.defined(ru).curve(d),h(f)},Tg=function(t){var r=t.className,n=t.points,i=t.path,a=t.pathRef;if((!n||!n.length)&&!i)return null;var o=n&&n.length?$K(t):i;return N.createElement("path",Cg({},Ae(t,!1),td(t),{className:Re("recharts-curve",r),d:o,ref:a}))},dP={exports:{}},IK="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",MK=IK,RK=MK;function fP(){}function hP(){}hP.resetWarningCache=fP;var DK=function(){function e(n,i,a,o,l,c){if(c!==RK){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:hP,resetWarningCache:fP};return r.PropTypes=r,r};dP.exports=DK();var LK=dP.exports;const Be=He(LK);var BK=Object.getOwnPropertyNames,FK=Object.getOwnPropertySymbols,qK=Object.prototype.hasOwnProperty;function W_(e,t){return function(n,i,a){return e(n,i,a)&&t(n,i,a)}}function nu(e){return function(r,n,i){if(!r||!n||typeof r!="object"||typeof n!="object")return e(r,n,i);var a=i.cache,o=a.get(r),l=a.get(n);if(o&&l)return o===n&&l===r;a.set(r,n),a.set(n,r);var c=e(r,n,i);return a.delete(r),a.delete(n),c}}function UK(e){return e!=null?e[Symbol.toStringTag]:void 0}function H_(e){return BK(e).concat(FK(e))}var zK=Object.hasOwn||function(e,t){return qK.call(e,t)};function ya(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var WK="__v",HK="__o",VK="_owner",V_=Object.getOwnPropertyDescriptor,G_=Object.keys;function GK(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function KK(e,t){return ya(e.getTime(),t.getTime())}function XK(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function YK(e,t){return e===t}function K_(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),a=e.entries(),o,l,c=0;(o=a.next())&&!o.done;){for(var u=t.entries(),d=!1,f=0;(l=u.next())&&!l.done;){if(i[f]){f++;continue}var h=o.value,p=l.value;if(r.equals(h[0],p[0],c,f,e,t,r)&&r.equals(h[1],p[1],h[0],p[0],e,t,r)){d=i[f]=!0;break}f++}if(!d)return!1;c++}return!0}var JK=ya;function QK(e,t,r){var n=G_(e),i=n.length;if(G_(t).length!==i)return!1;for(;i-- >0;)if(!pP(e,t,r,n[i]))return!1;return!0}function wo(e,t,r){var n=H_(e),i=n.length;if(H_(t).length!==i)return!1;for(var a,o,l;i-- >0;)if(a=n[i],!pP(e,t,r,a)||(o=V_(e,a),l=V_(t,a),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function ZK(e,t){return ya(e.valueOf(),t.valueOf())}function eX(e,t){return e.source===t.source&&e.flags===t.flags}function X_(e,t,r){var n=e.size;if(n!==t.size)return!1;if(!n)return!0;for(var i=new Array(n),a=e.values(),o,l;(o=a.next())&&!o.done;){for(var c=t.values(),u=!1,d=0;(l=c.next())&&!l.done;){if(!i[d]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){u=i[d]=!0;break}d++}if(!u)return!1}return!0}function tX(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function rX(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function pP(e,t,r,n){return(n===VK||n===HK||n===WK)&&(e.$$typeof||t.$$typeof)?!0:zK(t,n)&&r.equals(e[n],t[n],n,n,e,t,r)}var nX="[object Arguments]",iX="[object Boolean]",aX="[object Date]",sX="[object Error]",oX="[object Map]",lX="[object Number]",cX="[object Object]",uX="[object RegExp]",dX="[object Set]",fX="[object String]",hX="[object URL]",pX=Array.isArray,Y_=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,J_=Object.assign,mX=Object.prototype.toString.call.bind(Object.prototype.toString);function gX(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areErrorsEqual,i=e.areFunctionsEqual,a=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,f=e.areTypedArraysEqual,h=e.areUrlsEqual,p=e.unknownTagComparators;return function(v,m,x){if(v===m)return!0;if(v==null||m==null)return!1;var b=typeof v;if(b!==typeof m)return!1;if(b!=="object")return b==="number"?o(v,m,x):b==="function"?i(v,m,x):!1;var g=v.constructor;if(g!==m.constructor)return!1;if(g===Object)return l(v,m,x);if(pX(v))return t(v,m,x);if(Y_!=null&&Y_(v))return f(v,m,x);if(g===Date)return r(v,m,x);if(g===RegExp)return u(v,m,x);if(g===Map)return a(v,m,x);if(g===Set)return d(v,m,x);var S=mX(v);if(S===aX)return r(v,m,x);if(S===uX)return u(v,m,x);if(S===oX)return a(v,m,x);if(S===dX)return d(v,m,x);if(S===cX)return typeof v.then!="function"&&typeof m.then!="function"&&l(v,m,x);if(S===hX)return h(v,m,x);if(S===sX)return n(v,m,x);if(S===nX)return l(v,m,x);if(S===iX||S===lX||S===fX)return c(v,m,x);if(p){var w=p[S];if(!w){var j=UK(v);j&&(w=p[j])}if(w)return w(v,m,x)}return!1}}function yX(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,i={areArraysEqual:n?wo:GK,areDatesEqual:KK,areErrorsEqual:XK,areFunctionsEqual:YK,areMapsEqual:n?W_(K_,wo):K_,areNumbersEqual:JK,areObjectsEqual:n?wo:QK,arePrimitiveWrappersEqual:ZK,areRegExpsEqual:eX,areSetsEqual:n?W_(X_,wo):X_,areTypedArraysEqual:n?wo:tX,areUrlsEqual:rX,unknownTagComparators:void 0};if(r&&(i=J_({},i,r(i))),t){var a=nu(i.areArraysEqual),o=nu(i.areMapsEqual),l=nu(i.areObjectsEqual),c=nu(i.areSetsEqual);i=J_({},i,{areArraysEqual:a,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return i}function vX(e){return function(t,r,n,i,a,o,l){return e(t,r,l)}}function xX(e){var t=e.circular,r=e.comparator,n=e.createState,i=e.equals,a=e.strict;if(n)return function(c,u){var d=n(),f=d.cache,h=f===void 0?t?new WeakMap:void 0:f,p=d.meta;return r(c,u,{cache:h,equals:i,meta:p,strict:a})};if(t)return function(c,u){return r(c,u,{cache:new WeakMap,equals:i,meta:void 0,strict:a})};var o={cache:void 0,equals:i,meta:void 0,strict:a};return function(c,u){return r(c,u,o)}}var bX=Oi();Oi({strict:!0});Oi({circular:!0});Oi({circular:!0,strict:!0});Oi({createInternalComparator:function(){return ya}});Oi({strict:!0,createInternalComparator:function(){return ya}});Oi({circular:!0,createInternalComparator:function(){return ya}});Oi({circular:!0,createInternalComparator:function(){return ya},strict:!0});function Oi(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,n=e.createInternalComparator,i=e.createState,a=e.strict,o=a===void 0?!1:a,l=yX(e),c=gX(l),u=n?n(c):vX(c);return xX({circular:r,comparator:c,createState:i,equals:u,strict:o})}function wX(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function Q_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function i(a){r<0&&(r=a),a-r>t?(e(a),r=-1):wX(i)};requestAnimationFrame(n)}function kg(e){"@babel/helpers - typeof";return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kg(e)}function _X(e){return EX(e)||NX(e)||SX(e)||jX()}function jX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SX(e,t){if(e){if(typeof e=="string")return Z_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Z_(e,t)}}function Z_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function NX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EX(e){if(Array.isArray(e))return e}function AX(){var e={},t=function(){return null},r=!1,n=function i(a){if(!r){if(Array.isArray(a)){if(!a.length)return;var o=a,l=_X(o),c=l[0],u=l.slice(1);if(typeof c=="number"){Q_(i.bind(null,u),c);return}i(c),Q_(i.bind(null,u));return}kg(a)==="object"&&(e=a,t(e)),typeof a=="function"&&a()}};return{stop:function(){r=!0},start:function(a){r=!1,n(a)},subscribe:function(a){return t=a,function(){t=function(){return null}}}}}function zl(e){"@babel/helpers - typeof";return zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zl(e)}function e1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function t1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e1(Object(r),!0).forEach(function(n){mP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mP(e,t,r){return t=PX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PX(e){var t=OX(e,"string");return zl(t)==="symbol"?t:String(t)}function OX(e,t){if(zl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(zl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CX=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,i){return n.filter(function(a){return i.includes(a)})})},TX=function(t){return t},kX=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},Ho=function(t,r){return Object.keys(r).reduce(function(n,i){return t1(t1({},n),{},mP({},i,t(i,r[i])))},{})},r1=function(t,r,n){return t.map(function(i){return"".concat(kX(i)," ").concat(r,"ms ").concat(n)}).join(",")};function $X(e,t){return RX(e)||MX(e,t)||gP(e,t)||IX()}function IX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function MX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function RX(e){if(Array.isArray(e))return e}function DX(e){return FX(e)||BX(e)||gP(e)||LX()}function LX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gP(e,t){if(e){if(typeof e=="string")return $g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $g(e,t)}}function BX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function FX(e){if(Array.isArray(e))return $g(e)}function $g(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Cd=1e-4,yP=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},vP=function(t,r){return t.map(function(n,i){return n*Math.pow(r,i)}).reduce(function(n,i){return n+i})},n1=function(t,r){return function(n){var i=yP(t,r);return vP(i,n)}},qX=function(t,r){return function(n){var i=yP(t,r),a=[].concat(DX(i.map(function(o,l){return o*l}).slice(1)),[0]);return vP(a,n)}},i1=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0],a=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":i=0,a=0,o=1,l=1;break;case"ease":i=.25,a=.1,o=.25,l=1;break;case"ease-in":i=.42,a=0,o=1,l=1;break;case"ease-out":i=.42,a=0,o=.58,l=1;break;case"ease-in-out":i=0,a=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),d=$X(u,4);i=d[0],a=d[1],o=d[2],l=d[3]}}}var f=n1(i,o),h=n1(a,l),p=qX(i,o),y=function(x){return x>1?1:x<0?0:x},v=function(x){for(var b=x>1?1:x,g=b,S=0;S<8;++S){var w=f(g)-b,j=p(g);if(Math.abs(w-b)<Cd||j<Cd)return h(g);g=y(g-w/j)}return h(g)};return v.isStepper=!1,v},UX=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,i=t.damping,a=i===void 0?8:i,o=t.dt,l=o===void 0?17:o,c=function(d,f,h){var p=-(d-f)*n,y=h*a,v=h+(p-y)*l/1e3,m=h*l/1e3+d;return Math.abs(m-f)<Cd&&Math.abs(v)<Cd?[f,0]:[m,v]};return c.isStepper=!0,c.dt=l,c},zX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return i1(i);case"spring":return UX();default:if(i.split("(")[0]==="cubic-bezier")return i1(i)}return typeof i=="function"?i:null};function Wl(e){"@babel/helpers - typeof";return Wl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wl(e)}function a1(e){return VX(e)||HX(e)||xP(e)||WX()}function WX(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HX(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VX(e){if(Array.isArray(e))return Mg(e)}function s1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s1(Object(r),!0).forEach(function(n){Ig(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ig(e,t,r){return t=GX(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GX(e){var t=KX(e,"string");return Wl(t)==="symbol"?t:String(t)}function KX(e,t){if(Wl(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Wl(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XX(e,t){return QX(e)||JX(e,t)||xP(e,t)||YX()}function YX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xP(e,t){if(e){if(typeof e=="string")return Mg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Mg(e,t)}}function Mg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function JX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function QX(e){if(Array.isArray(e))return e}var Td=function(t,r,n){return t+(r-t)*n},Rg=function(t){var r=t.from,n=t.to;return r!==n},ZX=function e(t,r,n){var i=Ho(function(a,o){if(Rg(o)){var l=t(o.from,o.to,o.velocity),c=XX(l,2),u=c[0],d=c[1];return $t($t({},o),{},{from:u,velocity:d})}return o},r);return n<1?Ho(function(a,o){return Rg(o)?$t($t({},o),{},{velocity:Td(o.velocity,i[a].velocity,n),from:Td(o.from,i[a].from,n)}):o},r):e(t,i,n-1)};const eY=function(e,t,r,n,i){var a=CX(e,t),o=a.reduce(function(m,x){return $t($t({},m),{},Ig({},x,[e[x],t[x]]))},{}),l=a.reduce(function(m,x){return $t($t({},m),{},Ig({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,u,d,f=function(){return null},h=function(){return Ho(function(x,b){return b.from},l)},p=function(){return!Object.values(l).filter(Rg).length},y=function(x){u||(u=x);var b=x-u,g=b/r.dt;l=ZX(r,l,g),i($t($t($t({},e),t),h())),u=x,p()||(c=requestAnimationFrame(f))},v=function(x){d||(d=x);var b=(x-d)/n,g=Ho(function(w,j){return Td.apply(void 0,a1(j).concat([r(b)]))},o);if(i($t($t($t({},e),t),g)),b<1)c=requestAnimationFrame(f);else{var S=Ho(function(w,j){return Td.apply(void 0,a1(j).concat([r(1)]))},o);i($t($t($t({},e),t),S))}};return f=r.isStepper?y:v,function(){return requestAnimationFrame(f),function(){cancelAnimationFrame(c)}}};function Ns(e){"@babel/helpers - typeof";return Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ns(e)}var tY=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function rY(e,t){if(e==null)return{};var r=nY(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function nY(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function vp(e){return oY(e)||sY(e)||aY(e)||iY()}function iY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aY(e,t){if(e){if(typeof e=="string")return Dg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dg(e,t)}}function sY(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oY(e){if(Array.isArray(e))return Dg(e)}function Dg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function o1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function zr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o1(Object(r),!0).forEach(function(n){Oo(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Oo(e,t,r){return t=bP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lY(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cY(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bP(n.key),n)}}function uY(e,t,r){return t&&cY(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bP(e){var t=dY(e,"string");return Ns(t)==="symbol"?t:String(t)}function dY(e,t){if(Ns(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ns(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fY(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lg(e,t)}function Lg(e,t){return Lg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Lg(e,t)}function hY(e){var t=pY();return function(){var n=kd(e),i;if(t){var a=kd(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return Bg(this,i)}}function Bg(e,t){if(t&&(Ns(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Fg(e)}function Fg(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function kd(e){return kd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kd(e)}var bi=function(e){fY(r,e);var t=hY(r);function r(n,i){var a;lY(this,r),a=t.call(this,n,i);var o=a.props,l=o.isActive,c=o.attributeName,u=o.from,d=o.to,f=o.steps,h=o.children,p=o.duration;if(a.handleStyleChange=a.handleStyleChange.bind(Fg(a)),a.changeStyle=a.changeStyle.bind(Fg(a)),!l||p<=0)return a.state={style:{}},typeof h=="function"&&(a.state={style:d}),Bg(a);if(f&&f.length)a.state={style:f[0].style};else if(u){if(typeof h=="function")return a.state={style:u},Bg(a);a.state={style:c?Oo({},c,u):u}}else a.state={style:{}};return a}return uY(r,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isActive,o=i.canBegin;this.mounted=!0,!(!a||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var a=this.props,o=a.isActive,l=a.canBegin,c=a.attributeName,u=a.shouldReAnimate,d=a.to,f=a.from,h=this.state.style;if(l){if(!o){var p={style:c?Oo({},c,d):d};this.state&&h&&(c&&h[c]!==d||!c&&h!==d)&&this.setState(p);return}if(!(bX(i.to,d)&&i.canBegin&&i.isActive)){var y=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var v=y||u?f:i.to;if(this.state&&h){var m={style:c?Oo({},c,v):v};(c&&h[c]!==v||!c&&h!==v)&&this.setState(m)}this.runAnimation(zr(zr({},this.props),{},{from:v,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var a=this,o=i.from,l=i.to,c=i.duration,u=i.easing,d=i.begin,f=i.onAnimationEnd,h=i.onAnimationStart,p=eY(o,l,zX(u),c,this.changeStyle),y=function(){a.stopJSAnimation=p()};this.manager.start([h,d,y,c,f])}},{key:"runStepAnimation",value:function(i){var a=this,o=i.steps,l=i.begin,c=i.onAnimationStart,u=o[0],d=u.style,f=u.duration,h=f===void 0?0:f,p=function(v,m,x){if(x===0)return v;var b=m.duration,g=m.easing,S=g===void 0?"ease":g,w=m.style,j=m.properties,_=m.onAnimationEnd,E=x>0?o[x-1]:m,A=j||Object.keys(w);if(typeof S=="function"||S==="spring")return[].concat(vp(v),[a.runJSAnimation.bind(a,{from:E.style,to:w,duration:b,easing:S}),b]);var P=r1(A,b,S),T=zr(zr(zr({},E.style),w),{},{transition:P});return[].concat(vp(v),[T,b,_]).filter(TX)};return this.manager.start([c].concat(vp(o.reduce(p,[d,Math.max(h,l)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=AX());var a=i.begin,o=i.duration,l=i.attributeName,c=i.to,u=i.easing,d=i.onAnimationStart,f=i.onAnimationEnd,h=i.steps,p=i.children,y=this.manager;if(this.unSubscribe=y.subscribe(this.handleStyleChange),typeof u=="function"||typeof p=="function"||u==="spring"){this.runJSAnimation(i);return}if(h.length>1){this.runStepAnimation(i);return}var v=l?Oo({},l,c):c,m=r1(Object.keys(v),o,u);y.start([d,a,zr(zr({},v),{},{transition:m}),o,f])}},{key:"render",value:function(){var i=this.props,a=i.children;i.begin;var o=i.duration;i.attributeName,i.easing;var l=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var c=rY(i,tY),u=N.Children.count(a),d=this.state.style;if(typeof a=="function")return a(d);if(!l||u===0||o<=0)return a;var f=function(p){var y=p.props,v=y.style,m=v===void 0?{}:v,x=y.className,b=N.cloneElement(p,zr(zr({},c),{},{style:zr(zr({},m),d),className:x}));return b};return u===1?f(N.Children.only(a)):z.createElement("div",null,N.Children.map(a,function(h){return f(h)}))}}]),r}(N.PureComponent);bi.displayName="Animate";bi.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};bi.propTypes={from:Be.oneOfType([Be.object,Be.string]),to:Be.oneOfType([Be.object,Be.string]),attributeName:Be.string,duration:Be.number,begin:Be.number,easing:Be.oneOfType([Be.string,Be.func]),steps:Be.arrayOf(Be.shape({duration:Be.number.isRequired,style:Be.object.isRequired,easing:Be.oneOfType([Be.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Be.func]),properties:Be.arrayOf("string"),onAnimationEnd:Be.func})),children:Be.oneOfType([Be.node,Be.func]),isActive:Be.bool,canBegin:Be.bool,onAnimationEnd:Be.func,shouldReAnimate:Be.bool,onAnimationStart:Be.func,onAnimationReStart:Be.func};function Hl(e){"@babel/helpers - typeof";return Hl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hl(e)}function $d(){return $d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$d.apply(this,arguments)}function mY(e,t){return xY(e)||vY(e,t)||yY(e,t)||gY()}function gY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yY(e,t){if(e){if(typeof e=="string")return l1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l1(e,t)}}function l1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function vY(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function xY(e){if(Array.isArray(e))return e}function c1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function u1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c1(Object(r),!0).forEach(function(n){bY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bY(e,t,r){return t=wY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wY(e){var t=_Y(e,"string");return Hl(t)=="symbol"?t:t+""}function _Y(e,t){if(Hl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Hl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d1=function(t,r,n,i,a){var o=Math.min(Math.abs(n)/2,Math.abs(i)/2),l=i>=0?1:-1,c=n>=0?1:-1,u=i>=0&&n>=0||i<0&&n<0?1:0,d;if(o>0&&a instanceof Array){for(var f=[0,0,0,0],h=0,p=4;h<p;h++)f[h]=a[h]>o?o:a[h];d="M".concat(t,",").concat(r+l*f[0]),f[0]>0&&(d+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(u,",").concat(t+c*f[0],",").concat(r)),d+="L ".concat(t+n-c*f[1],",").concat(r),f[1]>0&&(d+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(u,`,
        `).concat(t+n,",").concat(r+l*f[1])),d+="L ".concat(t+n,",").concat(r+i-l*f[2]),f[2]>0&&(d+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(u,`,
        `).concat(t+n-c*f[2],",").concat(r+i)),d+="L ".concat(t+c*f[3],",").concat(r+i),f[3]>0&&(d+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(r+i-l*f[3])),d+="Z"}else if(o>0&&a===+a&&a>0){var y=Math.min(o,a);d="M ".concat(t,",").concat(r+l*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(t+c*y,",").concat(r,`
            L `).concat(t+n-c*y,",").concat(r,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(t+n,",").concat(r+l*y,`
            L `).concat(t+n,",").concat(r+i-l*y,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(t+n-c*y,",").concat(r+i,`
            L `).concat(t+c*y,",").concat(r+i,`
            A `).concat(y,",").concat(y,",0,0,").concat(u,",").concat(t,",").concat(r+i-l*y," Z")}else d="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return d},jY=function(t,r){if(!t||!r)return!1;var n=t.x,i=t.y,a=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(a,a+l),d=Math.max(a,a+l),f=Math.min(o,o+c),h=Math.max(o,o+c);return n>=u&&n<=d&&i>=f&&i<=h}return!1},SY={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},fv=function(t){var r=u1(u1({},SY),t),n=N.useRef(),i=N.useState(-1),a=mY(i,2),o=a[0],l=a[1];N.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var S=n.current.getTotalLength();S&&l(S)}catch{}},[]);var c=r.x,u=r.y,d=r.width,f=r.height,h=r.radius,p=r.className,y=r.animationEasing,v=r.animationDuration,m=r.animationBegin,x=r.isAnimationActive,b=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||d===0||f===0)return null;var g=Re("recharts-rectangle",p);return b?z.createElement(bi,{canBegin:o>0,from:{width:d,height:f,x:c,y:u},to:{width:d,height:f,x:c,y:u},duration:v,animationEasing:y,isActive:b},function(S){var w=S.width,j=S.height,_=S.x,E=S.y;return z.createElement(bi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:v,isActive:x,easing:y},z.createElement("path",$d({},Ae(r,!0),{className:g,d:d1(_,E,w,j,h),ref:n})))}):z.createElement("path",$d({},Ae(r,!0),{className:g,d:d1(c,u,d,f,h)}))},NY=["points","className","baseLinePoints","connectNulls"];function Wa(){return Wa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wa.apply(this,arguments)}function EY(e,t){if(e==null)return{};var r=AY(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function AY(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function f1(e){return TY(e)||CY(e)||OY(e)||PY()}function PY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OY(e,t){if(e){if(typeof e=="string")return qg(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qg(e,t)}}function CY(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TY(e){if(Array.isArray(e))return qg(e)}function qg(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var h1=function(t){return t&&t.x===+t.x&&t.y===+t.y},kY=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){h1(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),h1(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},Vo=function(t,r){var n=kY(t);r&&(n=[n.reduce(function(a,o){return[].concat(f1(a),f1(o))},[])]);var i=n.map(function(a){return a.reduce(function(o,l,c){return"".concat(o).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(i,"Z"):i},$Y=function(t,r,n){var i=Vo(t,n);return"".concat(i.slice(-1)==="Z"?i.slice(0,-1):i,"L").concat(Vo(r.reverse(),n).slice(1))},IY=function(t){var r=t.points,n=t.className,i=t.baseLinePoints,a=t.connectNulls,o=EY(t,NY);if(!r||!r.length)return null;var l=Re("recharts-polygon",n);if(i&&i.length){var c=o.stroke&&o.stroke!=="none",u=$Y(r,i,a);return z.createElement("g",{className:l},z.createElement("path",Wa({},Ae(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:u})),c?z.createElement("path",Wa({},Ae(o,!0),{fill:"none",d:Vo(r,a)})):null,c?z.createElement("path",Wa({},Ae(o,!0),{fill:"none",d:Vo(i,a)})):null)}var d=Vo(r,a);return z.createElement("path",Wa({},Ae(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",className:l,d}))};function Ug(){return Ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ug.apply(this,arguments)}var hv=function(t){var r=t.cx,n=t.cy,i=t.r,a=t.className,o=Re("recharts-dot",a);return r===+r&&n===+n&&i===+i?N.createElement("circle",Ug({},Ae(t,!1),td(t),{className:o,cx:r,cy:n,r:i})):null};function Vl(e){"@babel/helpers - typeof";return Vl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vl(e)}var MY=["x","y","top","left","width","height","className"];function zg(){return zg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zg.apply(this,arguments)}function p1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function RY(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p1(Object(r),!0).forEach(function(n){DY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DY(e,t,r){return t=LY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LY(e){var t=BY(e,"string");return Vl(t)=="symbol"?t:t+""}function BY(e,t){if(Vl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FY(e,t){if(e==null)return{};var r=qY(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function qY(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}var UY=function(t,r,n,i,a,o){return"M".concat(t,",").concat(a,"v").concat(i,"M").concat(o,",").concat(r,"h").concat(n)},zY=function(t){var r=t.x,n=r===void 0?0:r,i=t.y,a=i===void 0?0:i,o=t.top,l=o===void 0?0:o,c=t.left,u=c===void 0?0:c,d=t.width,f=d===void 0?0:d,h=t.height,p=h===void 0?0:h,y=t.className,v=FY(t,MY),m=RY({x:n,y:a,top:l,left:u,width:f,height:p},v);return!ce(n)||!ce(a)||!ce(f)||!ce(p)||!ce(l)||!ce(u)?null:z.createElement("path",zg({},Ae(m,!0),{className:Re("recharts-cross",y),d:UY(n,a,f,p,l,u)}))},WY=Hf,HY=D2,VY=Ei;function GY(e,t){return e&&e.length?WY(e,VY(t),HY):void 0}var KY=GY;const XY=He(KY);var YY=Hf,JY=Ei,QY=L2;function ZY(e,t){return e&&e.length?YY(e,JY(t),QY):void 0}var eJ=ZY;const tJ=He(eJ);var rJ=["cx","cy","angle","ticks","axisLine"],nJ=["ticks","tick","angle","tickFormatter","stroke"];function Es(e){"@babel/helpers - typeof";return Es=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Es(e)}function Go(){return Go=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Go.apply(this,arguments)}function m1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m1(Object(r),!0).forEach(function(n){Yf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g1(e,t){if(e==null)return{};var r=iJ(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function iJ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function aJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_P(n.key),n)}}function sJ(e,t,r){return t&&y1(e.prototype,t),r&&y1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function oJ(e,t,r){return t=Id(t),lJ(e,wP()?Reflect.construct(t,r||[],Id(e).constructor):t.apply(e,r))}function lJ(e,t){if(t&&(Es(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return cJ(e)}function cJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wP=function(){return!!e})()}function Id(e){return Id=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Id(e)}function uJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wg(e,t)}function Wg(e,t){return Wg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Wg(e,t)}function Yf(e,t,r){return t=_P(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _P(e){var t=dJ(e,"string");return Es(t)=="symbol"?t:t+""}function dJ(e,t){if(Es(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Es(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jf=function(e){function t(){return aJ(this,t),oJ(this,t,arguments)}return uJ(t,e),sJ(t,[{key:"getTickValueCoord",value:function(n){var i=n.coordinate,a=this.props,o=a.angle,l=a.cx,c=a.cy;return Je(l,c,i,o)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,i;switch(n){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var n=this.props,i=n.cx,a=n.cy,o=n.angle,l=n.ticks,c=XY(l,function(d){return d.coordinate||0}),u=tJ(l,function(d){return d.coordinate||0});return{cx:i,cy:a,startAngle:o,endAngle:o,innerRadius:u.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,a=n.cy,o=n.angle,l=n.ticks,c=n.axisLine,u=g1(n,rJ),d=l.reduce(function(y,v){return[Math.min(y[0],v.coordinate),Math.max(y[1],v.coordinate)]},[1/0,-1/0]),f=Je(i,a,d[0],o),h=Je(i,a,d[1],o),p=$i($i($i({},Ae(u,!1)),{},{fill:"none"},Ae(c,!1)),{},{x1:f.x,y1:f.y,x2:h.x,y2:h.y});return z.createElement("line",Go({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var n=this,i=this.props,a=i.ticks,o=i.tick,l=i.angle,c=i.tickFormatter,u=i.stroke,d=g1(i,nJ),f=this.getTickTextAnchor(),h=Ae(d,!1),p=Ae(o,!1),y=a.map(function(v,m){var x=n.getTickValueCoord(v),b=$i($i($i($i({textAnchor:f,transform:"rotate(".concat(90-l,", ").concat(x.x,", ").concat(x.y,")")},h),{},{stroke:"none",fill:u},p),{},{index:m},x),{},{payload:v});return z.createElement(ut,Go({className:Re("recharts-polar-radius-axis-tick",oP(o)),key:"tick-".concat(v.coordinate)},Cf(n.props,v,m)),t.renderTickItem(o,b,c?c(v.value,m):v.value))});return z.createElement(ut,{className:"recharts-polar-radius-axis-ticks"},y)}},{key:"render",value:function(){var n=this.props,i=n.ticks,a=n.axisLine,o=n.tick;return!i||!i.length?null:z.createElement(ut,{className:Re("recharts-polar-radius-axis",this.props.className)},a&&this.renderAxisLine(),o&&this.renderTicks(),Rt.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,i,a){var o;return z.isValidElement(n)?o=z.cloneElement(n,i):Oe(n)?o=n(i):o=z.createElement(xs,Go({},i,{className:"recharts-polar-radius-axis-tick-value"}),a),o}}])}(N.PureComponent);Yf(Jf,"displayName","PolarRadiusAxis");Yf(Jf,"axisType","radiusAxis");Yf(Jf,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function As(e){"@babel/helpers - typeof";return As=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},As(e)}function Wi(){return Wi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wi.apply(this,arguments)}function v1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ii(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?v1(Object(r),!0).forEach(function(n){Qf(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,SP(n.key),n)}}function hJ(e,t,r){return t&&x1(e.prototype,t),r&&x1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function pJ(e,t,r){return t=Md(t),mJ(e,jP()?Reflect.construct(t,r||[],Md(e).constructor):t.apply(e,r))}function mJ(e,t){if(t&&(As(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return gJ(e)}function gJ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function jP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(jP=function(){return!!e})()}function Md(e){return Md=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Md(e)}function yJ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hg(e,t)}function Hg(e,t){return Hg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Hg(e,t)}function Qf(e,t,r){return t=SP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SP(e){var t=vJ(e,"string");return As(t)=="symbol"?t:t+""}function vJ(e,t){if(As(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(As(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xJ=Math.PI/180,b1=1e-5,Zf=function(e){function t(){return fJ(this,t),pJ(this,t,arguments)}return yJ(t,e),hJ(t,[{key:"getTickLineCoord",value:function(n){var i=this.props,a=i.cx,o=i.cy,l=i.radius,c=i.orientation,u=i.tickSize,d=u||8,f=Je(a,o,l,n.coordinate),h=Je(a,o,l+(c==="inner"?-1:1)*d,n.coordinate);return{x1:f.x,y1:f.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(n){var i=this.props.orientation,a=Math.cos(-n.coordinate*xJ),o;return a>b1?o=i==="outer"?"start":"end":a<-b1?o=i==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var n=this.props,i=n.cx,a=n.cy,o=n.radius,l=n.axisLine,c=n.axisLineType,u=Ii(Ii({},Ae(this.props,!1)),{},{fill:"none"},Ae(l,!1));if(c==="circle")return z.createElement(hv,Wi({className:"recharts-polar-angle-axis-line"},u,{cx:i,cy:a,r:o}));var d=this.props.ticks,f=d.map(function(h){return Je(i,a,o,h.coordinate)});return z.createElement(IY,Wi({className:"recharts-polar-angle-axis-line"},u,{points:f}))}},{key:"renderTicks",value:function(){var n=this,i=this.props,a=i.ticks,o=i.tick,l=i.tickLine,c=i.tickFormatter,u=i.stroke,d=Ae(this.props,!1),f=Ae(o,!1),h=Ii(Ii({},d),{},{fill:"none"},Ae(l,!1)),p=a.map(function(y,v){var m=n.getTickLineCoord(y),x=n.getTickTextAnchor(y),b=Ii(Ii(Ii({textAnchor:x},d),{},{stroke:"none",fill:u},f),{},{index:v,payload:y,x:m.x2,y:m.y2});return z.createElement(ut,Wi({className:Re("recharts-polar-angle-axis-tick",oP(o)),key:"tick-".concat(y.coordinate)},Cf(n.props,y,v)),l&&z.createElement("line",Wi({className:"recharts-polar-angle-axis-tick-line"},h,m)),o&&t.renderTickItem(o,b,c?c(y.value,v):y.value))});return z.createElement(ut,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,i=n.ticks,a=n.radius,o=n.axisLine;return a<=0||!i||!i.length?null:z.createElement(ut,{className:Re("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,i,a){var o;return z.isValidElement(n)?o=z.cloneElement(n,i):Oe(n)?o=n(i):o=z.createElement(xs,Wi({},i,{className:"recharts-polar-angle-axis-tick-value"}),a),o}}])}(N.PureComponent);Qf(Zf,"displayName","PolarAngleAxis");Qf(Zf,"axisType","angleAxis");Qf(Zf,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var bJ=IA,wJ=bJ(Object.getPrototypeOf,Object),_J=wJ,jJ=zn,SJ=_J,NJ=Wn,EJ="[object Object]",AJ=Function.prototype,PJ=Object.prototype,NP=AJ.toString,OJ=PJ.hasOwnProperty,CJ=NP.call(Object);function TJ(e){if(!NJ(e)||jJ(e)!=EJ)return!1;var t=SJ(e);if(t===null)return!0;var r=OJ.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&NP.call(r)==CJ}var kJ=TJ;const $J=He(kJ);var IJ=zn,MJ=Wn,RJ="[object Boolean]";function DJ(e){return e===!0||e===!1||MJ(e)&&IJ(e)==RJ}var LJ=DJ;const BJ=He(LJ);function Gl(e){"@babel/helpers - typeof";return Gl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gl(e)}function Rd(){return Rd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rd.apply(this,arguments)}function FJ(e,t){return WJ(e)||zJ(e,t)||UJ(e,t)||qJ()}function qJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UJ(e,t){if(e){if(typeof e=="string")return w1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w1(e,t)}}function w1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function zJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function WJ(e){if(Array.isArray(e))return e}function _1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function j1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_1(Object(r),!0).forEach(function(n){HJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HJ(e,t,r){return t=VJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VJ(e){var t=GJ(e,"string");return Gl(t)=="symbol"?t:t+""}function GJ(e,t){if(Gl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Gl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S1=function(t,r,n,i,a){var o=n-i,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-o/2,",").concat(r+a),l+="L ".concat(t+n-o/2-i,",").concat(r+a),l+="L ".concat(t,",").concat(r," Z"),l},KJ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},XJ=function(t){var r=j1(j1({},KJ),t),n=N.useRef(),i=N.useState(-1),a=FJ(i,2),o=a[0],l=a[1];N.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var g=n.current.getTotalLength();g&&l(g)}catch{}},[]);var c=r.x,u=r.y,d=r.upperWidth,f=r.lowerWidth,h=r.height,p=r.className,y=r.animationEasing,v=r.animationDuration,m=r.animationBegin,x=r.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||f!==+f||h!==+h||d===0&&f===0||h===0)return null;var b=Re("recharts-trapezoid",p);return x?z.createElement(bi,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:h,x:c,y:u},to:{upperWidth:d,lowerWidth:f,height:h,x:c,y:u},duration:v,animationEasing:y,isActive:x},function(g){var S=g.upperWidth,w=g.lowerWidth,j=g.height,_=g.x,E=g.y;return z.createElement(bi,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:v,easing:y},z.createElement("path",Rd({},Ae(r,!0),{className:b,d:S1(_,E,S,w,j),ref:n})))}):z.createElement("g",null,z.createElement("path",Rd({},Ae(r,!0),{className:b,d:S1(c,u,d,f,h)})))},YJ=["option","shapeType","propTransformer","activeClassName","isActive"];function Kl(e){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kl(e)}function JJ(e,t){if(e==null)return{};var r=QJ(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function QJ(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function N1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N1(Object(r),!0).forEach(function(n){ZJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZJ(e,t,r){return t=eQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eQ(e){var t=tQ(e,"string");return Kl(t)=="symbol"?t:t+""}function tQ(e,t){if(Kl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Kl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rQ(e,t){return Dd(Dd({},t),e)}function nQ(e,t){return e==="symbols"}function E1(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return z.createElement(fv,r);case"trapezoid":return z.createElement(XJ,r);case"sector":return z.createElement(uP,r);case"symbols":if(nQ(t))return z.createElement(A0,r);break;default:return null}}function iQ(e){return N.isValidElement(e)?e.props:e}function aQ(e){var t=e.option,r=e.shapeType,n=e.propTransformer,i=n===void 0?rQ:n,a=e.activeClassName,o=a===void 0?"recharts-active-shape":a,l=e.isActive,c=JJ(e,YJ),u;if(N.isValidElement(t))u=N.cloneElement(t,Dd(Dd({},c),iQ(t)));else if(Oe(t))u=t(c);else if($J(t)&&!BJ(t)){var d=i(t,c);u=z.createElement(E1,{shapeType:r,elementProps:d})}else{var f=c;u=z.createElement(E1,{shapeType:r,elementProps:f})}return l?z.createElement(ut,{className:o},u):u}function eh(e,t){return t!=null&&"trapezoids"in e.props}function th(e,t){return t!=null&&"sectors"in e.props}function Xl(e,t){return t!=null&&"points"in e.props}function sQ(e,t){var r,n,i=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,a=e.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||e.y===t.y;return i&&a}function oQ(e,t){var r=e.endAngle===t.endAngle,n=e.startAngle===t.startAngle;return r&&n}function lQ(e,t){var r=e.x===t.x,n=e.y===t.y,i=e.z===t.z;return r&&n&&i}function cQ(e,t){var r;return eh(e,t)?r=sQ:th(e,t)?r=oQ:Xl(e,t)&&(r=lQ),r}function uQ(e,t){var r;return eh(e,t)?r="trapezoids":th(e,t)?r="sectors":Xl(e,t)&&(r="points"),r}function dQ(e,t){if(eh(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(th(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Xl(e,t)?t.payload:{}}function fQ(e){var t=e.activeTooltipItem,r=e.graphicalItem,n=e.itemData,i=uQ(r,t),a=dQ(r,t),o=n.filter(function(c,u){var d=ov(a,c),f=r.props[i].filter(function(y){var v=cQ(r,t);return v(y,t)}),h=r.props[i].indexOf(f[f.length-1]),p=u===h;return d&&p}),l=n.indexOf(o[o.length-1]);return l}var ju;function Ps(e){"@babel/helpers - typeof";return Ps=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ps(e)}function Ha(){return Ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ha.apply(this,arguments)}function A1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ke(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A1(Object(r),!0).forEach(function(n){Cr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function P1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,AP(n.key),n)}}function pQ(e,t,r){return t&&P1(e.prototype,t),r&&P1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function mQ(e,t,r){return t=Ld(t),gQ(e,EP()?Reflect.construct(t,r||[],Ld(e).constructor):t.apply(e,r))}function gQ(e,t){if(t&&(Ps(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yQ(e)}function yQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function EP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(EP=function(){return!!e})()}function Ld(e){return Ld=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ld(e)}function vQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vg(e,t)}function Vg(e,t){return Vg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Vg(e,t)}function Cr(e,t,r){return t=AP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AP(e){var t=xQ(e,"string");return Ps(t)=="symbol"?t:t+""}function xQ(e,t){if(Ps(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ps(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Vn=function(e){function t(r){var n;return hQ(this,t),n=mQ(this,t,[r]),Cr(n,"pieRef",null),Cr(n,"sectorRefs",[]),Cr(n,"id",Of("recharts-pie-")),Cr(n,"handleAnimationEnd",function(){var i=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Oe(i)&&i()}),Cr(n,"handleAnimationStart",function(){var i=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Oe(i)&&i()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return vQ(t,e),pQ(t,[{key:"isActiveIndex",value:function(n){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(n)!==-1:n===i}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var a=this.props,o=a.label,l=a.labelLine,c=a.dataKey,u=a.valueKey,d=Ae(this.props,!1),f=Ae(o,!1),h=Ae(l,!1),p=o&&o.offsetRadius||20,y=n.map(function(v,m){var x=(v.startAngle+v.endAngle)/2,b=Je(v.cx,v.cy,v.outerRadius+p,x),g=Ke(Ke(Ke(Ke({},d),v),{},{stroke:"none"},f),{},{index:m,textAnchor:t.getTextAnchor(b.x,v.cx)},b),S=Ke(Ke(Ke(Ke({},d),v),{},{fill:"none",stroke:v.fill},h),{},{index:m,points:[Je(v.cx,v.cy,v.outerRadius,x),b]}),w=c;return ke(c)&&ke(u)?w="value":ke(c)&&(w=u),z.createElement(ut,{key:"label-".concat(v.startAngle,"-").concat(v.endAngle,"-").concat(v.midAngle,"-").concat(m)},l&&t.renderLabelLineItem(l,S,"line"),t.renderLabelItem(o,g,gr(v,w)))});return z.createElement(ut,{className:"recharts-pie-labels"},y)}},{key:"renderSectorsStatically",value:function(n){var i=this,a=this.props,o=a.activeShape,l=a.blendStroke,c=a.inactiveShape;return n.map(function(u,d){if((u==null?void 0:u.startAngle)===0&&(u==null?void 0:u.endAngle)===0&&n.length!==1)return null;var f=i.isActiveIndex(d),h=c&&i.hasActiveIndex()?c:null,p=f?o:h,y=Ke(Ke({},u),{},{stroke:l?u.fill:u.stroke,tabIndex:-1});return z.createElement(ut,Ha({ref:function(m){m&&!i.sectorRefs.includes(m)&&i.sectorRefs.push(m)},tabIndex:-1,className:"recharts-pie-sector"},Cf(i.props,u,d),{key:"sector-".concat(u==null?void 0:u.startAngle,"-").concat(u==null?void 0:u.endAngle,"-").concat(u.midAngle,"-").concat(d)}),z.createElement(aQ,Ha({option:p,isActive:f,shapeType:"sector"},y)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,i=this.props,a=i.sectors,o=i.isAnimationActive,l=i.animationBegin,c=i.animationDuration,u=i.animationEasing,d=i.animationId,f=this.state,h=f.prevSectors,p=f.prevIsAnimationActive;return z.createElement(bi,{begin:l,duration:c,isActive:o,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(y){var v=y.t,m=[],x=a&&a[0],b=x.startAngle;return a.forEach(function(g,S){var w=h&&h[S],j=S>0?en(g,"paddingAngle",0):0;if(w){var _=bb(w.endAngle-w.startAngle,g.endAngle-g.startAngle),E=Ke(Ke({},g),{},{startAngle:b+j,endAngle:b+_(v)+j});m.push(E),b=E.endAngle}else{var A=g.endAngle,P=g.startAngle,T=bb(0,A-P),M=T(v),O=Ke(Ke({},g),{},{startAngle:b+j,endAngle:b+M+j});m.push(O),b=O.endAngle}}),z.createElement(ut,null,n.renderSectorsStatically(m))})}},{key:"attachKeyboardHandlers",value:function(n){var i=this;n.onkeydown=function(a){if(!a.altKey)switch(a.key){case"ArrowLeft":{var o=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[o].focus(),i.setState({sectorToFocus:o});break}case"ArrowRight":{var l=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[l].focus(),i.setState({sectorToFocus:l});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,i=n.sectors,a=n.isAnimationActive,o=this.state.prevSectors;return a&&i&&i.length&&(!o||!ov(o,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,i=this.props,a=i.hide,o=i.sectors,l=i.className,c=i.label,u=i.cx,d=i.cy,f=i.innerRadius,h=i.outerRadius,p=i.isAnimationActive,y=this.state.isAnimationFinished;if(a||!o||!o.length||!ce(u)||!ce(d)||!ce(f)||!ce(h))return null;var v=Re("recharts-pie",l);return z.createElement(ut,{tabIndex:this.props.rootTabIndex,className:v,ref:function(x){n.pieRef=x}},this.renderSectors(),c&&this.renderLabels(o),Rt.renderCallByParent(this.props,null,!1),(!p||y)&&ia.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,i){return i.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==i.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:n.sectors!==i.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,i){return n>i?"start":n<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,i,a){if(z.isValidElement(n))return z.cloneElement(n,i);if(Oe(n))return n(i);var o=Re("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return z.createElement(Tg,Ha({},i,{key:a,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(n,i,a){if(z.isValidElement(n))return z.cloneElement(n,i);var o=a;if(Oe(n)&&(o=n(i),z.isValidElement(o)))return o;var l=Re("recharts-pie-label-text",typeof n!="boolean"&&!Oe(n)?n.className:"");return z.createElement(xs,Ha({},i,{alignmentBaseline:"middle",className:l}),o)}}])}(N.PureComponent);ju=Vn;Cr(Vn,"displayName","Pie");Cr(Vn,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Lf.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Cr(Vn,"parseDeltaAngle",function(e,t){var r=$r(t-e),n=Math.min(Math.abs(t-e),360);return r*n});Cr(Vn,"getRealPieData",function(e){var t=e.data,r=e.children,n=Ae(e,!1),i=hn(r,L0);return t&&t.length?t.map(function(a,o){return Ke(Ke(Ke({payload:a},n),a),i&&i[o]&&i[o].props)}):i&&i.length?i.map(function(a){return Ke(Ke({},n),a.props)}):[]});Cr(Vn,"parseCoordinateOfPie",function(e,t){var r=t.top,n=t.left,i=t.width,a=t.height,o=sP(i,a),l=n+nr(e.cx,i,i/2),c=r+nr(e.cy,a,a/2),u=nr(e.innerRadius,o,0),d=nr(e.outerRadius,o,o*.8),f=e.maxRadius||Math.sqrt(i*i+a*a)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:d,maxRadius:f}});Cr(Vn,"getComposedData",function(e){var t=e.item,r=e.offset,n=t.type.defaultProps!==void 0?Ke(Ke({},t.type.defaultProps),t.props):t.props,i=ju.getRealPieData(n);if(!i||!i.length)return null;var a=n.cornerRadius,o=n.startAngle,l=n.endAngle,c=n.paddingAngle,u=n.dataKey,d=n.nameKey,f=n.valueKey,h=n.tooltipType,p=Math.abs(n.minAngle),y=ju.parseCoordinateOfPie(n,r),v=ju.parseDeltaAngle(o,l),m=Math.abs(v),x=u;ke(u)&&ke(f)?(kn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x="value"):ke(u)&&(kn(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x=f);var b=i.filter(function(E){return gr(E,x,0)!==0}).length,g=(m>=360?b:b-1)*c,S=m-b*p-g,w=i.reduce(function(E,A){var P=gr(A,x,0);return E+(ce(P)?P:0)},0),j;if(w>0){var _;j=i.map(function(E,A){var P=gr(E,x,0),T=gr(E,d,A),M=(ce(P)?P:0)/w,O;A?O=_.endAngle+$r(v)*c*(P!==0?1:0):O=o;var k=O+$r(v)*((P!==0?p:0)+M*S),F=(O+k)/2,I=(y.innerRadius+y.outerRadius)/2,W=[{name:T,value:P,payload:E,dataKey:x,type:h}],R=Je(y.cx,y.cy,I,F);return _=Ke(Ke(Ke({percent:M,cornerRadius:a,name:T,tooltipPayload:W,midAngle:F,middleRadius:I,tooltipPosition:R},E),y),{},{value:gr(E,x),startAngle:O,endAngle:k,payload:E,paddingAngle:$r(v)*c}),_})}return Ke(Ke({},y),{},{sectors:j,data:i})});var bQ=Math.ceil,wQ=Math.max;function _Q(e,t,r,n){for(var i=-1,a=wQ(bQ((t-e)/(r||1)),0),o=Array(a);a--;)o[n?a:++i]=e,e+=r;return o}var jQ=_Q,SQ=QA,O1=1/0,NQ=17976931348623157e292;function EQ(e){if(!e)return e===0?e:0;if(e=SQ(e),e===O1||e===-O1){var t=e<0?-1:1;return t*NQ}return e===e?e:0}var AQ=EQ,PQ=jQ,OQ=Df,xp=AQ;function CQ(e){return function(t,r,n){return n&&typeof n!="number"&&OQ(t,r,n)&&(r=n=void 0),t=xp(t),r===void 0?(r=t,t=0):r=xp(r),n=n===void 0?t<r?1:-1:xp(n),PQ(t,r,n,e)}}var TQ=CQ,kQ=TQ,$Q=kQ(),IQ=$Q;const Bd=He(IQ);function Yl(e){"@babel/helpers - typeof";return Yl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yl(e)}function C1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function T1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C1(Object(r),!0).forEach(function(n){PP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PP(e,t,r){return t=MQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MQ(e){var t=RQ(e,"string");return Yl(t)=="symbol"?t:t+""}function RQ(e,t){if(Yl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Yl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DQ=["Webkit","Moz","O","ms"],LQ=function(t,r){var n=t.replace(/(\w)/,function(a){return a.toUpperCase()}),i=DQ.reduce(function(a,o){return T1(T1({},a),{},PP({},o+n,r))},{});return i[t]=r,i};function Os(e){"@babel/helpers - typeof";return Os=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Os(e)}function Fd(){return Fd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fd.apply(this,arguments)}function k1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k1(Object(r),!0).forEach(function(n){dr(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BQ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,CP(n.key),n)}}function FQ(e,t,r){return t&&$1(e.prototype,t),r&&$1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function qQ(e,t,r){return t=qd(t),UQ(e,OP()?Reflect.construct(t,r||[],qd(e).constructor):t.apply(e,r))}function UQ(e,t){if(t&&(Os(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zQ(e)}function zQ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OP=function(){return!!e})()}function qd(e){return qd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},qd(e)}function WQ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gg(e,t)}function Gg(e,t){return Gg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Gg(e,t)}function dr(e,t,r){return t=CP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CP(e){var t=HQ(e,"string");return Os(t)=="symbol"?t:t+""}function HQ(e,t){if(Os(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Os(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var VQ=function(t){var r=t.data,n=t.startIndex,i=t.endIndex,a=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,u=zo().domain(Bd(0,c)).range([a,a+o-l]),d=u.domain().map(function(f){return u(f)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(n),endX:u(i),scale:u,scaleValues:d}},I1=function(t){return t.changedTouches&&!!t.changedTouches.length},Cs=function(e){function t(r){var n;return BQ(this,t),n=qQ(this,t,[r]),dr(n,"handleDrag",function(i){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(i):n.state.isSlideMoving&&n.handleSlideDrag(i)}),dr(n,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&n.handleDrag(i.changedTouches[0])}),dr(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=n.props,a=i.endIndex,o=i.onDragEnd,l=i.startIndex;o==null||o({endIndex:a,startIndex:l})}),n.detachDragEndListener()}),dr(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),dr(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),dr(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),dr(n,"handleSlideDragStart",function(i){var a=I1(i)?i.changedTouches[0]:i;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:a.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return WQ(t,e),FQ(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var i=n.startX,a=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,f=Math.min(i,a),h=Math.max(i,a),p=t.getIndexInRange(o,f),y=t.getIndexInRange(o,h);return{startIndex:p-p%c,endIndex:y===d?d:y-y%c}}},{key:"getTextOfTick",value:function(n){var i=this.props,a=i.data,o=i.tickFormatter,l=i.dataKey,c=gr(a[n],l,n);return Oe(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var i=this.state,a=i.slideMoveStartX,o=i.startX,l=i.endX,c=this.props,u=c.x,d=c.width,f=c.travellerWidth,h=c.startIndex,p=c.endIndex,y=c.onChange,v=n.pageX-a;v>0?v=Math.min(v,u+d-f-l,u+d-f-o):v<0&&(v=Math.max(v,u-o,u-l));var m=this.getIndex({startX:o+v,endX:l+v});(m.startIndex!==h||m.endIndex!==p)&&y&&y(m),this.setState({startX:o+v,endX:l+v,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,i){var a=I1(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:a.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var i=this.state,a=i.brushMoveStartX,o=i.movingTravellerId,l=i.endX,c=i.startX,u=this.state[o],d=this.props,f=d.x,h=d.width,p=d.travellerWidth,y=d.onChange,v=d.gap,m=d.data,x={startX:this.state.startX,endX:this.state.endX},b=n.pageX-a;b>0?b=Math.min(b,f+h-p-u):b<0&&(b=Math.max(b,f-u)),x[o]=u+b;var g=this.getIndex(x),S=g.startIndex,w=g.endIndex,j=function(){var E=m.length-1;return o==="startX"&&(l>c?S%v===0:w%v===0)||l<c&&w===E||o==="endX"&&(l>c?w%v===0:S%v===0)||l>c&&w===E};this.setState(dr(dr({},o,u+b),"brushMoveStartX",n.pageX),function(){y&&j()&&y(g)})}},{key:"handleTravellerMoveKeyboard",value:function(n,i){var a=this,o=this.state,l=o.scaleValues,c=o.startX,u=o.endX,d=this.state[i],f=l.indexOf(d);if(f!==-1){var h=f+n;if(!(h===-1||h>=l.length)){var p=l[h];i==="startX"&&p>=u||i==="endX"&&p<=c||this.setState(dr({},i,p),function(){a.props.onChange(a.getIndex({startX:a.state.startX,endX:a.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,i=n.x,a=n.y,o=n.width,l=n.height,c=n.fill,u=n.stroke;return z.createElement("rect",{stroke:u,fill:c,x:i,y:a,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,i=n.x,a=n.y,o=n.width,l=n.height,c=n.data,u=n.children,d=n.padding,f=N.Children.only(u);return f?z.cloneElement(f,{x:i,y:a,width:o,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,i){var a,o,l=this,c=this.props,u=c.y,d=c.travellerWidth,f=c.height,h=c.traveller,p=c.ariaLabel,y=c.data,v=c.startIndex,m=c.endIndex,x=Math.max(n,this.props.x),b=bp(bp({},Ae(this.props,!1)),{},{x,y:u,width:d,height:f}),g=p||"Min value: ".concat((a=y[v])===null||a===void 0?void 0:a.name,", Max value: ").concat((o=y[m])===null||o===void 0?void 0:o.name);return z.createElement(ut,{tabIndex:0,role:"slider","aria-label":g,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(w){["ArrowLeft","ArrowRight"].includes(w.key)&&(w.preventDefault(),w.stopPropagation(),l.handleTravellerMoveKeyboard(w.key==="ArrowRight"?1:-1,i))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(h,b))}},{key:"renderSlide",value:function(n,i){var a=this.props,o=a.y,l=a.height,c=a.stroke,u=a.travellerWidth,d=Math.min(n,i)+u,f=Math.max(Math.abs(i-n)-u,0);return z.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:o,width:f,height:l})}},{key:"renderText",value:function(){var n=this.props,i=n.startIndex,a=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,u=n.stroke,d=this.state,f=d.startX,h=d.endX,p=5,y={pointerEvents:"none",fill:u};return z.createElement(ut,{className:"recharts-brush-texts"},z.createElement(xs,Fd({textAnchor:"end",verticalAnchor:"middle",x:Math.min(f,h)-p,y:o+l/2},y),this.getTextOfTick(i)),z.createElement(xs,Fd({textAnchor:"start",verticalAnchor:"middle",x:Math.max(f,h)+c+p,y:o+l/2},y),this.getTextOfTick(a)))}},{key:"render",value:function(){var n=this.props,i=n.data,a=n.className,o=n.children,l=n.x,c=n.y,u=n.width,d=n.height,f=n.alwaysShowText,h=this.state,p=h.startX,y=h.endX,v=h.isTextActive,m=h.isSlideMoving,x=h.isTravellerMoving,b=h.isTravellerFocused;if(!i||!i.length||!ce(l)||!ce(c)||!ce(u)||!ce(d)||u<=0||d<=0)return null;var g=Re("recharts-brush",a),S=z.Children.count(o)===1,w=LQ("userSelect","none");return z.createElement(ut,{className:g,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:w},this.renderBackground(),S&&this.renderPanorama(),this.renderSlide(p,y),this.renderTravellerLayer(p,"startX"),this.renderTravellerLayer(y,"endX"),(v||m||x||b||f)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var i=n.x,a=n.y,o=n.width,l=n.height,c=n.stroke,u=Math.floor(a+l/2)-1;return z.createElement(z.Fragment,null,z.createElement("rect",{x:i,y:a,width:o,height:l,fill:c,stroke:"none"}),z.createElement("line",{x1:i+1,y1:u,x2:i+o-1,y2:u,fill:"none",stroke:"#fff"}),z.createElement("line",{x1:i+1,y1:u+2,x2:i+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,i){var a;return z.isValidElement(n)?a=z.cloneElement(n,i):Oe(n)?a=n(i):a=t.renderDefaultTraveller(i),a}},{key:"getDerivedStateFromProps",value:function(n,i){var a=n.data,o=n.width,l=n.x,c=n.travellerWidth,u=n.updateId,d=n.startIndex,f=n.endIndex;if(a!==i.prevData||u!==i.prevUpdateId)return bp({prevData:a,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o},a&&a.length?VQ({data:a,width:o,x:l,travellerWidth:c,startIndex:d,endIndex:f}):{scale:null,scaleValues:null});if(i.scale&&(o!==i.prevWidth||l!==i.prevX||c!==i.prevTravellerWidth)){i.scale.range([l,l+o-c]);var h=i.scale.domain().map(function(p){return i.scale(p)});return{prevData:a,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o,startX:i.scale(n.startIndex),endX:i.scale(n.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(n,i){for(var a=n.length,o=0,l=a-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>i?l=c:o=c}return i>=n[l]?l:o}}])}(N.PureComponent);dr(Cs,"displayName","Brush");dr(Cs,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var GQ=M0;function KQ(e,t){var r;return GQ(e,function(n,i,a){return r=t(n,i,a),!r}),!!r}var XQ=KQ,YQ=EA,JQ=Ei,QQ=XQ,ZQ=ur,eZ=Df;function tZ(e,t,r){var n=ZQ(e)?YQ:QQ;return r&&eZ(e,t,r)&&(t=void 0),n(e,JQ(t))}var rZ=tZ;const nZ=He(rZ);var mn=function(t,r){var n=t.alwaysShow,i=t.ifOverflow;return n&&(i="extendDomain"),i===r},M1=GA;function iZ(e,t,r){t=="__proto__"&&M1?M1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var aZ=iZ,sZ=aZ,oZ=HA,lZ=Ei;function cZ(e,t){var r={};return t=lZ(t),oZ(e,function(n,i,a){sZ(r,i,t(n,i,a))}),r}var uZ=cZ;const dZ=He(uZ);function fZ(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var hZ=fZ,pZ=M0;function mZ(e,t){var r=!0;return pZ(e,function(n,i,a){return r=!!t(n,i,a),r}),r}var gZ=mZ,yZ=hZ,vZ=gZ,xZ=Ei,bZ=ur,wZ=Df;function _Z(e,t,r){var n=bZ(e)?yZ:vZ;return r&&wZ(e,t,r)&&(t=void 0),n(e,xZ(t))}var jZ=_Z;const SZ=He(jZ);function Jl(e){"@babel/helpers - typeof";return Jl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jl(e)}function NZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R1(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,TP(n.key),n)}}function EZ(e,t,r){return t&&R1(e.prototype,t),r&&R1(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function D1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D1(Object(r),!0).forEach(function(n){pv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pv(e,t,r){return t=TP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TP(e){var t=AZ(e,"string");return Jl(t)=="symbol"?t:t+""}function AZ(e,t){if(Jl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Jl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kP=function(t,r){var n=t.x,i=t.y,a=r.x,o=r.y;return{x:Math.min(n,a),y:Math.min(i,o),width:Math.abs(a-n),height:Math.abs(o-i)}},PZ=function(t){var r=t.x1,n=t.y1,i=t.x2,a=t.y2;return kP({x:r,y:n},{x:i,y:a})},$P=function(){function e(t){NZ(this,e),this.scale=t}return EZ(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.bandAware,a=n.position;if(r!==void 0){if(a)switch(a){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(i){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),i=n[0],a=n[n.length-1];return i<=a?r>=i&&r<=a:r>=a&&r<=i}}],[{key:"create",value:function(r){return new e(r)}}])}();pv($P,"EPS",1e-4);var mv=function(t){var r=Object.keys(t).reduce(function(n,i){return iu(iu({},n),{},pv({},i,$P.create(t[i])))},{});return iu(iu({},r),{},{apply:function(i){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=a.bandAware,l=a.position;return dZ(i,function(c,u){return r[u].apply(c,{bandAware:o,position:l})})},isInRange:function(i){return SZ(i,function(a,o){return r[o].isInRange(a)})}})},OZ=aD(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),IP=N.createContext(void 0),MP=N.createContext(void 0),RP=N.createContext(void 0),CZ=N.createContext({}),DP=N.createContext(void 0),TZ=N.createContext(0),kZ=N.createContext(0),L1=function(t){var r=t.state,n=r.xAxisMap,i=r.yAxisMap,a=r.offset,o=t.clipPathId,l=t.children,c=t.width,u=t.height,d=OZ(a);return z.createElement(IP.Provider,{value:n},z.createElement(MP.Provider,{value:i},z.createElement(CZ.Provider,{value:a},z.createElement(RP.Provider,{value:d},z.createElement(DP.Provider,{value:o},z.createElement(TZ.Provider,{value:u},z.createElement(kZ.Provider,{value:c},l)))))))},$Z=function(){return N.useContext(DP)},IZ=function(t){var r=N.useContext(IP);r==null&&js();var n=r[t];return n==null&&js(),n},MZ=function(t){var r=N.useContext(MP);r==null&&js();var n=r[t];return n==null&&js(),n},RZ=function(){var t=N.useContext(RP);return t};function Ts(e){"@babel/helpers - typeof";return Ts=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ts(e)}function DZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,BP(n.key),n)}}function BZ(e,t,r){return t&&LZ(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function FZ(e,t,r){return t=Ud(t),qZ(e,LP()?Reflect.construct(t,r||[],Ud(e).constructor):t.apply(e,r))}function qZ(e,t){if(t&&(Ts(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return UZ(e)}function UZ(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LP=function(){return!!e})()}function Ud(e){return Ud=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ud(e)}function zZ(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Kg(e,t)}function Kg(e,t){return Kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Kg(e,t)}function B1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function F1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B1(Object(r),!0).forEach(function(n){gv(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gv(e,t,r){return t=BP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BP(e){var t=WZ(e,"string");return Ts(t)=="symbol"?t:t+""}function WZ(e,t){if(Ts(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ts(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function HZ(e,t){return XZ(e)||KZ(e,t)||GZ(e,t)||VZ()}function VZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GZ(e,t){if(e){if(typeof e=="string")return q1(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return q1(e,t)}}function q1(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function KZ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function XZ(e){if(Array.isArray(e))return e}function Xg(){return Xg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xg.apply(this,arguments)}var YZ=function(t,r){var n;return z.isValidElement(t)?n=z.cloneElement(t,r):Oe(t)?n=t(r):n=z.createElement("line",Xg({},r,{className:"recharts-reference-line-line"})),n},JZ=function(t,r,n,i,a,o,l,c,u){var d=a.x,f=a.y,h=a.width,p=a.height;if(n){var y=u.y,v=t.y.apply(y,{position:o});if(mn(u,"discard")&&!t.y.isInRange(v))return null;var m=[{x:d+h,y:v},{x:d,y:v}];return c==="left"?m.reverse():m}if(r){var x=u.x,b=t.x.apply(x,{position:o});if(mn(u,"discard")&&!t.x.isInRange(b))return null;var g=[{x:b,y:f+p},{x:b,y:f}];return l==="top"?g.reverse():g}if(i){var S=u.segment,w=S.map(function(j){return t.apply(j,{position:o})});return mn(u,"discard")&&nZ(w,function(j){return!t.isInRange(j)})?null:w}return null};function QZ(e){var t=e.x,r=e.y,n=e.segment,i=e.xAxisId,a=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,u=$Z(),d=IZ(i),f=MZ(a),h=RZ();if(!u||!h)return null;kn(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var p=mv({x:d.scale,y:f.scale}),y=At(t),v=At(r),m=n&&n.length===2,x=JZ(p,y,v,m,h,e.position,d.orientation,f.orientation,e);if(!x)return null;var b=HZ(x,2),g=b[0],S=g.x,w=g.y,j=b[1],_=j.x,E=j.y,A=mn(e,"hidden")?"url(#".concat(u,")"):void 0,P=F1(F1({clipPath:A},Ae(e,!0)),{},{x1:S,y1:w,x2:_,y2:E});return z.createElement(ut,{className:Re("recharts-reference-line",l)},YZ(o,P),Rt.renderCallByParent(e,PZ({x1:S,y1:w,x2:_,y2:E})))}var yv=function(e){function t(){return DZ(this,t),FZ(this,t,arguments)}return zZ(t,e),BZ(t,[{key:"render",value:function(){return z.createElement(QZ,this.props)}}])}(z.Component);gv(yv,"displayName","ReferenceLine");gv(yv,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function Yg(){return Yg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yg.apply(this,arguments)}function ks(e){"@babel/helpers - typeof";return ks=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ks(e)}function U1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function z1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U1(Object(r),!0).forEach(function(n){rh(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZZ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qP(n.key),n)}}function tee(e,t,r){return t&&eee(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function ree(e,t,r){return t=zd(t),nee(e,FP()?Reflect.construct(t,r||[],zd(e).constructor):t.apply(e,r))}function nee(e,t){if(t&&(ks(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iee(e)}function iee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function FP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(FP=function(){return!!e})()}function zd(e){return zd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zd(e)}function aee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jg(e,t)}function Jg(e,t){return Jg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Jg(e,t)}function rh(e,t,r){return t=qP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qP(e){var t=see(e,"string");return ks(t)=="symbol"?t:t+""}function see(e,t){if(ks(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(ks(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var oee=function(t){var r=t.x,n=t.y,i=t.xAxis,a=t.yAxis,o=mv({x:i.scale,y:a.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return mn(t,"discard")&&!o.isInRange(l)?null:l},nh=function(e){function t(){return ZZ(this,t),ree(this,t,arguments)}return aee(t,e),tee(t,[{key:"render",value:function(){var n=this.props,i=n.x,a=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,u=At(i),d=At(a);if(kn(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var f=oee(this.props);if(!f)return null;var h=f.x,p=f.y,y=this.props,v=y.shape,m=y.className,x=mn(this.props,"hidden")?"url(#".concat(c,")"):void 0,b=z1(z1({clipPath:x},Ae(this.props,!0)),{},{cx:h,cy:p});return z.createElement(ut,{className:Re("recharts-reference-dot",m)},t.renderDot(v,b),Rt.renderCallByParent(this.props,{x:h-o,y:p-o,width:2*o,height:2*o}))}}])}(z.Component);rh(nh,"displayName","ReferenceDot");rh(nh,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});rh(nh,"renderDot",function(e,t){var r;return z.isValidElement(e)?r=z.cloneElement(e,t):Oe(e)?r=e(t):r=z.createElement(hv,Yg({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function Qg(){return Qg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Qg.apply(this,arguments)}function $s(e){"@babel/helpers - typeof";return $s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$s(e)}function W1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function H1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W1(Object(r),!0).forEach(function(n){ih(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zP(n.key),n)}}function uee(e,t,r){return t&&cee(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function dee(e,t,r){return t=Wd(t),fee(e,UP()?Reflect.construct(t,r||[],Wd(e).constructor):t.apply(e,r))}function fee(e,t){if(t&&($s(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hee(e)}function hee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function UP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(UP=function(){return!!e})()}function Wd(e){return Wd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Wd(e)}function pee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zg(e,t)}function Zg(e,t){return Zg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Zg(e,t)}function ih(e,t,r){return t=zP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zP(e){var t=mee(e,"string");return $s(t)=="symbol"?t:t+""}function mee(e,t){if($s(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if($s(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var gee=function(t,r,n,i,a){var o=a.x1,l=a.x2,c=a.y1,u=a.y2,d=a.xAxis,f=a.yAxis;if(!d||!f)return null;var h=mv({x:d.scale,y:f.scale}),p={x:t?h.x.apply(o,{position:"start"}):h.x.rangeMin,y:n?h.y.apply(c,{position:"start"}):h.y.rangeMin},y={x:r?h.x.apply(l,{position:"end"}):h.x.rangeMax,y:i?h.y.apply(u,{position:"end"}):h.y.rangeMax};return mn(a,"discard")&&(!h.isInRange(p)||!h.isInRange(y))?null:kP(p,y)},ah=function(e){function t(){return lee(this,t),dee(this,t,arguments)}return pee(t,e),uee(t,[{key:"render",value:function(){var n=this.props,i=n.x1,a=n.x2,o=n.y1,l=n.y2,c=n.className,u=n.alwaysShow,d=n.clipPathId;kn(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=At(i),h=At(a),p=At(o),y=At(l),v=this.props.shape;if(!f&&!h&&!p&&!y&&!v)return null;var m=gee(f,h,p,y,this.props);if(!m&&!v)return null;var x=mn(this.props,"hidden")?"url(#".concat(d,")"):void 0;return z.createElement(ut,{className:Re("recharts-reference-area",c)},t.renderRect(v,H1(H1({clipPath:x},Ae(this.props,!0)),m)),Rt.renderCallByParent(this.props,m))}}])}(z.Component);ih(ah,"displayName","ReferenceArea");ih(ah,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});ih(ah,"renderRect",function(e,t){var r;return z.isValidElement(e)?r=z.cloneElement(e,t):Oe(e)?r=e(t):r=z.createElement(fv,Qg({},t,{className:"recharts-reference-area-rect"})),r});function V1(e){return bee(e)||xee(e)||vee(e)||yee()}function yee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vee(e,t){if(e){if(typeof e=="string")return ey(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ey(e,t)}}function xee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function bee(e){if(Array.isArray(e))return ey(e)}function ey(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ty=function(t,r,n,i,a){var o=hn(t,yv),l=hn(t,nh),c=[].concat(V1(o),V1(l)),u=hn(t,ah),d="".concat(i,"Id"),f=i[0],h=r;if(c.length&&(h=c.reduce(function(v,m){if(m.props[d]===n&&mn(m.props,"extendDomain")&&ce(m.props[f])){var x=m.props[f];return[Math.min(v[0],x),Math.max(v[1],x)]}return v},h)),u.length){var p="".concat(f,"1"),y="".concat(f,"2");h=u.reduce(function(v,m){if(m.props[d]===n&&mn(m.props,"extendDomain")&&ce(m.props[p])&&ce(m.props[y])){var x=m.props[p],b=m.props[y];return[Math.min(v[0],x,b),Math.max(v[1],x,b)]}return v},h)}return a&&a.length&&(h=a.reduce(function(v,m){return ce(m)?[Math.min(v[0],m),Math.max(v[1],m)]:v},h)),h},WP={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function a(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,f||c,h),y=r?r+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],p]:c._events[y].push(p):(c._events[y]=p,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,y=new Array(p);h<p;h++)y[h]=f[h].fn;return y},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,h,p,y){var v=r?r+u:u;if(!this._events[v])return!1;var m=this._events[v],x=arguments.length,b,g;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),x){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,d),!0;case 3:return m.fn.call(m.context,d,f),!0;case 4:return m.fn.call(m.context,d,f,h),!0;case 5:return m.fn.call(m.context,d,f,h,p),!0;case 6:return m.fn.call(m.context,d,f,h,p,y),!0}for(g=1,b=new Array(x-1);g<x;g++)b[g-1]=arguments[g];m.fn.apply(m.context,b)}else{var S=m.length,w;for(g=0;g<S;g++)switch(m[g].once&&this.removeListener(u,m[g].fn,void 0,!0),x){case 1:m[g].fn.call(m[g].context);break;case 2:m[g].fn.call(m[g].context,d);break;case 3:m[g].fn.call(m[g].context,d,f);break;case 4:m[g].fn.call(m[g].context,d,f,h);break;default:if(!b)for(w=1,b=new Array(x-1);w<x;w++)b[w-1]=arguments[w];m[g].fn.apply(m[g].context,b)}}return!0},l.prototype.on=function(u,d,f){return a(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return a(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return o(this,p),this;var y=this._events[p];if(y.fn)y.fn===d&&(!h||y.once)&&(!f||y.context===f)&&o(this,p);else{for(var v=0,m=[],x=y.length;v<x;v++)(y[v].fn!==d||h&&!y[v].once||f&&y[v].context!==f)&&m.push(y[v]);m.length?this._events[p]=m.length===1?m[0]:m:o(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(WP);var wee=WP.exports;const _ee=He(wee);var wp=new _ee,_p="recharts.syncMouseEvents";function Ql(e){"@babel/helpers - typeof";return Ql=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ql(e)}function jee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function See(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,HP(n.key),n)}}function Nee(e,t,r){return t&&See(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function jp(e,t,r){return t=HP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HP(e){var t=Eee(e,"string");return Ql(t)=="symbol"?t:t+""}function Eee(e,t){if(Ql(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Ql(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var Aee=function(){function e(){jee(this,e),jp(this,"activeIndex",0),jp(this,"coordinateList",[]),jp(this,"layout","horizontal")}return Nee(e,[{key:"setDetails",value:function(r){var n,i=r.coordinateList,a=i===void 0?null:i,o=r.container,l=o===void 0?null:o,c=r.layout,u=c===void 0?null:c,d=r.offset,f=d===void 0?null:d,h=r.mouseHandlerCallback,p=h===void 0?null:h;this.coordinateList=(n=a??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=f??this.offset,this.mouseHandlerCallback=p??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),a=i.x,o=i.y,l=i.height,c=this.coordinateList[this.activeIndex].coordinate,u=((r=window)===null||r===void 0?void 0:r.scrollX)||0,d=((n=window)===null||n===void 0?void 0:n.scrollY)||0,f=a+c+u,h=o+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:f,pageY:h})}}}])}();function Pee(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var n=e==null?void 0:e[0],i=e==null?void 0:e[1];if(n&&i&&ce(n)&&ce(i))return!0}return!1}function Oee(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function VP(e){var t=e.cx,r=e.cy,n=e.radius,i=e.startAngle,a=e.endAngle,o=Je(t,r,n,i),l=Je(t,r,n,a);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:a}}function Cee(e,t,r){var n,i,a,o;if(e==="horizontal")n=t.x,a=n,i=r.top,o=r.top+r.height;else if(e==="vertical")i=t.y,o=i,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,f=t.angle,h=Je(l,c,u,f),p=Je(l,c,d,f);n=h.x,i=h.y,a=p.x,o=p.y}else return VP(t);return[{x:n,y:i},{x:a,y:o}]}function Zl(e){"@babel/helpers - typeof";return Zl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zl(e)}function G1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function au(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G1(Object(r),!0).forEach(function(n){Tee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tee(e,t,r){return t=kee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kee(e){var t=$ee(e,"string");return Zl(t)=="symbol"?t:t+""}function $ee(e,t){if(Zl(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Zl(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iee(e){var t,r,n=e.element,i=e.tooltipEventType,a=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,f=e.layout,h=e.chartName,p=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!p||!a||!o||h!=="ScatterChart"&&i!=="axis")return null;var y,v=Tg;if(h==="ScatterChart")y=o,v=zY;else if(h==="BarChart")y=Oee(f,o,c,d),v=fv;else if(f==="radial"){var m=VP(o),x=m.cx,b=m.cy,g=m.radius,S=m.startAngle,w=m.endAngle;y={cx:x,cy:b,startAngle:S,endAngle:w,innerRadius:g,outerRadius:g},v=uP}else y={points:Cee(f,o,c)},v=Tg;var j=au(au(au(au({stroke:"#ccc",pointerEvents:"none"},c),y),Ae(p,!1)),{},{payload:l,payloadIndex:u,className:Re("recharts-tooltip-cursor",p.className)});return N.isValidElement(p)?N.cloneElement(p,j):N.createElement(v,j)}var Mee=["item"],Ree=["children","className","width","height","style","compact","title","desc"];function Is(e){"@babel/helpers - typeof";return Is=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Is(e)}function Va(){return Va=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Va.apply(this,arguments)}function K1(e,t){return Bee(e)||Lee(e,t)||KP(e,t)||Dee()}function Dee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lee(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,o,l=[],c=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function Bee(e){if(Array.isArray(e))return e}function X1(e,t){if(e==null)return{};var r=Fee(e,t),n,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function Fee(e,t){if(e==null)return{};var r={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){if(t.indexOf(n)>=0)continue;r[n]=e[n]}return r}function qee(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,XP(n.key),n)}}function zee(e,t,r){return t&&Uee(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wee(e,t,r){return t=Hd(t),Hee(e,GP()?Reflect.construct(t,r||[],Hd(e).constructor):t.apply(e,r))}function Hee(e,t){if(t&&(Is(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vee(e)}function Vee(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GP(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GP=function(){return!!e})()}function Hd(e){return Hd=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hd(e)}function Gee(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ry(e,t)}function ry(e,t){return ry=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ry(e,t)}function Ms(e){return Yee(e)||Xee(e)||KP(e)||Kee()}function Kee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KP(e,t){if(e){if(typeof e=="string")return ny(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ny(e,t)}}function Xee(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Yee(e){if(Array.isArray(e))return ny(e)}function ny(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Y1(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y1(Object(r),!0).forEach(function(n){be(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y1(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function be(e,t,r){return t=XP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XP(e){var t=Jee(e,"string");return Is(t)=="symbol"?t:t+""}function Jee(e,t){if(Is(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Is(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qee={xAxis:["bottom","top"],yAxis:["left","right"]},Zee={width:"100%",height:"100%"},YP={x:0,y:0};function su(e){return e}var ete=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},tte=function(t,r,n,i){var a=r.find(function(d){return d&&d.index===n});if(a){if(t==="horizontal")return{x:a.coordinate,y:i.y};if(t==="vertical")return{x:i.x,y:a.coordinate};if(t==="centric"){var o=a.coordinate,l=i.radius;return J(J(J({},i),Je(i.cx,i.cy,l,o)),{},{angle:o,radius:l})}var c=a.coordinate,u=i.angle;return J(J(J({},i),Je(i.cx,i.cy,c,u)),{},{angle:u,radius:c})}return YP},sh=function(t,r){var n=r.graphicalItems,i=r.dataStartIndex,a=r.dataEndIndex,o=(n??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(Ms(l),Ms(u)):l},[]);return o.length>0?o:t&&t.length&&ce(i)&&ce(a)?t.slice(i,a+1):[]};function JP(e){return e==="number"?[0,"auto"]:void 0}var iy=function(t,r,n,i){var a=t.graphicalItems,o=t.tooltipAxis,l=sh(r,t);return n<0||!a||!a.length||n>=l.length?null:a.reduce(function(c,u){var d,f=(d=u.props.data)!==null&&d!==void 0?d:r;f&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(f=f.slice(t.dataStartIndex,t.dataEndIndex+1));var h;if(o.dataKey&&!o.allowDuplicatedCategory){var p=f===void 0?l:f;h=Dm(p,o.dataKey,i)}else h=f&&f[n]||l[n];return h?[].concat(Ms(c),[AG(u,h)]):c},[])},J1=function(t,r,n,i){var a=i||{x:t.chartX,y:t.chartY},o=ete(a,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=dG(o,l,u,c);if(d>=0&&u){var f=u[d]&&u[d].value,h=iy(t,r,d,f),p=tte(n,l,d,a);return{activeTooltipIndex:d,activeLabel:f,activePayload:h,activeCoordinate:p}}return null},rte=function(t,r){var n=r.axes,i=r.graphicalItems,a=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=t.stackOffset,p=nP(d,a);return n.reduce(function(y,v){var m,x=v.type.defaultProps!==void 0?J(J({},v.type.defaultProps),v.props):v.props,b=x.type,g=x.dataKey,S=x.allowDataOverflow,w=x.allowDuplicatedCategory,j=x.scale,_=x.ticks,E=x.includeHidden,A=x[o];if(y[A])return y;var P=sh(t.data,{graphicalItems:i.filter(function(U){var G,B=o in U.props?U.props[o]:(G=U.type.defaultProps)===null||G===void 0?void 0:G[o];return B===A}),dataStartIndex:c,dataEndIndex:u}),T=P.length,M,O,k;Pee(x.domain,S,b)&&(M=Ng(x.domain,null,S),p&&(b==="number"||j!=="auto")&&(k=Wo(P,g,"category")));var F=JP(b);if(!M||M.length===0){var I,W=(I=x.domain)!==null&&I!==void 0?I:F;if(g){if(M=Wo(P,g,b),b==="category"&&p){var R=e4(M);w&&R?(O=M,M=Bd(0,T)):w||(M=T_(W,M,v).reduce(function(U,G){return U.indexOf(G)>=0?U:[].concat(Ms(U),[G])},[]))}else if(b==="category")w?M=M.filter(function(U){return U!==""&&!ke(U)}):M=T_(W,M,v).reduce(function(U,G){return U.indexOf(G)>=0||G===""||ke(G)?U:[].concat(Ms(U),[G])},[]);else if(b==="number"){var D=gG(P,i.filter(function(U){var G,B,me=o in U.props?U.props[o]:(G=U.type.defaultProps)===null||G===void 0?void 0:G[o],ue="hide"in U.props?U.props.hide:(B=U.type.defaultProps)===null||B===void 0?void 0:B.hide;return me===A&&(E||!ue)}),g,a,d);D&&(M=D)}p&&(b==="number"||j!=="auto")&&(k=Wo(P,g,"category"))}else p?M=Bd(0,T):l&&l[A]&&l[A].hasStack&&b==="number"?M=h==="expand"?[0,1]:iP(l[A].stackGroups,c,u):M=rP(P,i.filter(function(U){var G=o in U.props?U.props[o]:U.type.defaultProps[o],B="hide"in U.props?U.props.hide:U.type.defaultProps.hide;return G===A&&(E||!B)}),b,d,!0);if(b==="number")M=ty(f,M,A,a,_),W&&(M=Ng(W,M,S));else if(b==="category"&&W){var H=W,Q=M.every(function(U){return H.indexOf(U)>=0});Q&&(M=H)}}return J(J({},y),{},be({},A,J(J({},x),{},{axisType:a,domain:M,categoricalDomain:k,duplicateDomain:O,originalDomain:(m=x.domain)!==null&&m!==void 0?m:F,isCategorical:p,layout:d})))},{})},nte=function(t,r){var n=r.graphicalItems,i=r.Axis,a=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.layout,f=t.children,h=sh(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:u}),p=h.length,y=nP(d,a),v=-1;return n.reduce(function(m,x){var b=x.type.defaultProps!==void 0?J(J({},x.type.defaultProps),x.props):x.props,g=b[o],S=JP("number");if(!m[g]){v++;var w;return y?w=Bd(0,p):l&&l[g]&&l[g].hasStack?(w=iP(l[g].stackGroups,c,u),w=ty(f,w,g,a)):(w=Ng(S,rP(h,n.filter(function(j){var _,E,A=o in j.props?j.props[o]:(_=j.type.defaultProps)===null||_===void 0?void 0:_[o],P="hide"in j.props?j.props.hide:(E=j.type.defaultProps)===null||E===void 0?void 0:E.hide;return A===g&&!P}),"number",d),i.defaultProps.allowDataOverflow),w=ty(f,w,g,a)),J(J({},m),{},be({},g,J(J({axisType:a},i.defaultProps),{},{hide:!0,orientation:en(Qee,"".concat(a,".").concat(v%2),null),domain:w,originalDomain:S,isCategorical:y,layout:d})))}return m},{})},ite=function(t,r){var n=r.axisType,i=n===void 0?"xAxis":n,a=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,u=r.dataEndIndex,d=t.children,f="".concat(i,"Id"),h=hn(d,a),p={};return h&&h.length?p=rte(t,{axes:h,graphicalItems:o,axisType:i,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):o&&o.length&&(p=nte(t,{Axis:a,graphicalItems:o,axisType:i,axisIdKey:f,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),p},ate=function(t){var r=Oa(t),n=Po(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:R0(n,function(i){return i.coordinate}),tooltipAxis:r,tooltipAxisBandSize:Eg(r,n)}},Q1=function(t){var r=t.children,n=t.defaultShowTooltip,i=Ar(r,Cs),a=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(a=i.props.startIndex),i.props.endIndex>=0&&(o=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:a,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},ste=function(t){return!t||!t.length?!1:t.some(function(r){var n=Tn(r&&r.type);return n&&n.indexOf("Bar")>=0})},Z1=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},ote=function(t,r){var n=t.props,i=t.graphicalItems,a=t.xAxisMap,o=a===void 0?{}:a,l=t.yAxisMap,c=l===void 0?{}:l,u=n.width,d=n.height,f=n.children,h=n.margin||{},p=Ar(f,Cs),y=Ar(f,ts),v=Object.keys(c).reduce(function(w,j){var _=c[j],E=_.orientation;return!_.mirror&&!_.hide?J(J({},w),{},be({},E,w[E]+_.width)):w},{left:h.left||0,right:h.right||0}),m=Object.keys(o).reduce(function(w,j){var _=o[j],E=_.orientation;return!_.mirror&&!_.hide?J(J({},w),{},be({},E,en(w,"".concat(E))+_.height)):w},{top:h.top||0,bottom:h.bottom||0}),x=J(J({},m),v),b=x.bottom;p&&(x.bottom+=p.props.height||Cs.defaultProps.height),y&&r&&(x=pG(x,i,n,r));var g=u-x.left-x.right,S=d-x.top-x.bottom;return J(J({brushBottom:b},x),{},{width:Math.max(g,0),height:Math.max(S,0)})},lte=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},cte=function(t){var r=t.chartName,n=t.GraphicalChild,i=t.defaultTooltipEventType,a=i===void 0?"axis":i,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,f=t.defaultProps,h=function(x,b){var g=b.graphicalItems,S=b.stackGroups,w=b.offset,j=b.updateId,_=b.dataStartIndex,E=b.dataEndIndex,A=x.barSize,P=x.layout,T=x.barGap,M=x.barCategoryGap,O=x.maxBarSize,k=Z1(P),F=k.numericAxisName,I=k.cateAxisName,W=ste(g),R=[];return g.forEach(function(D,H){var Q=sh(x.data,{graphicalItems:[D],dataStartIndex:_,dataEndIndex:E}),U=D.type.defaultProps!==void 0?J(J({},D.type.defaultProps),D.props):D.props,G=U.dataKey,B=U.maxBarSize,me=U["".concat(F,"Id")],ue=U["".concat(I,"Id")],Ne={},ve=c.reduce(function(q,$){var X=b["".concat($.axisType,"Map")],xe=U["".concat($.axisType,"Id")];X&&X[xe]||$.axisType==="zAxis"||js();var ee=X[xe];return J(J({},q),{},be(be({},$.axisType,ee),"".concat($.axisType,"Ticks"),Po(ee)))},Ne),Y=ve[I],Z=ve["".concat(I,"Ticks")],te=S&&S[me]&&S[me].hasStack&&NG(D,S[me].stackGroups),L=Tn(D.type).indexOf("Bar")>=0,ae=Eg(Y,Z),oe=[],le=W&&fG({barSize:A,stackGroups:S,totalSize:lte(ve,I)});if(L){var he,Se,$e=ke(B)?O:B,ze=(he=(Se=Eg(Y,Z,!0))!==null&&Se!==void 0?Se:$e)!==null&&he!==void 0?he:0;oe=hG({barGap:T,barCategoryGap:M,bandSize:ze!==ae?ze:ae,sizeList:le[ue],maxBarSize:$e}),ze!==ae&&(oe=oe.map(function(q){return J(J({},q),{},{position:J(J({},q.position),{},{offset:q.position.offset-ze/2})})}))}var Le=D&&D.type&&D.type.getComposedData;Le&&R.push({props:J(J({},Le(J(J({},ve),{},{displayedData:Q,props:x,dataKey:G,item:D,bandSize:ae,barPosition:oe,offset:w,stackedData:te,layout:P,dataStartIndex:_,dataEndIndex:E}))),{},be(be(be({key:D.key||"item-".concat(H)},F,ve[F]),I,ve[I]),"animationId",j)),childIndex:d4(D,x.children),item:D})}),R},p=function(x,b){var g=x.props,S=x.dataStartIndex,w=x.dataEndIndex,j=x.updateId;if(!Nb({props:g}))return null;var _=g.children,E=g.layout,A=g.stackOffset,P=g.data,T=g.reverseStackOrder,M=Z1(E),O=M.numericAxisName,k=M.cateAxisName,F=hn(_,n),I=jG(P,F,"".concat(O,"Id"),"".concat(k,"Id"),A,T),W=c.reduce(function(U,G){var B="".concat(G.axisType,"Map");return J(J({},U),{},be({},B,ite(g,J(J({},G),{},{graphicalItems:F,stackGroups:G.axisType===O&&I,dataStartIndex:S,dataEndIndex:w}))))},{}),R=ote(J(J({},W),{},{props:g,graphicalItems:F}),b==null?void 0:b.legendBBox);Object.keys(W).forEach(function(U){W[U]=d(g,W[U],R,U.replace("Map",""),r)});var D=W["".concat(k,"Map")],H=ate(D),Q=h(g,J(J({},W),{},{dataStartIndex:S,dataEndIndex:w,updateId:j,graphicalItems:F,stackGroups:I,offset:R}));return J(J({formattedGraphicalItems:Q,graphicalItems:F,offset:R,stackGroups:I},H),W)},y=function(m){function x(b){var g,S,w;return qee(this,x),w=Wee(this,x,[b]),be(w,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),be(w,"accessibilityManager",new Aee),be(w,"handleLegendBBoxUpdate",function(j){if(j){var _=w.state,E=_.dataStartIndex,A=_.dataEndIndex,P=_.updateId;w.setState(J({legendBBox:j},p({props:w.props,dataStartIndex:E,dataEndIndex:A,updateId:P},J(J({},w.state),{},{legendBBox:j}))))}}),be(w,"handleReceiveSyncEvent",function(j,_,E){if(w.props.syncId===j){if(E===w.eventEmitterSymbol&&typeof w.props.syncMethod!="function")return;w.applySyncEvent(_)}}),be(w,"handleBrushChange",function(j){var _=j.startIndex,E=j.endIndex;if(_!==w.state.dataStartIndex||E!==w.state.dataEndIndex){var A=w.state.updateId;w.setState(function(){return J({dataStartIndex:_,dataEndIndex:E},p({props:w.props,dataStartIndex:_,dataEndIndex:E,updateId:A},w.state))}),w.triggerSyncEvent({dataStartIndex:_,dataEndIndex:E})}}),be(w,"handleMouseEnter",function(j){var _=w.getMouseInfo(j);if(_){var E=J(J({},_),{},{isTooltipActive:!0});w.setState(E),w.triggerSyncEvent(E);var A=w.props.onMouseEnter;Oe(A)&&A(E,j)}}),be(w,"triggeredAfterMouseMove",function(j){var _=w.getMouseInfo(j),E=_?J(J({},_),{},{isTooltipActive:!0}):{isTooltipActive:!1};w.setState(E),w.triggerSyncEvent(E);var A=w.props.onMouseMove;Oe(A)&&A(E,j)}),be(w,"handleItemMouseEnter",function(j){w.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),be(w,"handleItemMouseLeave",function(){w.setState(function(){return{isTooltipActive:!1}})}),be(w,"handleMouseMove",function(j){j.persist(),w.throttleTriggeredAfterMouseMove(j)}),be(w,"handleMouseLeave",function(j){w.throttleTriggeredAfterMouseMove.cancel();var _={isTooltipActive:!1};w.setState(_),w.triggerSyncEvent(_);var E=w.props.onMouseLeave;Oe(E)&&E(_,j)}),be(w,"handleOuterEvent",function(j){var _=u4(j),E=en(w.props,"".concat(_));if(_&&Oe(E)){var A,P;/.*touch.*/i.test(_)?P=w.getMouseInfo(j.changedTouches[0]):P=w.getMouseInfo(j),E((A=P)!==null&&A!==void 0?A:{},j)}}),be(w,"handleClick",function(j){var _=w.getMouseInfo(j);if(_){var E=J(J({},_),{},{isTooltipActive:!0});w.setState(E),w.triggerSyncEvent(E);var A=w.props.onClick;Oe(A)&&A(E,j)}}),be(w,"handleMouseDown",function(j){var _=w.props.onMouseDown;if(Oe(_)){var E=w.getMouseInfo(j);_(E,j)}}),be(w,"handleMouseUp",function(j){var _=w.props.onMouseUp;if(Oe(_)){var E=w.getMouseInfo(j);_(E,j)}}),be(w,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),be(w,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.handleMouseDown(j.changedTouches[0])}),be(w,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&w.handleMouseUp(j.changedTouches[0])}),be(w,"handleDoubleClick",function(j){var _=w.props.onDoubleClick;if(Oe(_)){var E=w.getMouseInfo(j);_(E,j)}}),be(w,"handleContextMenu",function(j){var _=w.props.onContextMenu;if(Oe(_)){var E=w.getMouseInfo(j);_(E,j)}}),be(w,"triggerSyncEvent",function(j){w.props.syncId!==void 0&&wp.emit(_p,w.props.syncId,j,w.eventEmitterSymbol)}),be(w,"applySyncEvent",function(j){var _=w.props,E=_.layout,A=_.syncMethod,P=w.state.updateId,T=j.dataStartIndex,M=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)w.setState(J({dataStartIndex:T,dataEndIndex:M},p({props:w.props,dataStartIndex:T,dataEndIndex:M,updateId:P},w.state)));else if(j.activeTooltipIndex!==void 0){var O=j.chartX,k=j.chartY,F=j.activeTooltipIndex,I=w.state,W=I.offset,R=I.tooltipTicks;if(!W)return;if(typeof A=="function")F=A(R,j);else if(A==="value"){F=-1;for(var D=0;D<R.length;D++)if(R[D].value===j.activeLabel){F=D;break}}var H=J(J({},W),{},{x:W.left,y:W.top}),Q=Math.min(O,H.x+H.width),U=Math.min(k,H.y+H.height),G=R[F]&&R[F].value,B=iy(w.state,w.props.data,F),me=R[F]?{x:E==="horizontal"?R[F].coordinate:Q,y:E==="horizontal"?U:R[F].coordinate}:YP;w.setState(J(J({},j),{},{activeLabel:G,activeCoordinate:me,activePayload:B,activeTooltipIndex:F}))}else w.setState(j)}),be(w,"renderCursor",function(j){var _,E=w.state,A=E.isTooltipActive,P=E.activeCoordinate,T=E.activePayload,M=E.offset,O=E.activeTooltipIndex,k=E.tooltipAxisBandSize,F=w.getTooltipEventType(),I=(_=j.props.active)!==null&&_!==void 0?_:A,W=w.props.layout,R=j.key||"_recharts-cursor";return z.createElement(Iee,{key:R,activeCoordinate:P,activePayload:T,activeTooltipIndex:O,chartName:r,element:j,isActive:I,layout:W,offset:M,tooltipAxisBandSize:k,tooltipEventType:F})}),be(w,"renderPolarAxis",function(j,_,E){var A=en(j,"type.axisType"),P=en(w.state,"".concat(A,"Map")),T=j.type.defaultProps,M=T!==void 0?J(J({},T),j.props):j.props,O=P&&P[M["".concat(A,"Id")]];return N.cloneElement(j,J(J({},O),{},{className:Re(A,O.className),key:j.key||"".concat(_,"-").concat(E),ticks:Po(O,!0)}))}),be(w,"renderPolarGrid",function(j){var _=j.props,E=_.radialLines,A=_.polarAngles,P=_.polarRadius,T=w.state,M=T.radiusAxisMap,O=T.angleAxisMap,k=Oa(M),F=Oa(O),I=F.cx,W=F.cy,R=F.innerRadius,D=F.outerRadius;return N.cloneElement(j,{polarAngles:Array.isArray(A)?A:Po(F,!0).map(function(H){return H.coordinate}),polarRadius:Array.isArray(P)?P:Po(k,!0).map(function(H){return H.coordinate}),cx:I,cy:W,innerRadius:R,outerRadius:D,key:j.key||"polar-grid",radialLines:E})}),be(w,"renderLegend",function(){var j=w.state.formattedGraphicalItems,_=w.props,E=_.children,A=_.width,P=_.height,T=w.props.margin||{},M=A-(T.left||0)-(T.right||0),O=eP({children:E,formattedGraphicalItems:j,legendWidth:M,legendContent:u});if(!O)return null;var k=O.item,F=X1(O,Mee);return N.cloneElement(k,J(J({},F),{},{chartWidth:A,chartHeight:P,margin:T,onBBoxUpdate:w.handleLegendBBoxUpdate}))}),be(w,"renderTooltip",function(){var j,_=w.props,E=_.children,A=_.accessibilityLayer,P=Ar(E,sn);if(!P)return null;var T=w.state,M=T.isTooltipActive,O=T.activeCoordinate,k=T.activePayload,F=T.activeLabel,I=T.offset,W=(j=P.props.active)!==null&&j!==void 0?j:M;return N.cloneElement(P,{viewBox:J(J({},I),{},{x:I.left,y:I.top}),active:W,label:F,payload:W?k:[],coordinate:O,accessibilityLayer:A})}),be(w,"renderBrush",function(j){var _=w.props,E=_.margin,A=_.data,P=w.state,T=P.offset,M=P.dataStartIndex,O=P.dataEndIndex,k=P.updateId;return N.cloneElement(j,{key:j.key||"_recharts-brush",onChange:eu(w.handleBrushChange,j.props.onChange),data:A,x:ce(j.props.x)?j.props.x:T.left,y:ce(j.props.y)?j.props.y:T.top+T.height+T.brushBottom-(E.bottom||0),width:ce(j.props.width)?j.props.width:T.width,startIndex:M,endIndex:O,updateId:"brush-".concat(k)})}),be(w,"renderReferenceElement",function(j,_,E){if(!j)return null;var A=w,P=A.clipPathId,T=w.state,M=T.xAxisMap,O=T.yAxisMap,k=T.offset,F=j.type.defaultProps||{},I=j.props,W=I.xAxisId,R=W===void 0?F.xAxisId:W,D=I.yAxisId,H=D===void 0?F.yAxisId:D;return N.cloneElement(j,{key:j.key||"".concat(_,"-").concat(E),xAxis:M[R],yAxis:O[H],viewBox:{x:k.left,y:k.top,width:k.width,height:k.height},clipPathId:P})}),be(w,"renderActivePoints",function(j){var _=j.item,E=j.activePoint,A=j.basePoint,P=j.childIndex,T=j.isRange,M=[],O=_.props.key,k=_.item.type.defaultProps!==void 0?J(J({},_.item.type.defaultProps),_.item.props):_.item.props,F=k.activeDot,I=k.dataKey,W=J(J({index:P,dataKey:I,cx:E.x,cy:E.y,r:4,fill:dv(_.item),strokeWidth:2,stroke:"#fff",payload:E.payload,value:E.value},Ae(F,!1)),td(F));return M.push(x.renderActiveDot(F,W,"".concat(O,"-activePoint-").concat(P))),A?M.push(x.renderActiveDot(F,J(J({},W),{},{cx:A.x,cy:A.y}),"".concat(O,"-basePoint-").concat(P))):T&&M.push(null),M}),be(w,"renderGraphicChild",function(j,_,E){var A=w.filterFormatItem(j,_,E);if(!A)return null;var P=w.getTooltipEventType(),T=w.state,M=T.isTooltipActive,O=T.tooltipAxis,k=T.activeTooltipIndex,F=T.activeLabel,I=w.props.children,W=Ar(I,sn),R=A.props,D=R.points,H=R.isRange,Q=R.baseLine,U=A.item.type.defaultProps!==void 0?J(J({},A.item.type.defaultProps),A.item.props):A.item.props,G=U.activeDot,B=U.hide,me=U.activeBar,ue=U.activeShape,Ne=!!(!B&&M&&W&&(G||me||ue)),ve={};P!=="axis"&&W&&W.props.trigger==="click"?ve={onClick:eu(w.handleItemMouseEnter,j.props.onClick)}:P!=="axis"&&(ve={onMouseLeave:eu(w.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:eu(w.handleItemMouseEnter,j.props.onMouseEnter)});var Y=N.cloneElement(j,J(J({},A.props),ve));function Z($){return typeof O.dataKey=="function"?O.dataKey($.payload):null}if(Ne)if(k>=0){var te,L;if(O.dataKey&&!O.allowDuplicatedCategory){var ae=typeof O.dataKey=="function"?Z:"payload.".concat(O.dataKey.toString());te=Dm(D,ae,F),L=H&&Q&&Dm(Q,ae,F)}else te=D==null?void 0:D[k],L=H&&Q&&Q[k];if(ue||me){var oe=j.props.activeIndex!==void 0?j.props.activeIndex:k;return[N.cloneElement(j,J(J(J({},A.props),ve),{},{activeIndex:oe})),null,null]}if(!ke(te))return[Y].concat(Ms(w.renderActivePoints({item:A,activePoint:te,basePoint:L,childIndex:k,isRange:H})))}else{var le,he=(le=w.getItemByXY(w.state.activeCoordinate))!==null&&le!==void 0?le:{graphicalItem:Y},Se=he.graphicalItem,$e=Se.item,ze=$e===void 0?j:$e,Le=Se.childIndex,q=J(J(J({},A.props),ve),{},{activeIndex:Le});return[N.cloneElement(ze,q),null,null]}return H?[Y,null,null]:[Y,null]}),be(w,"renderCustomized",function(j,_,E){return N.cloneElement(j,J(J({key:"recharts-customized-".concat(E)},w.props),w.state))}),be(w,"renderMap",{CartesianGrid:{handler:su,once:!0},ReferenceArea:{handler:w.renderReferenceElement},ReferenceLine:{handler:su},ReferenceDot:{handler:w.renderReferenceElement},XAxis:{handler:su},YAxis:{handler:su},Brush:{handler:w.renderBrush,once:!0},Bar:{handler:w.renderGraphicChild},Line:{handler:w.renderGraphicChild},Area:{handler:w.renderGraphicChild},Radar:{handler:w.renderGraphicChild},RadialBar:{handler:w.renderGraphicChild},Scatter:{handler:w.renderGraphicChild},Pie:{handler:w.renderGraphicChild},Funnel:{handler:w.renderGraphicChild},Tooltip:{handler:w.renderCursor,once:!0},PolarGrid:{handler:w.renderPolarGrid,once:!0},PolarAngleAxis:{handler:w.renderPolarAxis},PolarRadiusAxis:{handler:w.renderPolarAxis},Customized:{handler:w.renderCustomized}}),w.clipPathId="".concat((g=b.id)!==null&&g!==void 0?g:Of("recharts"),"-clip"),w.throttleTriggeredAfterMouseMove=ZA(w.triggeredAfterMouseMove,(S=b.throttleDelay)!==null&&S!==void 0?S:1e3/60),w.state={},w}return Gee(x,m),zee(x,[{key:"componentDidMount",value:function(){var g,S;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(g=this.props.margin.left)!==null&&g!==void 0?g:0,top:(S=this.props.margin.top)!==null&&S!==void 0?S:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var g=this.props,S=g.children,w=g.data,j=g.height,_=g.layout,E=Ar(S,sn);if(E){var A=E.props.defaultIndex;if(!(typeof A!="number"||A<0||A>this.state.tooltipTicks.length-1)){var P=this.state.tooltipTicks[A]&&this.state.tooltipTicks[A].value,T=iy(this.state,w,A,P),M=this.state.tooltipTicks[A].coordinate,O=(this.state.offset.top+j)/2,k=_==="horizontal",F=k?{x:M,y:O}:{y:M,x:O},I=this.state.formattedGraphicalItems.find(function(R){var D=R.item;return D.type.name==="Scatter"});I&&(F=J(J({},F),I.props.points[A].tooltipPosition),T=I.props.points[A].tooltipPayload);var W={activeTooltipIndex:A,isTooltipActive:!0,activeLabel:P,activePayload:T,activeCoordinate:F};this.setState(W),this.renderCursor(E),this.accessibilityManager.setIndex(A)}}}},{key:"getSnapshotBeforeUpdate",value:function(g,S){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==S.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==g.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==g.margin){var w,j;this.accessibilityManager.setDetails({offset:{left:(w=this.props.margin.left)!==null&&w!==void 0?w:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0}})}return null}},{key:"componentDidUpdate",value:function(g){Fm([Ar(g.children,sn)],[Ar(this.props.children,sn)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var g=Ar(this.props.children,sn);if(g&&typeof g.props.shared=="boolean"){var S=g.props.shared?"axis":"item";return l.indexOf(S)>=0?S:a}return a}},{key:"getMouseInfo",value:function(g){if(!this.container)return null;var S=this.container,w=S.getBoundingClientRect(),j=B7(w),_={chartX:Math.round(g.pageX-j.left),chartY:Math.round(g.pageY-j.top)},E=w.width/S.offsetWidth||1,A=this.inRange(_.chartX,_.chartY,E);if(!A)return null;var P=this.state,T=P.xAxisMap,M=P.yAxisMap,O=this.getTooltipEventType(),k=J1(this.state,this.props.data,this.props.layout,A);if(O!=="axis"&&T&&M){var F=Oa(T).scale,I=Oa(M).scale,W=F&&F.invert?F.invert(_.chartX):null,R=I&&I.invert?I.invert(_.chartY):null;return J(J({},_),{},{xValue:W,yValue:R},k)}return k?J(J({},_),k):null}},{key:"inRange",value:function(g,S){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=this.props.layout,_=g/w,E=S/w;if(j==="horizontal"||j==="vertical"){var A=this.state.offset,P=_>=A.left&&_<=A.left+A.width&&E>=A.top&&E<=A.top+A.height;return P?{x:_,y:E}:null}var T=this.state,M=T.angleAxisMap,O=T.radiusAxisMap;if(M&&O){var k=Oa(M);return I_({x:_,y:E},k)}return null}},{key:"parseEventsOfWrapper",value:function(){var g=this.props.children,S=this.getTooltipEventType(),w=Ar(g,sn),j={};w&&S==="axis"&&(w.props.trigger==="click"?j={onClick:this.handleClick}:j={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var _=td(this.props,this.handleOuterEvent);return J(J({},_),j)}},{key:"addListener",value:function(){wp.on(_p,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){wp.removeListener(_p,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(g,S,w){for(var j=this.state.formattedGraphicalItems,_=0,E=j.length;_<E;_++){var A=j[_];if(A.item===g||A.props.key===g.key||S===Tn(A.item.type)&&w===A.childIndex)return A}return null}},{key:"renderClipPath",value:function(){var g=this.clipPathId,S=this.state.offset,w=S.left,j=S.top,_=S.height,E=S.width;return z.createElement("defs",null,z.createElement("clipPath",{id:g},z.createElement("rect",{x:w,y:j,height:_,width:E})))}},{key:"getXScales",value:function(){var g=this.state.xAxisMap;return g?Object.entries(g).reduce(function(S,w){var j=K1(w,2),_=j[0],E=j[1];return J(J({},S),{},be({},_,E.scale))},{}):null}},{key:"getYScales",value:function(){var g=this.state.yAxisMap;return g?Object.entries(g).reduce(function(S,w){var j=K1(w,2),_=j[0],E=j[1];return J(J({},S),{},be({},_,E.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(g){var S;return(S=this.state.xAxisMap)===null||S===void 0||(S=S[g])===null||S===void 0?void 0:S.scale}},{key:"getYScaleByAxisId",value:function(g){var S;return(S=this.state.yAxisMap)===null||S===void 0||(S=S[g])===null||S===void 0?void 0:S.scale}},{key:"getItemByXY",value:function(g){var S=this.state,w=S.formattedGraphicalItems,j=S.activeItem;if(w&&w.length)for(var _=0,E=w.length;_<E;_++){var A=w[_],P=A.props,T=A.item,M=T.type.defaultProps!==void 0?J(J({},T.type.defaultProps),T.props):T.props,O=Tn(T.type);if(O==="Bar"){var k=(P.data||[]).find(function(R){return jY(g,R)});if(k)return{graphicalItem:A,payload:k}}else if(O==="RadialBar"){var F=(P.data||[]).find(function(R){return I_(g,R)});if(F)return{graphicalItem:A,payload:F}}else if(eh(A,j)||th(A,j)||Xl(A,j)){var I=fQ({graphicalItem:A,activeTooltipItem:j,itemData:M.data}),W=M.activeIndex===void 0?I:M.activeIndex;return{graphicalItem:J(J({},A),{},{childIndex:W}),payload:Xl(A,j)?M.data[I]:A.props.data[I]}}}return null}},{key:"render",value:function(){var g=this;if(!Nb(this))return null;var S=this.props,w=S.children,j=S.className,_=S.width,E=S.height,A=S.style,P=S.compact,T=S.title,M=S.desc,O=X1(S,Ree),k=Ae(O,!1);if(P)return z.createElement(L1,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},z.createElement(Um,Va({},k,{width:_,height:E,title:T,desc:M}),this.renderClipPath(),Ab(w,this.renderMap)));if(this.props.accessibilityLayer){var F,I;k.tabIndex=(F=this.props.tabIndex)!==null&&F!==void 0?F:0,k.role=(I=this.props.role)!==null&&I!==void 0?I:"application",k.onKeyDown=function(R){g.accessibilityManager.keyboardEvent(R)},k.onFocus=function(){g.accessibilityManager.focus()}}var W=this.parseEventsOfWrapper();return z.createElement(L1,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},z.createElement("div",Va({className:Re("recharts-wrapper",j),style:J({position:"relative",cursor:"default",width:_,height:E},A)},W,{ref:function(D){g.container=D}}),z.createElement(Um,Va({},k,{width:_,height:E,title:T,desc:M,style:Zee}),this.renderClipPath(),Ab(w,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(N.Component);be(y,"displayName",r),be(y,"defaultProps",J({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},f)),be(y,"getDerivedStateFromProps",function(m,x){var b=m.dataKey,g=m.data,S=m.children,w=m.width,j=m.height,_=m.layout,E=m.stackOffset,A=m.margin,P=x.dataStartIndex,T=x.dataEndIndex;if(x.updateId===void 0){var M=Q1(m);return J(J(J({},M),{},{updateId:0},p(J(J({props:m},M),{},{updateId:0}),x)),{},{prevDataKey:b,prevData:g,prevWidth:w,prevHeight:j,prevLayout:_,prevStackOffset:E,prevMargin:A,prevChildren:S})}if(b!==x.prevDataKey||g!==x.prevData||w!==x.prevWidth||j!==x.prevHeight||_!==x.prevLayout||E!==x.prevStackOffset||!Lm(A,x.prevMargin)){var O=Q1(m),k={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},F=J(J({},J1(x,g,_)),{},{updateId:x.updateId+1}),I=J(J(J({},O),k),F);return J(J(J({},I),p(J({props:m},I),x)),{},{prevDataKey:b,prevData:g,prevWidth:w,prevHeight:j,prevLayout:_,prevStackOffset:E,prevMargin:A,prevChildren:S})}if(!Fm(S,x.prevChildren)){var W,R,D,H,Q=Ar(S,Cs),U=Q&&(W=(R=Q.props)===null||R===void 0?void 0:R.startIndex)!==null&&W!==void 0?W:P,G=Q&&(D=(H=Q.props)===null||H===void 0?void 0:H.endIndex)!==null&&D!==void 0?D:T,B=U!==P||G!==T,me=!ke(g),ue=me&&!B?x.updateId:x.updateId+1;return J(J({updateId:ue},p(J(J({props:m},x),{},{updateId:ue,dataStartIndex:U,dataEndIndex:G}),x)),{},{prevChildren:S,dataStartIndex:U,dataEndIndex:G})}return null}),be(y,"renderActiveDot",function(m,x,b){var g;return N.isValidElement(m)?g=N.cloneElement(m,x):Oe(m)?g=m(x):g=z.createElement(hv,x),z.createElement(ut,{className:"recharts-active-dot",key:b},g)});var v=N.forwardRef(function(x,b){return z.createElement(y,Va({},x,{ref:b}))});return v.displayName=y.displayName,v},ute=cte({chartName:"PieChart",GraphicalChild:Vn,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Zf},{axisType:"radiusAxis",AxisComp:Jf}],formatAxisMap:RG,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const QP=({options:e=[],selectedValues:t=[],onChange:r,placeholder:n="Slectionner...",label:i,icon:a,displayFormat:o=(l,c)=>`${n} (${c})`})=>{const[l,c]=N.useState(!1),u=N.useRef(null),d=N.useRef(null);N.useEffect(()=>{const m=x=>{u.current&&!u.current.contains(x.target)&&c(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]),N.useEffect(()=>{d.current&&(d.current.indeterminate=t.length>0&&t.length<e.length)},[t,e.length]);const f=m=>{const x=typeof m=="string"?m:m.value,b=t.includes(x)?t.filter(g=>g!==x):[...t,x];r(b)},h=()=>{r([]),c(!1)},p=m=>{if(m.target.checked){const x=e.map(b=>typeof b=="string"?b:b.value);r(x)}else r([])};e.map(m=>typeof m=="string"?m:m.value);const y=m=>typeof m=="string"?m:m.label&&m.count!==void 0?`${m.label} (${m.count})`:m.label?m.label:m.value,v=m=>typeof m=="string"?m:m.value;return s.jsxs("div",{ref:u,className:"relative w-full",children:[i&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:i}),s.jsxs("button",{onClick:()=>c(!l),className:"w-full px-4 py-2 text-left bg-white border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent hover:border-gray-400 transition-colors flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[a&&s.jsx(a,{size:18,className:"text-gray-400"}),s.jsx("span",{className:"text-gray-700",children:t.length>0?`${t.length} slectionn${t.length>1?"s":""}`:o(0,e.length)})]}),s.jsx(ln,{size:18,className:`text-gray-400 transition-transform ${l?"rotate-180":""}`})]}),l&&s.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-lg shadow-lg z-50",children:[s.jsxs("div",{className:"sticky top-0 bg-gray-50 border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[s.jsx("input",{ref:d,type:"checkbox",checked:t.length===e.length&&e.length>0,onChange:p,className:"w-4 h-4 rounded cursor-pointer"}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Tous (",e.length,")"]})]}),t.length>0&&s.jsx("button",{onClick:h,className:"text-xs text-gray-500 hover:text-gray-700 transition-colors",title:"Rinitialiser la slection",children:s.jsx(Lr,{size:16})})]}),s.jsx("div",{className:"max-h-60 overflow-y-auto",children:e.length>0?e.map(m=>{const x=v(m),b=y(m);return s.jsxs("label",{className:"flex items-center gap-3 px-4 py-2 hover:bg-blue-50 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0",children:[s.jsx("input",{type:"checkbox",checked:t.includes(x),onChange:()=>f(m),className:"w-4 h-4 rounded cursor-pointer accent-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:b})]},x)}):s.jsx("div",{className:"px-4 py-3 text-center text-gray-500 text-sm",children:"Aucune option disponible"})})]})]})},ar={async getAll(){try{const{data:e,error:t}=await V.from(ie.PAIEMENTS).select(`
          *,
          created_by,
          client:prospects!client_id(raison_sociale, contact),
          installation:installations(application_installee, montant, type, created_by)
        `).order("date_paiement",{ascending:!1});if(t)throw t;return e.map(n=>{var c,u;const i=((c=n.installation)==null?void 0:c.montant)||0,a=n.montant||0,o=Math.max(0,i-a),l=n.created_by||((u=n.installation)==null?void 0:u.created_by)||null;return{...n,created_by:l,resteAPayer:o}})}catch(e){throw console.error("Erreur rcupration paiements:",e),e}},async getByClient(e){try{const{data:t,error:r}=await V.from(ie.PAIEMENTS).select(`
          id,
          installation_id,
          client_id,
          montant,
          mode_paiement,
          type,
          date_paiement,
          created_by,
          installation:installations(montant, type, created_by, application_installee)
        `).eq("client_id",e).order("date_paiement",{ascending:!1});if(r)throw r;return t.map(i=>{var u,d;const a=((u=i.installation)==null?void 0:u.montant)||0,o=i.montant||0,l=Math.max(0,a-o),c=i.created_by||((d=i.installation)==null?void 0:d.created_by)||null;return{...i,created_by:c,resteAPayer:l}})}catch(t){throw console.error("Erreur rcupration paiements client:",t),t}},async getByInstallation(e){try{const{data:t,error:r}=await V.from(ie.PAIEMENTS).select("id, montant, type, date_paiement, mode_paiement").eq("installation_id",e).order("date_paiement",{ascending:!0});if(r)throw r;return t||[]}catch(t){return console.error("Erreur rcupration paiements installation:",t),[]}},async getResteTotalClient(e){try{const{data:t,error:r}=await V.from(ie.INSTALLATIONS).select("id, montant").eq("client_id",e);if(r)throw r;const n=t.reduce((c,u)=>c+(u.montant||0),0),{data:i,error:a}=await V.from(ie.PAIEMENTS).select("montant").eq("client_id",e);if(a)throw a;const o=i.reduce((c,u)=>c+(u.montant||0),0),l=Math.max(0,n-o);return{totalInstallations:n,totalPaye:o,resteAPayer:l}}catch(t){throw console.error("Erreur calcul reste total:",t),t}},async create(e){try{const t={client_id:e.client_id,installation_id:e.installation_id,type:e.type,montant:e.montant,mode_paiement:e.mode_paiement,date_paiement:e.date_paiement||new Date().toISOString(),created_by:e.created_by||null},{data:r,error:n}=await V.from(ie.PAIEMENTS).insert([t]).select("*");if(n)throw n;return(r==null?void 0:r[0])||null}catch(t){throw console.error("Erreur cration paiement:",t),t}},async update(e,t){try{const{data:r,error:n}=await V.from(ie.PAIEMENTS).update(t).eq("id",e).select(`
          *,
          client:prospects!client_id(raison_sociale, contact),
          installation:installations(application_installee, montant)
        `).single();if(n)throw n;return r}catch(r){throw console.error("Erreur mise  jour paiement:",r),r}},async delete(e){try{const{error:t}=await V.from(ie.PAIEMENTS).delete().eq("id",e);if(t)throw t;return!0}catch(t){throw console.error("Erreur suppression paiement:",t),t}},async getStats(e=null,t=null){try{let r=V.from(ie.PAIEMENTS).select("montant, type, mode_paiement, date_paiement");e&&t&&(r=r.gte("date_paiement",e).lte("date_paiement",t));const{data:n,error:i}=await r;if(i)throw i;return{total:n.length,revenuTotal:n.reduce((o,l)=>o+(l.montant||0),0),acquisitions:n.filter(o=>o.type==="acquisition").length,abonnements:n.filter(o=>o.type==="abonnement").length,parMode:{especes:n.filter(o=>o.mode_paiement==="especes").length,virement:n.filter(o=>o.mode_paiement==="virement").length,cheque:n.filter(o=>o.mode_paiement==="cheque").length,autre:n.filter(o=>o.mode_paiement==="autre").length}}}catch(r){throw console.error("Erreur statistiques paiements:",r),r}},async getRevenusMensuels(e=new Date().getFullYear()){try{const{data:t,error:r}=await V.from(ie.PAIEMENTS).select("montant, date_paiement").gte("date_paiement",`${e}-01-01`).lte("date_paiement",`${e}-12-31`);if(r)throw r;const n=Array(12).fill(0);return t.forEach(i=>{const a=new Date(i.date_paiement).getMonth();n[a]+=i.montant||0}),n.map((i,a)=>({mois:["Jan","Fv","Mar","Avr","Mai","Jun","Jul","Ao","Sep","Oct","Nov","Dc"][a],montant:i}))}catch(t){throw console.error("Erreur revenus mensuels:",t),t}}},Tr={async getAll(){try{const{data:e,error:t}=await V.from(ie.INSTALLATIONS).select("*").order("date_installation",{ascending:!1});if(t)throw t;return await Promise.all(e.map(async n=>{let i={};if(n.client_id){const{data:a}=await V.from(ie.PROSPECTS).select("raison_sociale, contact, telephone, email, wilaya").eq("id",n.client_id).single();i=a||{}}return{...n,client:i,type:n.type||"acquisition",wilaya:(i==null?void 0:i.wilaya)||"Non spcifie"}}))}catch(e){throw console.error("Erreur rcupration installations:",e),e}},async getByClient(e){try{const{data:t,error:r}=await V.from(ie.INSTALLATIONS).select("*").eq("client_id",e).order("date_installation",{ascending:!1});if(r)throw r;return t||[]}catch(t){throw console.error("Erreur rcupration installations client:",t),t}},async hasPaiements(e){try{const{data:t,error:r,count:n}=await V.from(ie.PAIEMENTS).select("id",{count:"exact",head:!0}).eq("installation_id",e);if(r)throw r;return n>0}catch(t){return console.error("Erreur vrification paiements:",t),!1}},async create(e){var t;try{const{data:r,error:n}=await V.from(ie.INSTALLATIONS).insert([{client_id:e.client_id,application_installee:e.application_installee,montant:parseFloat(e.montant)||0,montant_abonnement:parseFloat(e.montant_abonnement)||0,date_installation:e.date_installation,type:e.type||"acquisition",statut:e.statut||"en cours",created_by:e.created_by||null}]).select();if(n)throw n;const i=r[0];return(i.type==="abonnement"||((t=i.type)==null?void 0:t.toLowerCase())==="abonnement")&&await Kt.createFromInstallation(i.id,e.montant_abonnement),await mt.convertToClient(e.client_id),await mt.addHistorique(e.client_id,"installation",`Installation cre: ${e.application_installee}`),i}catch(r){throw console.error("Erreur cration installation:",r),r}},async update(e,t){try{const r={};if(t.application_installee!==void 0&&(r.application_installee=t.application_installee),t.montant!==void 0&&(r.montant=parseFloat(t.montant)),t.type!==void 0&&(r.type=t.type||"acquisition"),t.statut!==void 0&&(r.statut=t.statut),t.date_installation!==void 0&&(r.date_installation=t.date_installation),t.mission_id!==void 0&&(r.mission_id=t.mission_id),t.application_installee!==void 0&&!r.application_installee)throw new Error("application_installee est requis");if(t.montant!==void 0&&(!r.montant||isNaN(r.montant)))throw new Error("montant est requis et doit tre un nombre");if(t.statut!==void 0&&!r.statut)throw new Error("statut est requis");if(t.date_installation!==void 0&&!r.date_installation)throw new Error("date_installation est requis");console.log("Donnes de mise  jour installation:",r);const{data:n,error:i}=await V.from(ie.INSTALLATIONS).update(r).eq("id",e).select();if(i)throw console.error("Erreur dtaille Supabase:",i),i;const a=n&&n.length>0?n[0]:null;if(!a)throw new Error("Installation non trouve aprs mise  jour");try{console.log("Recherche abonnements pour installation:",e);const{data:o,error:l}=await V.from(ie.ABONNEMENTS).select("*").eq("installation_id",e);if(l)return console.error("Erreur recherche abonnements:",l),a;if(console.log("Abonnements trouvs:",o),o&&o.length>0){for(const c of o){const u=new Date;u.setHours(0,0,0,0);const d=new Date(c.date_fin);d.setHours(0,0,0,0);const f=new Date(u);f.setDate(f.getDate()+30);let h="actif";d<u?h="expire":d<=f&&(h="en_alerte");const p={statut:h};if(t.date_installation){const y=new Date(t.date_installation),v=y.toISOString().split("T")[0],m=new Date(y);m.setFullYear(m.getFullYear()+1);const x=m.toISOString().split("T")[0];p.date_debut=v,p.date_fin=x}await V.from(ie.ABONNEMENTS).update(p).eq("id",c.id)}console.log("Abonnements mis  jour")}else console.log("Aucun abonnement trouv pour cette installation")}catch(o){console.error("Erreur dans mise  jour abonnement:",o)}return a}catch(r){throw console.error("Erreur mise  jour installation:",r),r}},async delete(e){try{if(await this.hasPaiements(e)){const a=new Error("Impossible de supprimer cette installation car elle a des paiements enregistrs. Supprimez d'abord les paiements avant de supprimer l'installation.");throw a.code="INSTALLATION_HAS_PAIEMENTS",a}const{data:r,error:n}=await V.from(ie.ABONNEMENTS).select("id").eq("installation_id",e);if(n)throw n;if(r&&r.length>0)for(const a of r)await Kt.delete(a.id);const{error:i}=await V.from(ie.INSTALLATIONS).delete().eq("id",e);if(i)throw i;return!0}catch(t){throw console.error("Erreur suppression installation:",t),t}},async getStats(){try{const{data:e,error:t}=await V.from(ie.INSTALLATIONS).select("statut, montant, date_installation");if(t)throw t;return{total:e.length,enCours:e.filter(n=>n.statut==="en cours").length,terminees:e.filter(n=>n.statut==="terminee").length,revenuTotal:e.reduce((n,i)=>n+(i.montant||0),0)}}catch(e){throw console.error("Erreur statistiques installations:",e),e}},async checkAndRenewAcquisitions(){try{const{data:e,error:t}=await V.from(ie.INSTALLATIONS).select("id, client_id, application_installee, montant, date_installation, type, statut, created_by").eq("type","acquisition");if(t)throw t;const r=new Date;r.setHours(0,0,0,0);const n=[];for(const i of e){const a=new Date(i.date_installation);a.setHours(0,0,0,0);const o=new Date(a);if(o.setFullYear(o.getFullYear()+1),r>=o){const{data:l,error:c}=await V.from(ie.ABONNEMENTS).select("id",{count:"exact"}).eq("installation_id",i.id).in("statut",["actif","en_alerte"]);if(!(l&&l.length>0))try{console.log(` Cration d'abonnement renouvellement pour installation ${i.id}`);const d=r,f=new Date(d);f.setFullYear(f.getFullYear()+1);const{error:h}=await V.from(ie.ABONNEMENTS).insert([{installation_id:i.id,date_debut:d.toISOString().split("T")[0],date_fin:f.toISOString().split("T")[0],statut:"actif",source:"ABONNEMENT (ACQUISITION)",auto_generated:!0}]);if(h){console.error(`Erreur cration abonnement renouvellement pour ${i.id}:`,h);continue}try{await mt.addHistorique(i.client_id,"abonnement_auto_renew",`Abonnement auto-renouvel pour ${i.application_installee}`,{installation_id:i.id,date_debut:d.toISOString().split("T")[0],date_fin:f.toISOString().split("T")[0],montant:i.montant,source:"ABONNEMENT (ACQUISITION)"}),console.log(` Action enregistre dans l'historique du prospect/client ${i.client_id}`)}catch(p){console.warn(" Impossible d'enregistrer dans l'historique:",p)}n.push(i),console.log(` Abonnement renouvel: ${i.application_installee} (Installation ${i.id}), Nouvel abonnement jusqu'au ${f.toISOString().split("T")[0]}`)}catch(d){console.error(`Erreur lors du renouvellement d'abonnement pour ${i.id}:`,d)}}}return{success:!0,renewedCount:n.length,installations:n}}catch(e){throw console.error("Erreur vrification renouvellement installations:",e),e}}},dte=(e,t,r)=>{if(r&&r>0)return r;if(!e||!t)return null;const n=new Date(e),i=new Date(t);if(isNaN(n.getTime())||isNaN(i.getTime()))return null;const a=i.getTime()-n.getTime(),o=Math.round(a/(1e3*60));return Math.max(0,o)},Su=e=>e&&{...e,duree_minutes:e.duree&&e.duree>0?e.duree:dte(e.created_at||e.time_creation||e.date_intervention,e.date_fin,e.duree)},Sp=e=>Array.isArray(e)?e.map(Su):e,ii={async getAll(){try{const{data:e,error:t}=await V.from(ie.INTERVENTIONS).select(`
          *,
          client:prospects!client_id(raison_sociale, contact, telephone, wilaya),
          technicien:users!technicien_id(id, nom, email)
        `).order("date_intervention",{ascending:!1});if(t)throw t;return Sp(e)}catch(e){throw console.error("Erreur rcupration interventions:",e),e}},async getByClient(e){try{const{data:t,error:r}=await V.from(ie.INTERVENTIONS).select(`
          *,
          technicien:users!technicien_id(id, nom, email)
        `).eq("client_id",e).order("date_intervention",{ascending:!1});if(r)throw r;return Sp(t)}catch(t){throw console.error("Erreur rcupration interventions client:",t),t}},async getByTechnicien(e){try{const{data:t,error:r}=await V.from(ie.INTERVENTIONS).select(`
          *,
          client:prospects!client_id(raison_sociale, contact, telephone, wilaya),
          technicien:users!technicien_id(id, nom, email)
        `).eq("technicien_id",e).order("date_intervention",{ascending:!1});if(r)throw r;return Sp(t)}catch(t){throw console.error("Erreur rcupration interventions technicien:",t),t}},async create(e){try{const t=new Date().toISOString();console.log("DEBUG create: creationTime (UTC):",t);const{data:r,error:n}=await V.from(ie.INTERVENTIONS).insert([{...e,statut:e.statut||"en_cours",date_intervention:e.date_intervention||new Date().toISOString(),duree:0,time_creation:t,created_by:e.created_by||null}]).select(`
          *,
          client:prospects!client_id(raison_sociale, contact, telephone, wilaya),
          technicien:users!technicien_id(id, nom, email)
        `).single();if(n)throw n;return console.log("DEBUG create: intervention cre avec time_creation =",r.time_creation),Su(r)}catch(t){throw console.error("Erreur cration intervention:",t),t}},async update(e,t){try{const{data:r,error:n}=await V.from(ie.INTERVENTIONS).update(t).eq("id",e).select(`
          *,
          client:prospects!client_id(raison_sociale, contact, telephone, wilaya),
          technicien:users!technicien_id(id, nom, email)
        `).single();if(n)throw n;return Su(r)}catch(r){throw console.error("Erreur mise  jour intervention:",r),r}},async cloturer(e,t,r){try{const{data:n,error:i}=await V.from(ie.INTERVENTIONS).select("*").eq("id",e).single();if(i)throw i;const o=new Date().toISOString();console.log("DEBUG cloturer:"),console.log("  intervention id:",e),console.log("  time_creation:",n.time_creation),console.log("  dateFin (UTC):",o);let l,c="UNKNOWN";if(console.log("  DEBUG: Checking timestamps..."),n.created_at)l=new Date(n.created_at),c="created_at",console.log("  Using created_at:",n.created_at);else if(n.time_creation){const y=n.time_creation.endsWith("Z")?n.time_creation:n.time_creation+"Z";l=new Date(y),c="time_creation",console.log("  Raw time_creation from DB:",n.time_creation),console.log("  With Z added:",y),console.log("  Using time_creation - parsed as:",l.toISOString())}else if(n.date_intervention){const y=n.date_intervention,v=new Date,m=v.getHours().toString().padStart(2,"0"),x=v.getMinutes().toString().padStart(2,"0"),b=v.getSeconds().toString().padStart(2,"0");l=new Date(y+"T"+m+":"+x+":"+b+"Z"),c="date_intervention with current time (fallback - NO EXACT TIME)",console.log("  Using date_intervention fallback with current time - parsed as:",l.toISOString()),console.log("  WARNING: time_creation was NULL - using current time as estimate!")}else l=new Date,c="NOW (last resort)",console.log("  Using NOW fallback");if(isNaN(l.getTime()))throw new Error("Impossible de calculer la date de dbut. time_creation: "+n.time_creation+", date_intervention: "+n.date_intervention);const u=new Date(o),d=u.getTime()-l.getTime(),f=Math.max(0,Math.round(d/(1e3*60)));console.log("  "),console.log("  === DURATION CALCULATION ==="),console.log("  source:",c),console.log("  dateDebut (ISO):",l.toISOString()),console.log("  dateDebut (getTime):",l.getTime()),console.log("  dateFin (ISO):",u.toISOString()),console.log("  dateFin (getTime):",u.getTime()),console.log("  timeDiffMs:",d),console.log("  durationMinutes:",f),console.log("  durationHeures:",(f/60).toFixed(2)),console.log("  ===========================");const{data:h,error:p}=await V.from(ie.INTERVENTIONS).update({statut:"cloturee",action_entreprise:t,commentaires:r,date_fin:o,duree:f}).eq("id",e).select(`
          *,
          client:prospects!client_id(raison_sociale, contact, telephone, wilaya),
          technicien:users!technicien_id(id, nom, email)
        `).single();if(p)throw p;return console.log("  Clture OK - duree enregistre:",h.duree),Su(h)}catch(n){throw console.error("Erreur clture intervention:",n),n}},async delete(e){try{const{error:t}=await V.from(ie.INTERVENTIONS).delete().eq("id",e);if(t)throw t;return!0}catch(t){throw console.error("Erreur suppression intervention:",t),t}},async getStats(){try{const{data:e,error:t}=await V.from(ie.INTERVENTIONS).select("statut, priorite, type_intervention, duree");if(t)throw t;return{total:e.length,enCours:e.filter(n=>n.statut==="en_cours").length,cloturees:e.filter(n=>n.statut==="cloturee").length,hautesPriorites:e.filter(n=>n.priorite==="haute").length,dureeMoyenne:e.reduce((n,i)=>n+(i.duree||0),0)/e.length||0}}catch(e){throw console.error("Erreur statistiques interventions:",e),e}}},Mt={async testTableAccess(){try{console.log("Testing missions table access...");const{data:e,error:t,status:r}=await V.from("missions").select("id").limit(1);return t?(console.error("Table access error:",t),{accessible:!1,error:t}):(console.log("Table access successful:",{dataCount:e==null?void 0:e.length,status:r}),{accessible:!0})}catch(e){return console.error("Table access test error:",e),{accessible:!1,error:e}}},async getAll(){try{const{data:e,error:t}=await V.from("missions").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Error loading missions:",{code:t.code,message:t.message,details:t.details,hint:t.hint}),t;return console.log("Missions loaded successfully:",e==null?void 0:e.length,"missions"),e||[]}catch(e){throw console.error("Erreur lors du chargement des missions:",e),e}},async getById(e){try{const{data:t,error:r}=await V.from("missions").select("*").eq("id",e).single();if(r)throw r;return t}catch(t){throw console.error("Erreur lors du chargement de la mission:",t),t}},async create(e){try{const t={titre:e.titre||"Sans titre",statut:"creee"};console.log("Form data received:",e),console.log("Initial insert data:",t),e.description&&e.description.trim()&&(t.description=e.description),e.clientId&&(console.log("Adding prospect_id:",e.clientId),t.prospect_id=e.clientId),e.lieu&&e.lieu.trim()&&(t.lieu=e.lieu),e.dateDebut&&(t.date_debut=e.dateDebut),e.dateFin&&(t.date_fin_prevue=e.dateFin),e.type&&(t.type_mission=e.type),e.priorite&&(t.priorite=e.priorite),e.budgetInitial&&(t.budget_alloue=parseFloat(e.budgetInitial)),e.chefMissionId&&(t.chef_mission_id=e.chefMissionId),e.accompagnateurIds&&e.accompagnateurIds.length>0&&(t.accompagnateurs_ids=e.accompagnateurIds),console.log("Final insert data:",t);const{data:r,error:n,status:i,statusText:a}=await V.from("missions").insert([t]).select();if(console.log("Insert response:",{data:r,error:n,status:i,statusText:a}),n)throw console.error("Supabase error details:",n),console.error("Error properties:",Object.keys(n)),console.error("Error stringified:",JSON.stringify(n,null,2)),n;return r&&r.length>0?r[0]:{...t,created_at:new Date().toISOString()}}catch(t){throw console.error("Erreur lors de la cration de la mission:",t),t}},async update(e,t){try{const r={};t.titre!==void 0&&(r.titre=t.titre),t.description!==void 0&&(r.description=t.description),t.clientId!==void 0&&(r.prospect_id=t.clientId),t.lieu!==void 0&&(r.lieu=t.lieu),t.dateDebut!==void 0&&(r.date_debut=t.dateDebut),t.dateFin!==void 0&&(r.date_fin_prevue=t.dateFin),t.type!==void 0&&(r.type_mission=t.type),t.priorite!==void 0&&(r.priorite=t.priorite),t.budgetInitial!==void 0&&(r.budget_alloue=parseFloat(t.budgetInitial)),t.chefMissionId!==void 0&&(r.chef_mission_id=t.chefMissionId),t.accompagnateurIds!==void 0&&(r.accompagnateurs_ids=t.accompagnateurIds),r.updated_at=new Date().toISOString();const{data:n,error:i}=await V.from("missions").update(r).eq("id",e);if(i)throw console.error("Supabase update error:",{code:i.code,message:i.message,details:i.details,hint:i.hint}),i;const{data:a,error:o}=await V.from("missions").select("*").eq("id",e).single();if(o)throw console.error("Error fetching updated mission:",o),o;return a}catch(r){throw console.error("Erreur lors de la mise  jour de la mission:",r),r}},async delete(e){try{const{error:t}=await V.from("missions").delete().eq("id",e);if(t)throw t;return!0}catch(t){throw console.error("Erreur lors de la suppression de la mission:",t),t}},async startMission(e){var t;try{const r=typeof e=="string"?parseInt(e,10):e;console.log(" Dmarrage de la mission:",r);const n=V.from("missions").update({statut:"en_cours",updated_at:new Date().toISOString()}).eq("id",r).select(),i=new Promise(o=>setTimeout(()=>o({data:[{id:r,statut:"en_cours"}],error:null}),5e3)),a=await Promise.race([n,i]);return a.error?(console.warn(" Erreur Supabase (mise  jour locale):",a.error),{id:r,statut:"en_cours",local:!0}):(console.log(" Mission dmarre"),((t=a.data)==null?void 0:t[0])||{id:r,statut:"en_cours"})}catch(r){return console.error("Erreur startMission:",r),{statut:"en_cours",local:!0}}},async updateStatus(e,t){try{const{data:r,error:n}=await V.from("missions").update({statut:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return r}catch(r){throw console.error("Erreur lors de la mise  jour du statut:",r),r}},async addParticipant(e,t,r){try{const{data:n,error:i}=await V.from("missions_participants").insert([{mission_id:e,user_id:t,role:r}]).select().single();if(i)throw i;return n}catch(n){throw console.error("Erreur lors de l'ajout du participant:",n),n}},async addExpense(e,t){try{const{data:r,error:n}=await V.from("missions_expenses").insert([{mission_id:e,type_depense:t.type,montant:t.montant,description:t.description,justificatif_url:t.justificatifUrl}]).select().single();if(n)throw n;return r}catch(r){throw console.error("Erreur lors de l'ajout de la dpense:",r),r}},async getExpenses(e){try{const{data:t,error:r}=await V.from("missions_expenses").select("*").eq("mission_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}catch(t){throw console.error("Erreur lors du chargement des dpenses:",t),t}},async getByClient(e){try{const{data:t,error:r}=await V.from("missions").select("*").eq("prospect_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}catch(t){throw console.error("Erreur lors du chargement des missions du client:",t),t}},async getByParticipant(e){var t;try{const{data:r,error:n}=await V.from("missions").select("*").in("id",((t=(await V.from("missions_participants").select("mission_id").eq("user_id",e)).data)==null?void 0:t.map(i=>i.mission_id))||[]).order("created_at",{ascending:!1});if(n)throw n;return r||[]}catch(r){throw console.error("Erreur lors du chargement des missions:",r),r}},async getStatistics(e={}){try{let t=V.from("missions").select("*");e.statut&&(t=t.eq("statut",e.statut)),e.type&&(t=t.eq("type_mission",e.type));const{data:r,error:n}=await t;if(n)throw n;const i={total:r.length,byStatus:{},byType:{},totalBudget:0,totalExpenses:0};return r.forEach(a=>{i.byStatus[a.statut]=(i.byStatus[a.statut]||0)+1,i.byType[a.type_mission]=(i.byType[a.type_mission]||0)+1,i.totalBudget+=0}),i}catch(t){throw console.error("Erreur lors du calcul des statistiques:",t),t}},async updateTechnicalDetails(e,t){try{const{data:r,error:n}=await V.from("missions").update({rapport_technique:t.rapportTechnique,actions_realisees:t.actionsRealisees,logiciels_materiels:t.logicielsMateriels,problemes_resolutions:t.problemesResolutions,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw n;return r}catch(r){throw console.error("Erreur lors de la mise  jour des dtails techniques:",r),r}},async closeMissionByChef(e,t){try{const r={cloturee_par_chef:!0,date_clot_chef:new Date().toISOString(),commentaire_clot_chef:t.commentaireChef,date_cloture_reelle:new Date().toISOString(),statut:"cloturee",updated_at:new Date().toISOString()};t.totalExpenses!==void 0&&t.totalExpenses!==null&&(r.budget_depense=parseFloat(t.totalExpenses)),console.log(" Envoi de closeMissionByChef avec:",r);const{data:n,error:i}=await V.from("missions").update(r).eq("id",e).select();if(i){if(console.error(" Erreur Supabase:",JSON.stringify(i,null,2)),i.code==="PGRST204")return{local:!0,id:e,...r};throw i}return console.log(" Mission ferme par chef"),n&&n.length>0?n[0]:{id:e,...r}}catch(r){return console.error("Erreur lors de la clture par le chef:",r),{local:!0,id:e,cloturee_par_chef:!0}}},async validateClosureByAdmin(e,t){try{const r={cloturee_definitive:t.clotureeDefinitive,date_clot_definitive:new Date().toISOString(),commentaire_clot_admin:t.commentaireAdmin,statut:"validee",updated_at:new Date().toISOString()};t.totalExpenses!==void 0&&t.totalExpenses!==null&&(r.budget_depense=parseFloat(t.totalExpenses));const{data:n,error:i}=await V.from("missions").update(r).eq("id",e).select();if(i){if(i.code==="PGRST204")return{local:!0,id:e,...r};throw i}return n&&n.length>0?n[0]:{id:e,...r}}catch(r){return console.error("Erreur lors de la validation dfinitive:",r),{local:!0,id:e,cloturee_definitive:!0}}},async uploadJustificatif(e,t,r){try{const n=`${e}/${t}/${Date.now()}_${r.name}`,{data:i,error:a}=await V.storage.from("mission-justificatifs").upload(n,r);if(a)throw a;const{data:{publicUrl:o}}=V.storage.from("mission-justificatifs").getPublicUrl(n),{error:l}=await V.from("missions_expenses").update({justificatif_url:o}).eq("id",t);if(l)throw l;return{url:o,fileName:n}}catch(n){throw console.error("Erreur lors de l'upload du justificatif:",n),n}},async getJustificatifs(e){try{const{data:t,error:r}=await V.from("missions_expenses").select("*").eq("mission_id",e).not("justificatif_url","is",null).order("created_at",{ascending:!1});if(r)throw r;return t||[]}catch(t){throw console.error("Erreur lors du chargement des justificatifs:",t),t}},async deleteJustificatif(e,t){try{const r=t.split("/").pop(),{error:n}=await V.storage.from("mission-justificatifs").remove([r]);if(n)throw n;const{error:i}=await V.from("missions_expenses").update({justificatif_url:null}).eq("id",e);if(i)throw i;return!0}catch(r){throw console.error("Erreur lors de la suppression du justificatif:",r),r}},async getDelayedMissions(){try{const e=new Date().toISOString().split("T")[0],{data:t,error:r}=await V.from("missions").select("*").lt("date_fin_prevue",e).in("statut",["creee","planifiee","en_cours"]);if(r)throw r;return t||[]}catch(e){throw console.error("Erreur lors du chargement des missions en retard:",e),e}},async getMissionsWithBudgetWarning(){try{const{data:e,error:t}=await V.from("missions").select("*");if(t)throw t;const r=[];for(const n of e){const{data:i,error:a}=await V.from("missions_expenses").select("montant").eq("mission_id",n.id);if(!a){const o=i.reduce((c,u)=>c+(u.montant||0),0);0>80}}return r}catch(e){throw console.error("Erreur lors du chargement des missions avec alerte budget:",e),e}},async saveCommentairesTechniques(e,t){try{const{data:r,error:n}=await V.from("missions").update({commentaires_techniques:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n){if(n.code==="PGRST204")return console.warn(" Colonne commentaires_techniques n'existe pas encore. Excutez la migration SQL."),console.log("Commentaires stocks localement (seront perdus aprs fermeture)"),{local:!0,data:t};throw n}return console.log(" Commentaires techniques sauvegards en base"),r}catch(r){throw console.error("Erreur lors de la sauvegarde des commentaires techniques:",r),r}},async saveCommentairesFinanciers(e,t){try{const{data:r,error:n}=await V.from("missions").update({commentaires_financiers:t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n){if(n.code==="PGRST204")return console.warn(" Colonne commentaires_financiers n'existe pas encore. Excutez la migration SQL."),console.log("Commentaires stocks localement (seront perdus aprs fermeture)"),{local:!0,data:t};throw n}return console.log(" Commentaires financiers sauvegards en base"),r}catch(r){throw console.error("Erreur lors de la sauvegarde des commentaires financiers:",r),r}},async saveDpenses(e,t){try{const{data:r,error:n}=await V.from("missions").update({depenses_details:t,budget_depense:t.reduce((i,a)=>i+(parseFloat(a.montant)||0),0),updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n){if(n.code==="PGRST204")return console.warn(" Colonne depenses_details n'existe pas encore. Excutez la migration SQL."),console.log("Dpenses stockes localement (seront perdues aprs fermeture)"),{local:!0,data:t};throw n}return console.log(" Dpenses sauvegardes en base"),r}catch(r){throw console.error("Erreur lors de la sauvegarde des dpenses:",r),r}}},ZP=[{code:"01",name:"Adrar"},{code:"02",name:"Chlef"},{code:"03",name:"Laghouat"},{code:"04",name:"Oum El Bouaghi"},{code:"05",name:"Batna"},{code:"06",name:"Bjaa"},{code:"07",name:"Biskra"},{code:"08",name:"Bechar"},{code:"09",name:"Blida"},{code:"10",name:"Bouira"},{code:"11",name:"Tamanrasset"},{code:"12",name:"Tbessa"},{code:"13",name:"Tlemcen"},{code:"14",name:"Tiaret"},{code:"15",name:"Tizi Ouzou"},{code:"16",name:"Alger"},{code:"17",name:"Djelfa"},{code:"18",name:"Jijel"},{code:"19",name:"Stif"},{code:"20",name:"Sada"},{code:"21",name:"Skikda"},{code:"22",name:"Sidi Bel Abbs"},{code:"23",name:"Annaba"},{code:"24",name:"Guelma"},{code:"25",name:"Constantine"},{code:"26",name:"Mda"},{code:"27",name:"Mostaghanem"},{code:"28",name:"Mascara"},{code:"29",name:"Ouargla"},{code:"30",name:"Oran"},{code:"31",name:"El Asnam"},{code:"32",name:"An Dfla"},{code:"33",name:"Boumdes"},{code:"34",name:"Boumerds"},{code:"35",name:"El Tarf"},{code:"36",name:"Tindouf"},{code:"37",name:"Tissemsilt"},{code:"38",name:"El Oued"},{code:"39",name:"Khenchela"},{code:"40",name:"Souk Ahras"},{code:"41",name:"Tipaza"},{code:"42",name:"Mila"},{code:"43",name:"An Temouchent"},{code:"44",name:"Ghardaa"},{code:"45",name:"Relizane"},{code:"46",name:"Draa Ben Khedda"},{code:"47",name:"Draa Ben Khelouf"},{code:"48",name:"Khemis Miliana"},{code:"49",name:"Laghouat"},{code:"50",name:"Nama"},{code:"51",name:"Ouled Djellal"},{code:"52",name:"Bordj Baji Mokhtar"},{code:"53",name:"Ouled Bni Sghir"},{code:"54",name:"ni Abbs"},{code:"55",name:"In Salah"},{code:"56",name:"In Guezzam"},{code:"57",name:"Touggourt"},{code:"58",name:"Djanet"}],fte=e=>{const t=ZP.find(r=>r.name.toLowerCase()===(e==null?void 0:e.toLowerCase()));return(t==null?void 0:t.code)||null},hte=e=>{const t=ZP.find(r=>r.code===e);return(t==null?void 0:t.name)||null},eO=e=>{if(!e)return null;if(e.includes(" - "))return e;if(/^\d{2}$/.test(e)){const r=hte(e);return r?`${e} - ${r}`:e}const t=fte(e);return t?`${t} - ${e}`:e},pte=async(e,t)=>{var r,n,i,a,o;try{const l="AIzaSyDWWtPvq5M42WWRXM5aldUwFNF3BTB5VUQ",c="gemini";if(console.log(" Dmarrage analyse IA..."),console.log("Provider:",c),console.log("API Key prsente:",l?"Oui ":"Non "),c==="gemini")return console.warn(" API Gemini temporairement dsactive (cl compromise). Utilisation des analyses par dfaut."),null;const u={totalClients:e.totalClients,prospects:e.prospects,revenus:e.revenus,resteAPayer:e.resteAPayer,totalInstallations:e.totalInstallations,tauxConversion:e.tauxConversion,tauxRecouvrement:(e.revenus/(e.totalInstallations||1)*100).toFixed(1),top5Dettes:t.slice(0,5).map(h=>({client:h.client,montant:h.montant}))},d=`Tu es un analyste financier expert pour A2S Gestion, socit de logiciels pharmaceutiques en Algrie.

Analyse ces donnes et fournis EXACTEMENT 4 insights en franais (max 50 mots chacun).

DONNES FINANCIRES:
- Clients actifs: ${u.totalClients}
- Prospects en cours: ${u.prospects}
- Revenus encaisss: ${u.revenus.toLocaleString("fr-FR")} DA
- Reste  payer: ${u.resteAPayer.toLocaleString("fr-FR")} DA
- Total installations: ${u.totalInstallations.toLocaleString("fr-FR")} DA
- Taux de conversion: ${u.tauxConversion}%
- Taux de recouvrement: ${u.tauxRecouvrement}%
- Top 5 clients dbiteurs: ${JSON.stringify(u.top5Dettes)}

INSTRUCTIONS:
Fournis 4 insights avec ces catgories exactes:
1. POSITIVE - Tendance encourageante
2. WARNING - Point d'attention urgent
3. INFO - Mtrique cl  surveiller
4. ACTION - Recommandation actionnable

FORMAT JSON STRICT:
[
  {"type": "positive", "title": "Titre court", "message": "Insight concis avec chiffres cls"},
  {"type": "warning", "title": "Titre court", "message": "Insight concis avec chiffres cls"},
  {"type": "info", "title": "Titre court", "message": "Insight concis avec chiffres cls"},
  {"type": "action", "title": "Titre court", "message": "Insight concis avec chiffres cls"}
]

RPONDS UNIQUEMENT EN JSON, RIEN D'AUTRE.`;let f=null;if(c==="gemini"){const h=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${l}`;console.log(" Appel API Gemini (v1beta/gemini-2.0-flash)...");const p=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:d}]}],generationConfig:{temperature:.7,maxOutputTokens:800,topP:.95,topK:40}})});if(console.log("Statut rponse Gemini:",p.status),!p.ok){const m=await p.text();throw console.error(" Erreur API Gemini:",m),new Error("Erreur API Gemini")}const y=await p.json();console.log(" Rponse Gemini reue");const v=(o=(a=(i=(n=(r=y.candidates)==null?void 0:r[0])==null?void 0:n.content)==null?void 0:i.parts)==null?void 0:a[0])==null?void 0:o.text;if(v){console.log(" Contenu brut:",v.substring(0,200)+"...");try{const m=v.replace(/```json\n?/g,"").replace(/```\n?/g,"").trim();f=JSON.parse(m),console.log(" JSON pars avec succs:",f.length,"insights")}catch(m){return console.warn(" Impossible de parser la rponse Gemini:",m.message),console.log("Contenu complet:",v),null}}else console.warn(" Aucun contenu dans la rponse Gemini")}return f&&Array.isArray(f)&&f.length===4?(console.log(" Analyse IA gnre avec succs - 4 insights valids"),f):(console.warn(" Format d'insights invalide:",f),null)}catch(l){return console.error(" Erreur gnration analyse IA:",l.message),console.error("Dtails:",l),null}},mte=()=>{const{profile:e}=dt(),t=uf(),[r,n]=N.useState({totalClients:0,prospects:0,revenus:0,abonnementsActifs:0,resteAPayer:0,totalPaiements:0,tauxConversion:0,totalInstallations:0,revenusAbonnementsPaiements:0,revenusAcquisitionsPaiements:0,revenusAbonnementsInstallations:0,revenusAcquisitionsInstallations:0,tauxRecouvrement:0,totalInterventions:0,nombreAbonnements:0,nombreAcquisitions:0}),[i,a]=N.useState(!0),[o,l]=N.useState([]),[c,u]=N.useState([]),[d,f]=N.useState([]),[h,p]=N.useState([]),[y,v]=N.useState([]),[m,x]=N.useState([]),[b,g]=N.useState([]),[S,w]=N.useState({fullyPaid:0,partiallyPaid:0,noPaid:0,totalInstallations:0}),[j,_]=N.useState(null),[E,A]=N.useState(!1),[P,T]=N.useState(!1);N.useEffect(()=>{if(!i){const I=setTimeout(()=>T(!0),500);return()=>clearTimeout(I)}},[i]),N.useEffect(()=>{M()},[]),N.useEffect(()=>{!i&&r.totalClients>0&&O()},[r]);const M=async()=>{try{a(!0);const I=new Date().getFullYear(),W=C=>C.filter(K=>{const re=K.created_at||K.date_creation||K.date_debut||K.date_installation||K.date_paiement||K.date;return re?new Date(re).getFullYear()===I:!1}),R=await mt.getAll(),D=W(R),H=D.filter(C=>C.statut==="actif").length,Q=D.filter(C=>C.statut==="prospect").length,U=await Tr.getAll(),G=W(U),B=G.reduce((C,K)=>C+(K.montant||0),0),me=await ar.getAll(),ue=W(me),Ne=ue.reduce((C,K)=>C+(K.montant||0),0),ve=await ii.getAll(),Y=W(ve),Z={};Y.forEach(C=>{var se;const K=((se=C.technicien)==null?void 0:se.nom)||"Sans technicien",re=(C.duree_minutes||0)/60;Z[K]||(Z[K]={nom:K,interventions:0,tempsTotalHeures:0}),Z[K].interventions+=1,Z[K].tempsTotalHeures+=re});const te=Object.values(Z).sort((C,K)=>K.interventions-C.interventions);f(te);const L=await Mt.getAll(),ae=W(L),oe={};ae.forEach(C=>{const K=C.wilaya||"Non spcifie";oe[K]||(oe[K]=0),oe[K]++});const le=Object.entries(oe).map(([C,K])=>({wilaya:C,count:K})).sort((C,K)=>K.count-C.count);p(le);const he=Math.max(0,B-Ne);let Se=0,$e=0;ue.forEach(C=>{var re;const K=C.montant||0;C.type==="abonnement"||((re=C.type)==null?void 0:re.toLowerCase())==="abonnement"?Se+=K:$e+=K}),Se===0&&$e===0&&(Se=Ne*.7,$e=Ne*.3);let ze=0,Le=0;G.forEach(C=>{var re;const K=C.montant||0;C.type==="abonnement"||((re=C.type)==null?void 0:re.toLowerCase())==="abonnement"?ze+=K:Le+=K}),ze===0&&Le===0&&(ze=B*.7,Le=B*.3);const q={};G.forEach(C=>{var K;if(!q[C.client_id]){const re=R.find(se=>se.id===C.client_id);q[C.client_id]={client_id:C.client_id,raison_sociale:(re==null?void 0:re.raison_sociale)||((K=C.prospects)==null?void 0:K.raison_sociale)||"Client Inconnu",total_installations:0,total_paye:0}}q[C.client_id].total_installations+=C.montant||0}),ue.forEach(C=>{q[C.client_id]&&(q[C.client_id].total_paye+=C.montant||0)});const $=Object.values(q).map(C=>({client:C.raison_sociale,montant:Math.max(0,C.total_installations-C.total_paye)})).filter(C=>C.montant>0).sort((C,K)=>K.montant-C.montant).slice(0,5);l($),u((()=>{const C=["Jan","Fv","Mar","Avr","Mai","Juin"],K={};return C.forEach(re=>{K[re]={total:0,abonnements:0,acquisitions:0}}),G.forEach(re=>{var Gn;const se=re.created_at;if(!se)return;const we=new Date(se).getMonth(),Pe=C[we]||"Jan",vn=re.montant||0;K[Pe].total+=vn,re.type==="abonnement"||((Gn=re.type)==null?void 0:Gn.toLowerCase())==="abonnement"?K[Pe].abonnements+=vn:K[Pe].acquisitions+=vn}),C.map(re=>({mois:re,total:K[re].total,abonnements:K[re].abonnements,acquisitions:K[re].acquisitions}))})());const xe=D.length>0?(H/D.length*100).toFixed(1):0,ee={fullyPaid:0,partiallyPaid:0,noPaid:0};G&&G.length>0&&G.forEach(C=>{const K=ue.filter(se=>se.installation_id===C.id).reduce((se,Te)=>se+(typeof Te.montant=="number"?Te.montant:0),0),re=Math.max(0,(C.montant||0)-K);re===C.montant||C.montant===0?ee.noPaid++:re>0?ee.partiallyPaid++:ee.fullyPaid++}),w({fullyPaid:ee.fullyPaid,partiallyPaid:ee.partiallyPaid,noPaid:ee.noPaid,totalInstallations:(G==null?void 0:G.length)||0}),n({totalClients:H,prospects:Q,revenus:Ne,abonnementsActifs:H,resteAPayer:he,totalPaiements:Ne,tauxConversion:parseFloat(xe),totalInstallations:B,revenusAbonnementsPaiements:Se,revenusAcquisitionsPaiements:$e,revenusAbonnementsInstallations:ze,revenusAcquisitionsInstallations:Le,tauxRecouvrement:B>0?(Ne/B*100).toFixed(1):0,totalInterventions:(Y==null?void 0:Y.length)||0,nombreAbonnements:(G==null?void 0:G.filter(C=>{var K;return C.type==="abonnement"||((K=C.type)==null?void 0:K.toLowerCase())==="abonnement"}).length)||0,nombreAcquisitions:(G==null?void 0:G.filter(C=>{var K;return C.type==="acquisition"||((K=C.type)==null?void 0:K.toLowerCase())==="acquisition"}).length)||0})}catch(I){console.error("Erreur chargement dashboard:",I)}finally{a(!1)}},O=async()=>{try{A(!0);const I=await pte(r,o);_(I)}catch(I){console.error("Erreur IA:",I),_(null)}finally{A(!1)}},k=[{name:"Abonnements",value:r.revenusAbonnementsPaiements||0,color:"#2563eb"},{name:"Acquisitions",value:r.revenusAcquisitionsPaiements||0,color:"#10b981"}].filter(I=>I.value>0);[{name:"Abonnements",value:r.revenusAbonnementsInstallations||0,color:"#2563eb"},{name:"Acquisitions",value:r.revenusAcquisitionsInstallations||0,color:"#10b981"}].filter(I=>I.value>0);const F=I=>new Intl.NumberFormat("fr-DZ",{style:"currency",currency:"DZD",minimumFractionDigits:0}).format(I);return i?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6 p-6 bg-[#f8fafc] min-h-screen lg:px-8",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-2",children:"Tableau de Bord A2S Gestion"}),s.jsxs("p",{className:"text-gray-600",children:["Bienvenue, ",(e==null?void 0:e.nom)||"utilisateur",". Voici un aperu de vos oprations."]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-sm p-4 hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-blue-100 uppercase tracking-widest text-[10px] font-bold",children:"Clients Actifs"}),s.jsx("h3",{className:"text-3xl font-black text-white",children:r.totalClients})]}),s.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 text-white flex items-center justify-center shrink-0",children:s.jsx(xl,{size:20})})]}),s.jsxs("div",{className:"text-[10px] font-bold text-blue-100 pt-2 border-t border-white/20 flex items-center gap-1 mt-1",children:[s.jsx(cn,{className:"w-3 h-3 mr-1"}),"Croissance stable"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl shadow-sm p-4 hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-emerald-100 uppercase tracking-widest text-[10px] font-bold",children:"Prospects"}),s.jsx("h3",{className:"text-3xl font-black text-white",children:r.prospects})]}),s.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 text-white flex items-center justify-center shrink-0",children:s.jsx(ni,{size:20})})]}),s.jsxs("div",{className:"text-[10px] font-bold text-emerald-100 pt-2 border-t border-white/20 flex items-center gap-1 mt-1",children:["Taux: ",r.tauxConversion,"%"]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-sm p-4 hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-indigo-100 uppercase tracking-widest text-[10px] font-bold",children:"Total Vente"}),s.jsx("h3",{className:"text-3xl font-black text-white",children:(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin"?`${(r.totalInstallations/1e3).toFixed(0)}K DA`:""})]}),s.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 text-white flex items-center justify-center shrink-0",children:s.jsx(yl,{size:20})})]}),s.jsx("div",{className:"text-[10px] font-bold text-indigo-100 pt-2 border-t border-white/20 mt-1",children:"Total gnr"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-sky-500 to-blue-600 rounded-xl shadow-sm p-4 hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sky-100 uppercase tracking-widest text-[10px] font-bold",children:"Montants Vers"}),s.jsx("h3",{className:"text-3xl font-black text-white",children:(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin"?`${(r.totalPaiements/1e3).toFixed(0)}K DA`:""})]}),s.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 text-white flex items-center justify-center shrink-0",children:s.jsx(zt,{size:20})})]}),s.jsx("div",{className:"text-[10px] font-bold text-sky-100 pt-2 border-t border-white/20 mt-1",children:"Paiements enregistrs"})]}),s.jsxs("div",{className:"bg-gradient-to-br from-rose-500 to-red-600 rounded-xl shadow-sm p-4 hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-rose-100 uppercase tracking-widest text-[10px] font-bold",children:"Reste  Payer"}),s.jsx("h3",{className:"text-3xl font-black text-white",children:(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="super_admin"?`${(r.resteAPayer/1e3).toFixed(0)}K DA`:""})]}),s.jsx("div",{className:"w-10 h-10 rounded-lg bg-white/20 text-white flex items-center justify-center shrink-0",children:s.jsx(xt,{size:20})})]}),s.jsx("div",{className:"text-[10px] font-bold text-rose-100 pt-2 border-t border-white/20 mt-1",children:"Montant encore  payer"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 hover:border-indigo-300 transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-widest",children:"Abonnements"}),s.jsx("div",{className:"w-10 h-10 bg-indigo-50 rounded-lg flex items-center justify-center",children:s.jsx(cn,{className:"text-indigo-500 w-5 h-5"})})]}),s.jsx("p",{className:"text-2xl font-black text-indigo-600 mb-1",children:r.nombreAbonnements}),s.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Installations abonnements"})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 hover:border-teal-300 transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-widest",children:"Acquisitions"}),s.jsx("div",{className:"w-10 h-10 bg-teal-50 rounded-lg flex items-center justify-center",children:s.jsx(ni,{className:"text-teal-500 w-5 h-5"})})]}),s.jsx("p",{className:"text-2xl font-black text-teal-600 mb-1",children:r.nombreAcquisitions}),s.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase",children:"Installations acquisitions"})]}),s.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-5 hover:border-cyan-300 transition-all",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:"text-sm font-bold text-gray-800 uppercase tracking-widest",children:"Interventions"}),s.jsx("div",{className:"w-10 h-10 bg-cyan-50 rounded-lg flex items-center justify-center",children:s.jsx(Vh,{className:"text-cyan-500 w-5 h-5"})})]}),s.jsxs("div",{className:"flex justify-between items-end",children:[s.jsx("p",{className:"text-2xl font-black text-cyan-600",children:r.totalInterventions}),s.jsx("div",{className:"flex flex-col gap-1 w-1/2",children:d.slice(0,2).map((I,W)=>s.jsxs("div",{className:"flex justify-between items-center text-[9px] font-bold",children:[s.jsx("span",{className:"text-gray-500 uppercase truncate max-w-[80px]",children:I.nom}),s.jsx("span",{className:"bg-gray-100 text-gray-800 px-1 py-0.5 rounded",children:I.interventions})]},W))})]})]})]}),s.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-100 p-8 hover:shadow-md transition-all",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[s.jsx("div",{className:"w-16 h-16 bg-purple-50 text-purple-600 rounded-2xl flex items-center justify-center",children:s.jsx(mM,{size:32})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"Intelligence Artificielle"}),s.jsx("p",{className:"text-gray-600 text-sm mt-1",children:E?" Analyse en cours...":" Recommandations personnalises bases sur vos donnes"})]})]}),E&&s.jsx("div",{className:"flex items-center justify-center py-16",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Gnration des insights IA..."})]})}),!E&&j&&s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:j.map((I,W)=>{const R={positive:"from-green-50 to-emerald-50 border-green-300",warning:"from-orange-50 to-amber-50 border-orange-300",info:"from-blue-50 to-indigo-50 border-blue-300",action:"from-purple-50 to-violet-50 border-purple-300"},D={positive:"bg-green-500",warning:"bg-orange-500",info:"bg-blue-500",action:"bg-purple-500"},H={positive:"text-green-800",warning:"text-orange-800",info:"text-blue-800",action:"text-purple-800"},Q=I.type==="positive"?cn:I.type==="warning"?xt:I.type==="info"?ni:xr;return s.jsx("div",{className:`bg-gradient-to-br ${R[I.type]} border-2 rounded-xl p-6 hover:shadow-md transition-all`,children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`w-12 h-12 ${D[I.type]} rounded-lg flex items-center justify-center flex-shrink-0`,children:s.jsx(Q,{size:24})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:`font-bold ${H[I.type]} text-lg mb-1`,children:I.title}),s.jsx("p",{className:"text-sm text-gray-800 leading-relaxed",children:I.message})]})]})},W)})}),!E&&!j&&s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-50 text-green-600 flex items-center justify-center flex-shrink-0",children:s.jsx(cn,{size:24})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900 text-lg mb-1",children:"Revenus Solides"}),s.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed font-medium",children:["Votre chiffre d'affaires s'lve  ",s.jsx("strong",{children:F(r.revenus)})," avec ",r.totalClients," clients actifs gnrant des revenus constants."]})]})]})}),s.jsx("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-orange-50 text-orange-600 flex items-center justify-center flex-shrink-0",children:s.jsx(xt,{size:24})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900 text-lg mb-1",children:"Attention Requise"}),s.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed font-medium",children:[s.jsx("strong",{children:F(r.resteAPayer)})," reste  recouvrer. Taux de recouvrement actuel: ",s.jsxs("strong",{children:[r.tauxRecouvrement,"%"]}),"."]})]})]})}),s.jsx("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-50 text-blue-600 flex items-center justify-center flex-shrink-0",children:s.jsx(ni,{size:24})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900 text-lg mb-1",children:"Conversion Prospects"}),s.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed font-medium",children:["Taux de conversion: ",s.jsxs("strong",{children:[r.tauxConversion,"%"]}),". Vous avez ",r.prospects," prospects actuellement en cours de ngociation."]})]})]})}),s.jsx("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-50 text-purple-600 flex items-center justify-center flex-shrink-0",children:s.jsx(Vh,{size:24})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-bold text-gray-900 text-lg mb-1",children:"Activit Technique"}),s.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed font-medium",children:[r.totalInterventions," interventions ralises. Productivit optimale de votre quipe technique."]})]})]})})]}),!E&&!j&&s.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-300 rounded-lg",children:s.jsxs("p",{className:"text-xs text-yellow-800",children:[" ",s.jsx("strong",{children:"Conseil:"})," Configurez VITE_AI_API_KEY dans votre fichier .env pour des analyses IA automatises avec GPT."]})})]}),P&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Interventions par Technicien"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Performance de l'quipe"})]}),s.jsx(Vh,{className:"text-cyan-500 w-6 h-6"})]}),s.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:d.slice(0,8).map((I,W)=>s.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:border-cyan-300 transition-colors",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"font-semibold text-gray-800",children:I.nom}),s.jsx("span",{className:"bg-cyan-100 text-cyan-800 text-xs font-bold px-2 py-1 rounded-full",children:I.interventions})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"bg-cyan-500 h-full rounded-full transition-all",style:{width:Math.min(I.interventions/Math.max(...d.map(R=>R.interventions),1)*100,100)+"%"}})}),s.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[I.tempsTotalHeures.toFixed(1),"h (",(I.tempsTotalHeures/(I.interventions||1)).toFixed(1),"h/intervention)"]})]},W))})]}),s.jsxs("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Rpartition Revenus"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Par type (Depuis Paiements)"})]}),s.jsx(ME,{className:"text-purple-500 w-6 h-6"})]}),s.jsx(k7,{width:"100%",height:320,children:s.jsxs(ute,{children:[s.jsx(Vn,{data:k,cx:"50%",cy:"50%",labelLine:!1,label:({name:I,percent:W})=>`${I} ${(W*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:k.map((I,W)=>s.jsx(L0,{fill:I.color},`cell-${W}`))}),s.jsx(sn,{formatter:I=>F(I)})]})}),s.jsx("div",{className:"mt-4 space-y-2",children:k.map((I,W)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:I.color}}),s.jsx("span",{className:"text-sm text-gray-700",children:I.name})]}),s.jsx("span",{className:"text-sm font-semibold text-gray-800",children:F(I.value)})]},W))})]})]}),s.jsxs("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 hover:shadow-lg transition-shadow",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Missions par Wilaya"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Distribution gographique"})]}),s.jsx(Cn,{className:"text-rose-500 w-6 h-6"})]}),h.length>0?s.jsx("div",{className:"space-y-3",children:h.map((I,W)=>{const R=Math.max(...h.map(U=>U.count),1),D=I.count/R*100,H=["bg-rose-500","bg-pink-500","bg-red-500","bg-orange-500","bg-amber-500"],Q=H[W%H.length];return s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-rose-300 transition-colors",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Cn,{className:"w-4 h-4 text-rose-500"}),s.jsx("span",{className:"font-semibold text-gray-800",children:I.wilaya})]}),s.jsxs("span",{className:`${Q} text-white text-xs font-bold px-3 py-1 rounded-full`,children:[I.count," mission",I.count>1?"s":""]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:`${Q} h-full rounded-full transition-all`,style:{width:D+"%"}})})]},W)})}):s.jsxs("div",{className:"text-center py-8 text-gray-600",children:[s.jsx(Cn,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),s.jsx("p",{children:"Aucune mission enregistre"})]})]}),P&&d.length>0&&s.jsxs("div",{className:"bg-white rounded-[1.5rem] shadow-sm border border-gray-100 p-6 overflow-x-auto",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Interventions par Utilisateur"}),s.jsxs("table",{className:"w-full text-sm text-gray-700",children:[s.jsx("thead",{className:"bg-gray-100 border-b-2 border-gray-300",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left font-bold text-gray-800",children:"Utilisateur"}),s.jsx("th",{className:"px-4 py-3 text-center font-bold text-gray-800",children:"Nombre d'Interventions"}),s.jsx("th",{className:"px-4 py-3 text-center font-bold text-gray-800",children:"Temps Total (heures)"}),s.jsx("th",{className:"px-4 py-3 text-center font-bold text-gray-800",children:"Temps Moyen"})]})}),s.jsx("tbody",{children:d.map((I,W)=>{const R=I.interventions>0?(I.tempsTotalHeures/I.interventions).toFixed(1):0;return s.jsxs("tr",{className:W%2===0?"bg-white":"bg-gray-50",children:[s.jsx("td",{className:"px-4 py-4 font-medium text-gray-900",children:I.nom}),s.jsx("td",{className:"px-4 py-4 text-center",children:s.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded-full font-semibold",children:I.interventions})}),s.jsx("td",{className:"px-4 py-4 text-center",children:s.jsxs("span",{className:"inline-block bg-green-100 text-green-800 px-3 py-1 rounded-full font-semibold",children:[I.tempsTotalHeures.toFixed(1),"h"]})}),s.jsxs("td",{className:"px-4 py-4 text-center text-gray-600",children:[R,"h/intervention"]})]},W)})})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl p-6 text-white shadow-lg hover:shadow-2xl hover:scale-[1.02] transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-10 -mt-10 group-hover:scale-150 transition-transform"}),s.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/20 text-white shadow-inner",children:s.jsx(ni,{size:28})}),s.jsx("h3",{className:"text-xl font-black",children:"Ajouter Prospect"})]}),s.jsx("p",{className:"text-blue-100 text-sm mb-6 flex-1",children:"Crer un nouveau prospect dans le pipeline"}),s.jsx("button",{onClick:()=>t(`/${Ee.PROSPECTS}`),className:"w-full bg-white/20 hover:bg-white text-white hover:text-indigo-600 py-3 px-4 rounded-xl transition-colors font-bold tracking-wide backdrop-blur-sm border border-white/30 hover:border-white shadow-sm",children:"Nouveau Prospect"})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 rounded-3xl p-6 text-white shadow-lg hover:shadow-2xl hover:scale-[1.02] transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-10 -mt-10 group-hover:scale-150 transition-transform"}),s.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/20 text-white shadow-inner",children:s.jsx(cn,{size:28})}),s.jsx("h3",{className:"text-xl font-black",children:"Gestion Missions"})]}),s.jsx("p",{className:"text-indigo-100 text-sm mb-6 flex-1",children:"Piloter les missions et l'oprationnel de l'quipe"}),s.jsx("button",{onClick:()=>t(`/${Ee.MISSIONS}`),className:"w-full bg-white/20 hover:bg-white text-white hover:text-purple-600 py-3 px-4 rounded-xl transition-colors font-bold tracking-wide backdrop-blur-sm border border-white/30 hover:border-white shadow-sm",children:"Voir Missions"})]})]}),s.jsxs("div",{className:"bg-gradient-to-br from-emerald-500 to-teal-600 rounded-3xl p-6 text-white shadow-lg hover:shadow-2xl hover:scale-[1.02] transition-all group relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-10 -mt-10 group-hover:scale-150 transition-transform"}),s.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/20 text-white shadow-inner",children:s.jsx(yl,{size:28})}),s.jsx("h3",{className:"text-xl font-black",children:"Paiements"})]}),s.jsx("p",{className:"text-emerald-100 text-sm mb-6 flex-1",children:"Grer les flux financiers et le recouvrement"}),s.jsx("button",{onClick:()=>t(`/${Ee.PAIEMENTS}`),className:"w-full bg-white/20 hover:bg-white text-white hover:text-teal-600 py-3 px-4 rounded-xl transition-colors font-bold tracking-wide backdrop-blur-sm border border-white/30 hover:border-white shadow-sm",children:"Accder aux Paiements"})]})]})]})]})]})},Wt=({isOpen:e,onClose:t,title:r,children:n,size:i="md"})=>{if(N.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[e]),!e)return null;const a={sm:"max-w-md",md:"max-w-2xl",lg:"max-w-4xl",xl:"max-w-6xl"};return s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),s.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:s.jsxs("div",{className:`relative bg-white rounded-xl shadow-2xl w-full ${a[i]} transform transition-all`,onClick:o=>o.stopPropagation(),children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:r}),s.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(Lr,{size:24})})]}),s.jsx("div",{className:"p-6",children:n})]})})]})},je=({children:e,variant:t="primary",size:r="md",icon:n,onClick:i,disabled:a=!1,type:o="button",className:l="",title:c=""})=>{const u="inline-flex items-center justify-center gap-2 font-semibold rounded-lg transition-colors duration-200",d={primary:a?"bg-gray-300 text-gray-500":"bg-primary hover:bg-primary-dark text-white",secondary:a?"bg-gray-300 text-gray-500":"bg-secondary hover:bg-secondary-dark text-white",success:a?"bg-gray-300 text-gray-500":"bg-success hover:bg-green-600 text-white",danger:a?"bg-gray-300 text-gray-500":"bg-danger hover:bg-red-600 text-white",warning:a?"bg-gray-300 text-gray-500":"bg-warning hover:bg-orange-600 text-white",outline:a?"border-2 border-gray-300 text-gray-400":"border-2 border-primary text-primary hover:bg-primary hover:text-white",ghost:a?"text-gray-300":"text-gray-600 hover:bg-gray-100"},f={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"},h=a?"cursor-not-allowed":"";return s.jsxs("button",{type:o,onClick:i,disabled:a,title:c,className:`${u} ${d[t]} ${f[r]} ${h} ${l}`,children:[n&&s.jsx(n,{size:r==="sm"?16:r==="lg"?24:20}),e]})},gc=({value:e,onChange:t,placeholder:r="Rechercher..."})=>s.jsxs("div",{className:"relative",children:[s.jsx(hf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),s.jsx("input",{type:"text",value:e,onChange:n=>t(n.target.value),placeholder:r,className:"input-field pl-10"})]}),Fe={async canCreate(e){return Zt.canManageUsers(e)},async canUpdate(e,t){if(!Zt.canManageUsers(e))return!1;if((e==null?void 0:e.role)==="admin")try{const r=await this.getById(t);if((r==null?void 0:r.role)==="super_admin")return!1}catch(r){return console.error("Erreur vrification permission update:",r),!1}return!0},async canDelete(e,t){if(!Zt.canManageUsers(e))return!1;try{const r=await this.getById(t);if((r==null?void 0:r.role)==="super_admin")return(e==null?void 0:e.role)==="super_admin";const{count:n}=await V.from(ie.PROSPECTS).select("id",{count:"exact",head:!0}).eq("created_by",t);if(n>0)return!1;const{count:i}=await V.from(ie.INSTALLATIONS).select("id",{count:"exact",head:!0}).eq("created_by",t);if(i>0)return!1;const{count:a}=await V.from(ie.PAIEMENTS).select("id",{count:"exact",head:!0}).eq("created_by",t);if(a>0)return!1;const{count:o}=await V.from(ie.INTERVENTIONS).select("id",{count:"exact",head:!0}).eq("created_by",t);return!(o>0)}catch(r){return console.error("Erreur vrification permission delete:",r),!1}},async getAll(){try{const{data:e,error:t}=await V.from(ie.USERS).select("*").order("nom",{ascending:!0});if(t)throw t;return e}catch(e){throw console.error("Erreur rcupration utilisateurs:",e),e}},async getById(e){try{const{data:t,error:r}=await V.from(ie.USERS).select("*").eq("id",e).single();if(r)throw r;return t}catch(t){throw console.error("Erreur rcupration utilisateur:",t),t}},async getByRole(e){try{const{data:t,error:r}=await V.from(ie.USERS).select("*").eq("role",e).order("nom",{ascending:!0});if(r)throw r;return t}catch(t){throw console.error("Erreur rcupration utilisateurs par rle:",t),t}},async getCommerciaux(){return this.getByRole("commercial")},async getTechniciens(){return this.getByRole("technicien")},async create(e,t){var r,n,i;try{if(!await this.canCreate(t)){const f=new Error("Vous n'avez pas la permission de crer des utilisateurs");throw f.code="PERMISSION_DENIED",f}const{data:a,error:o}=await V.from(ie.USERS).select("id, email").ilike("email",e.email);if(a&&a.length>0){const f=new Error(`Un utilisateur avec l'email ${e.email} existe dj`);throw f.code="DUPLICATE_EMAIL",f}const l=Object.values(cb),c=(r=e.role)==null?void 0:r.trim().toLowerCase();if(!c||!l.includes(c)){const f=new Error(`Rle invalide: "${e.role}". Rles valides: ${l.join(", ")}`);throw f.code="INVALID_ROLE",f}e.role=c;let u=null,d=null;try{console.log(` Cration d'utilisateur locale avec email: ${e.email}`);const{data:f,error:h}=await V.rpc("create_user_local",{p_email:e.email,p_password:e.password,p_nom:e.nom,p_role:e.role,p_pages_visibles:Array.isArray(e.pages_visibles)?e.pages_visibles:[]});if(h){if(console.error(" Erreur cration authentification locale:",h),(n=h.message)!=null&&n.includes("duplicate")||(i=h.message)!=null&&i.includes("existe")){const p=new Error(`Un utilisateur avec l'email ${e.email} existe dj`);throw p.code="DUPLICATE_EMAIL",p}throw h}if(f&&f.length>0){const p=f[0];if(u=p.user_id,d={id:p.user_id,email:p.email,nom:p.nom,role:p.role,pages_visibles:Array.isArray(e.pages_visibles)?e.pages_visibles:[]},console.log(" Utilisateur cr avec authentification locale:",{userId:u,email:e.email,nom:e.nom,role:e.role}),u)try{const y={};if(["can_create_prospects","can_edit_prospects","can_delete_prospects","can_create_clients","can_edit_clients","can_delete_clients","can_create_installations","can_edit_installations","can_delete_installations","can_create_abonnements","can_edit_abonnements","can_delete_abonnements","can_create_paiements","can_edit_paiements","can_delete_paiements","can_create_support","can_edit_support","can_delete_support","can_create_missions","can_edit_missions","can_delete_missions","can_close_missions","can_validate_missions","can_create_alertes","can_edit_alertes","can_delete_alertes","can_create_applications","can_edit_applications","can_delete_applications"].forEach(m=>{e.hasOwnProperty(m)&&(e[m]===!0||e[m]===!1)&&(y[m]=e[m])}),Object.keys(y).length>0){const{error:m}=await V.from(ie.USERS).update(y).eq("id",u);m?console.error("Erreur sauvegarde permissions:",m):console.log(" Permissions sauvegardes:",y)}}catch(y){console.error("Erreur lors de la sauvegarde des permissions:",y)}return d}else throw new Error("Impossible de crer l'utilisateur - pas de rponse du serveur")}catch(f){throw console.error(" Erreur cration utilisateur:",f),f}}catch(a){throw console.error(" Erreur cration utilisateur:",a),a}},async update(e,t,r){try{if(!await this.canUpdate(r,e)){const u=new Error("Vous n'avez pas la permission de modifier cet utilisateur");throw u.code="PERMISSION_DENIED",u}const i={};if(t.nom&&(i.nom=t.nom),t.email&&(i.email=t.email),t.role){const u=t.role.trim().toLowerCase(),d=Object.values(cb);if(!d.includes(u)){const f=new Error(`Rle invalide: "${t.role}". Rles valides: ${d.join(", ")}`);throw f.code="INVALID_ROLE",f}i.role=u}t.pages_visibles&&(Array.isArray(t.pages_visibles)?i.pages_visibles=t.pages_visibles:typeof t.pages_visibles=="object"&&(i.pages_visibles=Object.keys(t.pages_visibles).filter(u=>t.pages_visibles[u]===!0)));const a=["can_create_prospects","can_edit_prospects","can_delete_prospects","can_create_clients","can_edit_clients","can_delete_clients","can_create_installations","can_edit_installations","can_delete_installations","can_create_abonnements","can_edit_abonnements","can_delete_abonnements","can_create_paiements","can_edit_paiements","can_delete_paiements","can_create_support","can_edit_support","can_delete_support","can_create_missions","can_edit_missions","can_delete_missions","can_close_missions","can_validate_missions","can_create_alertes","can_edit_alertes","can_delete_alertes","can_create_applications","can_edit_applications","can_delete_applications"];let o=0;a.forEach(u=>{t.hasOwnProperty(u)&&(t[u]===!0||t[u]===!1)&&(i[u]=t[u],o++)}),o>0&&console.log(` ${o} permission(s) sera(ont) mise(s)  jour`),console.log("dataToUpdate final:",JSON.stringify(i,null,2));const{data:l,error:c}=await V.from(ie.USERS).update(i).eq("id",e).select().single();if(c)throw console.error("Erreur dtaille Supabase:",c),console.error("Donnes envoyes:",i),c;return l}catch(n){throw console.error("Erreur mise  jour utilisateur:",n),n}},async delete(e,t){try{const r=await this.getUserCreatedPieces(e);if(r.hasCreatedPieces){const o=new Error(` Impossible de supprimer cet utilisateur.

Cet utilisateur a cr les pices suivantes:

${r.details.join(`
`)}

Un utilisateur qui a cr au moins une pice ne peut pas tre supprim.
Contactez un administrateur.`);throw o.code="USER_CREATED_PIECES",o.details=r.details,o}if(!await this.canDelete(t,e)){const o=new Error("Vous n'avez pas la permission de supprimer cet utilisateur");throw o.code="PERMISSION_DENIED",o}const i=await this.checkUserReferences(e);if(i.hasReferences){const o=new Error(` Impossible de supprimer cet utilisateur.

L'utilisateur est li :
${i.details.join(`
`)}

Supprimez d'abord ces enregistrements ou contactez un administrateur.`);throw o.code="USER_HAS_REFERENCES",o.details=i.details,o}const{error:a}=await V.from(ie.USERS).delete().eq("id",e);if(a)throw console.error("Erreur suppression table users:",a),a;try{console.log(" Authentification locale supprime (cascade FK)")}catch{console.warn("Note: Authentification locale dj supprime ou inexistante")}return console.log(" Utilisateur supprim avec succs (BDD + authentification locale)"),!0}catch(r){throw console.error("Erreur suppression utilisateur:",r),r}},async hasCreatePermission(e,t){try{const r=await this.getById(e);if(!r)return!1;if(r.role==="admin"||r.role==="super_admin")return!0;const n=`can_create_${t}`;return r[n]===!0}catch(r){return console.error(`Erreur vrification permission create ${t}:`,r),!1}},async hasEditPermission(e,t){try{const r=await this.getById(e);if(!r)return!1;if(r.role==="admin"||r.role==="super_admin")return!0;const n=`can_edit_${t}`;return r[n]===!0}catch(r){return console.error(`Erreur vrification permission edit ${t}:`,r),!1}},async hasDeletePermission(e,t){try{const r=await this.getById(e);if(!r)return!1;if(r.role==="admin"||r.role==="super_admin")return!0;const n=`can_delete_${t}`;return r[n]===!0}catch(r){return console.error(`Erreur vrification permission delete ${t}:`,r),!1}},async hasClosePermission(e,t){try{const r=await this.getById(e);if(!r)return!1;if(r.role==="admin"||r.role==="super_admin")return!0;const n=`can_close_${t}`;return r[n]===!0}catch(r){return console.error(`Erreur vrification permission close ${t}:`,r),!1}},async getUserCreatedPieces(e){try{const t=[];let r=!1;const{data:n,error:i}=await V.from(ie.PROSPECTS).select("id",{count:"exact",head:!1}).eq("created_by",e).limit(5);!i&&(n==null?void 0:n.length)>0&&(r=!0,t.push(` ${n.length} prospect(s) cr(s)`));const{data:a,error:o}=await V.from(ie.INSTALLATIONS).select("id",{count:"exact",head:!1}).eq("created_by",e).limit(5);!o&&(a==null?void 0:a.length)>0&&(r=!0,t.push(` ${a.length} installation(s) cre(s)`));const{data:l,error:c}=await V.from(ie.PAIEMENTS).select("id",{count:"exact",head:!1}).eq("created_by",e).limit(5);!c&&(l==null?void 0:l.length)>0&&(r=!0,t.push(` ${l.length} paiement(s) cr(s)`));const{data:u,error:d}=await V.from(ie.INTERVENTIONS).select("id",{count:"exact",head:!1}).eq("created_by",e).limit(5);return!d&&(u==null?void 0:u.length)>0&&(r=!0,t.push(` ${u.length} intervention(s) cre(s)`)),{hasCreatedPieces:r,details:t}}catch(t){return console.error("Erreur vrification pices cres:",t),{hasCreatedPieces:!1,details:[]}}},async checkUserReferences(e){try{const t=[];let r=!1;const{data:n,error:i}=await V.from(ie.INTERVENTIONS).select("id",{count:"exact",head:!1}).eq("technicien_id",e).limit(5);return!i&&(n==null?void 0:n.length)>0&&(r=!0,t.push(` ${n.length} intervention(s) assigne(s)`)),{hasReferences:r,details:t}}catch(t){return console.error("Erreur vrification rfrences utilisateur:",t),{hasReferences:!1,details:[]}}}},vv=({onSearchChange:e,onDateStartChange:t,onDateEndChange:r,onCreatorChange:n,searchValue:i="",dateStart:a="",dateEnd:o="",creatorId:l=""})=>{const{profile:c}=dt(),[u,d]=N.useState([]),[f,h]=N.useState(!1),[p,y]=N.useState(l);(c==null?void 0:c.role)==="admin"||(c==null||c.role),N.useEffect(()=>{v()},[]),N.useEffect(()=>{y(l)},[l]);const v=async()=>{try{h(!0);const b=await Fe.getAll();d(b||[])}catch(b){console.error("Erreur chargement utilisateurs:",b),d([])}finally{h(!1)}},m=()=>{e(""),t(""),r(""),n("")},x=i||a||o||l;return s.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(hf,{size:18,className:"absolute left-3 top-3 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Rechercher...",value:i,onChange:b=>e(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(xr,{size:18,className:"absolute left-3 top-3 text-gray-400"}),s.jsx("input",{type:"date",value:a,onChange:b=>t(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(xr,{size:18,className:"absolute left-3 top-3 text-gray-400"}),s.jsx("input",{type:"date",value:o,onChange:b=>r(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("div",{className:"relative",children:[s.jsx(d0,{size:18,className:"absolute left-3 top-3 text-gray-400"}),s.jsxs("select",{value:p||"",onChange:b=>{const g=b.target.value;console.log(` Slection crateur dans FilterBar: ${g}`),y(g),n(g)},disabled:f||u.length===0,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100",title:u.length===0?`Chargement des utilisateurs (${u.length})`:"",children:[s.jsx("option",{value:"",children:f?"Chargement...":`Tous les crateurs (${u.length})`}),u.map(b=>s.jsx("option",{value:b.id,children:b.nom||b.email},b.id))]})]})]}),x&&s.jsx("div",{className:"mt-3 flex justify-end",children:s.jsxs("button",{onClick:m,className:"inline-flex items-center gap-2 px-3 py-1 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:[s.jsx(Lr,{size:16}),"Effacer les filtres"]})})]})},yc=({data:e=[],columns:t=[],actions:r=[],loading:n=!1,emptyMessage:i="Aucune donne trouve",onAdd:a=null,addButtonLabel:o="Ajouter",title:l="Tableau de Donnes",rowClassName:c=null,rowStyle:u=null})=>n?s.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:s.jsx("p",{className:"text-gray-600",children:"Chargement..."})}):e.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[s.jsx("p",{className:"text-gray-600",children:i}),a&&s.jsxs(je,{onClick:a,className:"mt-4 bg-primary hover:bg-primary-dark text-white flex items-center gap-2 mx-auto",children:[s.jsx(Un,{size:18}),o]})]}):s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[t.map(d=>s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",style:{width:d.width||"auto"},children:d.label},d.key)),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map((d,f)=>{const h=typeof c=="function"?c(d):c||"",p=typeof u=="function"?u(d):u||{};return s.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${h}`,style:p,children:[t.map(y=>s.jsx("td",{className:`px-6 py-4 text-sm ${y.className||"text-gray-600"}`,children:y.render?y.render(d):String(d[y.key]||"-")},y.key)),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx("div",{className:"flex gap-2 justify-center flex-wrap",children:r.map(y=>{if(y.condition&&!y.condition(d))return null;const v=typeof y.disabled=="function"?y.disabled(d):y.disabled||!1,m=typeof y.title=="function"?y.title(d):y.title||y.label,x=typeof y.className=="function"?y.className(d):y.className||"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2";return s.jsx(je,{onClick:()=>y.onClick(d),disabled:v,className:x,title:m,children:y.icon?y.icon:y.label},y.key)})})})]},d.id||f)})})]})}),e.length===0&&s.jsx("div",{className:"px-6 py-12 text-center",children:s.jsx("p",{className:"text-gray-600",children:i})})]}),Ie=({label:e,type:t="text",value:r,onChange:n,placeholder:i,error:a,required:o=!1,disabled:l=!1,icon:c,...u})=>s.jsxs("div",{className:"w-full",children:[e&&s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e,o&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsxs("div",{className:"relative",children:[c&&s.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:s.jsx(c,{size:20})}),s.jsx("input",{type:t,value:r||"",onChange:n,placeholder:i,disabled:l,className:`
            input-field
            ${c?"pl-10":""}
            ${a?"border-red-500 focus:ring-red-500":""}
            ${l?"bg-gray-100 cursor-not-allowed":""}
          `,...u})]}),a&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a})]}),tO=[{id:"01",name:"Adrar",code:"01"},{id:"02",name:"Chlef",code:"02"},{id:"03",name:"Laghouat",code:"03"},{id:"04",name:"Oum El Bouaghi",code:"04"},{id:"05",name:"Batna",code:"05"},{id:"06",name:"Bjaa",code:"06"},{id:"07",name:"Biskra",code:"07"},{id:"08",name:"Bchar",code:"08"},{id:"09",name:"Blida",code:"09"},{id:"10",name:"Bouira",code:"10"},{id:"11",name:"Tamanrasset",code:"11"},{id:"12",name:"Tbessa",code:"12"},{id:"13",name:"Tlemcen",code:"13"},{id:"14",name:"Tiaret",code:"14"},{id:"15",name:"Tizi Ouzou",code:"15"},{id:"16",name:"Alger",code:"16"},{id:"17",name:"Djelfa",code:"17"},{id:"18",name:"Djijel",code:"18"},{id:"19",name:"Stif",code:"19"},{id:"20",name:"Sada",code:"20"},{id:"21",name:"Skikda",code:"21"},{id:"22",name:"Sidi Bel Abbs",code:"22"},{id:"23",name:"Annaba",code:"23"},{id:"24",name:"Guelma",code:"24"},{id:"25",name:"Constantine",code:"25"},{id:"26",name:"Mda",code:"26"},{id:"27",name:"Mostaganem",code:"27"},{id:"28",name:"M'Sila",code:"28"},{id:"29",name:"Mascara",code:"29"},{id:"30",name:"Ouargla",code:"30"},{id:"31",name:"Oran",code:"31"},{id:"32",name:"El Bayadh",code:"32"},{id:"33",name:"Illizi",code:"33"},{id:"34",name:"Bordj Bou Arreridj",code:"34"},{id:"35",name:"Boumerds",code:"35"},{id:"36",name:"El Tarf",code:"36"},{id:"37",name:"Tindouf",code:"37"},{id:"38",name:"Tissemsilt",code:"38"},{id:"39",name:"El Oued",code:"39"},{id:"40",name:"Khenchela",code:"40"},{id:"41",name:"Souk Ahras",code:"41"},{id:"42",name:"Tipaza",code:"42"},{id:"43",name:"Mila",code:"43"},{id:"44",name:"An Defla",code:"44"},{id:"45",name:"Nama",code:"45"},{id:"46",name:"An Tmouchent",code:"46"},{id:"47",name:"Ghardaa",code:"47"},{id:"48",name:"Relizane",code:"48"},{id:"49",name:"El M'Ghair",code:"49"},{id:"50",name:"El Menia",code:"50"},{id:"51",name:"Ouled Djellal",code:"51"},{id:"52",name:"El Harrach",code:"52"},{id:"53",name:"El Madania",code:"53"},{id:"54",name:"El Kseur",code:"54"},{id:"55",name:"El Mena",code:"55"},{id:"56",name:"El Oued",code:"56"},{id:"57",name:"El Tarf",code:"57"},{id:"58",name:"Tissemsilt",code:"58"}],gte=e=>{const t=tO.find(r=>r.code===e);return t?t.name:e},yte=tO.map(e=>({value:e.code,label:`${e.code} - ${e.name}`})),vte=({prospect:e,onSubmit:t,onCancel:r})=>{const{user:n}=dt(),[i,a]=N.useState({raison_sociale:"",contact:"",secteur:"",telephone:"",email:"",wilaya:"",ville:"",adresse:"",forme_juridique:"",commercial_assigned:"",temperature:"froid"}),[o,l]=N.useState({}),[c,u]=N.useState(!1);N.useEffect(()=>{a(e?{raison_sociale:e.raison_sociale||"",contact:e.contact||"",secteur:e.secteur||"",telephone:e.telephone||"",email:e.email||"",wilaya:e.wilaya||"",ville:e.ville||"",adresse:e.adresse||"",forme_juridique:e.forme_juridique||"",commercial_assigned:e.commercial_assigned||(n==null?void 0:n.nom)||(n==null?void 0:n.email)||"",temperature:e.temperature||"froid"}:{raison_sociale:"",contact:"",secteur:"",telephone:"",email:"",wilaya:"",ville:"",adresse:"",forme_juridique:"",commercial_assigned:(n==null?void 0:n.nom)||(n==null?void 0:n.email)||"",temperature:"froid"}),l({})},[e,n]);const d=(h,p)=>{a(y=>({...y,[h]:p})),o[h]&&l(y=>({...y,[h]:""}))},f=async h=>{var y,v,m,x,b,g;h.preventDefault();const p={};if((y=i.raison_sociale)!=null&&y.trim()||(p.raison_sociale="Raison sociale requise"),(v=i.contact)!=null&&v.trim()||(p.contact="Contact requis"),(m=i.secteur)!=null&&m.trim()||(p.secteur="Secteur requis"),(x=i.telephone)!=null&&x.trim()||(p.telephone="Tlphone requis"),(b=i.email)!=null&&b.trim()||(p.email="Email requis"),(g=i.wilaya)!=null&&g.trim()||(p.wilaya="Wilaya requise"),Object.keys(p).length>0){l(p);return}if(!c)try{u(!0),await t(i)}finally{u(!1)}};return s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsx(Ie,{label:"Raison Sociale",type:"text",value:i.raison_sociale,onChange:h=>d("raison_sociale",h.target.value),placeholder:"Nom de l'entreprise",error:o.raison_sociale,required:!0,disabled:c}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Forme Juridique"}),s.jsxs("select",{value:i.forme_juridique,onChange:h=>d("forme_juridique",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",disabled:c,children:[s.jsx("option",{value:"",children:"Slectionner..."}),s.jsx("option",{value:"SARL",children:"SARL"}),s.jsx("option",{value:"EURL",children:"EURL"}),s.jsx("option",{value:"SPA",children:"SPA"}),s.jsx("option",{value:"SNC",children:"SNC"}),s.jsx("option",{value:"PERSONNE PHYSIQUE",children:"PERSONNE PHYSIQUE"}),s.jsx("option",{value:"AUTRE",children:"AUTRE"})]})]}),s.jsx(Ie,{label:"Contact",type:"text",value:i.contact,onChange:h=>d("contact",h.target.value),placeholder:"Nom du contact",error:o.contact,required:!0,disabled:c}),s.jsx(Ie,{label:"Tlphone",type:"tel",value:i.telephone,onChange:h=>d("telephone",h.target.value),placeholder:"+213 XXX XXX XXX",error:o.telephone,required:!0,disabled:c}),s.jsx(Ie,{label:"Email",type:"email",value:i.email,onChange:h=>d("email",h.target.value),placeholder:"email@example.com",error:o.email,required:!0,disabled:c}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Secteur ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:i.secteur,onChange:h=>d("secteur",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",disabled:c,required:!0,children:[s.jsx("option",{value:"",children:"Slectionner un secteur"}),s.jsx("option",{value:"GROSSISTE PHARM",children:"GROSSISTE PHARM"}),s.jsx("option",{value:"GROSSISTE PARA",children:"GROSSISTE PARA"}),s.jsx("option",{value:"PARA SUPER GROS",children:"PARA SUPER GROS"}),s.jsx("option",{value:"LABO PROD",children:"LABO PROD"}),s.jsx("option",{value:"AUTRE",children:"AUTRE"})]}),o.secteur&&s.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.secteur})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[" Wilaya ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsxs("select",{value:i.wilaya,onChange:h=>d("wilaya",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",disabled:c,required:!0,children:[s.jsx("option",{value:"",children:"Slectionner une wilaya"}),yte.map(h=>s.jsx("option",{value:h.value,children:h.label},h.value))]}),o.wilaya&&s.jsx("p",{className:"text-sm text-red-600 mt-1",children:o.wilaya})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(Ie,{label:"Ville",type:"text",value:i.ville,onChange:h=>d("ville",h.target.value),placeholder:"Ville",disabled:c}),s.jsx(Ie,{label:"Adresse",type:"text",value:i.adresse,onChange:h=>d("adresse",h.target.value),placeholder:"Adresse complte",disabled:c})]}),s.jsx(Ie,{label:"Commercial Assign",type:"text",value:i.commercial_assigned,disabled:!0,placeholder:"Assign automatiquement"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:" Degr d'intrt (Temprature)"}),s.jsxs("select",{value:i.temperature,onChange:h=>d("temperature",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",disabled:c,children:[s.jsx("option",{value:"froid",children:" Froid (Peu intress)"}),s.jsx("option",{value:"tiede",children:" Tide (En rflexion)"}),s.jsx("option",{value:"chaud",children:" Chaud (Trs intress)"}),s.jsx("option",{value:"brulant",children:" Brlant (Prt  signer)"}),s.jsx("option",{value:"acquis",children:" Acquis (Client historique)"})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"Permet de classer le prospect selon son niveau d'intrt actuel."})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{type:"button",variant:"ghost",onClick:r,disabled:c,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",disabled:c,children:c?"Cration en cours...":e?"Modifier":"Crer"})]})]})},Ko={async getAllPlanned(){try{console.log(" Chargement des installations planifies (prospect_history)...");const{data:e,error:t}=await V.from("prospect_history").select(`
    *,
    prospect: prospects(
        id,
        raison_sociale,
        contact,
        telephone,
        email,
        wilaya,
        secteur,
        statut
    ),
    mission: missions!mission_id(
        id,
        statut
    )
        `).eq("type_action","installation").order("date_debut",{ascending:!0});if(t)throw console.error(" Erreur rcupration installations (prospect_history table manquante ?):",t),console.error("Dtails erreur:",t.details,t.message),t;return console.log(" Installations charges:",(e==null?void 0:e.length)||0,"installations trouves"),e&&e.length>0?console.log(" Exemple 1er lment:",e[0]):console.warn(" Aucune installation trouve dans la table prospect_history."),e||[]}catch(e){return console.error(" Erreur CRITIQUE service installations:",e),[]}},async getByProspect(e){try{const{data:t,error:r}=await V.from("prospect_history").select("*").eq("prospect_id",e).eq("type_action","installation").order("date_debut",{ascending:!0});if(r)throw r;return t||[]}catch(t){return console.error("Erreur rcupration installations prospect:",t),[]}},async getByDateRange(e,t){try{const{data:r,error:n}=await V.from("prospect_history").select(`
        *,
        prospect: prospects(
            id,
            raison_sociale,
            contact,
            telephone,
            email,
            wilaya,
            secteur,
            statut
        ),
        mission: missions!mission_id(
            id,
            statut
        )
            `).eq("type_action","installation").gte("date_debut",e).lte("date_fin",t).order("date_debut",{ascending:!0});if(n)throw n;return r||[]}catch(r){return console.error("Erreur rcupration installations par priode:",r),[]}},async getStats(){try{const{data:e,error:t}=await V.from("prospect_history").select("*").eq("type_action","installation");if(t)throw t;const r=new Date,n=e||[];return{total:n.length,aVenir:n.filter(i=>new Date(i.date_debut)>r).length,enCours:n.filter(i=>{const a=new Date(i.date_debut),o=new Date(i.date_fin);return a<=r&&o>=r}).length,terminees:n.filter(i=>new Date(i.date_fin)<r).length}}catch(e){return console.error("Erreur statistiques installations:",e),{total:0,aVenir:0,enCours:0,terminees:0}}},async update(e,t){try{const{data:r,error:n}=await V.from("prospect_history").update(t).eq("id",e).select();if(n)throw n;return r&&r.length>0?r[0]:null}catch(r){throw console.error("Erreur mise  jour planning service:",r),r}},async delete(e){try{const{error:t}=await V.from("prospect_history").delete().eq("id",e);if(t)throw t;return!0}catch(t){throw console.error("Erreur suppression planning service:",t),t}}},rO=({prospectId:e,prospect:t})=>{const{profile:r}=dt(),[n,i]=N.useState([]),[a,o]=N.useState(null),[l,c]=N.useState(!0),[u,d]=N.useState([]),[f,h]=N.useState(!1),[p,y]=N.useState(null),[v,m]=N.useState(!1);N.useEffect(()=>{e&&(b(),x())},[e]);const x=async()=>{try{const _=await Fe.getAll();d(_||[])}catch(_){console.error("Erreur users:",_)}},b=async()=>{try{console.log(" Chargement historique pour prospect/client:",e);const _=await mt.getHistorique(e);console.log(" Historique rcupr:",_);const E=await Tr.getByClient(e);console.log(" Installations:",E);let A=null;E&&E.length>0&&(A=E.reduce((T,M)=>new Date(M.date_installation)<new Date(T.date_installation)?M:T)),o(A);let P=_;A&&console.log(" Premire installation trouve:",A.date_installation),console.log(" Historique affich:",P),i(P)}catch(_){console.error(" Erreur chargement historique:",_),i([])}finally{c(!1)}},g=async _=>{if(_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0"){alert(` Impossible de supprimer cette action car une mission (ID: ${_.mission_id}) y est dj lie.`);return}if(window.confirm(` Voulez-vous vraiment supprimer cette action du planning ?
Elle sera galement retire de la vue Planification.`))try{await mt.deleteAction(e,_),b()}catch(A){console.error("Erreur suppression:",A),alert("Erreur lors de la suppression")}},S=_=>{if(!_.id){alert(" Cette action ancienne ne peut pas tre modifie.");return}if(_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0"){alert(` Impossible de modifier cette action car une mission (ID: ${_.mission_id}) y est dj lie.`);return}y({..._}),h(!0)},w=async _=>{_.preventDefault(),m(!0);try{const{id:E,...A}=p,P={description:A.description};p.action==="installation"||p.type_action==="installation"?(P.application=A.application,P.date_debut=A.date_debut,P.date_fin=A.date_fin,P.chef_mission=A.chef_mission,P.conversion=A.conversion):P.created_at=A.created_at,await Ko.update(E,P),h(!1),b()}catch{alert("Erreur lors de la mise  jour")}finally{m(!1)}},j=_=>({appel:bu,email:c0,rdv:xr,demo:xu,offre_envoyee:xu,suivi:bu,relance:bu,visite:xr,negociation:zi,contrat_signe:aM,creation:zt,modification:br,conversion:Gh,installation:Gh,abonnement_acquisition:bl,abonnement_auto_renew:hs,temperature_change:wu,acquis:zt})[_]||xu;return l?s.jsx("div",{className:"text-center py-8",children:"Chargement..."}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"border-b border-gray-200 pb-2",children:s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:" Historique Actions"})}),s.jsxs("div",{className:"space-y-6",children:[n.length===0&&!a&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:"Aucun historique disponible"}),n.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-bold text-gray-800 text-sm",children:" Phase PROSPECT - Actions de Suivi"}),n.map((_,E)=>{var P;const A=j(_.action);return s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex flex-col items-center",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white ${_.action==="acquis"?"bg-gray-400":"bg-blue-500"}`,children:s.jsx(A,{size:20})}),E<n.length-1||a?s.jsx("div",{className:"w-0.5 h-12 bg-gray-200 mt-2"}):null]}),s.jsx("div",{className:"flex-1 pb-4",children:s.jsxs("div",{className:`${_.action==="acquis"?"bg-gray-50 border-gray-200":"bg-blue-50 border-blue-200"} rounded-lg p-4 border`,children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h4",{className:"font-semibold text-gray-800",children:_.action.replace(/_/g," ").toUpperCase()}),s.jsx("span",{className:"text-sm text-gray-500",children:DE(_.created_at)})]}),s.jsx("p",{className:"text-gray-800 text-sm font-medium mb-1",children:_.description}),_.details&&_.details!==_.description&&s.jsx("p",{className:"text-gray-500 text-xs italic mb-2 bg-white/30 p-1.5 rounded border-l-2 border-blue-200",children:_.details}),s.jsxs("div",{className:"flex gap-2 mt-3 border-t border-blue-200 pt-3",children:[s.jsxs("button",{onClick:()=>S(_),disabled:_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0",className:`flex items-center gap-1.5 px-3 py-1.5 rounded text-xs font-bold transition-colors ${_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0"?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[s.jsx(br,{size:12}),"Modifier"]}),s.jsxs("button",{onClick:()=>g(_),disabled:_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0",className:`flex items-center gap-1.5 px-3 py-1.5 rounded text-xs font-bold transition-colors ${_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0"?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-red-600 text-white hover:bg-red-700"}`,children:[s.jsx(rr,{size:12}),"Supprimer"]}),_.mission_id&&_.mission_id!=="null"&&_.mission_id!==0&&_.mission_id!=="0"&&s.jsx("span",{className:"text-[10px] text-blue-600 font-bold bg-blue-100 px-2 py-1 rounded border border-blue-200 uppercase",children:" Mission lie"})]}),(_.application||_.chef_mission||_.date_debut||_.date_fin||_.anciens_logiciels||_.conversion==="oui")&&s.jsxs("div",{className:"mt-3 grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 text-xs border-t border-blue-100 pt-3",children:[_.application&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:"Application:"}),s.jsx("span",{className:"text-blue-700 font-semibold",children:_.application})]}),_.chef_mission&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:"Chef de Mission:"}),s.jsx("span",{className:"text-gray-700 font-medium",children:((P=u.find(T=>String(T.id)===String(_.chef_mission)))==null?void 0:P.nom)||_.chef_mission})]}),_.date_debut&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:"Dbut:"}),s.jsx("span",{className:"text-gray-700",children:St(_.date_debut)})]}),_.date_fin&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase",children:"Fin:"}),s.jsx("span",{className:"text-gray-700",children:St(_.date_fin)})]}),_.conversion==="oui"&&s.jsx("div",{className:"flex items-center gap-2 col-span-full",children:s.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 rounded font-bold uppercase text-[9px]",children:"Avance Paye (Conversion OK)"})}),_.anciens_logiciels&&Array.isArray(_.anciens_logiciels)&&_.anciens_logiciels.length>0&&s.jsxs("div",{className:"col-span-full mt-1",children:[s.jsx("span",{className:"font-bold text-gray-500 uppercase block mb-1",children:"Anciens Logiciels:"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:_.anciens_logiciels.map((T,M)=>s.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded border border-gray-200 uppercase text-[9px]",children:T},M))})]})]}),_.action==="abonnement_auto_renew"&&_.details&&s.jsxs("div",{className:"text-sm text-gray-500 mt-2 space-y-1 bg-white/50 p-2 rounded border border-blue-100",children:[_.details.date_debut&&s.jsxs("p",{className:"flex items-center gap-2",children:[" ",s.jsx("strong",{children:"Priode:"})," Du ",_.details.date_debut," au ",_.details.date_fin]}),_.details.montant&&s.jsxs("p",{className:"flex items-center gap-2",children:[" ",s.jsx("strong",{children:"Montant:"})," ",s.jsxs("span",{className:"text-blue-600 font-bold",children:[_.details.montant," DA"]})]})]})]})})]},_.id||`history-${E}`)})]}),a&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"flex flex-col items-center",children:s.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white",children:s.jsx(Gh,{size:20})})}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-2",children:[s.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:" CONVERSION - PREMIRE INSTALLATION"}),s.jsx("span",{className:"text-sm text-gray-600 font-bold",children:St(a.date_installation)})]}),s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Application:"})," ",a.application_installee]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Montant:"})," ",s.jsx("span",{className:"font-bold text-green-600",children:(r==null?void 0:r.role)==="admin"||(r==null?void 0:r.role)==="super_admin"?Nt(a.montant||0):""})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Statut:"})," ",s.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded text-xs font-bold",children:"PROSPECT  ACTIF"})]})]})]})})]}),n.length===0&&a&&s.jsx("div",{className:"bg-yellow-50 rounded-lg p-4 border border-yellow-200 text-sm text-gray-700",children:" Aucune action de suivi enregistre avant la conversion en client actif."}),(n.length>0||a)&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("h3",{className:"font-bold text-gray-800 mb-3",children:" Rsum Phase Prospect"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Actions de Suivi"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.length})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Dure Phase Prospect"}),a?s.jsx("p",{className:"text-2xl font-bold text-green-600",children:(()=>{const _=n.length>0?new Date(n[n.length-1].created_at):new Date(a.date_installation),E=new Date(a.date_installation),A=Math.floor((E-_)/(1e3*60*60*24));return A>0?`${A}j`:"< 1j"})()}):s.jsx("p",{className:"text-lg font-bold text-gray-600",children:"En cours"})]}),a&&s.jsx(s.Fragment,{children:s.jsxs("div",{className:"col-span-2 pt-2 border-t border-gray-300",children:[s.jsx("p",{className:"text-gray-600 mb-1",children:" Date de Conversion"}),s.jsx("p",{className:"text-lg font-bold text-green-600",children:St(a.date_installation)})]})})]})]})]}),f&&p&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 font-sans",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:"bg-primary p-4 text-white flex justify-between items-center",children:[s.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[s.jsx(br,{size:18}),p.action==="installation"?"Modifier la Planification":`Modifier l'action : ${p.action.toUpperCase()}`]}),s.jsx("button",{onClick:()=>h(!1),className:"hover:bg-white/20 p-1 rounded-full transition-colors",title:"Fermer",children:s.jsx(Lr,{size:20})})]}),s.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Rsum / Dtail"}),s.jsx("textarea",{value:p.description||p.details||"",onChange:_=>y({...p,description:_.target.value}),rows:"3",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",placeholder:"Dtails de l'action..."})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date de l'action"}),s.jsx("input",{type:"date",required:!0,value:p.created_at?p.created_at.split("T")[0]:"",onChange:_=>y({...p,created_at:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),(p.action==="installation"||p.type_action==="installation")&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Application"}),s.jsx("input",{type:"text",required:!0,value:p.application||"",onChange:_=>y({...p,application:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",placeholder:"ex: Gestipharm"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Dbut"}),s.jsx("input",{type:"date",required:!0,value:p.date_debut?p.date_debut.split("T")[0]:"",onChange:_=>y({...p,date_debut:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Fin"}),s.jsx("input",{type:"date",required:!0,value:p.date_fin?p.date_fin.split("T")[0]:"",onChange:_=>y({...p,date_fin:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Chef de Mission"}),s.jsxs("select",{required:!0,value:p.chef_mission||"",onChange:_=>y({...p,chef_mission:_.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",children:[s.jsx("option",{value:"",children:"Slectionner un utilisateur"}),u.map(_=>s.jsx("option",{value:_.id,children:_.nom},_.id))]})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[s.jsx("input",{type:"checkbox",id:"conversion",checked:p.conversion==="oui",onChange:_=>y({...p,conversion:_.target.checked?"oui":"non"}),className:"w-4 h-4 text-primary"}),s.jsx("label",{htmlFor:"conversion",className:"text-sm font-medium text-gray-700",children:"Le client a-t-il dj pay l'avance ? (Conversion)"})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[s.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg font-bold text-gray-600 hover:bg-gray-50",disabled:v,children:"Annuler"}),s.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg font-bold hover:bg-primary/90 flex items-center justify-center gap-2 shadow-lg shadow-primary/20",disabled:v,children:[v?s.jsx(hs,{className:"animate-spin",size:18}):s.jsx(RE,{size:18}),"Enregistrer"]})]})]})]})})]})},yt=({label:e,value:t,onChange:r,options:n=[],error:i,required:a=!1,disabled:o=!1,placeholder:l="Slectionner...",...c})=>s.jsxs("div",{className:"w-full",children:[e&&s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e,a&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsxs("select",{value:t||"",onChange:r,disabled:o,className:`
          input-field
          ${i?"border-red-500 focus:ring-red-500":""}
          ${o?"bg-gray-100 cursor-not-allowed":""}
        `,...c,children:[s.jsx("option",{value:"",children:l}),n.map(u=>s.jsx("option",{value:u.value,children:u.label},u.value))]}),i&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:i})]}),Ga={getAll:async()=>{try{const{data:e,error:t}=await V.from("applications").select("*").order("nom",{ascending:!0});if(t)throw t;return e||[]}catch(e){throw console.error("Erreur rcupration applications:",e),e}},getById:async e=>{try{const{data:t,error:r}=await V.from("applications").select("*").eq("id",e).single();if(r)throw r;return t}catch(t){throw console.error("Erreur rcupration application:",t),t}},create:async e=>{try{const t={nom:e.nom,description:e.description||"",prix_acquisition:parseFloat(e.prix_acquisition)||parseFloat(e.prix)||0,prix_abonnement:parseFloat(e.prix_abonnement)||parseFloat(e.prix)||0,prix:parseFloat(e.prix_acquisition)||parseFloat(e.prix)||0},{data:r,error:n}=await V.from("applications").insert([t]).select().single();if(n)throw n;return r}catch(t){throw console.error("Erreur cration application:",t),t}},update:async(e,t)=>{try{const r={nom:t.nom||void 0,description:t.description||void 0,prix_acquisition:t.prix_acquisition?parseFloat(t.prix_acquisition):void 0,prix_abonnement:t.prix_abonnement?parseFloat(t.prix_abonnement):void 0};Object.keys(r).forEach(a=>r[a]===void 0&&delete r[a]),r.prix_acquisition&&(r.prix=r.prix_acquisition);const{data:n,error:i}=await V.from("applications").update(r).eq("id",e).select().single();if(i)throw i;return n}catch(r){throw console.error("Erreur mise  jour application:",r),r}},delete:async e=>{try{const{error:t}=await V.from("applications").delete().eq("id",e);if(t)throw t;return!0}catch(t){throw console.error("Erreur suppression application:",t),t}},getStats:async()=>{try{const{data:e,error:t}=await V.from("applications").select("*");if(t)throw t;return{total:e.length,actives:e.filter(r=>r.statut==="actif").length,inactives:e.filter(r=>r.statut==="inactif").length}}catch(e){throw console.error("Erreur rcupration stats applications:",e),e}}},xte=({prospect:e,onSubmit:t,onCancel:r})=>{const[n,i]=N.useState({type_action:"appel",date_action:new Date().toISOString().split("T")[0],date_debut:"",date_fin:"",description:"",details:"",conversion:"non",application:"",chef_mission:""}),[a,o]=N.useState(""),[l,c]=N.useState([]),[u,d]=N.useState([]),[f,h]=N.useState([]),[p,y]=N.useState(!1),[v,m]=N.useState([]),[x,b]=N.useState(!1),[g,S]=N.useState({}),[w,j]=N.useState(!1);N.useEffect(()=>{_()},[]);const _=async()=>{try{y(!0);const O=await Ga.getAll();h(O),b(!0);const k=await Fe.getAll();m(k)}catch(O){console.error("Erreur chargement donnes:",O)}finally{y(!1),b(!1)}},E=[{value:"appel",label:" Appel Tlphonique"},{value:"email",label:" Email"},{value:"suivi",label:" Suivi / Relance"},{value:"rdv",label:" Rendez-vous"},{value:"visite",label:" Visite Bureau"},{value:"demo",label:" Dmonstration"},{value:"negociation",label:" Ngociation"},{value:"offre_envoyee",label:" Offre Envoye"},{value:"contrat_signe",label:" Contrat Sign"},{value:"installation",label:" Installation"}],A=()=>{const O=a.trim();O&&(u.includes(O)||d([...u,O]),l.includes(O)||c([...l,O]),o(""))},P=O=>{d(u.filter((k,F)=>F!==O))},T=(O,k)=>{i(F=>({...F,[O]:k})),g[O]&&S(F=>({...F,[O]:""}))},M=async O=>{O.preventDefault();const k={};if(n.type_action||(k.type_action="Type d'action requis"),n.type_action==="installation"?(n.date_debut||(k.date_debut="Date de dbut requise"),n.date_fin||(k.date_fin="Date de fin requise")):n.date_action||(k.date_action="Date requise"),n.description.trim()||(k.description="Description requise"),Object.keys(k).length>0){S(k);return}try{j(!0);const F={...n,anciens_logiciels:u};await t(F)}finally{j(!1)}};return s.jsxs("form",{onSubmit:M,className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[s.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Prospect : ",s.jsx("span",{className:"font-bold",children:e.raison_sociale})]}),s.jsx("p",{className:"text-sm text-blue-700",children:e.contact})]}),s.jsx(yt,{label:"Type d'Action",value:n.type_action,onChange:O=>T("type_action",O.target.value),options:E,error:g.type_action,required:!0,disabled:w}),n.type_action==="installation"?s.jsxs("div",{className:"space-y-4",children:[s.jsx(yt,{label:"Application",value:n.application,onChange:O=>T("application",O.target.value),options:[{value:"",label:"-- Slectionner une application --"},...f.map(O=>({value:O.nom,label:O.nom}))],disabled:w||p,required:!0}),s.jsx(yt,{label:"Chef de Mission",value:n.chef_mission,onChange:O=>T("chef_mission",O.target.value),options:[{value:"",label:"-- Slectionner un chef de mission --"},...v.map(O=>({value:O.id,label:O.nom}))],disabled:w||x,required:!0}),s.jsx(Ie,{label:"Date de Dbut d'Installation",type:"date",value:n.date_debut,onChange:O=>T("date_debut",O.target.value),error:g.date_debut,required:!0,disabled:w}),s.jsx(Ie,{label:"Date de Fin d'Installation",type:"date",value:n.date_fin,onChange:O=>T("date_fin",O.target.value),error:g.date_fin,required:!0,disabled:w}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Anciens Logiciels Utiliss"}),s.jsxs("div",{className:"flex gap-2 items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx(Ie,{type:"text",list:"suggested-softwares",value:a,onChange:O=>o(O.target.value),placeholder:"Saisir ou slectionner un logiciel...",disabled:w,onKeyPress:O=>{O.key==="Enter"&&(O.preventDefault(),A())}}),s.jsx("datalist",{id:"suggested-softwares",children:[...new Set(l)].sort().map(O=>s.jsx("option",{value:O},O))})]}),s.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center justify-center h-[42px]",disabled:w||!a.trim(),title:"Ajouter ce logiciel",children:s.jsx(Un,{size:20})})]}),u.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg",children:u.map((O,k)=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[s.jsx("span",{children:O}),s.jsx("button",{type:"button",onClick:()=>P(k),className:"hover:bg-blue-200 rounded-full p-0.5",disabled:w,title:"Retirer ce logiciel",children:s.jsx(Lr,{size:14})})]},k))})]}),s.jsx(yt,{label:"Conversion BDD",value:n.conversion,onChange:O=>T("conversion",O.target.value),options:[{value:"non",label:"Non"},{value:"oui",label:"Oui"}],disabled:w})]}):s.jsx(Ie,{label:"Date de l'Action",type:"date",value:n.date_action,onChange:O=>T("date_action",O.target.value),error:g.date_action,required:!0,disabled:w}),s.jsx(Ie,{label:"Rsum de l'Action",type:"textarea",rows:"3",value:n.description,onChange:O=>T("description",O.target.value),placeholder:"Dcrivez brivement l'action effectue...",error:g.description,required:!0,disabled:w}),s.jsx(Ie,{label:"Dtails (Optionnel)",type:"textarea",rows:"4",value:n.details,onChange:O=>T("details",O.target.value),placeholder:"Ajoutez des dtails supplmentaires si ncessaire...",disabled:w}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,disabled:w,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",disabled:w,children:w?"Enregistrement...":"Enregistrer l'Action"})]})]})},bte=()=>{const e=uf(),[t,r]=N.useState([]),[n,i]=N.useState({}),[a,o]=N.useState(!0),[l,c]=N.useState("all"),[u,d]=N.useState({total:0,aVenir:0,enCours:0,terminees:0}),[f,h]=N.useState(!1),[p,y]=N.useState(null),[v,m]=N.useState(!1),[x,b]=N.useState([]),g=O=>{var F;let k=O.mission;if(Array.isArray(k)&&(k=k[0]),!k)return O.mission_id&&O.mission_id!=="null"&&O.mission_id!==0?{label:"PLANIFIE",class:"bg-blue-100 text-blue-800"}:{label:"-",class:"text-gray-400"};switch(k.statut){case"creee":case"planifiee":return{label:" VENIR",class:"bg-blue-100 text-blue-800"};case"en_cours":return{label:"EN COURS",class:"bg-amber-100 text-amber-800"};case"cloturee":case"validee":return{label:"TERMINE",class:"bg-green-100 text-green-800"};default:return{label:((F=k.statut)==null?void 0:F.toUpperCase())||"-",class:"bg-gray-100 text-gray-800"}}},S=O=>{new Date().setHours(0,0,0,0);const F=new Date(O.date_debut);F.setHours(0,0,0,0);const I=new Date(O.date_fin);I.setHours(0,0,0,0);const W=new Date;W.setHours(0,0,0,0);let R=O.mission;if(Array.isArray(R)&&(R=R[0]),R&&R.statut){const D=R.statut.toLowerCase();if(D==="cloturee"||D==="validee"||D==="termine"||D==="termin")return"completed";if(D==="en_cours"||D==="en cours")return"ongoing";if(D==="creee"||D==="planifiee"||D===" venir")return"upcoming"}return O.is_cancelled?"upcoming":I<W?"completed":F>W?"upcoming":"ongoing"},w=async(O,k)=>{k&&k.stopPropagation&&k.stopPropagation();const F=!O.is_cancelled,I=F?`Voulez-vous marquer cette installation comme ANNULE ou REPORTE ?
Le bouton de gnration de mission sera gris.`:"Voulez-vous RTABLIR cette planification ?";if(window.confirm(I))try{await Ko.update(O.id,{is_cancelled:F}),P()}catch(W){console.error("Erreur mise  jour statut installation:",W),alert("Erreur lors de la mise  jour")}},j=async(O,k)=>{if(k&&k.stopPropagation&&k.stopPropagation(),window.confirm(` Voulez-vous vraiment SUPPRIMER cette planification ?
Cette action est irrversible.`))try{await mt.deleteAction(O.prospect_id,O),P()}catch(F){console.error("Erreur suppression:",F),alert("Erreur lors de la suppression")}},_=(O,k)=>{k&&k.stopPropagation&&k.stopPropagation(),y({...O}),h(!0)},E=async O=>{O.preventDefault(),m(!0);try{const{id:k,...F}=p;await Ko.update(k,{application:F.application,date_debut:F.date_debut,date_fin:F.date_fin,chef_mission:F.chef_mission,description:F.description,conversion:F.conversion}),h(!1),P()}catch(k){console.error("Erreur update:",k),alert("Erreur lors de la mise  jour")}finally{m(!1)}},A=(O,k)=>{var I,W,R,D;k&&k.stopPropagation&&k.stopPropagation(),console.log(" Navigation vers Missions avec:",O);const F={titre:`Installation ${O.application||"Logiciel"} - ${((I=O.prospect)==null?void 0:I.raison_sociale)||"Client"}`,description:`Mission d'installation gnre depuis le planning.

Dtails:
- Application: ${O.application||"N/A"}
- Conversion: ${O.conversion}
- Migration: ${((W=O.anciens_logiciels)==null?void 0:W.join(", "))||"Non"}

${O.description||""}`,clientId:(R=O.prospect)==null?void 0:R.id,wilaya:(D=O.prospect)==null?void 0:D.wilaya,dateDebut:O.date_debut?O.date_debut.split("T")[0]:"",dateFin:O.date_fin?O.date_fin.split("T")[0]:"",type:"Installation",chefMissionId:O.chef_mission,priorite:"moyenne",installationId:O.id,prospectData:O.prospect};localStorage.setItem("temp_mission_create",JSON.stringify(F)),e("/missions",{state:{createMission:F}})};N.useEffect(()=>{P()},[]);const P=async()=>{try{o(!0);const[O,k]=await Promise.all([Ko.getAllPlanned(),Fe.getAll()]);r(O);const F={};k&&Array.isArray(k)&&(b(k),k.forEach(R=>F[R.id]=R.nom)),i(F);const I=new Date,W={total:O.length,aVenir:0,enCours:0,terminees:0};O.forEach(R=>{const D=S(R);D==="completed"?W.terminees++:D==="upcoming"?W.aVenir++:D==="ongoing"&&W.enCours++}),d(W)}catch(O){console.error("Erreur chargement planning:",O)}finally{o(!1)}},M=t.filter(O=>{const k=S(O);return l==="upcoming"?k==="upcoming":l==="ongoing"?k==="ongoing":l==="completed"?k==="completed":!0});return a?s.jsx("div",{className:"flex justify-center items-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsx("div",{onClick:()=>c("all"),className:`cursor-pointer p-4 rounded-xl border transition-all ${l==="all"?"bg-blue-50 border-blue-200 shadow-sm":"bg-white border-gray-100 hover:border-blue-100"}`,children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Planifi"}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:u.total})]}),s.jsx("div",{className:`p-2 rounded-lg ${l==="all"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:s.jsx(xr,{size:20})})]})}),s.jsx("div",{onClick:()=>c("ongoing"),className:`cursor-pointer p-4 rounded-xl border transition-all ${l==="ongoing"?"bg-amber-50 border-amber-200 shadow-sm":"bg-white border-gray-100 hover:border-amber-100"}`,children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-amber-600",children:"En Cours"}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:u.enCours})]}),s.jsx("div",{className:`p-2 rounded-lg ${l==="ongoing"?"bg-amber-100 text-amber-600":"bg-gray-100 text-gray-400"}`,children:s.jsx(zs,{size:20})})]})}),s.jsx("div",{onClick:()=>c("upcoming"),className:`cursor-pointer p-4 rounded-xl border transition-all ${l==="upcoming"?"bg-blue-50 border-blue-200 shadow-sm":"bg-white border-gray-100 hover:border-blue-100"}`,children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-blue-600",children:" Venir"}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:u.aVenir})]}),s.jsx("div",{className:`p-2 rounded-lg ${l==="upcoming"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"}`,children:s.jsx(xr,{size:20})})]})}),s.jsx("div",{onClick:()=>c("completed"),className:`cursor-pointer p-4 rounded-xl border transition-all ${l==="completed"?"bg-green-50 border-green-200 shadow-sm":"bg-white border-gray-100 hover:border-green-100"}`,children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-green-600",children:"Termines"}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:u.terminees})]}),s.jsx("div",{className:`p-2 rounded-lg ${l==="completed"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"}`,children:s.jsx(zt,{size:20})})]})})]}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Prospect"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Secteur"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Application"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Conversion"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Wilaya"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Dbut"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Fin"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Chef de Mission"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut Mission"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"8",className:"px-6 py-12 text-center",children:s.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-500",children:[s.jsx(xr,{className:"h-12 w-12 text-gray-300 mb-3"}),s.jsx("p",{className:"text-lg",children:"Aucune installation trouve pour ce filtre"})]})})}):M.map(O=>{var k,F,I,W;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"text-sm font-bold text-gray-900",children:((k=O.prospect)==null?void 0:k.raison_sociale)||"Inconnu"}),s.jsx("div",{className:"text-xs text-gray-500",children:(F=O.prospect)==null?void 0:F.contact})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:((I=O.prospect)==null?void 0:I.secteur)||"-"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(hM,{size:16,className:"text-gray-400 mr-2"}),O.application||"-"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:O.conversion==="oui"?s.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Oui"}):s.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800",children:"Non"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Cn,{size:16,className:"text-gray-400 mr-2"}),((W=O.prospect)==null?void 0:W.wilaya)||"-"]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-600",children:St(O.date_debut)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:St(O.date_fin)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(d0,{size:16,className:"text-gray-400 mr-2"}),s.jsx("span",{className:"text-sm text-gray-900 font-medium",children:n[O.chef_mission]||"Non assign"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(()=>{const R=g(O);return s.jsx("span",{className:`px-2.5 py-1 inline-flex text-[10px] leading-4 font-bold rounded-full border ${R.class}`,children:R.label})})()}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:O.mission_id&&O.mission_id!=="null"&&O.mission_id!==0&&O.mission_id!=="0"?s.jsx("div",{className:"flex flex-col gap-1 items-end",children:s.jsxs("span",{className:"inline-flex items-center px-3 py-1.5 rounded text-xs font-bold bg-gray-100 text-gray-500 border border-gray-200",children:[s.jsx(zt,{size:14,className:"mr-1.5"}),"MISSION GNRE"]})}):s.jsxs("div",{className:"flex flex-col gap-1.5 items-end",children:[s.jsxs("button",{disabled:O.is_cancelled,onClick:R=>A(O,R),className:`inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-bold rounded-md text-white shadow-sm transition-all ${O.is_cancelled?"bg-gray-300 cursor-not-allowed opacity-75":"bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"}`,title:O.is_cancelled?"L'installation a t annule ou reporte":"Crer une mission  partir de cette installation",children:[s.jsx(zi,{size:14,className:"mr-1.5"}),O.is_cancelled?"ANNULE / REPORTE":"GNRER MISSION !"]}),s.jsx("button",{onClick:R=>w(O,R),className:`text-[10px] font-bold uppercase tracking-tighter transition-colors ${O.is_cancelled?"text-blue-500 hover:text-blue-700 underline":"text-gray-400 hover:text-red-500"}`,children:O.is_cancelled?"Rtablir Planning":"Annuler l'installation ?"}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[s.jsx("button",{onClick:R=>_(O,R),className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Modifier les dtails",children:s.jsx(br,{size:14})}),s.jsx("button",{onClick:R=>j(O,R),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Supprimer dfinitivement",children:s.jsx(rr,{size:14})})]})]})})]},O.id)})})]})})}),f&&p&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100] p-4 font-sans",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[s.jsxs("div",{className:"bg-primary p-4 text-white flex justify-between items-center",children:[s.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[s.jsx(br,{size:18}),"Modifier Planification"]}),s.jsx("button",{onClick:()=>h(!1),className:"hover:bg-white/20 p-1 rounded-full transition-colors",title:"Fermer",children:s.jsx(Lr,{size:20})})]}),s.jsxs("form",{onSubmit:E,className:"p-6 space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Application"}),s.jsx("input",{type:"text",required:!0,value:p.application||"",onChange:O=>y({...p,application:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Dbut"}),s.jsx("input",{type:"date",required:!0,value:p.date_debut?p.date_debut.split("T")[0]:"",onChange:O=>y({...p,date_debut:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Date Fin"}),s.jsx("input",{type:"date",required:!0,value:p.date_fin?p.date_fin.split("T")[0]:"",onChange:O=>y({...p,date_fin:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Chef de Mission"}),s.jsxs("select",{required:!0,value:p.chef_mission||"",onChange:O=>y({...p,chef_mission:O.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none",children:[s.jsx("option",{value:"",children:"Slectionner..."}),x.map(O=>s.jsx("option",{value:O.id,children:O.nom},O.id))]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Commentaires"}),s.jsx("textarea",{value:p.description||"",onChange:O=>y({...p,description:O.target.value}),rows:"3",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary/20 outline-none"})]}),s.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[s.jsx("input",{type:"checkbox",id:"conversion_edit",checked:p.conversion==="oui",onChange:O=>y({...p,conversion:O.target.checked?"oui":"non"}),className:"w-4 h-4 text-primary"}),s.jsx("label",{htmlFor:"conversion_edit",className:"text-sm font-medium text-gray-700",children:"Client converti (Avance paye)"})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[s.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg font-bold text-gray-600 hover:bg-gray-50",disabled:v,children:"Annuler"}),s.jsxs("button",{type:"submit",className:"flex-1 px-4 py-2 bg-primary text-white rounded-lg font-bold hover:bg-primary/90 flex items-center justify-center gap-2",disabled:v,children:[v?s.jsx(hs,{className:"animate-spin",size:18}):s.jsx(RE,{size:18}),"Enregistrer"]})]})]})]})})]})},wte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState(!0),[o,l]=N.useState(""),[c,u]=N.useState("all"),[d,f]=N.useState(""),[h,p]=N.useState(""),[y,v]=N.useState(""),[m,x]=N.useState(!1),[b,g]=N.useState(!1),[S,w]=N.useState(!1),[j,_]=N.useState(!1),[E,A]=N.useState(null),[P,T]=N.useState("create"),[M,O]=N.useState("global"),[k,F]=N.useState(0),[I,W]=N.useState(!1),[R,D]=N.useState(!1),[H,Q]=N.useState(!1),[U,G]=N.useState(!1),[B,me]=N.useState(!1),[ue,Ne]=N.useState("prospects"),{addNotification:ve}=cr(),{user:Y,profile:Z}=dt();N.useEffect(()=>{te()},[]),N.useEffect(()=>{L()},[Y==null?void 0:Y.id,Z==null?void 0:Z.role]),N.useEffect(()=>{ae()},[e,o,c,d,h,y]);const te=async()=>{try{a(!0);const $=await mt.getAll();t($)}catch{ve({type:"error",message:"Erreur lors du chargement des prospects"})}finally{a(!1)}},L=async()=>{try{if(me(!0),Y!=null&&Y.id&&Z){const $=(Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin"||await Fe.hasCreatePermission(Y.id,"prospects"),X=(Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin"||await Fe.hasEditPermission(Y.id,"prospects"),xe=(Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin"||await Fe.hasDeletePermission(Y.id,"prospects");D($),Q(X),G(xe)}}catch($){console.error("Erreur chargement permissions:",$)}finally{me(!1)}},ae=()=>{let $=[...e];if(c!=="all"&&($=$.filter(X=>X.statut===c)),o&&($=$.filter(X=>{var xe,ee,C,K,re,se;return((xe=X.raison_sociale)==null?void 0:xe.toLowerCase().includes(o.toLowerCase()))||((ee=X.contact)==null?void 0:ee.toLowerCase().includes(o.toLowerCase()))||((C=X.telephone)==null?void 0:C.includes(o))||((K=X.email)==null?void 0:K.toLowerCase().includes(o.toLowerCase()))||((re=X.ville)==null?void 0:re.toLowerCase().includes(o.toLowerCase()))||((se=X.adresse)==null?void 0:se.toLowerCase().includes(o.toLowerCase()))})),d){const X=new Date(d);$=$.filter(xe=>new Date(xe.created_at)>=X)}if(h){const X=new Date(h);X.setHours(23,59,59,999),$=$.filter(xe=>new Date(xe.created_at)<=X)}y&&((Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin")&&($=$.filter(X=>X.created_by===y)),n($)},oe=async($,X)=>{try{await mt.updateTemperature($.id,X),ve({type:"success",message:`Intrt mis  jour pour ${$.raison_sociale}`}),te()}catch{ve({type:"error",message:"Erreur lors de la mise  jour de l'intrt"})}},le=()=>{R&&(A(null),T("create"),x(!0))},he=$=>{H&&(A($),T("edit"),x(!0))},Se=async $=>{var xe;const X=($==null?void 0:$.id)||$;if(U&&window.confirm("tes-vous sr de vouloir supprimer ce prospect ?"))try{await mt.delete(X),ve({type:"success",message:"Prospect supprim avec succs"}),te()}catch(ee){console.error("Erreur suppression prospect:",ee),ee.status===409||(xe=ee.message)!=null&&xe.includes("foreign key")?ve({type:"error",message:"Impossible de supprimer ce prospect car il est devenu client actif avec des enregistrements lis (installations, abonnements, paiements, etc.)"}):ve({type:"error",message:"Erreur lors de la suppression du prospect"})}},$e=async $=>{try{if(P==="create"){const X={...$,created_by:(Y==null?void 0:Y.id)||null};await mt.create(X),ve({type:"success",message:"Prospect cr avec succs"})}else await mt.update(E.id,$),ve({type:"success",message:"Prospect modifi avec succs"});x(!1),te()}catch{ve({type:"error",message:"Erreur lors de l'enregistrement"})}},ze=async $=>{try{if(E.statut==="actif"&&$.type_action!=="installation"){ve({type:"warning",message:"Ce client est actif. Seules les installations peuvent tre enregistres aprs la conversion."}),w(!1);return}const X={date_action:$.date_action,details_supplementaires:$.details};$.type_action==="installation"&&(X.application=$.application,X.chef_mission=$.chef_mission,X.date_debut=$.date_debut,X.date_fin=$.date_fin,X.conversion=$.conversion,X.anciens_logiciels=$.anciens_logiciels),await mt.addHistorique(E.id,$.type_action,$.description,X),ve({type:"success",message:"Action enregistre avec succs"}),w(!1),te()}catch{ve({type:"error",message:"Erreur lors de l'enregistrement de l'action"})}},Le=async()=>{try{if(W(!0),r.length===0){ve({type:"warning",message:"Aucun prospect  analyser"});return}_(!0),ve({type:"success",message:"Analyse complte!"})}catch($){ve({type:"error",message:`Erreur: ${$.message}`})}finally{W(!1)}},q={total:e.length,prospects:e.filter($=>$.statut==="prospect").length,actifs:e.filter($=>$.statut==="actif").length,inactifs:e.filter($=>$.statut==="inactif").length,tauxConversion:e.length>0?(e.filter($=>$.statut==="actif").length/e.length*100).toFixed(0):0};return i?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex gap-2 border-b border-gray-200 items-center justify-between pb-0",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>Ne("prospects"),className:`px-4 py-2 font-medium transition-colors ${ue==="prospects"?"text-primary border-b-2 border-primary -mb-0.5":"text-gray-600 hover:text-gray-800"}`,children:[" Gestion des Prospects ",s.jsx("small",{className:"text-[10px] opacity-20",children:"v2.2"})]}),s.jsx("button",{onClick:()=>Ne("installations"),className:`px-4 py-2 font-medium transition-colors ${ue==="installations"?"text-primary border-b-2 border-primary -mb-0.5":"text-gray-600 hover:text-gray-800"}`,children:" Planification des Installations"})]})}),ue==="prospects"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total Prospects"}),s.jsx("h3",{className:"text-3xl font-bold",children:q.total})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Convertis"}),s.jsx("h3",{className:"text-3xl font-bold",children:q.actifs})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"En attente"}),s.jsx("h3",{className:"text-3xl font-bold",children:q.prospects})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Taux Conversion"}),s.jsxs("h3",{className:"text-3xl font-bold",children:[q.tauxConversion,"%"]})]}),s.jsx("div",{className:"card space-y-2",children:s.jsx(je,{variant:"primary",icon:Un,onClick:le,disabled:!R,className:"w-full h-full",title:R?"Crer un nouveau prospect":"Permission refuse: Crer un prospect",children:"Nouveau"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(vv,{onSearchChange:l,onDateStartChange:f,onDateEndChange:p,onCreatorChange:v,searchValue:o,dateStart:d,dateEnd:h,creatorId:y}),s.jsxs("div",{className:"card",children:[s.jsx("div",{className:"flex flex-col md:flex-row gap-2 items-center justify-end",children:s.jsxs("button",{onClick:Le,disabled:I||r.length===0,className:"px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 disabled:from-gray-400 disabled:to-gray-400 text-white rounded-lg font-medium transition-all flex items-center gap-2 whitespace-nowrap text-sm",children:[s.jsx(bl,{size:18}),"ANALYSE"]})}),s.jsxs("div",{className:"flex gap-2 flex-wrap mt-4",children:[s.jsx("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="all"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tous"}),s.jsx("button",{onClick:()=>u("prospect"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="prospect"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Prospects"}),s.jsx("button",{onClick:()=>u("actif"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="actif"?"bg-success text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Actifs"}),s.jsx("button",{onClick:()=>u("inactif"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="inactif"?"bg-danger text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Inactifs"})]})]})]}),r.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucun prospect trouv"})}):s.jsx(yc,{data:r,columns:[{key:"raison_sociale",label:"Prospect",width:"200px",render:$=>s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:$.raison_sociale}),s.jsx("p",{className:"text-xs text-gray-500",children:$.forme_juridique||$.email||"N/A"})]})},{key:"created_at",label:"Date Cration",width:"120px",render:$=>{var X;return s.jsx("span",{className:`text-xs font-bold ${(X=$.created_at)!=null&&X.includes("2025-12-31")?"text-red-600 bg-red-50 p-1 rounded":"text-gray-600"}`,children:$.created_at?St($.created_at):"Sans date"})}},{key:"contact",label:"Contact",width:"150px",render:$=>s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-900",children:$.contact||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:$.telephone||"N/A"})]})},{key:"secteur",label:"Secteur",width:"120px",render:$=>s.jsx("span",{children:$.secteur||"N/A"})},{key:"statut",label:"Statut",width:"100px",render:$=>{var X;return s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${$.statut==="actif"?"bg-green-100 text-green-800":$.statut==="prospect"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:((X=$.statut)==null?void 0:X.toUpperCase())||"N/A"})}},{key:"wilaya",label:"Wilaya / Ville",width:"180px",render:$=>s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:$.wilaya||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:$.ville||""})]})},{key:"temperature",label:"Intrt",width:"130px",render:$=>{const X=$.temperature||"froid",xe={froid:{icon:fo,label:"FROID",color:"text-blue-500 bg-blue-50 border-blue-100"},tiede:{icon:Hc,label:"TIDE",color:"text-gray-500 bg-gray-50 border-gray-100"},chaud:{icon:uo,label:"CHAUD",color:"text-orange-500 bg-orange-50 border-orange-100"},brulant:{icon:wu,label:"BRLANT",color:"text-red-600 bg-red-50 border-red-200 shadow-sm animate-pulse"},acquis:{icon:zt,label:"ACQUIS",color:"text-gray-400 bg-gray-100 border-gray-200"}}[X]||{icon:fo,label:"FROID",color:"text-blue-500 bg-blue-50 border-blue-100"},ee=xe.icon;return s.jsxs("div",{className:`flex items-center gap-1.5 px-2 py-1 rounded-md border text-[10px] font-bold ${xe.color} cursor-pointer hover:brightness-95 transition-all`,onClick:C=>{C.stopPropagation();const K=["froid","tiede","chaud","brulant"],re=(K.indexOf(X)+1)%K.length;oe($,K[re])},title:"Cliquez pour changer le niveau d'intrt",children:[s.jsx(ee,{size:14}),xe.label]})}}],actions:[{key:"view",label:"Dtails",icon:s.jsx(vl,{size:18}),onClick:$=>{A($),g(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1"},{key:"action",label:"Afficher",icon:s.jsx(bl,{size:18}),onClick:$=>{!H||$.statut==="actif"||(A($),w(!0))},disabled:$=>!H||$.statut==="actif",title:$=>$.statut==="actif"?"Actions dsactives: Ce prospect est devenu client actif":H?"Ajouter une action":"Permission refuse: Ajouter une action",className:$=>!H||$.statut==="actif"?"bg-gray-400 cursor-not-allowed text-white px-3 py-1":"bg-purple-600 hover:bg-purple-700 text-white px-3 py-1"},{key:"edit",label:"Modifier",icon:s.jsx(br,{size:18}),onClick:$=>he($),disabled:!H,title:H?"Modifier ce prospect":"Permission refuse: Modifier",className:H?"bg-amber-600 hover:bg-amber-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"},{key:"delete",label:"Supprimer",icon:s.jsx(rr,{size:18}),onClick:$=>Se($),disabled:!U,title:U?"Supprimer ce prospect":"Permission refuse: Supprimer",className:U?"bg-red-600 hover:bg-red-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"}],loading:i,emptyMessage:"Aucun client trouv",rowStyle:$=>$.temperature==="acquis"?{opacity:.5,filter:"grayscale(100%)",backgroundColor:"#F9FAFB"}:{}})]}),ue==="installations"&&s.jsx(bte,{}),s.jsx(Wt,{isOpen:m,onClose:()=>x(!1),title:P==="create"?"Nouveau Prospect":"Modifier Prospect",children:s.jsx(vte,{prospect:E,onSubmit:$e,onCancel:()=>x(!1)})}),s.jsx(Wt,{isOpen:b,onClose:()=>g(!1),title:"Historique des Actions",size:"lg",children:s.jsx(rO,{prospectId:E==null?void 0:E.id,prospect:E})}),s.jsx(Wt,{isOpen:S,onClose:()=>w(!1),title:"Enregistrer une Action de Suivi",children:E&&s.jsx(xte,{prospect:E,onSubmit:ze,onCancel:()=>w(!1)})}),s.jsx(Wt,{isOpen:j,onClose:()=>_(!1),title:" Analyse IA - Prospects",size:"lg",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[s.jsx("button",{onClick:()=>{O("global"),F(0)},className:`px-4 py-2 font-medium transition-colors ${M==="global"?"text-primary border-b-2 border-primary":"text-gray-600 hover:text-gray-800"}`,children:" Analyse Globale"}),s.jsxs("button",{onClick:()=>O("prospects"),className:`px-4 py-2 font-medium transition-colors ${M==="prospects"?"text-primary border-b-2 border-primary":"text-gray-600 hover:text-gray-800"}`,children:[" Par Prospect (",r.length,")"]})]}),M==="global"&&s.jsxs("div",{className:"space-y-6 max-h-96 overflow-y-auto p-2",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[s.jsx("p",{className:"text-sm text-blue-600 font-semibold",children:"Total"}),s.jsx("p",{className:"text-3xl font-bold text-blue-900",children:r.length})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-200",children:[s.jsx("p",{className:"text-sm text-green-600 font-semibold",children:"Conversion"}),s.jsxs("p",{className:"text-3xl font-bold text-green-900",children:[r.length>0?(r.filter($=>$.statut==="actif").length/r.length*100).toFixed(1):0,"%"]})]})]}),s.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 rounded-lg p-4 border border-orange-200",children:[s.jsxs("h3",{className:"font-bold text-orange-800 mb-3 flex items-center gap-2",children:[s.jsx(uo,{size:18})," Temprature du Pipeline"]}),s.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{label:"Froid",level:"froid",color:"bg-blue-400",icon:fo},{label:"Tide",level:"tiede",color:"bg-gray-400",icon:Hc},{label:"Chaud",level:"chaud",color:"bg-orange-400",icon:uo},{label:"Brlant",level:"brulant",color:"bg-red-500",icon:wu}].map($=>{const X=r.filter(C=>C.temperature===$.level).length,xe=r.length>0?X/r.length*100:0,ee=$.icon;return s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:`w-full ${$.color} h-1.5 rounded-full mb-2`,children:s.jsx("div",{className:"h-full bg-white/30 rounded-full",style:{width:`${xe}%`}})}),s.jsxs("p",{className:"text-[10px] font-bold text-gray-600 uppercase flex items-center justify-center gap-1",children:[s.jsx(ee,{size:10})," ",$.label]}),s.jsx("p",{className:"text-sm font-bold text-gray-800",children:X})]},$.level)})})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("h3",{className:"font-bold text-gray-800 mb-3",children:"Rpartition par Statut"}),s.jsx("div",{className:"space-y-2",children:[{label:"Actifs",count:r.filter($=>$.statut==="actif").length,color:"bg-green-500"},{label:"Prospects",count:r.filter($=>$.statut==="prospect").length,color:"bg-blue-500"},{label:"Inactifs",count:r.filter($=>$.statut==="inactif").length,color:"bg-red-500"}].map($=>s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between mb-1",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:$.label}),s.jsx("span",{className:"text-sm font-bold text-gray-900",children:$.count})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:`${$.color} h-2 rounded-full`,style:{width:`${$.count/r.length*100}%`}})})]},$.label))})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[s.jsx("h3",{className:"font-bold text-gray-800 mb-3",children:"Top Secteurs"}),s.jsx("div",{className:"space-y-2",children:(()=>{const $={};return r.forEach(X=>{const xe=X.secteur||"Non spcifi";$[xe]=($[xe]||0)+1}),Object.entries($).sort((X,xe)=>xe[1]-X[1]).slice(0,5).map(([X,xe])=>s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-700",children:X}),s.jsx("span",{className:"bg-purple-600 text-white text-xs px-2 py-1 rounded-full font-bold",children:xe})]},X))})()})]}),s.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-200",children:[s.jsx("h3",{className:"font-bold text-gray-800 mb-3",children:" Actions Recommandes"}),s.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-amber-600 font-bold",children:""}),s.jsxs("span",{children:["Relancer les ",r.filter($=>$.statut==="prospect").length," prospects en attente"]})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-amber-600 font-bold",children:""}),s.jsx("span",{children:"Planifier des appels dans les 48h"})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{className:"text-amber-600 font-bold",children:""}),s.jsx("span",{children:"Mettre en place un suivi structur"})]})]})]})]}),M==="prospects"&&s.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto p-2",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("button",{onClick:()=>F(Math.max(0,k-1)),disabled:k===0,className:"px-3 py-1 bg-gray-200 text-gray-700 rounded disabled:opacity-50",children:" Prcdent"}),s.jsxs("span",{className:"text-sm font-bold text-gray-700",children:[k+1," / ",r.length]}),s.jsx("button",{onClick:()=>F(Math.min(r.length-1,k+1)),disabled:k===r.length-1,className:"px-3 py-1 bg-gray-200 text-gray-700 rounded disabled:opacity-50",children:"Suivant "})]}),(()=>{const $=r[k];let X=0;$.statut==="actif"?X=100:$.statut==="inactif"?X=15:(X={froid:20,tiede:45,chaud:75,brulant:95}[$.temperature||"froid"],$.wilaya==="ALGER"&&(X+=5),$.secteur==="GROSSISTE PHARM"&&(X+=5));const xe=Math.min(100,X),ee=xe>70?"from-orange-500 to-red-600":xe>40?"from-blue-500 to-purple-600":"from-gray-500 to-gray-700";return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:`bg-gradient-to-r ${ee} text-white rounded-lg p-6 shadow-lg transition-all duration-500`,children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm opacity-90 font-medium",children:"Potentiel de Conversion"}),s.jsxs("h2",{className:"text-5xl font-black",children:[xe,"%"]})]}),s.jsx("div",{className:"bg-white/20 p-3 rounded-full backdrop-blur-sm",children:xe>70?s.jsx(uo,{size:32}):xe>40?s.jsx(Hc,{size:32}):s.jsx(fo,{size:32})})]})}),s.jsxs("div",{className:"flex items-center gap-3 bg-white p-3 rounded-lg border border-gray-100 shadow-sm",children:[s.jsx("span",{className:"text-sm font-bold text-gray-500 uppercase",children:"Niveau d'intrt :"}),(()=>{const C=$.temperature||"froid",K={froid:{icon:fo,label:"FROID",color:"bg-blue-100 text-blue-700"},tiede:{icon:Hc,label:"TIDE",color:"bg-gray-100 text-gray-700"},chaud:{icon:uo,label:"CHAUD",color:"bg-orange-100 text-orange-700"},brulant:{icon:wu,label:"BRLANT",color:"bg-red-100 text-red-700 animate-pulse"}}[C],re=K.icon;return s.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-xs font-black ${K.color}`,children:[s.jsx(re,{size:14})," ",K.label]})})()]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[s.jsx("h3",{className:"font-bold text-gray-800 mb-2",children:" Rsum"}),s.jsxs("p",{className:"text-sm text-gray-700",children:[s.jsx("strong",{children:$.raison_sociale})," - ",$.contact," | Actions: 1 | Installations: 0"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[s.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:" Contact"}),s.jsx("p",{className:"text-sm font-bold text-blue-900",children:$.telephone})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 border border-purple-200",children:[s.jsx("p",{className:"text-xs text-purple-600 font-semibold",children:" Secteur"}),s.jsx("p",{className:"text-sm font-bold text-purple-900",children:$.secteur||"N/A"})]})]}),s.jsxs("div",{className:"bg-pink-50 rounded-lg p-4 border border-pink-200",children:[s.jsx("p",{className:"text-xs text-pink-600 font-semibold mb-1",children:" Statut"}),s.jsxs("p",{className:"text-sm font-bold",children:["Prospect:",s.jsx("span",{className:`ml-2 px-2 py-1 rounded font-bold text-white ${$.statut==="actif"?"bg-green-500":$.statut==="prospect"?"bg-blue-500":"bg-red-500"}`,children:$.statut.toUpperCase()})]})]}),s.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4 border border-indigo-100 shadow-inner",children:[s.jsx("h3",{className:"font-bold text-indigo-900 mb-3 flex items-center gap-2",children:" Recommandations IA"}),s.jsxs("ul",{className:"space-y-2 text-sm text-indigo-900/80",children:[$.statut==="prospect"&&s.jsxs(s.Fragment,{children:[$.temperature==="brulant"&&s.jsxs("li",{className:"flex gap-2 font-bold text-red-600",children:[s.jsx("span",{className:"text-red-500 underline",children:"URGENT"}),s.jsx("span",{children:"Clturer la vente aujourd'hui : Le client est prt."})]}),$.temperature==="chaud"&&s.jsxs("li",{className:"flex gap-2 text-orange-700",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Envoyer le contrat final immdiatement."})]}),$.temperature==="froid"&&s.jsxs("li",{className:"flex gap-2 text-blue-700",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Changer d'approche commerciale ou proposer une remise spciale."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{children:""}),s.jsxs("span",{children:["Vrifier la wilaya ",$.wilaya," pour logistique groupe."]})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Planifier relance dans les 24h."})]})]}),$.statut==="actif"&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Client stratgique : Proposer une extension de service."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Demander un tmoignage de satisfaction."})]})]}),$.statut==="inactif"&&s.jsxs(s.Fragment,{children:[s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Campagne de ractivation ncessaire."})]}),s.jsxs("li",{className:"flex gap-2",children:[s.jsx("span",{children:""}),s.jsx("span",{children:"Identifier le point de blocage historique."})]})]})]})]})]})})()]}),s.jsx("div",{className:"flex justify-end",children:s.jsx("button",{onClick:()=>_(!1),className:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors font-medium",children:"Fermer"})})]})})]})},_te=({client:e})=>{const[t,r]=N.useState([]),[n,i]=N.useState([]),[a,o]=N.useState([]),[l,c]=N.useState([]),[u,d]=N.useState(null),[f,h]=N.useState(!0),[p,y]=N.useState(!1),[v,m]=N.useState(!1);N.useEffect(()=>{e&&x()},[e]);const x=async()=>{try{h(!0);const g=await Tr.getByClient(e.id),S=await ar.getByClient(e.id);r(g||[]),i(S||[]);try{const A=(await mt.getHistorique(e.id)||[]).filter(P=>P.action==="abonnement_auto_renew").map((P,T)=>{var O;let M="Application inconnue";if(P.description){const k=P.description.match(/pour\s+(.+?)(?:\n|$)/);M=k?k[1].trim():"Application inconnue"}return{id:`renew-${P.id}-${T}`,application:M,date:P.date||P.created_at,montant:(O=P.details)==null?void 0:O.montant,description:P.description}});c(A)}catch(E){console.warn("Renouvellements non disponibles:",E),c([])}const w=(g||[]).reduce((E,A)=>E+(A.montant||0),0),j=(S||[]).reduce((E,A)=>E+(A.montant||0),0),_=Math.max(0,w-j);d({totalInstallations:w,totalPaye:j,resteAPayer:_});try{const E=await ii.getByClient(e.id);o(E||[])}catch(E){console.warn("Interventions non disponibles:",E),o([])}}catch(g){console.error("Erreur chargement donnes client:",g),r([]),i([]),o([]),c([]),d({totalInstallations:0,totalPaye:0,resteAPayer:0})}finally{h(!1)}};if(f)return s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Chargement..."})]});const b=n.reduce((g,S)=>g+(S.montant||0),0);return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-primary to-primary-dark text-white rounded-lg p-6",children:[s.jsx("h3",{className:"text-2xl font-bold mb-2",children:e.raison_sociale}),s.jsxs("div",{className:"space-y-1 text-blue-100",children:[s.jsxs("p",{children:["Contact: ",e.contact]}),s.jsxs("p",{children:["Tlphone: ",e.telephone]}),e.email&&s.jsxs("p",{children:["Email: ",e.email]}),e.secteur&&s.jsxs("p",{className:"flex items-center gap-2",children:[s.jsx("span",{children:"Secteur:"}),s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold ${e.secteur==="GROSSISTE PHARM"?"bg-blue-500 text-white":e.secteur==="GROSSISTE PARA"?"bg-green-500 text-white":e.secteur==="PARA SUPER GROS"?"bg-purple-500 text-white":e.secteur==="LABO PROD"?"bg-orange-500 text-white":"bg-gray-500 text-white"}`,children:e.secteur})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"card text-center hover:shadow-lg transition-shadow",children:[s.jsx(Uo,{className:"mx-auto mb-2 text-primary",size:32}),s.jsx("h4",{className:"text-2xl font-bold text-gray-800",children:t.length}),s.jsx("p",{className:"text-sm text-gray-600",children:"Installations"})]}),s.jsxs("div",{className:"card text-center hover:shadow-lg transition-shadow bg-gradient-to-br from-green-50 to-green-100",children:[s.jsx(Ua,{className:"mx-auto mb-2 text-green-600",size:32}),s.jsx("h4",{className:"text-2xl font-bold text-green-700",children:Nt(b)}),s.jsx("p",{className:"text-sm text-green-600",children:"Total Pay"})]}),s.jsxs("div",{className:"card text-center hover:shadow-lg transition-shadow bg-gradient-to-br from-red-50 to-red-100",children:[s.jsx(Ua,{className:"mx-auto mb-2 text-red-600",size:32}),s.jsx("h4",{className:"text-2xl font-bold text-red-700",children:Nt((u==null?void 0:u.resteAPayer)||0)}),s.jsx("p",{className:"text-sm text-red-600",children:"Reste  Payer"})]})]}),s.jsxs("div",{className:"card border-l-4 border-blue-500 bg-blue-50",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(oM,{size:20,className:"text-blue-600"})," Historique Complet du Client"]}),s.jsx("button",{onClick:()=>m(!v),className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-700 font-medium transition-colors",children:v?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Masquer"}),s.jsx(ri,{size:16})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Voir l'historique"}),s.jsx(ln,{size:16})]})})]}),v?s.jsx("div",{className:"bg-white rounded-lg p-4",children:s.jsx(rO,{prospectId:e.id})}):s.jsxs("div",{className:"text-sm text-gray-700",children:[s.jsx("p",{className:"mb-2",children:" Cet historique contient:"}),s.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2 mb-3",children:[s.jsxs("li",{children:[s.jsx("strong",{children:"Actions de suivi"})," (appels, emails, RDV, etc.)"]}),s.jsx("li",{children:s.jsx("strong",{children:"Conversion en client actif"})}),s.jsxs("li",{children:[s.jsx("strong",{children:"Installations"})," (ACQUISITION et ABONNEMENT)"]}),s.jsxs("li",{children:[s.jsx("strong",{children:"Abonnements"})," (cration et renouvellements auto)"]})]}),s.jsx("p",{className:"text-xs text-gray-600",children:"Il est conserv pour traabilit et analyse du parcours commercial."})]})]}),s.jsxs("div",{className:"card",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx(Uo,{size:20,className:"text-primary"}),"Installations"]}),t.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Uo,{className:"mx-auto text-gray-300 mb-2",size:48}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Aucune installation"})]}):s.jsx("div",{className:"space-y-3",children:t.map(g=>{const S=n.filter(_=>_.installation_id===g.id).reduce((_,E)=>_+(E.montant||0),0);Math.max(0,g.montant-S);const w=g.type&&g.type.toLowerCase()==="abonnement"?"ABONNEMENT":"ACQUISITION",j=w==="ABONNEMENT"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700";return s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors",children:s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("h4",{className:"font-semibold text-gray-800",children:g.application_installee}),s.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${j}`,children:w})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Install le ",St(g.date_installation)]})]}),s.jsx("div",{className:"text-right",children:s.jsxs("div",{className:`rounded-lg p-2 text-center font-bold text-2xl ${En(g.montant,S).couleur}`,children:[En(g.montant,S).code,s.jsx("div",{className:"text-lg",children:En(g.montant,S).icon})]})})]})},`inst-${g.id}`)})})]}),l.length>0&&s.jsxs("div",{className:"card",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx(hs,{size:20,className:"text-blue-600"})," Abonnements Renouvels"]}),s.jsx("div",{className:"space-y-3",children:l.map(g=>s.jsx("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-800",children:g.application}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Renouvel le ",St(g.date)]})]}),s.jsxs("div",{className:"text-right",children:[g.montant&&s.jsx("p",{className:"font-bold text-blue-600",children:Nt(g.montant)}),s.jsx("p",{className:"text-xs text-gray-500",children:"Auto-renouvellement"})]})]})},g.id))})]}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(Ua,{size:20,className:"text-green-500"}),"Historique Paiements"]}),n.length>0&&s.jsx("button",{onClick:()=>y(!p),className:"flex items-center gap-2 text-sm text-primary hover:text-primary-dark font-medium transition-colors",children:p?s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Voir rsum"}),s.jsx(ri,{size:16})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"Voir dtails"}),s.jsx(ln,{size:16})]})})]}),n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ua,{className:"mx-auto text-gray-300 mb-2",size:48}),s.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun paiement"})]}):p?s.jsx("div",{className:"space-y-3",children:n.map((g,S)=>{var E,A;let w=g.type?g.type.charAt(0).toUpperCase()+g.type.slice(1):"Paiement";g.type==="abonnement"&&((E=g.installation)==null?void 0:E.type)==="acquisition"&&(w="Abonnement via Acquisition");const j=g.type==="abonnement"?"bg-blue-50 border-blue-200":g.type==="acquisition"?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200",_=g.type==="abonnement"?"":g.type==="acquisition"?"":"";return s.jsx("div",{className:`rounded-lg p-3 border ${j}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{children:_}),s.jsx("p",{className:"font-semibold text-gray-800",children:w})]}),s.jsx("p",{className:"text-sm text-gray-600 font-medium",children:((A=g.installation)==null?void 0:A.application_installee)||"Application inconnue"}),s.jsx("p",{className:"text-sm text-gray-600",children:St(g.date_paiement)}),g.mode_paiement&&s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:g.mode_paiement})]}),s.jsx("div",{className:"text-right",children:s.jsx("p",{className:"font-bold text-green-600",children:Nt(g.montant)})})]})},g.id)})}):s.jsxs("div",{className:"space-y-2",children:[n.slice(0,5).map((g,S)=>{var _;let w=g.type?g.type.charAt(0).toUpperCase()+g.type.slice(1):"Paiement";g.type==="abonnement"&&((_=g.installation)==null?void 0:_.type)==="acquisition"&&(w="Abonnement via Acquisition");const j=g.type==="abonnement"?"":g.type==="acquisition"?"":"";return s.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-0",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{children:j}),s.jsx("p",{className:"font-medium text-gray-800",children:w})]}),s.jsx("p",{className:"text-sm text-gray-600",children:St(g.date_paiement)})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-bold text-green-600",children:Nt(g.montant)}),g.mode_paiement&&s.jsx("p",{className:"text-xs text-gray-500 capitalize",children:g.mode_paiement})]})]},g.id)}),n.length>5&&s.jsxs("button",{onClick:()=>y(!0),className:"w-full py-2 text-sm text-primary hover:text-primary-dark font-medium",children:["Voir les ",n.length-5," autres paiements"]})]})]}),a.length>0&&s.jsxs("div",{className:"card",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx(pM,{size:20,className:"text-purple-500"}),"Interventions Rcentes"]}),s.jsxs("div",{className:"space-y-3",children:[a.slice(0,5).map(g=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-semibold text-gray-800 capitalize",children:g.type_intervention}),s.jsx("span",{className:g.statut==="cloturee"?"badge-success":"badge-warning",children:g.statut==="cloturee"?"Clture":"En cours"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:g.resume_probleme}),s.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[s.jsx("span",{children:St(g.date_intervention)}),s.jsxs("span",{children:[g.duree_minutes||"-"," min"]}),g.technicien&&s.jsxs("span",{children:["Tech: ",g.technicien.nom]})]})]},g.id)),a.length>5&&s.jsxs("p",{className:"text-center text-sm text-gray-500 pt-2",children:["+",a.length-5," autres interventions"]})]})]})]})},jte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState(!0),[o,l]=N.useState(""),[c,u]=N.useState(!1),[d,f]=N.useState(null),{addNotification:h}=cr();N.useEffect(()=>{p()},[]),N.useEffect(()=>{y()},[e,o]);const p=async()=>{try{a(!0);const x=(await mt.getAll()).filter(g=>g.statut==="actif"),b=await Promise.all(x.map(async g=>{try{const S=await Tr.getByClient(g.id),w=await ar.getByClient(g.id),j=(S||[]).reduce((A,P)=>A+(P.montant||0),0),_=(w||[]).reduce((A,P)=>A+(P.montant||0),0),E=Math.max(0,j-_);return{...g,montant_paye:_,reste_a_payer:E,montant_total:j}}catch(S){return console.warn(`Erreur calcul financials pour client ${g.id}:`,S),{...g,montant_paye:0,reste_a_payer:0,montant_total:0}}}));t(b)}catch{h({type:"error",message:"Erreur lors du chargement des clients"})}finally{a(!1)}},y=()=>{let m=[...e];o&&(m=m.filter(x=>{var b,g,S,w;return((b=x.raison_sociale)==null?void 0:b.toLowerCase().includes(o.toLowerCase()))||((g=x.contact)==null?void 0:g.toLowerCase().includes(o.toLowerCase()))||((S=x.telephone)==null?void 0:S.includes(o))||((w=x.email)==null?void 0:w.toLowerCase().includes(o.toLowerCase()))})),n(m)},v=m=>{f(m),u(!0)};return i?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total Clients"}),s.jsx("h3",{className:"text-4xl font-bold",children:e.length})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Actifs ce mois"}),s.jsx("h3",{className:"text-4xl font-bold",children:e.length})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Nouveaux"}),s.jsx("h3",{className:"text-4xl font-bold",children:"+5"})]})]}),s.jsx("div",{className:"card",children:s.jsx(gc,{value:o,onChange:l,placeholder:"Rechercher un client..."})}),r.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucun client trouv"})}):s.jsx(yc,{data:r,columns:[{key:"raison_sociale",label:"Client",width:"200px",render:m=>s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:m.raison_sociale}),s.jsx("p",{className:"text-xs text-gray-500",children:m.email||"N/A"})]})},{key:"created_at",label:"Date Cration",width:"120px",render:m=>{var x;return s.jsx("span",{className:`text-xs font-bold ${(x=m.created_at)!=null&&x.includes("2025-12-31")?"text-red-600 bg-red-50 p-1 rounded":"text-gray-600"}`,children:m.created_at?St(m.created_at):"Sans date"})}},{key:"contact",label:"Contact",width:"150px",render:m=>s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-900",children:m.contact||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:m.telephone||"N/A"})]})},{key:"secteur",label:"Secteur",width:"120px",render:m=>s.jsx("span",{children:m.secteur||"N/A"})},{key:"statut_paiement",label:"Statut de Paiement",width:"140px",render:m=>{const x=m.montant_total||0,b=m.montant_paye||0,g=Math.max(0,x-b);let S,w,j;return g===x||x===0?(S="Aucun paiement",w="bg-red-100 text-red-700",j=0):g>0?(S="Partiellement pay",w="bg-orange-100 text-orange-700",j=1):(S="Totalement pay",w="bg-green-100 text-green-700",j=2),s.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${w}`,children:[j," (",S,")"]})}},{key:"wilaya",label:"Wilaya",width:"100px",render:m=>s.jsx("span",{children:m.wilaya||"N/A"})},{key:"statut",label:"Statut",width:"100px",render:m=>s.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"CLIENT ACTIF"})}],actions:[{key:"view",label:"Dtails",icon:s.jsx(vl,{size:18}),onClick:v,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1"}],loading:i,emptyMessage:"Aucun client trouv"}),s.jsx(Wt,{isOpen:c,onClose:()=>u(!1),title:"Dtails du Client",size:"lg",children:s.jsx(_te,{client:d})})]})},oh=({options:e=[],value:t,onChange:r,placeholder:n="Slectionner...",label:i,name:a,error:o,required:l=!1,disabled:c=!1,className:u=""})=>{const[d,f]=N.useState(!1),[h,p]=N.useState(""),y=N.useRef(null),v=N.useRef(null);N.useEffect(()=>{const S=w=>{y.current&&!y.current.contains(w.target)&&f(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]);const m=N.useMemo(()=>e.find(S=>S.value===t),[e,t]),x=N.useMemo(()=>{if(!h)return e;const S=h.toLowerCase();return e.filter(w=>w.label.toLowerCase().includes(S)||w.description&&w.description.toLowerCase().includes(S))},[e,h]),b=S=>{r({target:{name:a,value:S}})},g=()=>{c||(f(!0),setTimeout(()=>{v.current&&v.current.focus()},100))};return s.jsxs("div",{ref:y,className:`w-full relative ${u}`,children:[i&&s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[i,l&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{type:"button",onClick:()=>d?f(!1):g(),disabled:c,className:`
            w-full px-4 py-2 text-left bg-white border rounded-lg flex items-center justify-between transition-all duration-200
            ${o?"border-red-500 ring-1 ring-red-500":"border-gray-300 focus:ring-2 focus:ring-primary focus:border-transparent"}
            ${c?"bg-gray-100 cursor-not-allowed text-gray-400":"text-gray-900 hover:border-gray-400"}
          `,children:[s.jsx("span",{className:`block truncate ${m?"":"text-gray-500"}`,children:m?m.label:n}),s.jsx(ln,{size:18,className:`text-gray-400 transition-transform duration-200 ${d?"rotate-180":""}`})]}),d&&s.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-xl z-[100] overflow-hidden",children:[s.jsx("div",{className:"p-2 border-b border-gray-100 bg-gray-50",children:s.jsxs("div",{className:"relative",children:[s.jsx(hf,{size:14,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),s.jsx("input",{ref:v,type:"text",className:"w-full pl-9 pr-3 py-1.5 text-sm bg-white border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary transition-all",placeholder:"Rechercher...",value:h,onChange:S=>p(S.target.value),onClick:S=>S.stopPropagation(),autoFocus:!0})]})}),s.jsx("div",{className:"max-h-64 overflow-y-auto py-1",children:x.length>0?x.map(S=>s.jsxs("button",{type:"button",onClick:()=>{b(S.value),f(!1),p("")},className:`
                      w-full px-4 py-2.5 text-left text-sm flex items-center justify-between transition-colors
                      ${S.value===t?"bg-primary/5 text-primary font-semibold":"text-gray-700 hover:bg-gray-50"}
                    `,children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"block truncate",children:S.label}),S.description&&s.jsx("span",{className:"text-[10px] text-gray-400 font-normal truncate",children:S.description})]}),S.value===t&&s.jsx(nM,{size:14,className:"text-primary shrink-0"})]},S.value)):s.jsx("div",{className:"px-4 py-8 text-center",children:s.jsxs("p",{className:"text-sm text-gray-400 italic",children:['Aucun rsultat trouv pour "',h,'"']})})})]})]}),o&&s.jsx("p",{className:"mt-1 text-xs text-red-600 font-medium",children:o})]})},Ste=({installation:e,onSubmit:t,onCancel:r})=>{const[n,i]=N.useState({client_id:"",application_installee:"",montant:"",montant_abonnement:"",date_installation:"",type:"acquisition",statut:"en_cours"}),[a,o]=N.useState(""),[l,c]=N.useState({}),[u,d]=N.useState([]),[f,h]=N.useState([]),[p,y]=N.useState(!1);N.useEffect(()=>{v(),m()},[]),N.useEffect(()=>{var w;if(e&&(i({client_id:e.client_id||"",application_installee:e.application_installee||"",montant:e.montant||"",montant_abonnement:e.montant_abonnement||"",date_installation:((w=e.date_installation)==null?void 0:w.split("T")[0])||"",type:e.type||"acquisition",statut:e.statut||"en_cours"}),e.application_installee&&f.length>0)){const j=f.find(_=>_.nom===e.application_installee);j&&o(j.id)}},[e]);const v=async()=>{try{const w=await mt.getAll();d(w)}catch(w){console.error("Erreur chargement clients:",w)}},m=async()=>{try{const w=await Ga.getAll();h(w)}catch(w){console.error("Erreur chargement applications:",w)}},x=(w,j)=>{i(_=>({..._,[w]:j})),l[w]&&c(_=>({..._,[w]:""}))},b=w=>{const j=f.find(_=>_.id===w);if(j){const _=n.type==="abonnement"?j.prix_abonnement||j.prix_acquisition||j.prix||0:j.prix_acquisition||j.prix_abonnement||j.prix||0;i(E=>({...E,application_installee:j.nom,montant:_})),console.log(` Application slectionne: ${j.nom}, Type: ${n.type}, Prix: ${_}`)}},g=w=>{const j=n.application_installee;if(j){const _=f.find(E=>E.nom===j);if(_){const E=w==="abonnement"?_.prix_abonnement||_.prix_acquisition||_.prix||0:_.prix_acquisition||_.prix_abonnement||_.prix||0;i(A=>({...A,type:w,montant:E})),console.log(` Type chang: ${w}, Montant recalcul: ${E}`);return}}x("type",w)},S=async w=>{if(w.preventDefault(),p)return;const j={};if(n.client_id||(j.client_id="Client requis"),n.application_installee||(j.application_installee="Application requise"),n.montant||(j.montant="Montant requis"),n.montant_abonnement||(j.montant_abonnement="Montant d'abonnement requis"),n.date_installation||(j.date_installation="Date requise"),n.type||(j.type="Type requis"),Object.keys(j).length>0){c(j);return}try{y(!0);const E=new Date(n.date_installation).toISOString().split("T")[0],A={client_id:n.client_id,application_installee:n.application_installee,montant:parseFloat(n.montant),montant_abonnement:parseFloat(n.montant_abonnement),date_installation:E,type:n.type,statut:n.statut};await t(A)}finally{y(!1)}};return s.jsxs("form",{onSubmit:S,className:"space-y-4",children:[s.jsx(oh,{label:"Client",value:n.client_id,onChange:w=>x("client_id",w.target.value),options:u.map(w=>({value:w.id,label:w.raison_sociale,description:`${w.ville||""} ${w.wilaya?`(${w.wilaya})`:""} - ${w.contact||""}`.trim().replace(/^ - /,"")})),placeholder:"Rechercher un client...",error:l.client_id,required:!0,disabled:p}),s.jsx(yt,{label:"Application",value:a,onChange:w=>{o(w.target.value),b(w.target.value)},options:[{value:"",label:"Slectionner une application..."},...f.map(w=>{const j=w.prix_acquisition||w.prix,_=w.prix_abonnement||w.prix;return{value:w.id,label:`${w.nom} - ACQ: ${j} DA / ABO: ${_} DA`}})],disabled:p}),s.jsx(Ie,{label:"Application Installe",value:n.application_installee,onChange:w=>x("application_installee",w.target.value),placeholder:"Nom de l'application",error:l.application_installee,required:!0,disabled:p}),s.jsx(Ie,{label:"Montant (DA)",type:"number",step:"0.01",value:n.montant,onChange:w=>x("montant",w.target.value),placeholder:"0.00",error:l.montant,required:!0,disabled:p}),s.jsx(Ie,{label:"Montant d'Abonnement (DA)",type:"number",step:"0.01",value:n.montant_abonnement,onChange:w=>x("montant_abonnement",w.target.value),placeholder:"0.00",error:l.montant_abonnement,required:!0,disabled:p}),s.jsx(Ie,{label:"Date d'Installation",type:"date",value:n.date_installation,onChange:w=>x("date_installation",w.target.value),error:l.date_installation,required:!0,disabled:p}),s.jsx(yt,{label:"Type",value:n.type,onChange:w=>g(w.target.value),options:[{value:"acquisition",label:"Acquisition"},{value:"abonnement",label:"Abonnement"}],error:l.type,required:!0,disabled:p}),s.jsx(yt,{label:"Statut",value:n.statut,onChange:w=>x("statut",w.target.value),options:[{value:"en_cours",label:"En Cours"},{value:"terminee",label:"Termine"}],required:!0,disabled:p}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,disabled:p,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",disabled:p,children:p?"En cours...":e?"Modifier":"Crer"})]})]})},Nte=({installation:e,onEdit:t,onDelete:r,onPayment:n,refreshTrigger:i})=>{var T,M;const[a,o]=N.useState(0),[l,c]=N.useState(0),[u,d]=N.useState([]),[f,h]=N.useState(!0),{profile:p,user:y}=dt(),[v,m]=N.useState(null),[x,b]=N.useState(!1),[g,S]=N.useState(!1),[w,j]=N.useState(!1),[_,E]=N.useState(!1);N.useEffect(()=>{(async()=>{try{if(e!=null&&e.created_by&&((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")){b(!0);const k=await Fe.getById(e.created_by);m(k)}if(y!=null&&y.id&&p){E(!0);const k=await Fe.hasEditPermission(y.id,"installations"),F=await Fe.hasDeletePermission(y.id,"installations");S(k),j(F)}}catch(k){console.error("Erreur chargement donnes:",k)}finally{b(!1),E(!1)}})()},[e==null?void 0:e.created_by,p==null?void 0:p.role,y==null?void 0:y.id,p]),N.useEffect(()=>{e&&e.client_id&&e.id&&A()},[e==null?void 0:e.id,i]);const A=async()=>{try{h(!0);const k=(await ar.getByClient(e.client_id)).filter(W=>W.installation_id===e.id);d(k);const F=k.reduce((W,R)=>W+(R.montant||0),0);c(F);const I=Math.max(0,e.montant-F);o(I)}catch(O){console.error("Erreur calcul reste  payer:",O),o(e.montant),c(0)}finally{h(!1)}},P=()=>{n&&n(e)};return s.jsxs("div",{className:"card hover:shadow-xl transition-shadow duration-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-1",children:e.application_installee}),s.jsx("span",{className:`${wM(e.statut)} text-xs`,children:_u(e.statut)})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>t(e),disabled:!g&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin"),className:`p-2 rounded-lg transition-colors ${!g&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")?"text-gray-400 cursor-not-allowed":"text-blue-600 hover:bg-blue-50"}`,title:!g&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")?"Permission refuse":"Modifier",children:!g&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")?s.jsx(xi,{size:18}):s.jsx(br,{size:18})}),s.jsx("button",{onClick:()=>r(e.id),disabled:!w&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin"),className:`p-2 rounded-lg transition-colors ${!w&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")?"text-gray-400 cursor-not-allowed":"text-red-600 hover:bg-red-50"}`,title:!w&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")?"Permission refuse":"Supprimer",children:!w&&!((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")?s.jsx(xi,{size:18}):s.jsx(rr,{size:18})})]})]}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm",children:[s.jsx(Uo,{size:16}),s.jsx("span",{className:"font-medium",children:(T=e.client)==null?void 0:T.raison_sociale})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm",children:[s.jsx(xr,{size:16}),s.jsxs("span",{children:["Install le ",St(e.date_installation)]})]}),s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[s.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:"MONTANT"}),s.jsx("p",{className:"text-2xl font-bold text-blue-700",children:(p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin"?Nt(e.montant||0):""})]}),!f&&s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"bg-green-50 rounded-lg p-3 border border-green-200",children:[s.jsx("p",{className:"text-xs text-green-600 font-semibold",children:"MONTANT PAY"}),s.jsx("p",{className:"text-xl font-bold text-green-700",children:(p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin"?Nt(l):""})]}),s.jsxs("div",{className:`rounded-lg p-3 border ${a>0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[s.jsx("p",{className:`text-xs font-semibold ${a>0?"text-red-600":"text-green-600"}`,children:"RESTE  PAYER"}),s.jsx("p",{className:`text-xl font-bold ${a>0?"text-red-700":"text-green-700"}`,children:(p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin"?Nt(a):""})]})]}),!f&&u.length>0&&((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")&&s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[s.jsxs("div",{className:"text-sm text-blue-700 font-medium mb-2",children:["Paiements enregistrs (",u.length,"):"]}),s.jsx("div",{className:"space-y-2",children:u.map(O=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-blue-600",children:St(O.date_paiement)}),s.jsx("span",{className:"font-bold text-blue-700",children:Nt(O.montant)})]},O.id))})]})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-200 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Client:"}),s.jsx("span",{className:"font-medium text-gray-800",children:(M=e.client)==null?void 0:M.contact})]}),v&&((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")&&s.jsx("div",{className:"text-xs text-gray-500",children:s.jsxs("p",{children:["Cr par: ",s.jsx("span",{className:"font-semibold text-gray-700",children:v.nom||v.email})]})}),a>0&&((p==null?void 0:p.role)==="admin"||(p==null?void 0:p.role)==="super_admin")&&s.jsxs("button",{onClick:P,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[s.jsx(Ua,{size:18}),"Enregistrer un paiement"]})]})]})},Ete=({installation:e,onSubmit:t,onCancel:r,isSubmitting:n=!1})=>{var b;const{profile:i}=dt(),[a,o]=N.useState({montant:"",mode_paiement:"virement",type:"acquisition",date_paiement:new Date().toISOString().split("T")[0]}),[l,c]=N.useState({}),[u,d]=N.useState(0),[f,h]=N.useState(0),[p,y]=N.useState(!0);N.useEffect(()=>{v()},[e==null?void 0:e.id]),N.useEffect(()=>{e&&e.type&&o(g=>({...g,type:e.type}))},[e==null?void 0:e.id,e==null?void 0:e.type]);const v=async()=>{try{if(y(!0),!e||!e.id){d(0),h(0),y(!1);return}console.log("Installation slectionne:",e.id);const g=await ar.getByClient(e.client_id);console.log("Tous les paiements du client:",g);const S=g.filter(_=>(console.log(`Comparaison: ${_.installation_id} === ${e.id} => ${_.installation_id===e.id}`),_.installation_id===e.id));console.log("Paiements de CETTE installation:",S);const w=S.reduce((_,E)=>_+(E.montant||0),0);console.log("Total pay:",w,"Montant installation:",e.montant),h(w);const j=Math.max(0,e.montant-w);d(j),console.log("Reste  payer:",j),j>0?o(_=>({..._,montant:j.toString()})):o(_=>({..._,montant:""}))}catch(g){console.error("Erreur calcul reste:",g),d((e==null?void 0:e.montant)||0)}finally{y(!1)}},m=(g,S)=>{o(w=>({...w,[g]:S})),l[g]&&c(w=>({...w,[g]:""}))},x=g=>{g.preventDefault();const S={};if(a.mode_paiement||(S.mode_paiement="Mode de paiement requis"),a.date_paiement||(S.date_paiement="Date requise"),Object.keys(S).length>0){c(S);return}const w={montant:parseFloat(a.montant),mode_paiement:a.mode_paiement,type:a.type,date_paiement:a.date_paiement};t(w)};return p?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):s.jsxs("form",{onSubmit:x,className:"space-y-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 space-y-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Installation"}),s.jsx("p",{className:"text-lg font-bold text-gray-800",children:e.application_installee})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Client"}),s.jsx("p",{className:"text-gray-800",children:(b=e.client)==null?void 0:b.raison_sociale})]}),s.jsxs("div",{className:"border-t border-blue-200 pt-3 grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Statut"}),s.jsx("p",{className:`text-3xl font-bold ${En(e.montant,f).couleur}`,children:En(e.montant,f).code})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Montant"}),s.jsx("p",{className:"text-lg font-bold text-gray-600",children:(i==null?void 0:i.role)==="admin"||(i==null?void 0:i.role)==="super_admin"?Nt(e.montant||0):""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Pourcentage"}),s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[(f/e.montant*100).toFixed(0),"%"]})]})]})]}),u===0&&s.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:s.jsx("p",{className:"text-sm text-green-700 font-semibold",children:" Cette installation est entirement paye !"})}),s.jsx(Ie,{label:"Montant Vers (DA)",type:"number",step:"0.01",value:a.montant,onChange:g=>m("montant",g.target.value),placeholder:"Entrer le montant vers",error:l.montant,required:!0}),s.jsx(yt,{label:"Mode de Paiement",value:a.mode_paiement,onChange:g=>m("mode_paiement",g.target.value),options:[{value:"especes",label:"Espces"},{value:"virement",label:"Virement"},{value:"cheque",label:"Chque"},{value:"autre",label:"Autre"}],error:l.mode_paiement,required:!0}),s.jsx(yt,{label:"Type de Paiement",value:a.type,onChange:g=>m("type",g.target.value),disabled:!0,options:[{value:"acquisition",label:"Acquisition"},{value:"abonnement",label:"Abonnement"}],error:l.type,required:!0}),s.jsx(Ie,{label:"Date du Paiement",type:"date",value:a.date_paiement,onChange:g=>m("date_paiement",g.target.value),error:l.date_paiement,required:!0}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,disabled:n,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",disabled:u===0||n,children:n?" Enregistrement...":"Enregistrer le Paiement"})]})]})},Ate=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState([]),[o,l]=N.useState(!0),[c,u]=N.useState(""),[d,f]=N.useState("all"),[h,p]=N.useState(""),[y,v]=N.useState(""),[m,x]=N.useState(""),[b,g]=N.useState(!1),[S,w]=N.useState(!1),[j,_]=N.useState(!1),[E,A]=N.useState(null),[P,T]=N.useState("create"),[M,O]=N.useState(0),[k,F]=N.useState(!1),[I,W]=N.useState(!1),[R,D]=N.useState(!1),[H,Q]=N.useState(!1),[U,G]=N.useState(!1),[B,me]=N.useState([]),[ue,Ne]=N.useState([]),{addNotification:ve}=cr(),{user:Y,profile:Z}=dt();N.useEffect(()=>{te()},[]),N.useEffect(()=>{e.length>0&&L()},[e]),N.useEffect(()=>{const ee=[...new Set(e.map(C=>C.wilaya).filter(C=>C&&C.trim()!=="").map(C=>C.trim()))].sort();Ne(ee)},[e]),N.useEffect(()=>{le()},[Y==null?void 0:Y.id,Z==null?void 0:Z.role]),N.useEffect(()=>{he()},[e,c,d,h,y,m,B]);const te=async()=>{try{l(!0);const ee=await Tr.getAll();t(ee)}catch{ve({type:"error",message:"Erreur lors du chargement des installations"})}finally{l(!1)}},L=async()=>{try{const ee=await ar.getAll();a(ee)}catch(ee){console.error("Erreur lors du chargement des paiements:",ee)}},ae=ee=>i.filter(C=>C.installation_id===ee).reduce((C,K)=>C+(K.montant||0),0),oe=ee=>{const C=ae(ee.id);return Math.max(0,(ee.montant||0)-C)},le=async()=>{try{if(Q(!0),Y!=null&&Y.id&&Z){const ee=(Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin"||await Fe.hasCreatePermission(Y.id,"installations"),C=(Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin"||await Fe.hasEditPermission(Y.id,"installations"),K=(Z==null?void 0:Z.role)==="admin"||(Z==null?void 0:Z.role)==="super_admin"||await Fe.hasDeletePermission(Y.id,"installations");F(ee),W(C),D(K)}}catch(ee){console.error("Erreur chargement permissions:",ee)}finally{Q(!1)}},he=()=>{let ee=[...e];d!=="all"&&(ee=ee.filter(C=>C.statut===d)),c&&(ee=ee.filter(C=>{var K,re,se;return((K=C.application_installee)==null?void 0:K.toLowerCase().includes(c.toLowerCase()))||((se=(re=C.client)==null?void 0:re.raison_sociale)==null?void 0:se.toLowerCase().includes(c.toLowerCase()))})),h&&(ee=ee.filter(C=>new Date(C.date_installation)>=new Date(h))),y&&(ee=ee.filter(C=>new Date(C.date_installation)<=new Date(y+"T23:59:59"))),m&&(ee=ee.filter(C=>C.created_by===m)),B.length>0&&(ee=ee.filter(C=>B.includes(C.wilaya))),n(ee)},Se=()=>{k&&(A(null),T("create"),g(!0))},$e=ee=>{I&&(A(ee),T("edit"),g(!0))},ze=async ee=>{const C=(ee==null?void 0:ee.id)||ee;if(!R)return;try{if(await Tr.hasPaiements(C)){window.alert(` SUPPRESSION IMPOSSIBLE 

Cette installation est lie  un ou plusieurs paiements enregistrs.

 Vous ne pouvez pas supprimer cette installation.

 Solution: Supprimez d'abord les paiements avant de supprimer l'installation.`);return}}catch(se){console.error("Erreur vrification paiements:",se)}if(!window.confirm(` ATTENTION 

Cette action va supprimer:
- L'installation
- Tous les abonnements lis

Cette action est IRRVERSIBLE !

tes-vous absolument sr de vouloir continuer ?`))return;if(window.prompt('Pour confirmer la suppression, tapez "SUPPRIMER" en majuscules:')!=="SUPPRIMER"){ve({type:"info",message:"Suppression annule"});return}try{await Tr.delete(C),ve({type:"success",message:"Installation supprime avec succs"}),te()}catch(se){se.code==="INSTALLATION_HAS_PAIEMENTS"?window.alert(` SUPPRESSION IMPOSSIBLE 

Cette installation est lie  un ou plusieurs paiements enregistrs.

 Vous ne pouvez pas supprimer cette installation.

 Solution: Supprimez d'abord les paiements avant de supprimer l'installation.`):ve({type:"error",message:se.message||"Erreur lors de la suppression"})}},Le=ee=>{A(ee),w(!0)},q=async ee=>{try{if(P==="create"){const C={...ee,created_by:(Y==null?void 0:Y.id)||null};await Tr.create(C),ve({type:"success",message:"Installation cre avec succs"})}else await Tr.update(E.id,ee),ve({type:"success",message:"Installation modifie avec succs"});g(!1),te()}catch(C){ve({type:"error",message:C.message||"Erreur lors de l'enregistrement"})}},$=async ee=>{if(!U){G(!0);try{await ar.create({...ee,client_id:E.client_id,installation_id:E.id,created_by:(Y==null?void 0:Y.id)||null}),ve({type:"success",message:"Paiement enregistr avec succs"}),w(!1),await te(),X()}catch(C){ve({type:"error",message:C.message||"Erreur lors de l'enregistrement du paiement"})}finally{G(!1)}}},X=()=>{O(ee=>ee+1)},xe={total:e.length,enCours:e.filter(ee=>ee.statut==="en_cours").length,terminees:e.filter(ee=>ee.statut==="terminee").length,acquisitions:e.filter(ee=>ee.type==="acquisition").length,abonnements:e.filter(ee=>ee.type==="abonnement").length,revenuTotal:e.reduce((ee,C)=>ee+(C.montant||0),0)};return o?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total Installations"}),s.jsx("h3",{className:"text-3xl font-bold",children:xe.total})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"En Cours"}),s.jsx("h3",{className:"text-3xl font-bold",children:xe.enCours})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Termines"}),s.jsx("h3",{className:"text-3xl font-bold",children:xe.terminees})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Acquisitions"}),s.jsx("h3",{className:"text-3xl font-bold",children:xe.acquisitions})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-indigo-500 to-indigo-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Abonnements"}),s.jsx("h3",{className:"text-3xl font-bold",children:xe.abonnements})]}),s.jsx("div",{className:"card",children:s.jsx(je,{variant:"primary",icon:Un,onClick:Se,disabled:!k,className:"w-full h-full",title:k?"Crer une nouvelle installation":"Permission refuse: Crer une installation",children:"Nouvelle Installation"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx(vv,{onSearchChange:u,onDateStartChange:p,onDateEndChange:v,onCreatorChange:x,searchValue:c,dateStart:h,dateEnd:y,creatorId:m}),s.jsx("div",{className:"card",children:s.jsx(QP,{options:ue.map(ee=>({value:ee,label:eO(ee),count:e.filter(C=>C.wilaya===ee).length})),selectedValues:B,onChange:me,placeholder:"Filtrer par Wilaya",label:"Filtrer par Wilaya",icon:Cn,displayFormat:(ee,C)=>`Tous les Wilayas (${C})`})})]}),r.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune installation trouve"})}):s.jsx(yc,{data:r,columns:[{key:"application_installee",label:"Application",width:"200px",render:ee=>{var C;return s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:ee.application_installee||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:((C=ee.client)==null?void 0:C.raison_sociale)||"N/A"})]})}},{key:"date_installation",label:"Date Installation",width:"150px",render:ee=>s.jsx("span",{children:ee.date_installation?new Date(ee.date_installation).toLocaleDateString("fr-FR"):"N/A"})},{key:"statut",label:"Statut",width:"120px",render:ee=>s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${ee.statut==="en_cours"?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:ee.statut==="en_cours"?"En cours":"Termine"})},{key:"type",label:"Type",width:"120px",render:ee=>s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${ee.type==="acquisition"?"bg-purple-100 text-purple-800":"bg-indigo-100 text-indigo-800"}`,children:ee.type==="acquisition"?"Acquisition":"Abonnement"})},{key:"statut_paiement",label:"Statut de Paiement",width:"140px",render:ee=>{ae(ee.id);const C=oe(ee);let K,re,se;return C===ee.montant?(K="Aucun paiement",re="bg-red-100 text-red-700",se=0):C>0?(K="Partiellement pay",re="bg-orange-100 text-orange-700",se=1):(K="Totalement pay",re="bg-green-100 text-green-700",se=2),s.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${re}`,children:[se," (",K,")"]})}}],actions:[{key:"details",label:"Dtails",icon:s.jsx(vl,{size:18}),onClick:ee=>{A(ee),_(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1"},{key:"edit",label:"Modifier",icon:s.jsx(br,{size:18}),onClick:$e,disabled:!I,title:I?"Modifier cette installation":"Permission refuse: Modifier",className:I?"bg-amber-600 hover:bg-amber-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"},{key:"delete",label:"Supprimer",icon:s.jsx(rr,{size:18}),onClick:ze,disabled:!R,title:R?"Supprimer cette installation":"Permission refuse: Supprimer",className:R?"bg-red-600 hover:bg-red-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"}],loading:o,emptyMessage:"Aucune installation trouve"}),s.jsx(Wt,{isOpen:b,onClose:()=>g(!1),title:P==="create"?"Nouvelle Installation":"Modifier Installation",children:s.jsx(Ste,{installation:E,onSubmit:q,onCancel:()=>g(!1)})}),s.jsx(Wt,{isOpen:j,onClose:()=>_(!1),title:"Dtails Installation",size:"lg",children:E&&s.jsx(Nte,{installation:E,onEdit:$e,onDelete:ze,onPayment:Le,refreshTrigger:M})}),s.jsx(Wt,{isOpen:S,onClose:()=>w(!1),title:`Enregistrer un paiement - ${E==null?void 0:E.application_installee}`,children:E&&s.jsx(Ete,{installation:E,onSubmit:$,onCancel:()=>w(!1),isSubmitting:U})})]})},lh={validateProspect:e=>{const t={};return(!e.raison_sociale||e.raison_sociale.trim()==="")&&(t.raison_sociale="La raison sociale est obligatoire"),(!e.contact||e.contact.trim()==="")&&(t.contact="Le contact est obligatoire"),!e.telephone||e.telephone.trim()===""?t.telephone="Le tlphone est obligatoire":/^(0)(5|6|7)[0-9]{8}$/.test(e.telephone.replace(/\s/g,""))||(t.telephone="Format de tlphone invalide (ex: 0555123456)"),e.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)&&(t.email="Format d'email invalide"),{isValid:Object.keys(t).length===0,errors:t}},validateInstallation:e=>{const t={};return e.client_id||(t.client_id="Le client est obligatoire"),(!e.application_installee||e.application_installee.trim()==="")&&(t.application_installee="L'application est obligatoire"),(!e.montant||e.montant<=0)&&(t.montant="Le montant doit tre suprieur  0"),e.date_installation||(t.date_installation="La date d'installation est obligatoire"),{isValid:Object.keys(t).length===0,errors:t}},validatePaiement:e=>{const t={};e.client_id||(t.client_id="Le client est obligatoire"),e.type||(t.type="Le type de paiement est obligatoire");const r=parseFloat(e.montant);return(!e.montant||isNaN(r)||r<=0)&&(t.montant="Le montant doit tre un nombre positif"),e.mode_paiement||(t.mode_paiement="Le mode de paiement est obligatoire"),e.date_paiement||(t.date_paiement="La date de paiement est obligatoire"),{isValid:Object.keys(t).length===0,errors:t}},validateIntervention:e=>{const t={};return e.client_id||(t.client_id="Le client est obligatoire"),e.technicien_id||(t.technicien_id="Le technicien est obligatoire"),e.mode_intervention||(t.mode_intervention="Le mode d'intervention est obligatoire"),e.type_intervention||(t.type_intervention="Le type d'intervention est obligatoire"),(!e.resume_probleme||e.resume_probleme.trim()==="")&&(t.resume_probleme="Le rsum du problme est obligatoire"),{isValid:Object.keys(t).length===0,errors:t}},validateApplication:e=>{const t={};return(!e.nom||e.nom.trim()==="")&&(t.nom="Le nom de l'application est obligatoire"),(!e.prix_acquisition||e.prix_acquisition<=0)&&(t.prix_acquisition="Le prix d'acquisition doit tre suprieur  0"),(!e.prix_abonnement||e.prix_abonnement<=0)&&(t.prix_abonnement="Le prix d'abonnement doit tre suprieur  0"),{isValid:Object.keys(t).length===0,errors:t}},validateUser:e=>{const t={};return(!e.nom||e.nom.trim()==="")&&(t.nom="Le nom est obligatoire"),!e.email||e.email.trim()===""?t.email="L'email est obligatoire":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(t.email="Format d'email invalide"),e.role||(t.role="Le rle est obligatoire"),(!e.password||e.password.length<6)&&(t.password="Le mot de passe doit contenir au moins 6 caractres"),{isValid:Object.keys(t).length===0,errors:t}}},nO=({paiement:e,onSubmit:t,onCancel:r,isAbonnement:n=!1,isSubmitting:i=!1})=>{const{profile:a}=dt(),[o,l]=N.useState({client_id:"",installation_id:"",type:"acquisition",montant:"",mode_paiement:"especes",date_paiement:new Date().toISOString().split("T")[0]}),[c,u]=N.useState({}),[d,f]=N.useState([]),[h,p]=N.useState([]),[y,v]=N.useState(0),[m,x]=N.useState(0),[b,g]=N.useState(0),[S,w]=N.useState(0),[j,_]=N.useState(0),[E,A]=N.useState(!1);N.useEffect(()=>{var k;P(),e&&(l({client_id:e.client_id||"",installation_id:e.installation_id||"",type:e.type||"acquisition",montant:e.montant||"",mode_paiement:e.mode_paiement||"especes",date_paiement:((k=e.date_paiement)==null?void 0:k.split("T")[0])||""}),n&&e.abonnement_montant&&(v(e.abonnement_montant),(async()=>{try{if(e.installation_id){const W=(await ar.getByInstallation(e.installation_id)).reduce((D,H)=>D+(H.montant||0),0),R=Math.max(0,e.abonnement_montant-W);x(R),console.log(` Abonnement - Montant: ${e.abonnement_montant}, Pay: ${W}, Reste: ${R}`)}else x(e.abonnement_montant)}catch(I){console.error("Erreur calcul reste abonnement:",I),x(e.abonnement_montant)}})()))},[e,n]);const P=async()=>{try{const F=(await mt.getAll()).filter(I=>I.statut==="actif");f(F)}catch(k){console.error("Erreur chargement clients:",k)}},T=async k=>{try{const F=await Tr.getByClient(k);p(F)}catch(F){console.error("Erreur chargement installations:",F)}},M=(k,F)=>{if(l(I=>({...I,[k]:F})),c[k]&&u(I=>({...I,[k]:""})),k==="client_id"&&F&&T(F),k==="installation_id"&&F){const I=h.find(W=>String(W.id)===String(F));I&&(l(R=>({...R,type:I.type||"acquisition"})),(async()=>{try{const D=(await ar.getByInstallation(F)).reduce((Q,U)=>Q+(U.montant||0),0);_(D),g(I.montant||0);const H=Math.max(0,(I.montant||0)-D);w(H),A(!0),console.log(` Installation: ${I.application_installee}, Montant: ${I.montant}, Pay: ${D}, Reste: ${H}`)}catch(R){console.error("Erreur calcul reste  payer:",R),g(I.montant||0),w(I.montant||0),A(!0)}})())}},O=k=>{k.preventDefault();let F={};const I=lh.validatePaiement(o);if(!I.isValid){u({...I.errors,...F});return}if(Object.keys(F).length>0){u(F);return}t(o)};return s.jsxs("form",{onSubmit:O,className:"space-y-4",children:[s.jsx(oh,{label:"Client",value:o.client_id,onChange:k=>M("client_id",k.target.value),disabled:n,options:d.map(k=>({value:k.id,label:k.raison_sociale,description:`${k.ville||""} ${k.wilaya?`(${k.wilaya})`:""} - ${k.contact||""}`.trim().replace(/^ - /,"")})),placeholder:"Rechercher un client...",error:c.client_id,required:!0}),h.length>0&&s.jsx(yt,{label:"Installation (optionnel)",value:o.installation_id,onChange:k=>M("installation_id",k.target.value),disabled:n,options:h.map(k=>({value:k.id,label:k.application_installee}))}),o.installation_id&&!n&&(b>0||E)&&s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Statut"}),s.jsx("p",{className:`text-3xl font-bold ${En(b,b-S).couleur}`,children:En(b,b-S).code})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Montant"}),s.jsx("p",{className:"text-lg font-bold text-gray-600",children:(a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="super_admin"?Nt(b):""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Pourcentage"}),s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[((b-S)/b*100).toFixed(0),"%"]})]})]})}),s.jsx(yt,{label:"Type de Paiement",value:o.type,onChange:k=>M("type",k.target.value),disabled:!!o.installation_id||n,options:[{value:"acquisition",label:"Acquisition"},{value:"abonnement",label:"Abonnement"}],error:c.type,required:!0}),n&&y>0&&s.jsx("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3",children:s.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Statut"}),s.jsx("p",{className:`text-3xl font-bold ${En(y,y-m).couleur}`,children:En(y,y-m).code})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Montant"}),s.jsx("p",{className:"text-lg font-bold text-gray-600",children:(a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="super_admin"?Nt(y):""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Pourcentage"}),s.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[((y-m)/y*100).toFixed(0),"%"]})]})]})}),s.jsx(Ie,{label:"Montant Vers (DA)",type:"number",step:"0.01",value:o.montant,onChange:k=>M("montant",k.target.value),placeholder:"Entrer le montant vers",error:c.montant,required:!0}),s.jsx(yt,{label:"Mode de Paiement",value:o.mode_paiement,onChange:k=>M("mode_paiement",k.target.value),options:[{value:"especes",label:"Espces"},{value:"virement",label:"Virement"},{value:"cheque",label:"Chque"},{value:"autre",label:"Autre"}],error:c.mode_paiement,required:!0}),s.jsx(Ie,{label:"Date de Paiement",type:"date",value:o.date_paiement,onChange:k=>M("date_paiement",k.target.value),error:c.date_paiement,required:!0}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,disabled:i,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",disabled:i,children:i?" Enregistrement...":e?"Modifier":"Enregistrer"})]})]})},Pte=()=>{var k,F,I,W,R;const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState(!0),[o,l]=N.useState(""),[c,u]=N.useState("all"),[d,f]=N.useState(!1),[h,p]=N.useState(null),[y,v]=N.useState(!1),[m,x]=N.useState(!1),[b,g]=N.useState(!1),{addNotification:S}=cr(),{user:w,profile:j}=dt();N.useEffect(()=>{_()},[]),N.useEffect(()=>{E()},[w==null?void 0:w.id,j==null?void 0:j.role]),N.useEffect(()=>{A()},[e,o,c]);const _=async()=>{try{a(!0);const D=await Kt.getAll(),H=await Promise.all(D.map(async Q=>{var U,G,B,me;try{const{data:ue}=await V.from("paiements").select("montant").eq("installation_id",Q.installation_id),Ne=(ue||[]).reduce((te,L)=>te+(L.montant||0),0);let Y=((U=Q.installation)==null?void 0:U.montant)||0;try{const{data:te}=await V.from("applications").select("prix_abonnement, prix_acquisition").eq("nom",(G=Q.installation)==null?void 0:G.application_installee).single();te!=null&&te.prix_abonnement&&(Y=te.prix_abonnement)}catch{console.warn("Impossible de rcuprer le prix_abonnement")}const Z=Math.max(0,Y-Ne);return{...Q,totalPaye:Ne,resteAPayer:Z,montantInstallation:Y}}catch(ue){return console.error("Erreur chargement paiements:",ue),{...Q,totalPaye:0,resteAPayer:((B=Q.installation)==null?void 0:B.montant)||0,montantInstallation:((me=Q.installation)==null?void 0:me.montant)||0}}}));t(H)}catch{S({type:"error",message:"Erreur lors du chargement des abonnements"})}finally{a(!1)}},E=async()=>{try{if(w!=null&&w.id&&j){const D=(j==null?void 0:j.role)==="admin"||(j==null?void 0:j.role)==="super_admin"||await Fe.hasDeletePermission(w.id,"abonnements"),H=(j==null?void 0:j.role)==="admin"||(j==null?void 0:j.role)==="super_admin";v(D),x(H)}}catch(D){console.error("Erreur chargement permissions:",D)}},A=()=>{let D=[...e];c!=="all"&&(D=D.filter(H=>H.statut===c)),o&&(D=D.filter(H=>{var Q,U,G,B,me;return((U=(Q=H.installation)==null?void 0:Q.application_installee)==null?void 0:U.toLowerCase().includes(o.toLowerCase()))||((me=(B=(G=H.installation)==null?void 0:G.client)==null?void 0:B.raison_sociale)==null?void 0:me.toLowerCase().includes(o.toLowerCase()))})),n(D)},P=async D=>{const H=typeof D=="object"?D.id:D,Q=typeof D=="object"?D:e.find(U=>U.id===H);if(window.confirm("tes-vous sr de vouloir renouveler cet abonnement ?"))try{if(await Kt.delete(H),!Q)throw new Error("Abonnement non trouv");const U=new Date(Q.date_fin),G=new Date(U);G.setFullYear(G.getFullYear()+1),await Kt.create({installation_id:Q.installation_id,date_debut:U.toISOString(),date_fin:G.toISOString(),statut:"actif"}),S({type:"success",message:"Abonnement renouvel avec succs"}),_()}catch(U){S({type:"error",message:U.message||"Erreur lors du renouvellement"})}},T=D=>{m&&(p(D),f(!0))},M=async D=>{var H,Q;if(!b){g(!0);try{const U={montant:D.montant,type:D.type,mode_paiement:D.mode_paiement,date_paiement:D.date_paiement,client_id:((Q=(H=h.installation)==null?void 0:H.client)==null?void 0:Q.id)||h.installation.client_id,installation_id:h.installation_id,created_by:(w==null?void 0:w.id)||null};if(await ar.create(U),h.statut==="expire"){const{data:G}=await V.from("paiements").select("montant").eq("installation_id",h.installation_id),B=(G||[]).reduce((ue,Ne)=>ue+(Ne.montant||0),0),me=h.installation;if(B>=((me==null?void 0:me.montant)||0)){await Kt.delete(h.id);const ue=new Date(h.date_fin),Ne=new Date(ue);Ne.setFullYear(Ne.getFullYear()+1),await Kt.create({installation_id:h.installation_id,date_debut:ue.toISOString(),date_fin:Ne.toISOString(),statut:"actif"}),S({type:"success",message:"Paiement enregistr et abonnement renouvel automatiquement"})}else S({type:"success",message:"Paiement enregistr avec succs"})}else S({type:"success",message:"Paiement enregistr avec succs"});f(!1),p(null),_()}catch(U){S({type:"error",message:U.message||"Erreur lors de l'enregistrement du paiement"})}finally{g(!1)}}},O={total:e.length,actifs:e.filter(D=>D.statut==="actif").length,enAlerte:e.filter(D=>D.statut==="en_alerte").length,expires:e.filter(D=>D.statut==="expire").length};return i?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total Abonnements"}),s.jsx("h3",{className:"text-3xl font-bold",children:O.total})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Actifs"}),s.jsx("h3",{className:"text-3xl font-bold",children:O.actifs}),s.jsxs("p",{className:"text-sm opacity-90 mt-1",children:["Taux ",O.total>0?(O.actifs/O.total*100).toFixed(0):0,"%"]})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"En Alerte"}),s.jsx("h3",{className:"text-3xl font-bold",children:O.enAlerte}),s.jsx("p",{className:"text-sm opacity-90 mt-1",children:" renouveler"})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-red-500 to-red-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Expirs"}),s.jsx("h3",{className:"text-3xl font-bold",children:O.expires}),s.jsx("p",{className:"text-sm opacity-90 mt-1",children:"Action requise"})]})]}),s.jsx("div",{className:"card",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(gc,{value:o,onChange:l,placeholder:"Rechercher un abonnement..."})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="all"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tous"}),s.jsx("button",{onClick:()=>u("actif"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="actif"?"bg-success text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Actifs"}),s.jsx("button",{onClick:()=>u("en_alerte"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="en_alerte"?"bg-warning text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"En Alerte"}),s.jsx("button",{onClick:()=>u("expire"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="expire"?"bg-danger text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Expirs"})]})]})}),r.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucun abonnement trouv"})}):s.jsx(yc,{data:r,columns:[{key:"installation",label:"Installation",width:"200px",render:D=>{var H,Q,U;return s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:((H=D.installation)==null?void 0:H.application_installee)||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:((U=(Q=D.installation)==null?void 0:Q.client)==null?void 0:U.raison_sociale)||"N/A"})]})}},{key:"date_debut",label:"Date Dbut",width:"120px",render:D=>s.jsx("span",{children:D.date_debut?new Date(D.date_debut).toLocaleDateString("fr-FR"):"N/A"})},{key:"date_fin",label:"Date Fin",width:"120px",render:D=>s.jsx("span",{children:D.date_fin?new Date(D.date_fin).toLocaleDateString("fr-FR"):"N/A"})},{key:"montant",label:"Montant",width:"120px",render:D=>s.jsx("span",{className:"font-semibold",children:(j==null?void 0:j.role)==="admin"||(j==null?void 0:j.role)==="super_admin"?s.jsx("span",{className:"text-blue-600",children:Nt(D.montantInstallation||0)}):s.jsx("span",{className:"text-gray-400",children:""})})},{key:"statut_paiement",label:"Statut de Paiement",width:"140px",render:D=>{const H=D.montantInstallation||0,Q=D.totalPaye||0,U=Math.max(0,H-Q);let G,B,me;return U===H||H===0?(G="Aucun paiement",B="bg-red-100 text-red-700",me=0):U>0?(G="Partiellement pay",B="bg-orange-100 text-orange-700",me=1):(G="Totalement pay",B="bg-green-100 text-green-700",me=2),s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium whitespace-nowrap ${B}`,children:(j==null?void 0:j.role)==="admin"||(j==null?void 0:j.role)==="super_admin"?s.jsx(s.Fragment,{children:me}):s.jsxs(s.Fragment,{children:[me," (",G,")"]})})}},{key:"statut",label:"Statut",width:"100px",render:D=>{const H=new Date,Q=new Date(D.date_fin),U=Q<H,G=Math.ceil((Q-H)/(1e3*60*60*24));return s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${U?"bg-red-100 text-red-800":G<=30?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:U?"Expir":G<=30?" renouveler":"Actif"})}}],actions:[{key:"payment",label:"Paiement",icon:"",onClick:T,disabled:!m,title:m?"Ajouter un paiement":"Permission refuse: Ajouter un paiement",className:m?"bg-green-600 hover:bg-green-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"},{key:"renew",label:"Renouveler",icon:"",onClick:P,className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1",condition:D=>{const H=new Date,Q=new Date(D.date_fin),U=Q<H,G=Math.ceil((Q-H)/(1e3*60*60*24));return U||G<=30}}],loading:i,emptyMessage:"Aucun abonnement trouv"}),s.jsx(Wt,{isOpen:d,onClose:()=>{f(!1),p(null)},title:h?`Enregistrer paiement - ${(k=h.installation)==null?void 0:k.application_installee}`:"Enregistrer paiement",size:"lg",children:h&&s.jsx(nO,{isAbonnement:!0,isSubmitting:b,paiement:{client_id:((I=(F=h.installation)==null?void 0:F.client)==null?void 0:I.id)||((W=h.installation)==null?void 0:W.client_id)||"",installation_id:h.installation_id,type:"abonnement",mode_paiement:"especes",montant:"",date_paiement:new Date().toISOString().split("T")[0],abonnement_montant:((R=h.installation)==null?void 0:R.montant)||0},onSubmit:M,onCancel:()=>f(!1)})})]})},Ote=({refreshTrigger:e,onRefreshTrigger:t})=>{const[r,n]=N.useState([]),[i,a]=N.useState([]),[o,l]=N.useState([]),[c,u]=N.useState(!0),[d,f]=N.useState(""),[h,p]=N.useState("all"),[y,v]=N.useState(""),[m,x]=N.useState(""),[b,g]=N.useState(""),[S,w]=N.useState([]),[j,_]=N.useState(!1),[E,A]=N.useState(null),[P,T]=N.useState("create"),[M,O]=N.useState(!1),[k,F]=N.useState(!1),[I,W]=N.useState(!1),[R,D]=N.useState(!1),[H,Q]=N.useState({fullyPaid:0,partiallyPaid:0,noPaid:0}),{addNotification:U}=cr(),{user:G,profile:B}=dt();N.useEffect(()=>{me()},[e]),N.useEffect(()=>{(async()=>{if(G!=null&&G.id&&B)try{const ae=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"||await Fe.hasCreatePermission(G.id,"paiements"),oe=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"||await Fe.hasEditPermission(G.id,"paiements"),le=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"||await Fe.hasDeletePermission(G.id,"paiements");O(ae),F(oe),W(le)}catch(ae){console.error("Erreur vrification permissions:",ae)}})()},[G==null?void 0:G.id,B]),N.useEffect(()=>{ue()},[r,d,h,y,m,b]),N.useEffect(()=>{const L={fullyPaid:0,partiallyPaid:0,noPaid:0};o&&o.length>0&&o.forEach(ae=>{const oe=r.filter(he=>he.installation_id===ae.id).reduce((he,Se)=>he+(typeof Se.montant=="number"?Se.montant:0),0),le=Math.max(0,(ae.montant||0)-oe);le===ae.montant||ae.montant===0?L.noPaid++:le>0?L.partiallyPaid++:L.fullyPaid++}),Q(L),console.log(" Stats mises  jour:",L)},[o,r]);const me=async()=>{try{u(!0);const[L,ae,oe]=await Promise.all([ar.getAll(),Tr.getAll(),Fe.getAll()]);console.log(` Paiements chargs (${L.length}):`,L.slice(0,3)),console.log(` Utilisateurs chargs (${oe.length}):`,oe.map(he=>({id:he.id,email:he.email})));const le=L.filter(he=>he.created_by);console.log(` Paiements avec created_by: ${le.length}/${L.length}`),le.length>0&&console.log("   Exemples:",le.slice(0,2).map(he=>({id:he.id,created_by:he.created_by}))),n(L),l(ae),w(oe)}catch(L){console.error("Erreur chargement:",L),U({type:"error",message:"Erreur lors du chargement des donnes"})}finally{u(!1)}},ue=()=>{let L=[...r];h!=="all"&&(L=L.filter(ae=>ae.type===h)),d&&(L=L.filter(ae=>{var oe,le,he;return((le=(oe=ae.client)==null?void 0:oe.raison_sociale)==null?void 0:le.toLowerCase().includes(d.toLowerCase()))||((he=ae.mode_paiement)==null?void 0:he.toLowerCase().includes(d.toLowerCase()))})),y&&(L=L.filter(ae=>new Date(ae.date_paiement)>=new Date(y))),m&&(L=L.filter(ae=>new Date(ae.date_paiement)<=new Date(m+"T23:59:59"))),b&&(L=L.filter(ae=>ae.created_by===b)),a(L)},Ne=L=>{k&&(A(L),T("edit"),_(!0))},ve=async L=>{var le;const ae=(L==null?void 0:L.id)||L;if(!(!I||!window.confirm(` ATTENTION 

Voulez-vous vraiment supprimer ce paiement ?

Cette action est IRRVERSIBLE et affectera:
- L'historique financier
- Les statistiques de revenus
- Le reste  payer de l'installation

tes-vous sr de vouloir continuer ?`)))try{await ar.delete(ae),U({type:"success",message:"Paiement supprim avec succs"}),me(),t&&t()}catch(he){console.error("Erreur suppression paiement:",he),he.status===409||(le=he.message)!=null&&le.includes("foreign key")?U({type:"error",message:"Impossible de supprimer ce paiement car il est li  d'autres enregistrements"}):U({type:"error",message:he.message||"Erreur lors de la suppression du paiement"})}},Y=async L=>{if(!R){D(!0);try{if(P==="edit")await ar.update(E.id,L),U({type:"success",message:"Paiement modifi avec succs"});else{const ae={client_id:L.client_id,installation_id:L.installation_id,type:L.type,montant:L.montant,mode_paiement:L.mode_paiement,date_paiement:L.date_paiement,created_by:(G==null?void 0:G.id)||null};if(await ar.create(ae),L.installation_id){const{data:oe}=await V.from("abonnements").select("*").eq("installation_id",L.installation_id).eq("statut","expire");if(oe&&oe.length>0){const le=oe[0],{data:he}=await V.from("paiements").select("montant").eq("installation_id",L.installation_id),Se=(he||[]).reduce((ze,Le)=>ze+(Le.montant||0),0),{data:$e}=await V.from("installations").select("montant").eq("id",L.installation_id).single();if(Se>=(($e==null?void 0:$e.montant)||0)){await Kt.delete(le.id);const ze=new Date(le.date_fin),Le=new Date(ze);Le.setFullYear(Le.getFullYear()+1),await Kt.create({installation_id:L.installation_id,date_debut:ze.toISOString(),date_fin:Le.toISOString(),statut:"actif"}),U({type:"success",message:"Paiement enregistr et abonnement renouvel automatiquement"})}else U({type:"success",message:"Paiement enregistr avec succs"})}else U({type:"success",message:"Paiement enregistr avec succs"})}else U({type:"success",message:"Paiement enregistr avec succs"})}_(!1),me(),t&&t()}catch(ae){U({type:"error",message:ae.message||"Erreur lors de l'enregistrement"})}finally{D(!1)}}},Z=()=>{const L=r.reduce((le,he)=>le+(he.resteAPayer||0),0),ae=new Set(r.map(le=>le.installation_id).filter(le=>le)),oe=o.filter(le=>!ae.has(le.id)).reduce((le,he)=>le+(he.montant||0),0);return L+oe},te={total:i.length,revenuTotal:i.reduce((L,ae)=>L+(ae.montant||0),0),acquisitions:i.filter(L=>{var ae;return((ae=L.installation)==null?void 0:ae.type)==="acquisition"}).length,abonnements:i.filter(L=>{var ae;return((ae=L.installation)==null?void 0:ae.type)==="abonnement"}).length,resteTotal:Z()};return c?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total des Paiements"}),s.jsx("h3",{className:"text-3xl font-bold",children:(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"?Nt(te.revenuTotal):""})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-red-500 to-red-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Reste  Payer"}),s.jsx("h3",{className:"text-3xl font-bold",children:(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"?Nt(te.resteTotal):""})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Nombre de Paiements"}),s.jsx("h3",{className:"text-3xl font-bold",children:te.total})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"card p-4",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" Type:"}),s.jsxs("select",{value:h,onChange:L=>p(L.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[s.jsx("option",{value:"all",children:"Tous les types"}),s.jsx("option",{value:"acquisition",children:"Acquisition"}),s.jsx("option",{value:"abonnement",children:"Abonnement"})]})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" Du:"}),s.jsx("input",{type:"date",value:y,onChange:L=>v(L.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" Au:"}),s.jsx("input",{type:"date",value:m,onChange:L=>x(L.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" Crateur:"}),s.jsxs("select",{value:b||"",onChange:L=>g(L.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[s.jsx("option",{value:"",children:"Tous les crateurs"}),Array.from(new Map(r.map(L=>[L.created_by,L])).entries()).filter(([L])=>L).map(([L,ae])=>{var Se;const oe=r.filter($e=>$e.created_by===L),le=S.find($e=>$e.id===L),he=((Se=le==null?void 0:le.email)==null?void 0:Se.split("@")[0])||(le==null?void 0:le.email)||(L==null?void 0:L.substring(0,8))||"Inconnu";return s.jsxs("option",{value:L,children:[he," (",oe.length,")"]},L)})]})]})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" Rechercher:"}),s.jsx("input",{type:"text",placeholder:"Client ou mode de paiement...",value:d,onChange:L=>f(L.target.value),className:"w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),s.jsx("div",{className:"card overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Installation"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montant Vers"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mode"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),s.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length===0?s.jsx("tr",{children:s.jsx("td",{colSpan:"7",className:"px-6 py-8 text-center text-gray-500",children:"Aucun paiement trouv"})}):i.map(L=>{var ae,oe,le,he,Se;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[s.jsx("div",{className:"font-medium text-gray-800",children:(ae=L.client)==null?void 0:ae.raison_sociale}),s.jsx("div",{className:"text-sm text-gray-600",children:(oe=L.client)==null?void 0:oe.contact})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:(le=L.installation)==null?void 0:le.application_installee}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`badge-${((he=L.installation)==null?void 0:he.type)==="acquisition"?"info":"success"}`,children:((Se=L.installation)==null?void 0:Se.type)==="acquisition"?"Acquisition":"Abonnement"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold",children:(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"?s.jsx("span",{className:"text-blue-600",children:Nt(L.montant||0)}):s.jsx("span",{className:"text-gray-400",children:""})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 capitalize",children:L.mode_paiement}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:St(L.date_paiement)}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx("button",{onClick:()=>Ne(L),disabled:!k&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"),className:`p-2 rounded-lg transition-colors ${!k&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")?"text-gray-400 cursor-not-allowed":"text-blue-600 hover:bg-blue-50"}`,title:!k&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")?"Permission refuse":"Modifier",children:!k&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")?s.jsx(xi,{size:18}):s.jsx(br,{size:18})}),s.jsx("button",{onClick:()=>ve(L.id),disabled:!I&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"),className:`p-2 rounded-lg transition-colors ${!I&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")?"text-gray-400 cursor-not-allowed":"text-red-600 hover:bg-red-50"}`,title:!I&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")?"Permission refuse":"Supprimer",children:!I&&!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")?s.jsx(xi,{size:18}):s.jsx(rr,{size:18})})]})})]},L.id)})})]})}),s.jsx(Wt,{isOpen:j,onClose:()=>_(!1),title:"Modifier Paiement",children:s.jsx(nO,{paiement:E,onSubmit:Y,onCancel:()=>_(!1),isSubmitting:R})})]})},Cte=({intervention:e,onSubmit:t,onCancel:r})=>{const{user:n,profile:i}=dt(),[a,o]=N.useState({client_id:"",priorite:"normale",mode_intervention:"sur_site",type_intervention:"accompagnement",statut:"en_cours",date_intervention:new Date().toISOString().split("T")[0],resume_probleme:"",action_entreprise:"",commentaires:""}),[l,c]=N.useState({}),[u,d]=N.useState([]),[f,h]=N.useState(null),[p,y]=N.useState(""),[v,m]=N.useState(!1),x=["accompagnement","adaptation","assistance","blocage","correction","fonctionnalite","erreur","formation","integration","mise_a_jour","parametrage","impression","reseau","question","suivi"],b=_=>{if(!_)return"accompagnement";const E=_.toLowerCase().replace(/\s+/g,"_");return x.includes(E)?E:"accompagnement"},g=async _=>{if(!_){h(null);return}try{const A=(await Kt.getAll()).filter(F=>{var I;return((I=F.installation)==null?void 0:I.client_id)===_||F.client_id===_});if(A.length===0){h({noAbonnement:!0});return}const P=A[0],T=new Date(P.date_fin),M=new Date;M.setHours(0,0,0,0),T.setHours(0,0,0,0);const O=Math.floor((T-M)/(1e3*60*60*24));let k=P.statut||"actif";O<0?k="expire":O<=30?k="en_alerte":k="actif",h({...P,daysLeft:O,statut:k,isExpired:k==="expire",isExpiring:k==="en_alerte",application:P.application||"Non spcifie",type:P.type||"standard"})}catch(E){console.error("Erreur chargement abonnement:",E),h({error:!0,message:E.message})}};N.useEffect(()=>{var _;S(),e&&o({client_id:e.client_id||"",priorite:e.priorite||"normale",mode_intervention:e.mode_intervention||"sur_site",type_intervention:b(e.type_intervention),statut:e.statut||"en_cours",date_intervention:((_=e.date_intervention)==null?void 0:_.split("T")[0])||"",resume_probleme:e.resume_probleme||"",action_entreprise:e.action_entreprise||"",commentaires:e.commentaires||""})},[e]);const S=async()=>{try{const E=(await mt.getAll()).filter(A=>A.statut==="actif");d(E)}catch(_){console.error("Erreur chargement clients:",_)}},w=(_,E)=>{if(o(A=>({...A,[_]:E})),l[_]&&c(A=>({...A,[_]:""})),_==="client_id"){g(E);const A=u.find(P=>P.id===E);y((A==null?void 0:A.raison_sociale)||"")}},j=_=>{if(_.preventDefault(),v)return;const E={...a,technicien_id:n.id,type_intervention:b(a.type_intervention)},A=lh.validateIntervention(E);if(!A.isValid){c(A.errors);return}m(!0);try{t(E)}finally{m(!1)}};return s.jsxs("form",{onSubmit:j,className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("span",{className:"font-semibold",children:"Technicien:"})," ",(i==null?void 0:i.nom)||"Utilisateur"]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(oh,{label:"Client",value:a.client_id,onChange:_=>w("client_id",_.target.value),options:u.map(_=>({value:_.id,label:_.raison_sociale,description:`${_.ville||""} ${_.wilaya?`(${_.wilaya})`:""} - ${_.contact||""}`.trim().replace(/^ - /,"")})),placeholder:"Rechercher un client...",error:l.client_id,required:!0}),s.jsx(yt,{label:"Priorit",value:a.priorite,onChange:_=>w("priorite",_.target.value),options:[{value:"normale",label:"Normale"},{value:"haute",label:"Haute"}],required:!0})]}),f&&s.jsxs("div",{className:`rounded-lg p-4 flex items-start gap-3 ${f.noAbonnement?"bg-yellow-50 border border-yellow-200":f.error||f.isExpired?"bg-red-50 border border-red-200":f.isExpiring?"bg-orange-50 border border-orange-200":"bg-green-50 border border-green-200"}`,children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:f.noAbonnement?s.jsx(xt,{className:"w-5 h-5 text-yellow-600"}):f.error?s.jsx(xt,{className:"w-5 h-5 text-red-600"}):f.isExpired?s.jsx(xt,{className:"w-5 h-5 text-red-600"}):f.isExpiring?s.jsx(zs,{className:"w-5 h-5 text-orange-600"}):s.jsx(zt,{className:"w-5 h-5 text-green-600"})}),s.jsx("div",{className:"flex-1",children:f.noAbonnement?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-yellow-800",children:" Pas d'abonnement actif"}),s.jsxs("p",{className:"text-sm text-yellow-700",children:[p," - Aucun abonnement trouv"]})]}):f.error?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-red-800",children:" Erreur"}),s.jsx("p",{className:"text-sm text-red-700",children:"Impossible de charger les infos d'abonnement"})]}):f.isExpired?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-red-800",children:" ABONNEMENT EXPIR"}),s.jsxs("p",{className:"text-sm text-red-700",children:["Application: ",f.application]}),s.jsxs("p",{className:"text-sm text-red-700",children:["Expir depuis le ",new Date(f.date_fin).toLocaleDateString("fr-FR")]}),s.jsx("p",{className:"text-xs text-red-600 mt-1",children:" URGENT: Contacter le client pour renouvellement"})]}):f.isExpiring?s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-orange-800",children:" ABONNEMENT EXPIRE BIENTT"}),s.jsxs("p",{className:"text-sm text-orange-700",children:["Application: ",f.application]}),s.jsxs("p",{className:"text-sm text-orange-700",children:["Expire dans ",f.daysLeft," jour",f.daysLeft>1?"s":"","(",new Date(f.date_fin).toLocaleDateString("fr-FR"),")"]}),s.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"  renouveler rapidement"})]}):s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-800",children:" ABONNEMENT ACTIF"}),s.jsxs("p",{className:"text-sm text-green-700",children:["Application: ",f.application]}),s.jsxs("p",{className:"text-sm text-green-700",children:["Valide jusqu'au ",new Date(f.date_fin).toLocaleDateString("fr-FR"),"(",f.daysLeft," jours restants)"]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx(yt,{label:"Mode d'Intervention",value:a.mode_intervention,onChange:_=>w("mode_intervention",_.target.value),options:[{value:"sur_site",label:"Sur Site"},{value:"a_distance",label:" Distance"}],error:l.mode_intervention,required:!0}),s.jsx(yt,{label:"Type d'Intervention",value:a.type_intervention,onChange:_=>w("type_intervention",_.target.value),options:[{value:"accompagnement",label:"Accompagnement utilisateur (prise en main)"},{value:"adaptation",label:"Adaptation d'un tat / rapport / modle d'impression"},{value:"assistance",label:"Assistance sur une opration exceptionnelle"},{value:"blocage",label:"Blocage d'accs / authentification"},{value:"correction",label:"Correction de bug / anomalie"},{value:"fonctionnalite",label:"Demande de nouvelle fonctionnalit"},{value:"erreur",label:"Erreur systme (plantage, message d'erreur critique)"},{value:"formation",label:"Formation"},{value:"integration",label:"Intgration avec un autre outil ou API"},{value:"mise_a_jour",label:"Mise  jour"},{value:"parametrage",label:"Paramtrage"},{value:"impression",label:"Problme d'impression ou de gnration de documents"},{value:"reseau",label:"Problme rseau ou de connection (accs distant, VPN)"},{value:"question",label:"Rponse  une question mtier"},{value:"suivi",label:"Suivi aprs une mise  jour majeure"}],error:l.type_intervention,required:!0}),s.jsx(Ie,{label:"Date d'Intervention",type:"date",value:a.date_intervention,onChange:_=>w("date_intervention",_.target.value),error:l.date_intervention,required:!0})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Rsum du Problme ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{value:a.resume_probleme,onChange:_=>w("resume_probleme",_.target.value),rows:"4",className:"input-field",placeholder:"Dcrivez le problme rencontr..."}),l.resume_probleme&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:l.resume_probleme})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Action Entreprise"}),s.jsx("textarea",{value:a.action_entreprise,onChange:_=>w("action_entreprise",_.target.value),rows:"3",className:"input-field",placeholder:"Action entreprise pour rsoudre le problme..."})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaires"}),s.jsx("textarea",{value:a.commentaires,onChange:_=>w("commentaires",_.target.value),rows:"3",className:"input-field",placeholder:"Commentaires additionnels..."})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,disabled:v,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",disabled:v,children:v?" Enregistrement...":e?"Modifier":"Crer"})]})]})},Tte=({intervention:e,onClose:t,onEdit:r,onDelete:n,onCloturer:i,hasClosePermission:a=!0})=>{var l,c,u,d,f;if(!e)return null;const o=()=>e.priorite==="haute"?"bg-red-100 text-red-800 border-red-200":"bg-blue-100 text-blue-800 border-blue-200";return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-start justify-between pb-4 border-b border-gray-200",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${e.statut==="cloturee"?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:_u(e.statut)}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${o()}`,children:e.priorite==="haute"?" Haute Priorit":" Normale"})]}),s.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:_u(e.type_intervention)})]}),s.jsxs("div",{className:"flex gap-2",children:[e.statut==="en_cours"&&s.jsxs("button",{onClick:()=>i(e),disabled:!a,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${a?"bg-green-600 text-white hover:bg-green-700":"bg-gray-400 text-white cursor-not-allowed"}`,title:a?"Clturer cette intervention":"Permission refuse: Clturer",children:[s.jsx(zt,{size:18}),"Clturer"]}),s.jsxs("button",{onClick:()=>r(e),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",title:"Modifier",children:[s.jsx(br,{size:18}),"Modifier"]}),s.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center gap-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",title:"Supprimer",children:[s.jsx(rr,{size:18}),"Supprimer"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(d0,{className:"text-blue-600",size:20}),s.jsx("h4",{className:"font-semibold text-blue-900",children:"Client"})]}),s.jsx("p",{className:"text-lg font-bold text-blue-800",children:(l=e.client)==null?void 0:l.raison_sociale}),s.jsx("p",{className:"text-sm text-blue-600",children:(c=e.client)==null?void 0:c.contact}),s.jsx("p",{className:"text-sm text-blue-600",children:(u=e.client)==null?void 0:u.telephone})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(yM,{className:"text-purple-600",size:20}),s.jsx("h4",{className:"font-semibold text-purple-900",children:"Technicien"})]}),s.jsx("p",{className:"text-lg font-bold text-purple-800",children:(d=e.technicien)==null?void 0:d.nom}),s.jsx("p",{className:"text-sm text-purple-600",children:(f=e.technicien)==null?void 0:f.email})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(xr,{className:"text-green-600",size:20}),s.jsx("h4",{className:"font-semibold text-green-900",children:"Date & Heure"})]}),s.jsx("p",{className:"text-lg font-bold text-green-800",children:St(e.date_intervention)}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(zs,{size:16,className:"text-green-600"}),s.jsxs("p",{className:"text-sm text-green-600",children:[e.duree_minutes||"-"," minutes"]})]})]}),s.jsxs("div",{className:"bg-orange-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(Cn,{className:"text-orange-600",size:20}),s.jsx("h4",{className:"font-semibold text-orange-900",children:"Mode"})]}),s.jsx("p",{className:"text-lg font-bold text-orange-800",children:_u(e.mode_intervention)})]})]}),s.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(xt,{className:"text-red-600",size:20}),s.jsx("h4",{className:"font-semibold text-red-900",children:"Problme Rencontr"})]}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.resume_probleme})]}),e.action_entreprise&&s.jsxs("div",{className:"bg-green-50 border-l-4 border-green-500 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx(zt,{className:"text-green-600",size:20}),s.jsx("h4",{className:"font-semibold text-green-900",children:"Action Entreprise"})]}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.action_entreprise})]}),e.commentaires&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Commentaires"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.commentaires})]}),e.date_fin&&s.jsx("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:s.jsxs("p",{className:"text-sm text-blue-600",children:["Intervention clture le ",s.jsx("span",{className:"font-semibold",children:DE(e.date_fin)})]})})]})},kte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(null),[i,a]=N.useState(!0);N.useEffect(()=>{o()},[]);const o=async()=>{try{const c=await ii.getAll();t(c),l(c)}catch(c){console.error("Erreur chargement interventions:",c)}finally{a(!1)}},l=c=>{if(c.length===0){n(null);return}const u=c.length,d=c.filter(P=>P.statut==="cloturee"),f=c.filter(P=>P.statut==="en_cours"),h=c.filter(P=>P.priorite==="haute"),p=Math.round(c.reduce((P,T)=>P+(T.duree_minutes||0),0)/u||0),y=Math.round(d.length/u*100||0),v={};c.forEach(P=>{v[P.type_intervention]=(v[P.type_intervention]||0)+1});const m=Object.entries(v).sort((P,T)=>T[1]-P[1])[0],x={};c.forEach(P=>{var M;(((M=P.resume_probleme)==null?void 0:M.toLowerCase().split(" "))||[]).forEach(O=>{O.length>4&&(x[O]=(x[O]||0)+1)})});const b=Object.entries(x).sort((P,T)=>T[1]-P[1]).slice(0,5).map(([P,T])=>({mot:P,count:T})),g={};c.forEach(P=>{var T;(T=P.technicien)!=null&&T.nom&&(g[P.technicien.nom]||(g[P.technicien.nom]={total:0,cloturees:0,duree:0}),g[P.technicien.nom].total++,P.statut==="cloturee"&&g[P.technicien.nom].cloturees++,g[P.technicien.nom].duree+=P.duree_minutes||0)});const S=Object.entries(g).map(([P,T])=>({nom:P,total:T.total,tauxResolution:Math.round(T.cloturees/T.total*100),dureeMoyenne:Math.round(T.duree/T.total)})).sort((P,T)=>T.tauxResolution-P.tauxResolution),w=new Date,j=new Date(w.getTime()-7*24*60*60*1e3),E=c.filter(P=>new Date(P.date_intervention)>=j).length>u/4?"hausse":"baisse",A=[];f.length>d.length&&A.push({type:"warning",message:`${f.length} interventions en cours. Prioriser la clture des interventions en attente.`}),h.length>u*.3&&A.push({type:"danger",message:`${h.length} interventions haute priorit. Augmenter les ressources techniques.`}),p>120&&A.push({type:"info",message:`Dure moyenne leve (${p} min). Envisager une formation technique supplmentaire.`}),y>80&&A.push({type:"success",message:`Excellent taux de rsolution (${y}%). Continuez sur cette lance !`}),b.length>0&&A.push({type:"info",message:`Problme rcurrent dtect: "${b[0].mot}". Crer une documentation prventive.`}),n({totalInterventions:u,cloturees:d.length,enCours:f.length,hautesPriorites:h.length,dureeMoyenne:p,tauxResolution:y,typePlusFrequent:m,problemesRecurrents:b,performanceTechniciens:S,tendance:E,recommandations:A})};return i?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):r?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center",children:s.jsx(Mm,{size:32})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-1",children:"Analyse IA des Interventions"}),s.jsx("p",{className:"text-purple-100",children:"Intelligence artificielle  Insights automatiques"})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-l-4 border-blue-500",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(zs,{className:"text-blue-600",size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Dure Moyenne"}),s.jsxs("h3",{className:"text-2xl font-bold text-blue-800",children:[r.dureeMoyenne," min"]})]})]})}),s.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-l-4 border-green-500",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(zt,{className:"text-green-600",size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Taux de Rsolution"}),s.jsxs("h3",{className:"text-2xl font-bold text-green-800",children:[r.tauxResolution,"%"]})]})]})}),s.jsx("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-l-4 border-orange-500",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(fs,{className:"text-orange-600",size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Haute Priorit"}),s.jsx("h3",{className:"text-2xl font-bold text-orange-800",children:r.hautesPriorites})]})]})}),s.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-l-4 border-purple-500",children:s.jsxs("div",{className:"flex items-center gap-3",children:[r.tendance==="hausse"?s.jsx(cn,{className:"text-purple-600",size:32}):s.jsx(gM,{className:"text-purple-600",size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Tendance"}),s.jsx("h3",{className:"text-2xl font-bold text-purple-800 capitalize",children:r.tendance})]})]})})]}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(bl,{className:"text-yellow-500",size:24}),s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Recommandations IA"})]}),s.jsx("div",{className:"space-y-3",children:r.recommandations.map((c,u)=>s.jsx("div",{className:`p-4 rounded-lg border-l-4 ${c.type==="success"?"bg-green-50 border-green-500":c.type==="warning"?"bg-orange-50 border-orange-500":c.type==="danger"?"bg-red-50 border-red-500":"bg-blue-50 border-blue-500"}`,children:s.jsx("p",{className:`text-sm font-medium ${c.type==="success"?"text-green-800":c.type==="warning"?"text-orange-800":c.type==="danger"?"text-red-800":"text-blue-800"}`,children:c.message})},u))})]}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(tM,{className:"text-primary",size:24}),s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Performance des Techniciens"})]}),s.jsx("div",{className:"space-y-3",children:r.performanceTechniciens.map((c,u)=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${u===0?"bg-yellow-100":u===1?"bg-gray-200":u===2?"bg-orange-100":"bg-blue-100"}`,children:s.jsx(xl,{className:u===0?"text-yellow-600":u===1?"text-gray-600":u===2?"text-orange-600":"text-blue-600",size:20})}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-gray-800",children:c.nom}),s.jsxs("p",{className:"text-xs text-gray-500",children:[c.total," interventions"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[c.tauxResolution,"%"]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[c.dureeMoyenne," min/inter"]})]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${c.tauxResolution}%`}})})]},u))})]}),r.problemesRecurrents.length>0&&s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(fs,{className:"text-orange-500",size:24}),s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Problmes Rcurrents Dtects"})]}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:r.problemesRecurrents.map((c,u)=>s.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 text-center border border-orange-200",children:[s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:c.count}),s.jsx("p",{className:"text-sm text-orange-800 capitalize truncate",children:c.mot})]},u))})]}),r.typePlusFrequent&&s.jsx("div",{className:"card bg-gradient-to-br from-indigo-50 to-indigo-100 border border-indigo-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-indigo-600 font-medium mb-1",children:"Type d'intervention le plus frquent"}),s.jsx("h3",{className:"text-2xl font-bold text-indigo-800 capitalize",children:r.typePlusFrequent[0]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-4xl font-bold text-indigo-600",children:r.typePlusFrequent[1]}),s.jsx("p",{className:"text-sm text-indigo-500",children:"occurrences"})]})]})})]}):s.jsxs("div",{className:"card text-center py-12",children:[s.jsx(Mm,{className:"mx-auto text-gray-300 mb-4",size:64}),s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune donne disponible pour l'analyse"})]})},$te=()=>{const[t,r]=N.useState([]),[n,i]=N.useState([]),[a,o]=N.useState(!0),[l,c]=N.useState(""),[u,d]=N.useState("all"),[f,h]=N.useState("all"),[p,y]=N.useState([]),[v,m]=N.useState([]),[x,b]=N.useState(""),[g,S]=N.useState(""),[w,j]=N.useState(""),[_,E]=N.useState("journal"),[A,P]=N.useState(1),[T,M]=N.useState(!1),[O,k]=N.useState(!1),[F,I]=N.useState(!1),[W,R]=N.useState(null),[D,H]=N.useState("create"),[Q,U]=N.useState(!1),[G,B]=N.useState(!1),[me,ue]=N.useState(!1),[Ne,ve]=N.useState(!1),{addNotification:Y}=cr(),{user:Z,profile:te}=dt();N.useEffect(()=>{L()},[]),N.useEffect(()=>{L()},[]),N.useEffect(()=>{ae(),P(1)},[t,u,f,l,x,g,w,p,te]),N.useEffect(()=>{const q=[...new Set(t.map($=>{var X;return(X=$.client)==null?void 0:X.wilaya}).filter($=>$&&$.trim()!=="").map($=>$.trim()))].sort();m(q)},[t]),N.useEffect(()=>{(async()=>{if(Z!=null&&Z.id&&te)try{const $=(te==null?void 0:te.role)==="admin"||(te==null?void 0:te.role)==="super_admin"||await Fe.hasCreatePermission(Z.id,"support"),X=(te==null?void 0:te.role)==="admin"||(te==null?void 0:te.role)==="super_admin"||await Fe.hasEditPermission(Z.id,"support"),xe=(te==null?void 0:te.role)==="admin"||(te==null?void 0:te.role)==="super_admin"||await Fe.hasDeletePermission(Z.id,"support"),ee=(te==null?void 0:te.role)==="admin"||(te==null?void 0:te.role)==="super_admin"||await Fe.hasClosePermission(Z.id,"support");U($),B(X),ue(xe),ve(ee)}catch($){console.error("Erreur vrification permissions:",$)}})()},[Z==null?void 0:Z.id,te]);const L=async()=>{try{o(!0);const q=await ii.getAll();r(q)}catch{Y({type:"error",message:"Erreur lors du chargement des interventions"})}finally{o(!1)}},ae=()=>{let q=[...t];if(u!=="all"&&(q=q.filter($=>$.statut===u)),f!=="all"&&(q=q.filter($=>$.type===f)),p.length>0&&(q=q.filter($=>{var X;return p.includes((X=$.client)==null?void 0:X.wilaya)})),l&&(q=q.filter($=>{var X,xe,ee,C,K;return((xe=(X=$.client)==null?void 0:X.raison_sociale)==null?void 0:xe.toLowerCase().includes(l.toLowerCase()))||((C=(ee=$.technicien)==null?void 0:ee.nom)==null?void 0:C.toLowerCase().includes(l.toLowerCase()))||((K=$.resume_probleme)==null?void 0:K.toLowerCase().includes(l.toLowerCase()))})),x){const $=new Date(x);q=q.filter(X=>new Date(X.date_intervention)>=$)}if(g){const $=new Date(g);$.setHours(23,59,59,999),q=q.filter(X=>new Date(X.date_intervention)<=$)}w&&((te==null?void 0:te.role)==="admin"||(te==null?void 0:te.role)==="super_admin")&&(q=q.filter($=>$.created_by===w)),i(q)},oe=()=>{Q&&(R(null),H("create"),M(!0))},le=q=>{G&&(R(q),H("edit"),M(!0))},he=q=>{Ne&&(R(q),I(!0))},Se=async q=>{var X;const $=(q==null?void 0:q.id)||q;if(me&&window.confirm("tes-vous sr de vouloir supprimer cette intervention ?"))try{await ii.delete($),Y({type:"success",message:"Intervention supprime avec succs"}),L()}catch(xe){console.error("Erreur suppression intervention:",xe),xe.status===409||(X=xe.message)!=null&&X.includes("foreign key")?Y({type:"error",message:"Impossible de supprimer cette intervention car elle est lie  d'autres enregistrements"}):Y({type:"error",message:"Erreur lors de la suppression de l'intervention"})}},$e=async q=>{try{if(D==="create"){const $={...q,created_by:(Z==null?void 0:Z.id)||null};await ii.create($),Y({type:"success",message:"Intervention cre avec succs"})}else await ii.update(W.id,q),Y({type:"success",message:"Intervention modifie avec succs"});M(!1),L()}catch{Y({type:"error",message:"Erreur lors de l'enregistrement"})}},ze=async q=>{q.preventDefault();const $=new FormData(q.target);try{const X=await ii.cloturer(W.id,$.get("action_entreprise"),$.get("commentaires"));Y({type:"success",message:"Intervention clture avec succs"}),I(!1),k(!1),R(null),L()}catch{Y({type:"error",message:"Erreur lors de la clture"})}},Le={total:t.length,enCours:t.filter(q=>q.statut==="en_cours").length,cloturees:t.filter(q=>q.statut==="cloturee").length,hautesPriorites:t.filter(q=>q.priorite==="haute").length};return a?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"card bg-blue-50 border-l-4 border-blue-500",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(vl,{size:20,className:"text-blue-600 mt-0.5 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-blue-900",children:"Consultation de toutes les interventions"}),s.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Vous pouvez consulter ",s.jsx("strong",{children:"toutes les interventions"})," indpendamment de leur crateur. Vos permissions pour Crer, Modifier ou Supprimer sont dfinies individuellement par les administrateurs."]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total Interventions"}),s.jsx("h3",{className:"text-3xl font-bold",children:Le.total})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"En Cours"}),s.jsx("h3",{className:"text-3xl font-bold",children:Le.enCours})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Cltures"}),s.jsx("h3",{className:"text-3xl font-bold",children:Le.cloturees})]}),s.jsx("div",{className:"card",children:s.jsx(je,{variant:"primary",icon:Un,onClick:oe,disabled:!Q,className:"w-full h-full",title:Q?"Crer une nouvelle intervention":"Permission refuse: Crer une intervention",children:"Nouvelle Intervention"})})]}),s.jsx("div",{className:"card",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>E("journal"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${_==="journal"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.jsx(xu,{size:18}),"Journal"]}),s.jsxs("button",{onClick:()=>E("analyse"),className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ${_==="analyse"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.jsx(Mm,{size:18}),"Analyse IA"]})]})}),_==="journal"&&s.jsxs(s.Fragment,{children:[s.jsx(vv,{onSearchChange:c,onDateStartChange:b,onDateEndChange:S,onCreatorChange:j,searchValue:l,dateStart:x,dateEnd:g,creatorId:w}),s.jsx("div",{className:"card",children:s.jsx(QP,{options:v.map(q=>({value:q,label:eO(q),count:t.filter($=>{var X;return((X=$.client)==null?void 0:X.wilaya)===q}).length})),selectedValues:p,onChange:y,placeholder:"Filtrer par Wilaya",label:"Filtrer par Wilaya",icon:Cn,displayFormat:(q,$)=>`Tous les Wilayas (${$})`})}),n.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune intervention trouve"})}):s.jsx(yc,{data:n.slice((A-1)*25,A*25),columns:[{key:"client",label:"Client",width:"180px",render:q=>{var $,X;return s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:(($=q.client)==null?void 0:$.raison_sociale)||"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:((X=q.technicien)==null?void 0:X.nom)||"N/A"})]})}},{key:"resume_probleme",label:"Problme",width:"180px",render:q=>s.jsx("span",{children:q.resume_probleme||"N/A"})},{key:"time_creation",label:"Dbut",width:"160px",render:q=>{const $=q.created_at||q.time_creation,X=$!=null&&$.endsWith("Z")?$:$?$+"Z":null;return s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:X?new Date(X).toLocaleDateString("fr-FR"):"N/A"}),s.jsx("p",{className:"text-xs text-gray-500",children:X?new Date(X).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"N/A"})]})}},{key:"date_fin",label:"Fin",width:"160px",render:q=>{var X;const $=(X=q.date_fin)!=null&&X.endsWith("Z")?q.date_fin:q.date_fin?q.date_fin+"Z":null;return s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:$?new Date($).toLocaleDateString("fr-FR"):"-"}),s.jsx("p",{className:"text-xs text-gray-500",children:$?new Date($).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"}):"-"})]})}},{key:"duree_minutes",label:"Dure",width:"80px",render:q=>s.jsxs("span",{className:"font-semibold text-blue-600",children:[q.duree_minutes||0," min"]})},{key:"priorite",label:"Priorit",width:"100px",render:q=>s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${q.priorite==="haute"?"bg-red-100 text-red-800":q.priorite==="normale"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:q.priorite==="haute"?"Haute":q.priorite==="normale"?"Normale":"Basse"})},{key:"statut",label:"Statut",width:"100px",render:q=>s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${q.statut==="en_cours"?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:q.statut==="en_cours"?"En cours":"Clture"})}],actions:[{key:"details",label:"Dtails",icon:s.jsx(vl,{size:18}),onClick:q=>{R(q),k(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1"},{key:"edit",label:"Modifier",icon:s.jsx(br,{size:18}),onClick:le,disabled:!G,title:G?"Modifier cette intervention":"Permission refuse: Modifier",className:G?"bg-amber-600 hover:bg-amber-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"},{key:"delete",label:"Supprimer",icon:s.jsx(rr,{size:18}),onClick:Se,disabled:!me,title:me?"Supprimer cette intervention":"Permission refuse: Supprimer",className:me?"bg-red-600 hover:bg-red-700 text-white px-3 py-1":"bg-gray-400 cursor-not-allowed text-white px-3 py-1"}],loading:a,emptyMessage:"Aucune intervention trouve"})]}),_==="journal"&&n.length>0&&s.jsxs("div",{className:"card flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Affichage ",Math.min((A-1)*25+1,n.length)," "," ",Math.min(A*25,n.length)," sur"," ",n.length," interventions"]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>P(q=>Math.max(1,q-1)),disabled:A===1,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300",children:" Prcdent"}),s.jsx("div",{className:"flex items-center gap-2",children:Array.from({length:Math.ceil(n.length/25)}).map((q,$)=>s.jsx("button",{onClick:()=>P($+1),className:`px-3 py-2 rounded-lg ${A===$+1?"bg-primary text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:$+1},$+1))}),s.jsx("button",{onClick:()=>P(q=>Math.min(Math.ceil(n.length/25),q+1)),disabled:A===Math.ceil(n.length/25),className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-300",children:"Suivant "})]})]}),_==="analyse"&&s.jsx(kte,{}),s.jsx(Wt,{isOpen:T,onClose:()=>M(!1),title:D==="create"?"Nouvelle Intervention":"Modifier Intervention",size:"lg",children:s.jsx(Cte,{intervention:W,onSubmit:$e,onCancel:()=>M(!1)})}),s.jsx(Wt,{isOpen:O,onClose:()=>k(!1),title:"Dtails Intervention",size:"lg",children:W&&s.jsx(Tte,{intervention:W,onClose:()=>k(!1),onEdit:le,onDelete:Se,onCloturer:he,hasClosePermission:Ne})}),s.jsx(Wt,{isOpen:F,onClose:()=>I(!1),title:"Clturer l'Intervention",children:s.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Action Entreprise ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("textarea",{name:"action_entreprise",rows:"4",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Dcrivez l'action entreprise...",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaires"}),s.jsx("textarea",{name:"commentaires",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Commentaires additionnels..."})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:()=>I(!1),children:"Annuler"}),s.jsx(je,{type:"submit",variant:"success",children:"Clturer"})]})]})})]})},Ite=({mission:e,initialData:t,onSave:r,onSubmit:n,onCancel:i,missionTypes:a=[],clients:o=[],users:l=[],isSubmitting:c=!1})=>{const[u,d]=N.useState({titre:"",description:"",clientId:"",lieu:"",wilaya:"",dateDebut:"",dateFin:"",budgetInitial:"",type:"",priorite:"moyenne",chefMissionId:"",accompagnateurIds:[],commentaireCreation:""}),[f,h]=N.useState([]),[p,y]=N.useState({}),v=["Installation","Formation","Support","Maintenance","Audit"],m=a&&a.length>0?a:v;N.useEffect(()=>{var A;e?(d({titre:e.titre||"",description:e.description||"",clientId:((A=e.client)==null?void 0:A.id)||e.prospect_id||e.clientId||"",lieu:e.lieu||"",wilaya:e.wilaya||e.lieu||"",dateDebut:e.dateDebut||e.date_debut||"",dateFin:e.dateFin||e.date_fin_prevue||"",budgetInitial:e.budgetInitial||e.budget_alloue||"",type:e.type||e.type_mission||"",priorite:e.priorite||"moyenne",chefMissionId:e.chefMissionId||e.chef_mission_id||"",accompagnateurIds:e.accompagnateurIds||e.accompagnateurs_ids||[],commentaireCreation:e.commentaireCreation||""}),h(e.accompagnateurIds||e.accompagnateurs_ids||[])):t&&d(P=>({...P,titre:t.titre||"",description:t.description||"",clientId:t.clientId||"",wilaya:t.wilaya||"",lieu:t.wilaya||"",dateDebut:t.dateDebut||"",dateFin:t.dateFin||"",type:t.type||"Installation",chefMissionId:t.chefMissionId||""}))},[e,t]),N.useEffect(()=>{if(u.clientId){const A=o.find(T=>T.id===u.clientId),P=(A==null?void 0:A.wilaya)||(A==null?void 0:A.lieu)||"";P&&d(T=>({...T,wilaya:P,lieu:P}))}},[u.clientId,o]);const x=()=>{const A={};return u.titre.trim()||(A.titre="Le titre est requis"),u.clientId||(A.clientId="Le client est requis"),u.chefMissionId||(A.chefMissionId="Le Chef de Mission est requis"),u.dateDebut||(A.dateDebut="La date de dbut est requise"),u.dateFin||(A.dateFin="La date de fin est requise"),new Date(u.dateDebut)>new Date(u.dateFin)&&(A.dateFin="La date de fin doit tre aprs la date de dbut"),(!u.budgetInitial||u.budgetInitial<=0)&&(A.budgetInitial="Le budget doit tre suprieur  0"),u.type||(A.type="Le type de mission est requis"),y(A),Object.keys(A).length===0},b=A=>{const{name:P,value:T}=A.target;d(M=>({...M,[P]:T})),p[P]&&y(M=>({...M,[P]:""}))},g=A=>{f.includes(A)||(h([...f,A]),d(P=>({...P,accompagnateurIds:[...P.accompagnateurIds,A]})))},S=A=>{const P=f.filter(T=>T!==A);h(P),d(T=>({...T,accompagnateurIds:P}))},w=A=>{if(A.preventDefault(),x()){const P=n||r;P&&P(u)}};o.map(A=>({value:A.id,label:A.raison_sociale||"Sans nom"}));const j=l.map(A=>({value:A.id,label:A.full_name||A.email})),_=l.filter(A=>A.id!==u.chefMissionId&&!f.includes(A.id)).map(A=>({value:A.id,label:A.full_name||A.email})),E=l.filter(A=>f.includes(A.id));return s.jsxs("form",{onSubmit:w,className:"space-y-5",children:[!e&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:[s.jsx("p",{className:"text-sm text-blue-800 font-medium",children:" Cration de mission rserve aux administrateurs"}),s.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Slectionnez le Chef de Mission qui sera responsable de cette mission"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Titre de la Mission *"}),s.jsx(Ie,{type:"text",name:"titre",value:u.titre,onChange:b,placeholder:"Exemple: Installation ERP ABC",error:p.titre})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{name:"description",value:u.description,onChange:b,placeholder:"Dcrivez la mission en dtail...",rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client *"}),s.jsx(oh,{name:"clientId",value:u.clientId,onChange:A=>b({target:{name:"clientId",value:A.target.value}}),options:o.map(A=>({value:A.id,label:A.raison_sociale||"Sans nom",description:`${A.ville||""} ${A.wilaya?`(${A.wilaya})`:""}`.trim()||A.lieu||""})),placeholder:"Rechercher un client...",error:p.clientId,required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de Mission *"}),s.jsx(yt,{name:"type",value:u.type,onChange:b,options:m.map(A=>({value:A,label:A})),error:p.type})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" Wilaya / Lieu"}),u.wilaya?s.jsxs("div",{className:"w-full px-3 py-2 border border-green-300 rounded-lg bg-green-50 flex items-center gap-2",children:[s.jsx(Cn,{className:"text-green-600",size:18}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900",children:gte(u.wilaya)||u.wilaya}),s.jsx("p",{className:"text-xs text-green-700",children:"Auto-rempli depuis la fiche client"})]})]}):s.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",children:"(Slectionner un client d'abord)"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priorit"}),s.jsx(yt,{name:"priorite",value:u.priorite,onChange:b,options:[{value:"faible",label:" Faible"},{value:"moyenne",label:" Moyenne"},{value:"haute",label:" Haute"},{value:"critique",label:" Critique"}]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de Dbut *"}),s.jsx(Ie,{type:"date",name:"dateDebut",value:u.dateDebut,onChange:b,error:p.dateDebut})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de Fin *"}),s.jsx(Ie,{type:"date",name:"dateFin",value:u.dateFin,onChange:b,error:p.dateFin})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget Initial () *"}),s.jsx(Ie,{type:"number",name:"budgetInitial",value:u.budgetInitial,onChange:b,placeholder:"0.00",min:"0",step:"0.01",error:p.budgetInitial})]}),s.jsxs("div",{className:`border-l-4 p-4 rounded ${e?"bg-gray-100 border-gray-400":"bg-blue-50 border-blue-500"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h3",{className:`font-semibold ${e?"text-gray-700":"text-blue-900"}`,children:" Chef de Mission *"}),e&&s.jsx("span",{className:"text-xs px-2 py-1 bg-gray-400 text-white rounded",children:" Fig  la cration"})]}),e?s.jsx("div",{className:"bg-white p-3 rounded border border-gray-300",children:u.chefMissionId?(()=>{const A=l.find(O=>O.id===u.chefMissionId),P=(A==null?void 0:A.full_name)||"Chef inconnu",T=A==null?void 0:A.email,M=((A==null?void 0:A.full_name)||T||"?").charAt(0).toUpperCase();return s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-200 flex items-center justify-center text-sm font-semibold text-blue-800",children:M}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:P}),T&&s.jsx("p",{className:"text-xs text-gray-500",children:T})]})]})})():s.jsx("p",{className:"text-gray-500 text-sm",children:" Aucun Chef de Mission assign"})}):s.jsx(yt,{name:"chefMissionId",value:u.chefMissionId,onChange:b,options:[{value:"",label:"Slectionner le Chef de Mission..."},...j],error:p.chefMissionId}),s.jsx("p",{className:`text-xs mt-2 ${e?"text-gray-600":"text-blue-700"}`,children:e?" Le Chef de Mission ne peut pas tre modifi aprs la cration":"Le Chef de Mission sera responsable de la clture de la mission"})]}),s.jsxs("div",{className:`border-l-4 p-4 rounded ${e?"bg-gray-100 border-gray-400":"bg-green-50 border-green-500"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h3",{className:`font-semibold ${e?"text-gray-700":"text-green-900"}`,children:" Accompagnateurs"}),e&&s.jsx("span",{className:"text-xs px-2 py-1 bg-gray-400 text-white rounded",children:" Fig  la cration"})]}),!e&&_.length>0&&s.jsx("div",{className:"mb-3",children:s.jsx(yt,{options:[{value:"",label:"+ Ajouter un accompagnateur..."},..._],value:"",onChange:A=>{A.target.value&&g(A.target.value)}})}),s.jsx("div",{className:"space-y-2",children:E.map(A=>{var P,T;return s.jsxs("div",{className:`flex items-center justify-between p-2 rounded border ${e?"bg-gray-50 border-gray-300":"bg-white border-green-200"}`,children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold ${e?"bg-gray-300 text-gray-700":"bg-green-200 text-green-800"}`,children:((P=A.full_name)==null?void 0:P.charAt(0))||((T=A.email)==null?void 0:T.charAt(0))}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:A.full_name||A.email})]}),!e&&s.jsx("button",{type:"button",onClick:()=>S(A.id),className:"text-red-500 hover:text-red-700",children:s.jsx(Lr,{size:18})})]},A.id)})}),E.length===0&&s.jsx("p",{className:"text-xs font-medium text-gray-500",children:e?" Aucun accompagnateur assign":" Aucun accompagnateur slectionn"}),e&&s.jsx("p",{className:"text-xs text-gray-600 mt-2",children:" Les accompagnateurs ne peuvent pas tre modifis aprs la cration"})]}),!e&&s.jsxs("div",{className:"p-4 bg-blue-50 border-l-4 border-blue-500 rounded",children:[s.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:" Statut Initial  la Cration"}),s.jsxs("p",{className:"text-sm text-blue-800",children:["La mission sera cre avec le statut ",s.jsx("strong",{children:'"Planifie"'})," (mission future, avant dmarrage)."]}),s.jsx("p",{className:"text-xs text-blue-700 mt-2",children:' Cliquez sur " Dmarrer la Mission" pour passer au statut "En cours"'})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Commentaire Initial (Admin)"}),s.jsx("textarea",{name:"commentaireCreation",value:u.commentaireCreation,onChange:b,placeholder:"Contexte ou remarques  la cration de la mission...",rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),s.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[s.jsx(je,{type:"button",onClick:i,disabled:c,className:`flex-1 ${c?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gray-200 text-gray-800 hover:bg-gray-300"}`,children:"Annuler"}),s.jsx(je,{type:"submit",disabled:c,className:`flex-1 ${c?"bg-gray-400 text-gray-600 cursor-not-allowed":"bg-primary text-white hover:bg-primary-dark"}`,children:c?" Sauvegarde...":e?"Mettre  jour":"Crer la Mission"})]})]})},Mte=({mission:e,tab:t="general",onClose:r,onClosureAdmin:n,currentUser:i,userProfile:a,onValidate:o,onClosure:l,onRemove:c,isAdmin:u})=>{var he,Se,$e,ze,Le;const{addNotification:d}=cr(),[f,h]=N.useState(t),[p,y]=N.useState(""),[v,m]=N.useState(""),[x,b]=N.useState([]),[g,S]=N.useState([]),[w,j]=N.useState([]),[_,E]=N.useState({type:"transport",montant:"",description:""}),[A,P]=N.useState({general:!0,technique:t==="technique",financier:t==="financier",cloture:t==="cloture"});N.useEffect(()=>{if(e){try{const q=e.commentaires_techniques;Array.isArray(q)?b(q):typeof q=="string"&&b(JSON.parse(q)||[])}catch{b([])}try{const q=e.commentaires_financiers;Array.isArray(q)?S(q):typeof q=="string"&&S(JSON.parse(q)||[])}catch{S([])}try{const q=e.depenses_details||e.expenses||e.depenses||[];Array.isArray(q)?j(q):typeof q=="string"&&j(JSON.parse(q)||[])}catch{j([])}}},[e==null?void 0:e.id]);const T=[{value:"transport",label:" Transport / Fuel"},{value:"hotel",label:" Htel"},{value:"repas",label:" Repas"},{value:"divers",label:" Divers"}],M=q=>{P($=>({...$,[q]:!$[q]}))},O=async()=>{if(p.trim()){const q={id:Date.now(),texte:p,auteur:(i==null?void 0:i.email)||"Utilisateur",date_creation:new Date().toISOString(),date_affichage:new Date().toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},$=[...x,q];b($),y("");try{const X=await Mt.saveCommentairesTechniques(e.id,$);X!=null&&X.local?alert(` Commentaire stock localement

Les colonnes commentaires ne sont pas encore cres en base.
Veuillez excuter la migration SQL pour la persistance.`):console.log(" Commentaire technique sauvegard en base")}catch(X){console.error(" Erreur sauvegarde:",X),alert(` Commentaire stock localement

Excutez la migration SQL pour la persistance.`)}}},k=async()=>{if(v.trim()){const q={id:Date.now(),texte:v,auteur:(i==null?void 0:i.email)||"Utilisateur",date_creation:new Date().toISOString(),date_affichage:new Date().toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},$=[...g,q];S($),m("");try{const X=await Mt.saveCommentairesFinanciers(e.id,$);X!=null&&X.local?alert(` Commentaire stock localement

Les colonnes commentaires ne sont pas encore cres en base.
Veuillez excuter la migration SQL pour la persistance.`):console.log(" Commentaire financier sauvegard en base")}catch(X){console.error(" Erreur sauvegarde:",X),alert(` Commentaire stock localement

Excutez la migration SQL pour la persistance.`)}}},F=async()=>{if(_.montant&&_.montant>0){const q={id:Date.now(),..._,montant:parseFloat(_.montant),date_creation:new Date().toISOString(),date_affichage:new Date().toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),auteur:(i==null?void 0:i.email)||"Utilisateur"},$=[...w,q];j($),E({type:"transport",montant:"",description:""});try{const X=await Mt.saveDpenses(e.id,$);X!=null&&X.local?alert(` Dpense stocke localement

Les colonnes dpenses ne sont pas encore cres en base.
Veuillez excuter la migration SQL pour la persistance.`):console.log(" Dpense sauvegarde en base")}catch(X){console.error(" Erreur sauvegarde:",X),alert(` Dpense stocke localement

Excutez la migration SQL pour la persistance.`)}}},I=async q=>{const $=w.filter(X=>X.id!==q);j($);try{await Mt.saveDpenses(e.id,$),console.log(" Dpense supprime et sauvegarde en base")}catch(X){console.error(" Erreur sauvegarde:",X),alert("Erreur lors de la suppression de la dpense")}},W=async q=>{const $=x.filter(X=>X.id!==q);b($);try{await Mt.saveCommentairesTechniques(e.id,$),console.log(" Commentaire technique supprim et sauvegard en base")}catch(X){console.error(" Erreur sauvegarde:",X),alert("Erreur lors de la suppression du commentaire")}},R=async q=>{const $=g.filter(X=>X.id!==q);S($);try{await Mt.saveCommentairesFinanciers(e.id,$),console.log(" Commentaire financier supprim et sauvegard en base")}catch(X){console.error(" Erreur sauvegarde:",X),alert("Erreur lors de la suppression du commentaire")}},D=async()=>{if(window.confirm(` tes-vous certain de vouloir dmarrer cette mission?
Le statut passera  "En cours".`))try{if(await Mt.startMission(e.id)){d({type:"success",message:" Mission dmarre avec succs"});const $={...e,statut:"en_cours"};setTimeout(()=>{r()},800)}}catch(q){console.error("Erreur handleStartMission:",q),d({type:"success",message:" Mission dmarre"}),setTimeout(()=>{r()},800)}},H=u!==void 0?u:(a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="super_admin",Q=(e==null?void 0:e.chefMissionId)===(i==null?void 0:i.id)||(e==null?void 0:e.chef_mission_id)===(i==null?void 0:i.id),U=(he=e==null?void 0:e.accompagnateurs_ids)==null?void 0:he.includes(i==null?void 0:i.id),G=Q&&H,B=Q||U||H,me=(e==null?void 0:e.cloturee_par_chef)||(e==null?void 0:e.cloturee_definitive),ue=me?H||G:Q,Ne=Q||H,ve=H,Y=Q&&((e==null?void 0:e.statut)==="creee"||(e==null?void 0:e.statut)==="planifiee")&&!me,Z=w.reduce((q,$)=>q+(parseFloat($.montant)||0),0),te=parseFloat((e==null?void 0:e.budgetInitial)||(e==null?void 0:e.budget_alloue))||0,L=te>0?Math.round(Z/te*100):0,ae=te-Z,oe=q=>({creee:"Planifie",planifiee:"Planifie",en_cours:"En cours",cloturee:"Clture",validee:"Valide"})[q]||q,le=({section:q,label:$})=>s.jsxs("button",{onClick:()=>M(q),className:"w-full flex items-center justify-between bg-gradient-to-r from-primary to-primary-dark hover:from-primary-dark hover:to-primary p-4 rounded-lg font-semibold text-white transition-colors",children:[s.jsx("span",{children:$}),A[q]?s.jsx(ri,{size:20}):s.jsx(ln,{size:20})]});return s.jsxs("div",{className:"space-y-4",children:[!B&&s.jsxs("div",{className:"p-6 bg-red-50 border-2 border-red-300 rounded-lg text-center",children:[s.jsx("div",{className:"flex justify-center mb-3",children:s.jsx(Rm,{size:40,className:"text-red-600"})}),s.jsx("p",{className:"font-bold text-red-900 text-lg",children:" Accs Refus"}),s.jsx("p",{className:"text-red-800 mt-2",children:"Vous n'avez pas accs  cette mission. Seul le Chef de Mission, les Accompagnateurs et les Administrateurs peuvent la consulter."}),s.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium",children:"Fermer"})]}),B&&s.jsxs(s.Fragment,{children:[me&&s.jsx("div",{className:`p-4 rounded-lg border-l-4 ${G?"bg-blue-50 border-blue-400 text-blue-800":H?"bg-yellow-50 border-yellow-400 text-yellow-800":"bg-red-50 border-red-400 text-red-800"}`,children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xi,{size:20}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold",children:" Mission Clture"}),s.jsx("p",{className:"text-sm",children:G?" Vous tes Chef de Mission avec rle Admin - dition complte autorise":H?" Seul un administrateur peut modifier cette mission.":"Cette mission est clture et ne peut plus tre modifie."})]})]})}),s.jsxs("div",{className:"bg-gradient-to-r from-primary to-primary-dark text-white rounded-lg p-6 shadow-lg",children:[s.jsx("h3",{className:"text-2xl font-bold mb-2",children:e.titre}),s.jsx("p",{className:"text-primary-light mb-4 text-sm",children:e.description}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3 pt-4 border-t border-white border-opacity-30",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xl,{size:18}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs opacity-80",children:"Client"}),s.jsx("p",{className:"font-semibold",children:((Se=e.client)==null?void 0:Se.raison_sociale)||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Cn,{size:18}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs opacity-80",children:"Wilaya"}),s.jsx("p",{className:"font-semibold",children:e.wilaya||e.lieu||"N/A"})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zt,{size:18}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs opacity-80",children:"Statut"}),s.jsx("p",{className:"font-semibold",children:oe(e.statut)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-5 h-5 bg-white bg-opacity-30 rounded flex items-center justify-center text-xs",children:""}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs opacity-80",children:"Type"}),s.jsx("p",{className:"font-semibold",children:e.type})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yl,{size:18}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs opacity-80",children:"Budget"}),s.jsxs("p",{className:"font-semibold",children:[(e.budgetInitial||e.budget_alloue||0).toLocaleString("fr-DZ")," DA"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-5 h-5 bg-white bg-opacity-30 rounded flex items-center justify-center text-xs",children:""}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs opacity-80",children:"Avancement"}),s.jsxs("p",{className:"font-semibold",children:[e.avancement||0,"%"]})]})]})]})]}),s.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg overflow-x-auto",children:[s.jsx("button",{onClick:()=>{h("general"),P(q=>({...q,general:!0}))},className:`flex-1 py-2 px-4 rounded font-medium transition-colors whitespace-nowrap ${f==="general"?"bg-white text-primary shadow-sm":"text-gray-700 hover:text-gray-900"}`,children:" Gnral"}),s.jsx("button",{onClick:()=>{h("technique"),P(q=>({...q,technique:!0}))},className:`flex-1 py-2 px-4 rounded font-medium transition-colors whitespace-nowrap ${f==="technique"?"bg-white text-primary shadow-sm":"text-gray-700 hover:text-gray-900"}`,children:" Technique"}),s.jsx("button",{onClick:()=>{h("financier"),P(q=>({...q,financier:!0}))},className:`flex-1 py-2 px-4 rounded font-medium transition-colors whitespace-nowrap ${f==="financier"?"bg-white text-primary shadow-sm":"text-gray-700 hover:text-gray-900"}`,children:" Financier"}),s.jsx("button",{onClick:()=>{h("cloture"),P(q=>({...q,cloture:!0}))},className:`flex-1 py-2 px-4 rounded font-medium transition-colors whitespace-nowrap ${f==="cloture"?"bg-white text-red-600 shadow-sm":"text-gray-700 hover:text-gray-900"}`,children:" Clture"})]}),f==="general"&&s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[s.jsx(le,{section:"general",label:" Informations Gnrales"}),A.general&&s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4 border-l-4 border-primary",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 uppercase font-semibold",children:"Client"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1 font-medium",children:(($e=e.client)==null?void 0:$e.raison_sociale)||"N/A"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 uppercase font-semibold",children:"Dates Prvues"}),s.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[new Date(e.dateDebut||e.date_debut).toLocaleDateString("fr-FR"),"  ",new Date(e.dateFin||e.date_fin_prevue).toLocaleDateString("fr-FR")]})]}),e.date_demarrage&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-green-600 uppercase font-semibold",children:" Dmarre le"}),s.jsx("p",{className:"text-sm text-green-900 mt-1 font-semibold",children:new Date(e.date_demarrage).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]}),e.date_cloture_reelle&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-red-600 uppercase font-semibold",children:" Clture le"}),s.jsx("p",{className:"text-sm text-red-900 mt-1 font-semibold",children:new Date(e.date_cloture_reelle).toLocaleDateString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})]}),s.jsx("div",{className:"grid grid-cols-2 gap-4",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 uppercase font-semibold",children:"Priorit"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:((ze=e.priorite)==null?void 0:ze.charAt(0).toUpperCase())+((Le=e.priorite)==null?void 0:Le.slice(1))})]})}),e.commentaireCreation&&s.jsxs("div",{className:"p-3 bg-blue-50 rounded border border-blue-200",children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold mb-1",children:"Notes  la cration"}),s.jsx("p",{className:"text-sm text-blue-900",children:e.commentaireCreation})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 uppercase font-semibold",children:"Chef de Mission"}),s.jsx("p",{className:"text-sm text-gray-900 mt-1",children:e.chef_name||"Non assign"})]}),Y&&s.jsxs("div",{className:"pt-2",children:[s.jsx(je,{onClick:D,className:"w-full bg-green-600 hover:bg-green-700 text-white flex items-center justify-center gap-2 py-3 font-semibold",children:" Dmarrer la Mission"}),s.jsx("p",{className:"text-xs text-gray-600 mt-2",children:'Le statut passera  "En cours"'})]}),!Y&&((e==null?void 0:e.statut)==="creee"||(e==null?void 0:e.statut)==="planifiee")&&s.jsx("div",{className:"p-3 bg-amber-50 rounded border border-amber-200 text-sm text-amber-900",children:s.jsxs("p",{children:[s.jsx("strong",{children:" Info:"})," Seul le Chef de Mission peut dmarrer cette mission."]})})]})]}),f==="technique"&&s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[s.jsx(le,{section:"technique",label:" Volet Technique"}),A.technique&&s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4 border-l-4 border-primary",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 uppercase font-semibold mb-2",children:"Rapport Technique"}),s.jsx("p",{className:"text-sm text-gray-900 bg-white p-3 rounded",children:e.rapportTechnique||"Pas encore document"})]}),e.actionsRealisees&&e.actionsRealisees.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 uppercase font-semibold mb-2",children:"Actions Ralises"}),s.jsx("ul",{className:"space-y-2",children:e.actionsRealisees.map((q,$)=>s.jsxs("li",{className:"text-sm bg-white p-2 rounded border-l-2 border-green-500",children:[" ",q]},$))})]}),s.jsxs("div",{className:`bg-white p-4 rounded-lg border ${ue?"border-gray-200":"border-red-300 bg-red-50 opacity-60"}`,children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:" Ajouter un Commentaire Technique"}),!ue&&s.jsx("p",{className:"text-red-600 text-sm mb-3",children:" Mission clture - dition non autorise"}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("textarea",{value:p,onChange:q=>y(q.target.value),placeholder:"Observations techniques, remarques sur l'excution, problmes rencontrs...",rows:"3",disabled:!ue,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-100 disabled:cursor-not-allowed"}),s.jsx(je,{onClick:O,disabled:!ue,className:`w-full flex items-center justify-center gap-2 ${ue?"bg-primary hover:bg-primary-dark text-white":"bg-gray-400 cursor-not-allowed"}`,children:" Enregistrer le Commentaire"})]})]}),x.length>0&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[s.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:" Historique des Commentaires Techniques"}),s.jsx("div",{className:"space-y-3",children:x.map(q=>s.jsx("div",{className:"bg-white p-3 rounded border-l-4 border-blue-500",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-900",children:q.texte}),s.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-gray-600",children:[s.jsxs("span",{children:[" ",q.auteur]}),s.jsxs("span",{children:[" ",q.date_affichage]})]})]}),s.jsx("button",{onClick:()=>W(q.id),className:"text-red-500 hover:text-red-700 ml-2",children:s.jsx(rr,{size:16})})]})},q.id))})]})]})]}),f==="financier"&&s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[s.jsx(le,{section:"financier",label:" Volet Financier"}),A.financier&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsxs("div",{className:"p-3 bg-blue-50 rounded border border-blue-200",children:[s.jsx("p",{className:"text-xs text-blue-600 uppercase font-semibold",children:"Budget Initial"}),s.jsxs("p",{className:"text-xl font-bold text-blue-900 mt-1",children:[te.toLocaleString("fr-DZ")," DA"]})]}),s.jsxs("div",{className:`p-3 rounded border ${L>80?"bg-red-50 border-red-200":"bg-orange-50 border-orange-200"}`,children:[s.jsx("p",{className:`text-xs uppercase font-semibold ${L>80?"text-red-600":"text-orange-600"}`,children:"Dpenses"}),s.jsxs("p",{className:`text-xl font-bold mt-1 ${L>80?"text-red-900":"text-orange-900"}`,children:[Z.toLocaleString("fr-DZ")," DA"]})]}),s.jsxs("div",{className:`p-3 rounded border ${ae<0?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[s.jsx("p",{className:`text-xs uppercase font-semibold ${ae<0?"text-red-600":"text-green-600"}`,children:"Restant"}),s.jsxs("p",{className:`text-xl font-bold mt-1 ${ae<0?"text-red-900":"text-green-900"}`,children:[ae.toLocaleString("fr-DZ")," DA"]})]}),s.jsxs("div",{className:`p-3 rounded border ${L>80?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:[s.jsx("p",{className:`text-xs uppercase font-semibold ${L>80?"text-red-600":"text-yellow-600"}`,children:"Utilisation"}),s.jsxs("p",{className:`text-xl font-bold mt-1 ${L>80?"text-red-900":"text-yellow-900"}`,children:[L,"%"]})]})]}),L>80&&s.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded flex gap-3",children:[s.jsx(xt,{className:"text-red-600 flex-shrink-0",size:20}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-red-900",children:" Dpassement Budgtaire!"}),s.jsxs("p",{className:"text-sm text-red-800 mt-1",children:["Budget utilis  ",L,"%. Attention  ne pas dpasser la limite."]})]})]}),s.jsxs("div",{className:`p-4 rounded-lg border ${ue?"bg-gray-50 border-gray-200":"bg-red-50 border-red-300 opacity-60"}`,children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:" Ajouter une Dpense"}),!ue&&s.jsx("p",{className:"text-red-600 text-sm mb-3",children:" Mission clture - dition non autorise"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de Dpense"}),s.jsx("select",{value:_.type,onChange:q=>E({..._,type:q.target.value}),disabled:!ue,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-100 disabled:cursor-not-allowed",children:T.map(q=>s.jsx("option",{value:q.value,children:q.label},q.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Montant (DA)"}),s.jsx(Ie,{type:"number",value:_.montant,onChange:q=>E({..._,montant:q.target.value}),placeholder:"0.00",disabled:!ue})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:_.description,onChange:q=>E({..._,description:q.target.value}),placeholder:"Dtails de la dpense...",rows:"2",disabled:!ue,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-100 disabled:cursor-not-allowed"})]}),s.jsxs(je,{onClick:F,disabled:!ue,className:`w-full flex items-center justify-center gap-2 ${ue?"bg-primary hover:bg-primary-dark text-white":"bg-gray-400 cursor-not-allowed"}`,children:[s.jsx(Un,{size:18}),"Ajouter la Dpense"]})]})]}),w.length>0&&s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:[" Dpenses Enregistres (",w.length,")"]}),s.jsx("div",{className:"space-y-2",children:w.map(q=>{var $;return s.jsxs("div",{className:"flex items-start justify-between bg-white p-3 rounded border border-gray-200",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900",children:($=T.find(X=>X.value===q.type))==null?void 0:$.label}),s.jsx("p",{className:"text-sm text-gray-600",children:q.description}),s.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-gray-500",children:[s.jsxs("span",{children:[" ",q.auteur||"Utilisateur"]}),s.jsxs("span",{children:[" ",q.date_affichage||new Date(q.date_creation).toLocaleDateString("fr-FR")]})]})]}),s.jsx("div",{className:"text-right mr-3 min-w-fit",children:s.jsxs("p",{className:"font-semibold text-gray-900",children:[q.montant.toLocaleString("fr-DZ")," DA"]})}),s.jsx("button",{onClick:()=>I(q.id),className:"text-red-500 hover:text-red-700 ml-2",children:s.jsx(rr,{size:18})})]},q.id)})})]}),s.jsxs("div",{className:`p-4 rounded-lg border ${ue?"bg-gray-50 border-gray-200":"bg-red-50 border-red-300 opacity-60"}`,children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:" Ajouter un Commentaire Financier"}),!ue&&s.jsx("p",{className:"text-red-600 text-sm mb-3",children:" Mission clture - dition non autorise"}),s.jsx("textarea",{value:v,onChange:q=>m(q.target.value),placeholder:"Vos observations ou commentaires financiers...",rows:"3",disabled:!ue,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary disabled:bg-gray-100 disabled:cursor-not-allowed"}),s.jsx(je,{onClick:k,disabled:!ue,className:`mt-2 w-full ${ue?"bg-primary hover:bg-primary-dark text-white":"bg-gray-400 cursor-not-allowed"}`,children:" Enregistrer le Commentaire"})]}),g.length>0&&s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[s.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:" Historique des Commentaires Financiers"}),s.jsx("div",{className:"space-y-3",children:g.map(q=>s.jsx("div",{className:"bg-white p-3 rounded border-l-4 border-green-500",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm text-gray-900",children:q.texte}),s.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-gray-600",children:[s.jsxs("span",{children:[" ",q.auteur]}),s.jsxs("span",{children:[" ",q.date_affichage]})]})]}),s.jsx("button",{onClick:()=>R(q.id),className:"text-red-500 hover:text-red-700 ml-2",children:s.jsx(rr,{size:16})})]})},q.id))})]})]})]}),f==="cloture"&&s.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:[s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("p",{className:"text-sm text-yellow-900",children:[s.jsx("strong",{children:" Statut actuel:"})," ",oe(e.statut)]})}),me&&s.jsxs("div",{className:"p-4 bg-green-50 border border-green-300 rounded-lg flex gap-3",children:[s.jsx(zt,{className:"text-green-600 flex-shrink-0",size:20}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900",children:" Mission Clture"}),s.jsxs("p",{className:"text-sm text-green-800 mt-1",children:["Cette mission a t clture ",e.date_cloture_reelle?`le ${new Date(e.date_cloture_reelle).toLocaleDateString("fr-FR")}`:"",".",!H&&" Seul un administrateur peut la modifier."]})]})]}),!Ne&&e.statut!=="cloturee"&&e.statut!=="validee"&&s.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg flex gap-3",children:[s.jsx(Rm,{className:"text-red-600 flex-shrink-0",size:20}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-red-900",children:" Accs Restreint"}),s.jsx("p",{className:"text-sm text-red-800 mt-1",children:"Vous n'avez pas les permissions ncessaires pour clturer cette mission. Seul le Chef de Mission ou un Admin peut clturer."})]})]}),Ne&&e.statut!=="cloturee"&&e.statut!=="validee"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:"Actions de Clture Disponibles:"}),e.statut==="en_cours"&&Q&&s.jsx(je,{onClick:()=>{n&&n({type:"chef",totalExpenses:w.reduce((q,$)=>q+($.montant||0),0)})},className:"w-full bg-amber-500 hover:bg-amber-600 text-white flex items-center justify-center gap-2",children:" Clturer par Chef de Mission"}),ve&&s.jsxs(je,{onClick:()=>n({type:"admin",totalExpenses:w.reduce((q,$)=>q+($.montant||0),0)}),className:"w-full bg-red-600 hover:bg-red-700 text-white flex items-center justify-center gap-2",children:[s.jsx(xi,{size:18})," Clture Dfinitive (Admin)"]}),!ve&&Q&&s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded text-sm text-blue-900",children:s.jsxs("p",{children:[s.jsx("strong",{children:" Info:"}),` Le bouton "Clture Dfinitive (Admin)" n'est accessible qu'aux administrateurs.`]})})]}),(e.statut==="cloturee"||e.statut==="validee")&&s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg flex gap-3",children:[s.jsx(zt,{className:"text-green-600 flex-shrink-0",size:20}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900",children:" Mission Clture"}),s.jsx("p",{className:"text-sm text-green-800 mt-1",children:"Cette mission a t clture et valide."})]})]}),H&&s.jsxs("div",{className:"flex gap-3 mt-6 flex-wrap",children:[e.statut!=="validee"&&o&&s.jsxs(je,{onClick:()=>{o(e),r()},className:"flex-1 min-w-[120px] bg-green-50 text-green-600 hover:bg-green-100 rounded-lg py-2 font-medium flex items-center justify-center gap-2",title:"Valider cette mission",children:[s.jsx(zt,{size:16}),"Valider"]}),e.statut!=="cloturee"&&l&&s.jsxs(je,{onClick:()=>{l(e),r()},className:"flex-1 min-w-[120px] bg-orange-50 text-orange-600 hover:bg-orange-100 rounded-lg py-2 font-medium flex items-center justify-center gap-2",title:"Clturer cette mission",children:[s.jsx(xt,{size:16}),"Clturer"]}),c&&s.jsxs(je,{onClick:()=>{c(e),r()},className:"flex-1 min-w-[120px] bg-red-50 text-red-600 hover:bg-red-100 rounded-lg py-2 font-medium flex items-center justify-center gap-2",title:"Supprimer cette mission (Admin - Irrversible)",children:[s.jsx(rr,{size:16}),"Supprimer"]})]})]})]})]})},Rte=({analysisData:e,loading:t})=>{const[r,n]=N.useState({risks:!0,anomalies:!0,metrics:!0,trends:!0,recommendations:!0}),i=h=>{n(p=>({...p,[h]:!p[h]}))};if(!e)return s.jsx("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200 text-center",children:s.jsx("p",{className:"text-gray-500",children:`Aucune analyse disponible. Cliquez sur "Analyser avec l'IA" pour gnrer une analyse.`})});const{missionMetrics:a,riskLevels:o,anomalies:l,performanceMetrics:c,trends:u,recommendations:d,summary:f}=e;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[s.jsx("p",{className:"text-sm text-blue-600 font-semibold",children:"Total Missions"}),s.jsx("p",{className:"text-2xl font-bold text-blue-900",children:f.totalMissions})]}),s.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[s.jsx("p",{className:"text-sm text-red-600 font-semibold",children:"Critique"}),s.jsx("p",{className:"text-2xl font-bold text-red-900",children:f.criticalMissions})]}),s.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[s.jsx("p",{className:"text-sm text-yellow-600 font-semibold",children:"Avertissement"}),s.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:f.warningMissions})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[s.jsx("p",{className:"text-sm text-green-600 font-semibold",children:"Compltion"}),s.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[f.completionRate,"%"]})]})]}),s.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[s.jsxs("div",{onClick:()=>i("risks"),className:"bg-gradient-to-r from-red-500 to-red-600 p-4 cursor-pointer flex items-center justify-between hover:shadow-lg transition",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(xt,{size:20,className:"text-white"}),s.jsxs("span",{className:"text-white font-semibold",children:[" Risques Identifis (",f.criticalMissions+f.warningMissions," missions)"]})]}),r.risks?s.jsx(ri,{size:20,className:"text-white"}):s.jsx(ln,{size:20,className:"text-white"})]}),r.risks&&s.jsxs("div",{className:"p-4 space-y-3",children:[o.critique.length>0&&s.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[s.jsx("h4",{className:"font-semibold text-red-900 mb-2",children:" Missions Critiques"}),s.jsx("div",{className:"space-y-2",children:o.critique.map(h=>s.jsxs("div",{className:"text-sm text-red-800 p-2 bg-white rounded border-l-4 border-red-500",children:[s.jsx("p",{className:"font-semibold",children:h.titre}),s.jsxs("p",{className:"text-xs mt-1",children:["Score risque: ",s.jsxs("span",{className:"font-bold",children:[h.riskScore,"/100"]})," |",h.daysLeft," jour(s) restant(s) | Budget: ",h.budgetPercent,"%"]})]},h.id))})]}),o.avertissement.length>0&&s.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[s.jsx("h4",{className:"font-semibold text-yellow-900 mb-2",children:" Missions  Surveiller"}),s.jsxs("div",{className:"space-y-2",children:[o.avertissement.slice(0,3).map(h=>s.jsxs("div",{className:"text-sm text-yellow-800 p-2 bg-white rounded border-l-4 border-yellow-500",children:[s.jsx("p",{className:"font-semibold",children:h.titre}),s.jsxs("p",{className:"text-xs mt-1",children:["Score risque: ",s.jsxs("span",{className:"font-bold",children:[h.riskScore,"/100"]})]})]},h.id)),o.avertissement.length>3&&s.jsxs("p",{className:"text-xs text-yellow-600 italic",children:["+",o.avertissement.length-3," autre(s)..."]})]})]}),o.critique.length===0&&o.avertissement.length===0&&s.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:s.jsx("p",{className:"text-green-800 font-semibold",children:" Aucune mission critique - Bonne sant du portefeuille"})})]})]}),l.length>0&&s.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[s.jsxs("div",{onClick:()=>i("anomalies"),className:"bg-gradient-to-r from-orange-500 to-orange-600 p-4 cursor-pointer flex items-center justify-between hover:shadow-lg transition",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(xt,{size:20,className:"text-white"}),s.jsxs("span",{className:"text-white font-semibold",children:[" Anomalies Dtectes (",l.length,")"]})]}),r.anomalies?s.jsx(ri,{size:20,className:"text-white"}):s.jsx(ln,{size:20,className:"text-white"})]}),r.anomalies&&s.jsx("div",{className:"p-4 space-y-3",children:l.map((h,p)=>s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${h.severity==="critique"?"bg-red-50 border-red-500":h.severity==="haute"?"bg-orange-50 border-orange-500":"bg-yellow-50 border-yellow-500"}`,children:[s.jsx("h4",{className:`font-semibold mb-1 ${h.severity==="critique"?"text-red-900":h.severity==="haute"?"text-orange-900":"text-yellow-900"}`,children:h.title}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:h.description}),s.jsxs("p",{className:"text-xs font-semibold text-gray-800 bg-white bg-opacity-50 p-2 rounded",children:[" Action: ",h.action]})]},p))})]}),s.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[s.jsxs("div",{onClick:()=>i("metrics"),className:"bg-gradient-to-r from-blue-500 to-blue-600 p-4 cursor-pointer flex items-center justify-between hover:shadow-lg transition",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ni,{size:20,className:"text-white"}),s.jsx("span",{className:"text-white font-semibold",children:" Mtriques de Performance"})]}),r.metrics?s.jsx(ri,{size:20,className:"text-white"}):s.jsx(ln,{size:20,className:"text-white"})]}),r.metrics&&s.jsxs("div",{className:"p-4 grid grid-cols-2 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 p-3 rounded border border-blue-200",children:[s.jsx("p",{className:"text-xs text-blue-600 font-semibold",children:"Taux Compltion"}),s.jsxs("p",{className:"text-xl font-bold text-blue-900",children:[c.tauxCompletion,"%"]})]}),s.jsxs("div",{className:"bg-green-50 p-3 rounded border border-green-200",children:[s.jsx("p",{className:"text-xs text-green-600 font-semibold",children:"Efficience Budget"}),s.jsxs("p",{className:"text-xl font-bold text-green-900",children:[c.budgetEfficiency,"%"]})]}),s.jsxs("div",{className:"bg-purple-50 p-3 rounded border border-purple-200",children:[s.jsx("p",{className:"text-xs text-purple-600 font-semibold",children:"Avancement Moyen"}),s.jsxs("p",{className:"text-xl font-bold text-purple-900",children:[c.averageProgress,"%"]})]}),s.jsxs("div",{className:"bg-indigo-50 p-3 rounded border border-indigo-200",children:[s.jsx("p",{className:"text-xs text-indigo-600 font-semibold",children:"Taux Retard"}),s.jsxs("p",{className:"text-xl font-bold text-indigo-900",children:[c.tauxRetard,"%"]})]}),s.jsxs("div",{className:"bg-orange-50 p-3 rounded border border-orange-200",children:[s.jsx("p",{className:"text-xs text-orange-600 font-semibold",children:"Charge Moyenne"}),s.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[Math.round(c.missionCount/Math.max(c.chefCount,1))," / chef"]})]}),s.jsxs("div",{className:"bg-cyan-50 p-3 rounded border border-cyan-200",children:[s.jsx("p",{className:"text-xs text-cyan-600 font-semibold",children:"Chefs Assigns"}),s.jsx("p",{className:"text-xl font-bold text-cyan-900",children:c.chefCount})]})]})]}),s.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[s.jsxs("div",{onClick:()=>i("trends"),className:"bg-gradient-to-r from-purple-500 to-purple-600 p-4 cursor-pointer flex items-center justify-between hover:shadow-lg transition",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(cn,{size:20,className:"text-white"}),s.jsx("span",{className:"text-white font-semibold",children:" Tendances & Prdictions"})]}),r.trends?s.jsx(ri,{size:20,className:"text-white"}):s.jsx(ln,{size:20,className:"text-white"})]}),r.trends&&s.jsxs("div",{className:"p-4 space-y-3",children:[s.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"font-semibold text-blue-900",children:"Vlocit"}),s.jsx("span",{className:"text-2xl",children:u.velocity.icon})]}),s.jsxs("p",{className:"text-sm text-blue-800",children:[s.jsx("span",{className:"font-bold capitalize",children:u.velocity.status})," - ",u.velocity.value," missions/semaine"]})]}),s.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"font-semibold text-green-900",children:"Budget"}),s.jsx("span",{className:"text-2xl",children:u.budget.icon})]}),s.jsxs("p",{className:"text-sm text-green-800",children:[s.jsx("span",{className:"font-bold capitalize",children:u.budget.status})," - ",u.budget.percent,"% d'efficience"]})]}),s.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg border border-orange-200",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"font-semibold text-orange-900",children:"Dlais"}),s.jsx("span",{className:"text-2xl",children:u.deadline.icon})]}),s.jsxs("p",{className:"text-sm text-orange-800",children:[s.jsx("span",{className:"font-bold capitalize",children:u.deadline.status})," - ",u.deadline.value," jours en moyenne"]})]}),s.jsxs("div",{className:"p-4 bg-red-50 rounded-lg border border-red-200",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("span",{className:"font-semibold text-red-900",children:"Charge quipe"}),s.jsx("span",{className:"text-2xl",children:u.teamLoad.icon})]}),s.jsxs("p",{className:"text-sm text-red-800",children:[s.jsx("span",{className:"font-bold capitalize",children:u.teamLoad.status})," - ",u.teamLoad.value," missions par chef"]})]})]})]}),s.jsxs("div",{className:"border rounded-lg overflow-hidden bg-white",children:[s.jsxs("div",{onClick:()=>i("recommendations"),className:"bg-gradient-to-r from-green-500 to-green-600 p-4 cursor-pointer flex items-center justify-between hover:shadow-lg transition",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(uM,{size:20,className:"text-white"}),s.jsxs("span",{className:"text-white font-semibold",children:[" Recommandations (",d.length,")"]})]}),r.recommendations?s.jsx(ri,{size:20,className:"text-white"}):s.jsx(ln,{size:20,className:"text-white"})]}),r.recommendations&&s.jsx("div",{className:"p-4 space-y-3",children:d.map((h,p)=>s.jsxs("div",{className:`p-4 rounded-lg border-l-4 ${h.severity==="critique"?"bg-red-50 border-red-500":h.severity==="avertissement"?"bg-yellow-50 border-yellow-500":h.severity==="success"?"bg-green-50 border-green-500":"bg-blue-50 border-blue-500"}`,children:[s.jsxs("h4",{className:`font-semibold mb-1 flex items-center gap-2 ${h.severity==="critique"?"text-red-900":h.severity==="avertissement"?"text-yellow-900":h.severity==="success"?"text-green-900":"text-blue-900"}`,children:[s.jsx("span",{children:h.icon}),h.title]}),s.jsx("p",{className:"text-sm text-gray-700 mb-2",children:h.description}),s.jsxs("div",{className:`text-xs font-semibold p-2 rounded ${h.severity==="critique"?"bg-red-100 text-red-900":h.severity==="avertissement"?"bg-yellow-100 text-yellow-900":h.severity==="success"?"bg-green-100 text-green-900":"bg-blue-100 text-blue-900"}`,children:[" ",h.action]})]},p))})]})]})},Dte=(e,t)=>{const r=new Date(e.dateFin||e.date_fin_prevue),n=new Date(e.dateDebut||e.date_debut_prevue),i=Math.ceil((r-t)/(1e3*60*60*24)),a=Math.ceil((t-n)/(1e3*60*60*24)),o=Math.ceil((r-n)/(1e3*60*60*24)),l=e.budgetInitial||e.budget_alloue||0,c=e.depenses||0,u=l>0?c/l*100:0,d=e.avancement||0,f=o>0?a/o*100:0,h=d-f;let p=0;return(e.statut==="en_cours"||e.statut==="en-cours")&&(i<1?p+=40:i<3?p+=30:i<7?p+=20:i<14&&(p+=10),u>120?p+=35:u>100?p+=25:u>85&&(p+=15),h<-30?p+=30:h<-15?p+=20:h<-5&&(p+=10)),Math.min(Math.max(p,0),100)},Lte=(e,t)=>{const r=new Date;return e.map(i=>{const a=new Date(i.dateFin||i.date_fin_prevue),o=new Date(i.dateDebut||i.date_debut_prevue),l=Math.ceil((a-r)/(1e3*60*60*24)),c=Math.ceil((r-o)/(1e3*60*60*24)),u=Math.ceil((a-o)/(1e3*60*60*24)),d=i.budgetInitial||i.budget_alloue||0,f=i.depenses||0,h=d>0?f/d*100:0,p=d-f,y=i.avancement||0,v=u>0?c/u*100:0,m=y-v;return{id:i.id,titre:i.titre,statut:i.statut,avancementActuel:y,avancementPrvu:Math.round(v),cartAvancement:Math.round(m),budgetPercent:Math.round(h),budget:Math.round(d),depenses:Math.round(f),budgetRemaining:Math.round(p),daysLeft:l,daysElapsed:c,totalDuration:u,type:i.type||"Gnral",priorite:i.priorite||"normale",chefMission:i.chef_name||i.chef_id||"Non assign",riskScore:Dte(i,r)}})},Bte=e=>({critique:e.filter(t=>t.riskScore>=70),avertissement:e.filter(t=>t.riskScore>=40&&t.riskScore<70),normal:e.filter(t=>t.riskScore<40)}),Fte=e=>{const t=[];return e.forEach(r=>{r.cartAvancement<-15&&(r.statut==="en_cours"||r.statut==="en-cours")&&t.push({type:"retard_chronologique",mission:r,severity:"haute",title:` Retard Chronologique: ${r.titre}`,description:`${Math.abs(r.cartAvancement)}% en retard sur le calendrier prvu`,action:"Acclrer l'excution ou reprogrammer"}),r.budgetPercent>120&&t.push({type:"depassement_budget",mission:r,severity:r.budgetPercent>150?"critique":"haute",title:` Dpassement Budget: ${r.titre}`,description:`Dpassement de ${Math.round(r.budgetPercent-100)}% (${r.depenses} / ${r.budget})`,action:"Revoir le budget ou demander crdits supplmentaires"}),r.cartAvancement>20&&(r.statut==="en_cours"||r.statut==="en-cours")&&t.push({type:"qualite_suspecte",mission:r,severity:"moyenne",title:` Progression Rapide: ${r.titre}`,description:`${r.cartAvancement}% d'avance sur le calendrier - vrifier la qualit`,action:"Audit qualit pour confirmer la conformit"}),r.daysLeft<3&&r.avancementActuel<80&&t.push({type:"urgence_inachevement",mission:r,severity:"critique",title:` CRITIQUE: ${r.titre}`,description:`${r.daysLeft} jour(s) restant(s), seulement ${r.avancementActuel}% complt`,action:"Intervention immdiate requise"})}),t.sort((r,n)=>{const i={critique:3,haute:2,moyenne:1};return(i[n.severity]||0)-(i[r.severity]||0)})},qte=(e,t)=>({tauxCompletion:t.total>0?Math.round(t.validees/t.total*100):0,tauxRetard:t.total>0?Math.round(t.delaiees/t.total*100):0,budgetEfficiency:t.budgetTotal>0?Math.round((t.budgetTotal-t.depensesTotal)/t.budgetTotal*100):0,averageProgress:t.enCours>0?Math.round(e.filter(r=>r.statut==="en_cours"||r.statut==="en-cours").reduce((r,n)=>r+(n.avancement||0),0)/Math.max(t.enCours,1)):0,missionCount:e.length,chefCount:new Set(e.map(r=>r.chef_id)).size}),Ute=(e,t)=>{const n=e.filter(d=>d.statut==="validee"||d.statut==="cloturee").length/Math.max(e.length,1),i=Math.round(n*10)/10,a=e.filter(d=>d.budgetPercent<=100).length/Math.max(e.length,1)*100,l=e.filter(d=>d.daysLeft>=7||d.statut!=="en_cours"&&d.statut!=="en-cours").length/Math.max(e.length,1),c=e.filter(d=>d.statut==="en_cours"||d.statut==="en-cours").reduce((d,f)=>d+Math.max(0,f.daysLeft),0)/Math.max(e.filter(d=>d.statut==="en_cours"||d.statut==="en-cours").length,1),u=t.missionCount/Math.max(t.chefCount,1);return{velocity:{status:n>.4?"improving":n>.2?"stable":"declining",value:i,icon:n>.4?"":n>.2?"":""},budget:{status:a>70?"sain":a>50?"moyen":"critique",percent:Math.round(a),icon:a>70?"":a>50?"":""},deadline:{status:l>.7?"contrle":"serre",value:Math.round(c),icon:l>.7?"":""},teamLoad:{status:u>5?"leve":"normale",value:Math.round(u*10)/10,icon:u>5?"":""}}},zte=(e,t,r,n,i)=>{const a=[];t.critique.length>0&&a.push({priority:"urgent",severity:"critique",icon:"",title:`INTERVENTION IMMDIATE: ${t.critique.length} Mission(s) Critique(s)`,description:`Les missions suivantes ncessitent une action immdiate: ${t.critique.slice(0,2).map(c=>c.titre).join(", ")}${t.critique.length>2?"...":""}`,action:"Runion de crise - Allouer ressources supplmentaires"});const o=r.filter(c=>c.severity==="critique");o.length>0&&a.push({priority:"urgent",severity:"critique",icon:"",title:`${o.length} Anomalie(s) Critique(s)`,description:o[0].description,action:o[0].action}),n.tauxCompletion<60&&a.push({priority:"haute",severity:"avertissement",icon:"",title:"Taux de Compltion Faible",description:`${n.tauxCompletion}% de compltion (objectif: 80%+). Revoir la planification ou augmenter les ressources.`,action:"Analyser les goulots d'tranglement et les blocages"});const l=e.filter(c=>c.budgetPercent>100);return l.length>e.length*.3&&a.push({priority:"haute",severity:"avertissement",icon:"",title:"Dpassements Budgtaires Rcurrents",description:`${l.length} mission(s) en dpassement. Plus de 30% du portefeuille affect.`,action:"Revoir le modle d'estimation et les marges de scurit"}),n.tauxCompletion>0&&n.tauxCompletion<30&&a.push({priority:"moyenne",severity:"info",icon:"",title:"Vlocit  Optimiser",description:"La cadence actuelle laisse peu de marge. Considrer une augmentation de capacit.",action:"valuer les ressources disponibles et la charge de travail"}),n.tauxCompletion>70&&t.critique.length===0&&a.push({priority:"info",severity:"success",icon:"",title:"Excellent Taux de Compltion",description:`Performance de ${n.tauxCompletion}% - quipe en excellente trajectoire.`,action:"Maintenir la dynamique actuelle"}),a},Wte=(e,t)=>{const r=Lte(e),n=Bte(r),i=Fte(r),a=qte(e,t),o=Ute(r,a),l=zte(r,n,i,a);return{missionMetrics:r,riskLevels:n,anomalies:i,performanceMetrics:a,trends:o,recommendations:l,summary:{totalMissions:e.length,criticalMissions:n.critique.length,warningMissions:n.avertissement.length,normalMissions:n.normal.length,detectedAnomalies:i.length,completionRate:a.tauxCompletion,budgetHealth:a.budgetEfficiency}}},Hte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState([]),[o,l]=N.useState([]),[c,u]=N.useState(!0),[d,f]=N.useState(""),[h,p]=N.useState("all"),[y,v]=N.useState(""),[m,x]=N.useState(""),[b,g]=N.useState("all"),[S,w]=N.useState(!1),[j,_]=N.useState(!1),[E,A]=N.useState(!1),[P,T]=N.useState(null),[M,O]=N.useState(null),[k,F]=N.useState(null),[I,W]=N.useState(null),[R,D]=N.useState(!1),[H,Q]=N.useState(!1),{addNotification:U}=cr(),{user:G,profile:B}=dt(),me=oc(),[ue,Ne]=N.useState(null);N.useEffect(()=>{var K;let C=(K=me.state)==null?void 0:K.createMission;if(!C){const re=localStorage.getItem("temp_mission_create");if(re)try{C=JSON.parse(re),console.log(" Dashboard: Donnes rcupres du localStorage !")}catch(se){console.error("Erreur lecture localStorage",se)}}if(C){if(console.log(" Dashboard: DCLENCHEMENT MODAL AVEC DONNES:",C),C.prospectData){const re=C.prospectData;a(se=>{if(!se.find(we=>we.id===re.id)){console.log(" Dashboard: Injection prospect manquant:",re);const we={...re,raison_sociale:re.raison_sociale||re.nom||"Prospect",statut:"actif"};return[...se,we]}return se})}T(null),Ne(C),w(!0),setTimeout(()=>localStorage.removeItem("temp_mission_create"),2e3)}},[me.state]);const ve=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin",Y=[{id:1,titre:"Installation Systme ERP",description:"Installation complte du systme ERP client ABC",client:{id:1,raison_sociale:"Entreprise ABC"},lieu:"Alger",dateDebut:"2025-11-20",dateFin:"2025-11-25",budgetInitial:5e4,statut:"en_cours",type:"Installation",participants:[{id:1,nom:"Jean Dupont",role:"Technicien"}],priorite:"haute",avancement:65,dureePrevue:5,durationReelle:3,depenses:21500},{id:2,titre:"Formation quipe Support",description:"Formation sur la nouvelle plateforme logicielle",client:{id:2,raison_sociale:"Socit XYZ"},lieu:"Oran",dateDebut:"2025-11-22",dateFin:"2025-11-23",budgetInitial:15e3,statut:"planifiee",type:"Formation",participants:[{id:2,nom:"Marie Martin",role:"Formateur"}],priorite:"moyenne",avancement:0,dureePrevue:2,durationReelle:0,depenses:0},{id:3,titre:"Support Technique Urgent",description:"Intervention d'urgence pour panne systme",client:{id:3,raison_sociale:"Client DEF"},lieu:"Constantine",dateDebut:"2025-11-19",dateFin:"2025-11-20",budgetInitial:8e3,statut:"validee",type:"Support",participants:[{id:3,nom:"Pierre Lefevre",role:"Technicien"}],priorite:"critique",avancement:100,dureePrevue:1,durationReelle:1.5,depenses:6800},{id:4,titre:"Maintenance Serveurs",description:"Maintenance prventive serveurs client",client:{id:4,raison_sociale:"Tech Solutions"},lieu:"Annaba",dateDebut:"2025-11-25",dateFin:"2025-11-27",budgetInitial:12e3,statut:"creee",type:"Maintenance",participants:[{id:1,nom:"Jean Dupont",role:"Technicien"}],priorite:"moyenne",avancement:0,dureePrevue:2,durationReelle:0,depenses:0},{id:5,titre:"Audit Scurit",description:"Audit complet de scurit informatique",client:{id:5,raison_sociale:"Finance Pro"},lieu:"Blida",dateDebut:"2025-11-21",dateFin:"2025-11-24",budgetInitial:25e3,statut:"en_cours",type:"Audit",participants:[{id:4,nom:"Sophie Durand",role:"Auditeur"}],priorite:"haute",avancement:45,dureePrevue:3,durationReelle:2,depenses:8900}];N.useEffect(()=>{Z()},[]),N.useEffect(()=>{G!=null&&G.id&&B&&te()},[e,d,h,y,m,b,G==null?void 0:G.id,B]);const Z=async()=>{try{u(!0);const C=await Mt.testTableAccess();console.log("Missions table access test:",C);const re=(await mt.getAll()).filter(se=>se.statut==="actif");a(re);try{const se=await Fe.getAll();console.log("Users loaded:",se==null?void 0:se.length,"users",se),l(se||[])}catch(se){console.error("Erreur chargement utilisateurs:",se),l([])}try{const Te=(await Mt.getAll()||[]).map(we=>{const Pe=we.prospect_id||we.clientId,vn=Pe?re.find(ch=>ch.id===Pe):null,Gn=we.client||vn||{id:Pe,raison_sociale:"Client"};return{...we,type:we.type_mission||we.type,budgetInitial:we.budget_alloue||we.budgetInitial||0,depenses:we.budget_depense||we.depenses||0,avancement:we.avancement||0,client:Gn}});console.log("Missions transformed:",Te),t(Te)}catch(se){console.warn("Missions BD non disponibles, utilisation des donnes mockes:",se),t(Y)}}catch(C){console.error("Erreur:",C),U({type:"error",message:"Erreur lors du chargement des donnes"})}finally{u(!1)}},te=()=>{let C=[...e];const K=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin";C=C.filter(re=>{var Pe;const se=re.chefMissionId===(G==null?void 0:G.id)||re.chef_mission_id===(G==null?void 0:G.id),Te=(Pe=re.accompagnateurs_ids)==null?void 0:Pe.includes(G==null?void 0:G.id);return se||K||Te}),h!=="all"&&(C=C.filter(re=>h==="planifiee"?re.statut==="planifiee"||re.statut==="creee":re.statut===h)),y&&(C=C.filter(re=>{const se=new Date(re.dateDebut||re.date_debut),Te=new Date(y);return se>=Te})),m&&(C=C.filter(re=>{const se=new Date(re.dateDebut||re.date_debut),Te=new Date(m);return se<=Te})),b!=="all"&&(C=C.filter(re=>re.chefMissionId===b||re.chef_mission_id===b)),d&&(C=C.filter(re=>{var se,Te,we;return((se=re.titre)==null?void 0:se.toLowerCase().includes(d.toLowerCase()))||((we=(Te=re.client)==null?void 0:Te.raison_sociale)==null?void 0:we.toLowerCase().includes(d.toLowerCase()))})),n(C),L(C)},L=C=>{const K=C.length,re=C.filter(ht=>ht.statut==="planifiee"||ht.statut==="creee").length,se=C.filter(ht=>ht.statut==="en_cours").length,Te=C.filter(ht=>ht.statut==="validee").length,we=C.filter(ht=>ht.statut==="cloturee").length,Pe=C.reduce((ht,va)=>ht+(va.budgetInitial||0),0),vn=C.reduce((ht,va)=>ht+(va.depenses||0),0),Gn=C.map(ht=>ht.avancement||0),ch=Gn.length>0?Math.round(Gn.reduce((ht,va)=>ht+va)/Gn.length):0,iO=C.filter(ht=>new Date(ht.dateFin)<new Date&&ht.statut!=="validee"&&ht.statut!=="cloturee").length,aO=Pe>0?Math.round(vn/Pe*100):0;O({total:K,planifiees:re,enCours:se,validees:Te,cloturees:we,budgetTotal:Pe,depensesTotal:vn,tauxUtilisation:aO,avantageMoyen:ch,delaiees:iO,restant:Pe-vn})},ae=()=>{try{if(!E){if(D(!0),r.length===0){U({type:"warning",message:"Aucune mission  analyser"}),D(!1);return}const C=Wte(r,M);W(C)}A(!E),U(E?{type:"success",message:" Vue Missions Affiche"}:{type:"success",message:" Vue Analyse Affiche"})}catch(C){console.error("Erreur:",C),U({type:"error",message:"Erreur lors du basculement"})}finally{D(!1)}},oe=C=>({creee:"bg-blue-100 text-blue-800",planifiee:"bg-blue-100 text-blue-800",en_cours:"bg-amber-100 text-amber-800",cloturee:"bg-green-100 text-green-800",validee:"bg-emerald-100 text-emerald-800"})[C]||"bg-gray-100 text-gray-800",le=C=>({creee:"Planifie",planifiee:"Planifie",en_cours:"En cours",cloturee:"Clture",validee:"Valide"})[C]||C,he=async C=>{if(!ve){U({type:"error",message:"Seuls les administrateurs peuvent valider une mission"});return}if(window.confirm(`tes-vous sr de vouloir valider la mission "${C.titre}"?`))try{t(e.map(K=>K.id===C.id?{...K,statut:"validee"}:K)),T({...C,statut:"validee"}),U({type:"success",message:` Mission "${C.titre}" valide`})}catch{U({type:"error",message:"Erreur lors de la validation"})}},Se=async C=>{if(!ve){U({type:"error",message:"Seuls les administrateurs peuvent clturer une mission"});return}if(window.confirm(`tes-vous sr de vouloir clturer la mission "${C.titre}"?`))try{t(e.map(K=>K.id===C.id?{...K,statut:"cloturee",cloturee_definitive:!0}:K)),T({...C,statut:"cloturee",cloturee_definitive:!0}),U({type:"success",message:` Mission "${C.titre}" clture`})}catch{U({type:"error",message:"Erreur lors de la clture"})}},$e=async C=>{if(!ve){U({type:"error",message:"Seuls les administrateurs peuvent supprimer une mission"});return}if(window.confirm(`tes-vous sr de vouloir supprimer dfinitivement la mission "${C.titre}"? Cette action est irrversible.`))try{t(e.filter(K=>K.id!==C.id)),_(!1),U({type:"success",message:` Mission "${C.titre}" supprime`})}catch{U({type:"error",message:"Erreur lors de la suppression"})}},ze=()=>{if(!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin")){U({type:"error",message:"Seuls les administrateurs peuvent crer des missions"});return}T(null),w(!0)},Le=C=>{const K=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin",re=(C==null?void 0:C.created_by)===(G==null?void 0:G.id),se=(C==null?void 0:C.chefMissionId)===(G==null?void 0:G.id);return K||re||se&&(C==null?void 0:C.statut)!=="cloturee"&&(C==null?void 0:C.statut)!=="validee"},q=C=>{const K=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin",re=(C==null?void 0:C.created_by)===(G==null?void 0:G.id);return(K||re)&&(C==null?void 0:C.statut)!=="cloturee"&&(C==null?void 0:C.statut)!=="validee"},$=C=>{if(!Le(C)){U({type:"error",message:" Vous n'avez pas les permissions pour modifier cette mission"});return}_(!1),w(!0)},X=async C=>{if(!q(C)){U({type:"error",message:" Vous n'avez pas les permissions pour supprimer cette mission"});return}if(window.confirm(" tes-vous certain de vouloir supprimer cette mission?"))try{await Mt.delete(C.id),t(e.filter(K=>K.id!==C.id)),_(!1),U({type:"success",message:" Mission supprime"})}catch(K){console.error("Erreur suppression:",K),U({type:"error",message:" Erreur lors de la suppression"})}},xe=async C=>{try{const K=typeof C=="string"?C:C==null?void 0:C.type,re=typeof C=="object"?C==null?void 0:C.totalExpenses:0,se=(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin",Te=(P==null?void 0:P.chefMissionId)===(G==null?void 0:G.id)||(P==null?void 0:P.chef_mission_id)===(G==null?void 0:G.id);if(K==="start"){if(!Te){U({type:"error",message:" Seul le Chef de Mission assign peut dmarrer la mission"});return}const we={...P,statut:"en_cours",dateDebut:new Date().toISOString()};try{await Mt.updateStatus(P.id,"en_cours"),t(e.map(Pe=>Pe.id===P.id?we:Pe)),T(we),U({type:"success",message:" Mission dmarre - Statut: En cours"})}catch(Pe){console.error("Erreur lors du dmarrage de la mission:",Pe),U({type:"error",message:" Erreur lors du dmarrage de la mission"})}return}if(K==="admin"){if(!se){U({type:"error",message:" Seul un administrateur peut effectuer une clture dfinitive"});return}if(window.confirm(" tes-vous certain de vouloir clturer dfinitivement cette mission? Cette action est irrversible.")){const we={...P,statut:"cloturee",dateCloture:new Date().toISOString(),budget_depense:re,clotureeParAdmin:G==null?void 0:G.id};try{await Mt.validateClosureByAdmin(P.id,{clotureeDefinitive:!0,commentaireAdmin:"Clture dfinitive",totalExpenses:re}),t(e.map(Pe=>Pe.id===P.id?we:Pe)),T(we),U({type:"success",message:" Mission clture dfinitivement par Admin"}),setTimeout(()=>_(!1),1e3)}catch(Pe){console.error("Erreur lors de la clture:",Pe),U({type:"error",message:" Erreur lors de la clture dfinitive"})}}}else if(K==="chef"){if(!se){U({type:"error",message:" Seul un administrateur peut effectuer une clture dfinitive"});return}if(window.confirm(" tes-vous certain de vouloir clturer dfinitivement cette mission? Cette action est irrversible.")){const we={...P,statut:"cloturee",dateCloture:new Date().toISOString(),budget_depense:re,clotureeParAdmin:G==null?void 0:G.id};try{await Mt.closeMissionByChef(P.id,{commentaireChef:"Clture par chef",avancements:P.avancement||100,dateClotureReelle:new Date().toISOString(),totalExpenses:re}),t(e.map(Pe=>Pe.id===P.id?we:Pe)),T(we),U({type:"success",message:" Mission clture par Chef - En attente de validation Admin"}),setTimeout(()=>_(!1),1e3)}catch(Pe){console.error("Erreur lors de la clture par chef:",Pe),U({type:"error",message:" Erreur lors de la clture par le chef"})}}}else if(K==="chef"){if(!Te){U({type:"error",message:" Seul le Chef de Mission assign peut clturer la mission"});return}const we={...P,statut:"cloturee",dateCloture:new Date().toISOString(),budget_depense:re,clotureeParChef:G==null?void 0:G.id};try{await Mt.closeMissionByChef(P.id,{commentaireChef:"Clture par chef de mission",avancements:P.avancement||100,dateClotureReelle:new Date().toISOString(),totalExpenses:re}),t(e.map(Pe=>Pe.id===P.id?we:Pe)),T(we),U({type:"success",message:" Mission clture par le Chef de Mission"})}catch(Pe){console.error("Erreur lors de la clture par chef:",Pe),U({type:"error",message:" Erreur lors de la clture par le chef"})}}}catch(K){console.error("Erreur clture:",K),U({type:"error",message:"Erreur lors de la clture"})}},ee=async C=>{if(!H)try{Q(!0);let K;if(P)K=await Mt.update(P.id,C),t(e.map(re=>re.id===P.id?K:re)),U({type:"success",message:" Mission mise  jour avec succs"});else{if(K=await Mt.create(C),ue&&ue.installationId)try{console.log(" Liaison Mission <-> Planning",ue.installationId),await Ko.update(ue.installationId,{mission_id:K.id})}catch(re){console.error("Erreur liaison planning:",re),U({type:"warning",message:"Mission cre mais chec du lien au planning (vrifiez la table prospect_history)"})}t([K,...e]),U({type:"success",message:" Mission cre avec succs"})}w(!1),T(null)}catch(K){console.error("Erreur dtails:",{message:K.message,code:K.code,details:K.details,hint:K.hint,fullError:K}),U({type:"error",message:`Erreur: ${K.message||"Erreur lors de la sauvegarde de la mission"}`})}finally{Q(!1)}};return c?s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx(zi,{className:"mx-auto mb-4 text-primary animate-bounce",size:48}),s.jsx("p",{className:"text-gray-600",children:"Chargement des missions..."})]})}):s.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[s.jsxs("div",{className:"w-full",children:[s.jsxs("div",{className:"mb-8 px-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(zi,{className:"text-primary",size:32}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de Bord Missions"}),s.jsx("p",{className:"text-gray-600",children:"Suivi statistique et financier en temps rel"})]})]}),s.jsxs(je,{onClick:ze,className:`flex items-center gap-2 ${(B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"?"bg-primary hover:bg-primary-dark text-white":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,disabled:!((B==null?void 0:B.role)==="admin"||(B==null?void 0:B.role)==="super_admin"),children:[s.jsx(Un,{size:20}),"Nouvelle Mission"]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[s.jsx(gc,{placeholder:"Rechercher une mission...",value:d,onChange:f,icon:s.jsx(zi,{size:18})}),s.jsxs("select",{value:h,onChange:C=>p(C.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[s.jsx("option",{value:"all",children:"Tous les statuts"}),s.jsx("option",{value:"planifiee",children:"Planifies (futures)"}),s.jsx("option",{value:"en_cours",children:"En cours"}),s.jsx("option",{value:"validee",children:"Valides"}),s.jsx("option",{value:"cloturee",children:"Cltures"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 font-semibold mb-1",children:"Du"}),s.jsx("input",{type:"date",value:y,onChange:C=>v(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 font-semibold mb-1",children:"Au"}),s.jsx("input",{type:"date",value:m,onChange:C=>x(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs text-gray-600 font-semibold mb-1",children:"Chef Mission"}),s.jsxs("select",{value:b,onChange:C=>g(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[s.jsx("option",{value:"all",children:"Tous"}),o.map(C=>s.jsx("option",{value:C.id,children:C.nom||C.email},C.id))]})]})]}),s.jsxs("div",{className:"flex gap-3 mb-6 flex-wrap",children:[s.jsxs(je,{onClick:ae,disabled:R,className:`flex items-center gap-2 ${E?"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white":"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white"}`,children:[s.jsx(cn,{size:18}),R?"Chargement...":E?" Voir Missions":" Voir Analyse"]}),(y||m||b!=="all"||h!=="all"||d)&&s.jsxs(je,{onClick:()=>{v(""),x(""),g("all"),p("all"),f("")},className:"bg-gray-200 text-gray-700 hover:bg-gray-300 flex items-center gap-2",children:[s.jsx(Lr,{size:18}),"Rinitialiser"]})]})]}),E?s.jsx("div",{className:"mb-8",children:I?s.jsx(Rte,{analysisData:I,loading:R}):s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"text-center",children:s.jsx("p",{className:"text-lg text-gray-500",children:"Aucune analyse disponible"})})})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-blue-500",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-gray-600 text-sm font-medium",children:"Total Missions"}),s.jsx(zi,{className:"text-blue-500",size:20})]}),s.jsx("p",{className:"text-3xl font-bold text-gray-900",children:M.total}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[M.enCours," en cours  ",M.validees," compltes"]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-green-500",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-gray-600 text-sm font-medium",children:"Avancement Moyen"}),s.jsx(cn,{className:"text-green-500",size:20})]}),s.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[M.avantageMoyen,"%"]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-3",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${M.avantageMoyen}%`}})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-yellow-500",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-gray-600 text-sm font-medium",children:"Budget Total"}),s.jsx(yl,{className:"text-yellow-500",size:20})]}),s.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[(M.budgetTotal/1e3).toFixed(0),"K DA"]}),s.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Dpens: ",M.depensesTotal.toLocaleString("fr-DZ")," DA"]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-red-500",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-gray-600 text-sm font-medium",children:"Utilisation Budget"}),s.jsx(ME,{className:"text-red-500",size:20})]}),s.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[M.tauxUtilisation,"%"]}),s.jsx("p",{className:`text-xs mt-2 font-medium ${M.tauxUtilisation>80?"text-red-500":"text-green-500"}`,children:M.tauxUtilisation>80?" Attention":" Normal"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(rM,{size:20,className:"text-primary"}),"Distribution Statuts"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Planifies (futures)"}),s.jsx("span",{className:"font-semibold text-gray-900",children:M.planifiees})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"En cours"}),s.jsx("span",{className:"font-semibold text-amber-600",children:M.enCours})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Valides"}),s.jsx("span",{className:"font-semibold text-green-600",children:M.validees})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Cltures"}),s.jsx("span",{className:"font-semibold text-emerald-600",children:M.cloturees})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(fs,{size:20,className:"text-red-500"}),"Alertes & Risques"]}),s.jsxs("div",{className:"space-y-3",children:[M.delaiees>0&&s.jsx("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:s.jsxs("p",{className:"text-sm font-medium text-red-800",children:[" ",M.delaiees," mission(s) retarde(s)"]})}),M.tauxUtilisation>80&&s.jsx("div",{className:"p-3 bg-orange-50 rounded-lg border border-orange-200",children:s.jsxs("p",{className:"text-sm font-medium text-orange-800",children:[" Budget  ",M.tauxUtilisation,"%"]})}),M.enCours>0&&M.avantageMoyen<50&&s.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:s.jsxs("p",{className:"text-sm font-medium text-yellow-800",children:[" Avancement faible (",M.avantageMoyen,"%)"]})}),M.delaiees===0&&M.tauxUtilisation<=80&&s.jsx("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:s.jsx("p",{className:"text-sm font-medium text-green-800",children:" Aucun risque majeur"})})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(yl,{size:20,className:"text-green-500"}),"Situation Financire"]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[s.jsx("span",{className:"text-sm text-blue-900",children:"Budget Total"}),s.jsxs("span",{className:"font-bold text-blue-900",children:[M.budgetTotal.toLocaleString("fr-DZ")," DA"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[s.jsx("span",{className:"text-sm text-red-900",children:"Dpens"}),s.jsxs("span",{className:"font-bold text-red-900",children:[M.depensesTotal.toLocaleString("fr-DZ")," DA"]})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[s.jsx("span",{className:"text-sm text-green-900",children:"Restant"}),s.jsxs("span",{className:"font-bold text-green-900",children:[M.restant.toLocaleString("fr-DZ")," DA"]})]})]})]})]}),k&&!I&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[s.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-orange-50 rounded-lg shadow p-6 border border-red-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(xt,{size:20,className:"text-red-600"})," Top Risques (IA)"]}),s.jsx("div",{className:"space-y-2",children:(k.risques||[]).map((C,K)=>s.jsxs("p",{className:"text-sm text-gray-700",children:[" ",C]},K))})]}),s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg shadow p-6 border border-green-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(ni,{size:20,className:"text-green-600"})," Opportunits (IA)"]}),s.jsx("div",{className:"space-y-2",children:(k.opportunites||[]).map((C,K)=>s.jsxs("p",{className:"text-sm text-gray-700",children:[" ",C]},K))})]}),s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg shadow p-6 border border-blue-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(bl,{size:20,className:"text-blue-600"})," Actions Prioritaires (IA)"]}),s.jsx("div",{className:"space-y-2",children:(k.recommandations||[]).map((C,K)=>s.jsxs("p",{className:"text-sm text-gray-700",children:[" ",C]},K))})]}),s.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg shadow p-6 border border-purple-200",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[s.jsx(cn,{size:20,className:"text-purple-600"})," Tendances (IA)"]}),s.jsx("div",{className:"space-y-2",children:(k.tendances||[]).map((C,K)=>s.jsxs("p",{className:"text-sm text-gray-700",children:[" ",C]},K))})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:s.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Missions Filtres (",r.length,")"]})}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Titre"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Client"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Type"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Statut"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Chef de Mission"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Accompagnateurs"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Avancement"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Budget"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-semibold text-gray-600",children:"Dpenses"}),s.jsx("th",{className:"px-6 py-3 text-center text-xs font-semibold text-gray-600",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(C=>{var K;return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:C.titre}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:((K=C.client)==null?void 0:K.raison_sociale)||"N/A"}),s.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:C.type||C.type_mission||"N/A"}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${oe(C.statut)}`,children:le(C.statut)})}),s.jsx("td",{className:"px-6 py-4 text-sm",children:(()=>{var Te,we;const re=C.chef_mission_id||C.chefMissionId;if(!re)return s.jsx("span",{className:"text-red-600 font-medium",children:" Non assign"});const se=o.find(Pe=>Pe.id===re);return se?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center text-xs font-bold text-blue-600",children:(we=(Te=se.full_name||se.email)==null?void 0:Te[0])==null?void 0:we.toUpperCase()}),s.jsx("span",{className:"text-gray-900 font-medium",children:se.full_name||se.email})]}):(console.warn("Chef not found in users array:",{chefId:re,usersCount:o.length}),s.jsx("span",{className:"text-amber-600 font-medium",children:" ID invalide"}))})()}),s.jsx("td",{className:"px-6 py-4 text-sm",children:(()=>{const re=C.accompagnateurs_ids||C.accompagnateurIds||[];if(!Array.isArray(re)||re.length===0)return s.jsx("span",{className:"text-red-600 font-medium",children:" Aucun"});const se=re.map(Te=>{const we=o.find(Pe=>Pe.id===Te);return(we==null?void 0:we.full_name)||(we==null?void 0:we.email)||null}).filter(Boolean);return se.length===0?s.jsx("span",{className:"text-red-600 font-medium",children:" Aucun"}):s.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:se.map((Te,we)=>s.jsx("span",{className:"inline-block px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:Te},we))})})()}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:`${C.avancement||0}%`}})}),s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[C.avancement||0,"%"]})]})}),s.jsxs("td",{className:"px-6 py-4 text-sm text-gray-600",children:[(C.budgetInitial||C.budget_alloue||0).toLocaleString("fr-DZ")," DA"]}),s.jsx("td",{className:"px-6 py-4 text-sm",children:s.jsxs("span",{className:(C.depenses||0)>(C.budgetInitial||C.budget_alloue||0)?"text-red-600 font-bold":"text-gray-600",children:[(C.depenses||C.budget_depense||0).toLocaleString("fr-DZ")," DA"]})}),s.jsx("td",{className:"px-6 py-4 text-center",children:s.jsx(je,{onClick:()=>{const re={...C,chef_name:(()=>{const se=C.chef_mission_id||C.chefMissionId;if(!se)return"Non assign";const Te=o.find(we=>we.id===se);return(Te==null?void 0:Te.full_name)||(Te==null?void 0:Te.email)||"Non assign"})()};T(re),_(!0)},className:"text-primary hover:bg-primary hover:text-white px-3 py-1 rounded text-sm",children:"Dtails"})})]},C.id)})})]})}),r.length===0&&s.jsxs("div",{className:"px-6 py-12 text-center",children:[s.jsx(zi,{className:"mx-auto mb-3 text-gray-400",size:40}),s.jsx("p",{className:"text-gray-600",children:"Aucune mission trouve"})]})]})]})]}),s.jsx(Wt,{isOpen:S,onClose:()=>w(!1),title:P?"Modifier Mission":"Nouvelle Mission",children:s.jsx(Ite,{mission:P,initialData:ue,clients:i,users:o,onSubmit:ee,onCancel:()=>w(!1),isSubmitting:H})}),P&&j&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-6xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"bg-gradient-to-r from-primary to-primary-dark text-white p-6 flex items-center justify-between flex-shrink-0",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-3xl font-bold",children:P.titre}),s.jsx("p",{className:"text-primary-light text-sm mt-1",children:P.description})]}),s.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-white hover:bg-opacity-20 rounded-lg transition",children:s.jsx(Lr,{size:28})})]}),s.jsx("div",{className:"overflow-y-auto flex-1",children:s.jsx("div",{className:"p-6",children:s.jsx(Mte,{mission:P,onClose:()=>_(!1),onClosureAdmin:xe,currentUser:G,userProfile:B,onValidate:he,onClosure:Se,onRemove:$e,isAdmin:ve})})}),s.jsxs("div",{className:"border-t border-gray-200 p-4 bg-gray-50 flex gap-3 justify-end flex-shrink-0",children:[s.jsx(je,{onClick:()=>_(!1),className:"bg-gray-200 hover:bg-gray-300 text-gray-800",children:"Fermer"}),Le(P)&&s.jsx(je,{onClick:()=>$(P),className:"bg-primary hover:bg-primary-dark text-white",children:" Modifier"}),q(P)&&s.jsx(je,{onClick:()=>X(P),className:"bg-red-600 hover:bg-red-700 text-white",children:" Supprimer"}),!Le(P)&&s.jsx("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-50 rounded text-red-700 text-sm",children:s.jsx("span",{children:" dition non autorise"})})]})]})})]})},ej=({alerte:e,type:t,onRenouveler:r})=>{var l,c,u,d,f;const n=Ao(e.date_fin),i=()=>t==="danger"?"border-red-500":t==="warning"?"border-orange-500":"border-blue-500",a=()=>t==="danger"?"bg-red-50":t==="warning"?"bg-orange-50":"bg-blue-50",o=()=>t==="danger"?"text-red-700":t==="warning"?"text-orange-700":"text-blue-700";return s.jsxs("div",{className:`card hover:shadow-xl transition-shadow duration-200 border-l-4 ${i()}`,children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:(l=e.installation)==null?void 0:l.application_installee}),t==="danger"&&s.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm font-medium",children:[s.jsx(xt,{size:16}),s.jsx("span",{children:"EXPIR"})]}),t==="warning"&&s.jsxs("div",{className:"flex items-center gap-2 text-orange-600 text-sm font-medium",children:[s.jsx(xt,{size:16}),s.jsxs("span",{children:[n," JOURS RESTANTS"]})]})]})}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-4",children:[s.jsx(Uo,{size:18}),s.jsx("span",{className:"font-medium",children:(u=(c=e.installation)==null?void 0:c.client)==null?void 0:u.raison_sociale})]}),s.jsxs("div",{className:`${a()} rounded-lg p-3 mb-4`,children:[s.jsxs("div",{className:"flex items-center justify-between text-sm mb-2",children:[s.jsx("span",{className:"text-gray-600",children:"Date de fin:"}),s.jsx("span",{className:`font-bold ${o()}`,children:St(e.date_fin)})]}),((f=(d=e.installation)==null?void 0:d.client)==null?void 0:f.commercial_assigne)&&s.jsxs("div",{className:"text-xs text-gray-600 mt-2",children:["Commercial: ",e.installation.client.commercial_assigne]})]}),s.jsxs("button",{onClick:()=>r(e.id),className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-lg font-medium transition-colors ${t==="danger"?"bg-red-600 hover:bg-red-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white"}`,children:[s.jsx(hs,{size:18}),"Renouveler Maintenant"]})]})},Vte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState(!0),{addNotification:i}=cr();N.useEffect(()=>{a()},[]);const a=async()=>{try{n(!0);const u=await Kt.checkAlertes();t(u)}catch{i({type:"error",message:"Erreur lors du chargement des alertes"})}finally{n(!1)}},o=async u=>{if(window.confirm("tes-vous sr de vouloir renouveler cet abonnement ?"))try{const d=e.find(p=>p.id===u);if(!d)throw new Error("Abonnement non trouv");await Kt.delete(u);const f=new Date(d.date_fin),h=new Date(f);h.setFullYear(h.getFullYear()+1),await Kt.create({installation_id:d.installation_id,date_debut:f.toISOString(),date_fin:h.toISOString(),statut:"actif"}),i({type:"success",message:"Abonnement renouvel avec succs"}),a()}catch(d){i({type:"error",message:d.message||"Erreur lors du renouvellement"})}};if(r)return s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});const l=e.filter(u=>new Date(u.date_fin)>=new Date),c=e.filter(u=>new Date(u.date_fin)<new Date);return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"card bg-gradient-to-br from-orange-500 to-red-500 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Alertes de Renouvellement"}),s.jsxs("p",{className:"text-white opacity-90",children:[e.length," abonnement(s) ncessitent votre attention"]})]}),s.jsx(xt,{size:64,className:"opacity-50"})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsx("div",{className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(ed,{size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"En Alerte"}),s.jsx("h3",{className:"text-3xl font-bold",children:l.length})]})]})}),s.jsx("div",{className:"card bg-gradient-to-br from-red-500 to-red-600 text-white",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(xt,{size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Expirs"}),s.jsx("h3",{className:"text-3xl font-bold",children:c.length})]})]})}),s.jsx("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(xr,{size:32}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total"}),s.jsx("h3",{className:"text-3xl font-bold",children:e.length})]})]})})]}),l.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx(ed,{className:"text-orange-500",size:24}),"Abonnements  Renouveler Prochainement"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(u=>s.jsx(ej,{alerte:u,type:"warning",onRenouveler:o},u.id))})]}),c.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[s.jsx(xt,{className:"text-red-500",size:24}),"Abonnements Expirs - Action Urgente"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(u=>s.jsx(ej,{alerte:u,type:"danger",onRenouveler:o},u.id))})]}),e.length===0&&s.jsx("div",{className:"card text-center py-12",children:s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:s.jsx(xr,{className:"text-green-600",size:32})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Aucune Alerte Active"}),s.jsx("p",{className:"text-gray-600",children:"Tous les abonnements sont  jour !"})]})]})})]})},Gte=({application:e,onSubmit:t,onCancel:r})=>{const[n,i]=N.useState({nom:"",description:"",prix_acquisition:"",prix_abonnement:""}),[a,o]=N.useState({});N.useEffect(()=>{e&&i({nom:e.nom||"",description:e.description||"",prix_acquisition:e.prix_acquisition||e.prix||"",prix_abonnement:e.prix_abonnement||e.prix||""})},[e]);const l=(u,d)=>{i(f=>({...f,[u]:d})),a[u]&&o(f=>({...f,[u]:""}))},c=u=>{u.preventDefault();const d=lh.validateApplication(n);if(!d.isValid){o(d.errors);return}t(n)};return s.jsxs("form",{onSubmit:c,className:"space-y-4",children:[s.jsx(Ie,{label:"Nom de l'Application",value:n.nom,onChange:u=>l("nom",u.target.value),error:a.nom,required:!0}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),s.jsx("textarea",{value:n.description,onChange:u=>l("description",u.target.value),rows:"4",className:"input-field",placeholder:"Description de l'application..."})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(Ie,{label:"Prix Acquisition (DA)",type:"number",value:n.prix_acquisition,onChange:u=>l("prix_acquisition",u.target.value),error:a.prix_acquisition,required:!0}),s.jsx(Ie,{label:"Prix Abonnement (DA)",type:"number",value:n.prix_abonnement,onChange:u=>l("prix_abonnement",u.target.value),error:a.prix_abonnement,required:!0})]}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",children:e?"Modifier":"Crer"})]})]})},Kte=({application:e,onEdit:t,onDelete:r,hasEditPermission:n=!0,hasDeletePermission:i=!0})=>{const{profile:a}=dt();return s.jsxs("div",{className:"card hover:shadow-xl transition-shadow duration-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:s.jsx(u0,{className:"text-purple-600",size:24})}),s.jsx("div",{children:s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:e.nom})})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>t(e),disabled:!n,className:`p-2 rounded-lg transition-colors ${n?"text-blue-600 hover:bg-blue-50":"text-gray-400 cursor-not-allowed"}`,title:n?"Modifier cette application":"Permission refuse: Modifier",children:n?s.jsx(br,{size:18}):s.jsx(xi,{size:18})}),s.jsx("button",{onClick:()=>r(e.id),disabled:!i,className:`p-2 rounded-lg transition-colors ${i?"text-red-600 hover:bg-red-50":"text-gray-400 cursor-not-allowed"}`,title:i?"Supprimer cette application":"Permission refuse: Supprimer",children:i?s.jsx(rr,{size:18}):s.jsx(xi,{size:18})})]})]}),e.description&&s.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:e.description}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-auto",children:[s.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-green-600 mb-1 font-semibold",children:"PRIX ACQUISITION"}),s.jsx("p",{className:"text-xl font-bold text-green-700",children:(a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="super_admin"?Nt(e.prix_acquisition||e.prix||0):""})]}),s.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4",children:[s.jsx("p",{className:"text-xs text-blue-600 mb-1 font-semibold",children:"PRIX ABONNEMENT"}),s.jsx("p",{className:"text-xl font-bold text-blue-700",children:(a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="super_admin"?Nt(e.prix_abonnement||e.prix||0):""})]})]})]})},Xte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState(!0),[o,l]=N.useState(""),[c,u]=N.useState(!1),[d,f]=N.useState(null),[h,p]=N.useState("create"),[y,v]=N.useState(!1),[m,x]=N.useState(!1),[b,g]=N.useState(!1),[S,w]=N.useState(!1),{addNotification:j}=cr(),{user:_,profile:E}=dt();N.useEffect(()=>{A()},[]),N.useEffect(()=>{P()},[_==null?void 0:_.id,E==null?void 0:E.role]),N.useEffect(()=>{T()},[e,o]);const A=async()=>{try{a(!0);const I=await Ga.getAll();t(I)}catch{j({type:"error",message:"Erreur lors du chargement des applications"})}finally{a(!1)}},P=async()=>{try{if(w(!0),_!=null&&_.id&&E){const I=(E==null?void 0:E.role)==="admin"||(E==null?void 0:E.role)==="super_admin"||await Fe.hasCreatePermission(_.id,"applications"),W=(E==null?void 0:E.role)==="admin"||(E==null?void 0:E.role)==="super_admin"||await Fe.hasEditPermission(_.id,"applications"),R=(E==null?void 0:E.role)==="admin"||(E==null?void 0:E.role)==="super_admin"||await Fe.hasDeletePermission(_.id,"applications");v(I),x(W),g(R)}}catch(I){console.error("Erreur chargement permissions:",I)}finally{w(!1)}},T=()=>{let I=[...e];o&&(I=I.filter(W=>{var R,D;return((R=W.nom)==null?void 0:R.toLowerCase().includes(o.toLowerCase()))||((D=W.description)==null?void 0:D.toLowerCase().includes(o.toLowerCase()))})),n(I)},M=()=>{y&&(f(null),p("create"),u(!0))},O=I=>{m&&(f(I),p("edit"),u(!0))},k=async I=>{var R;const W=(I==null?void 0:I.id)||I;if(b&&window.confirm("tes-vous sr de vouloir supprimer cette application ?"))try{await Ga.delete(W),j({type:"success",message:"Application supprime avec succs"}),A()}catch(D){console.error("Erreur suppression application:",D),D.status===409||(R=D.message)!=null&&R.includes("foreign key")?j({type:"error",message:"Impossible de supprimer cette application car elle est lie  d'autres enregistrements"}):j({type:"error",message:"Erreur lors de la suppression de l'application"})}},F=async I=>{try{h==="create"?(await Ga.create(I),j({type:"success",message:"Application cre avec succs"})):(await Ga.update(d.id,I),j({type:"success",message:"Application modifie avec succs"})),u(!1),A()}catch{j({type:"error",message:"Erreur lors de l'enregistrement"})}};return i?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Catalogue d'Applications"}),s.jsxs("p",{className:"text-white opacity-90",children:[e.length," application(s) disponible(s)"]})]}),s.jsx(u0,{size:64,className:"opacity-50"})]})}),s.jsx("div",{className:"card",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(gc,{value:o,onChange:l,placeholder:"Rechercher une application..."})}),s.jsx(je,{variant:"primary",icon:Un,onClick:M,disabled:!y,title:y?"Ajouter une nouvelle application":"Permission refuse: Crer une application",children:"Ajouter Application"})]})}),r.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune application trouve"})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(I=>s.jsx(Kte,{application:I,onEdit:O,onDelete:k,hasEditPermission:m,hasDeletePermission:b},I.id))}),s.jsx(Wt,{isOpen:c,onClose:()=>u(!1),title:h==="create"?"Nouvelle Application":"Modifier Application",children:s.jsx(Gte,{application:d,onSubmit:F,onCancel:()=>u(!1)})})]})},Yte=({user:e,onSubmit:t,onCancel:r})=>{const[n,i]=N.useState({nom:"",email:"",password:"",role:"commercial",pages_visibles:[],permissions:{}}),[a,o]=N.useState({}),l=[{value:Ee.DASHBOARD,label:"Tableau de Bord"},{value:Ee.PROSPECTS,label:"Prospects"},{value:Ee.CLIENTS,label:"Clients"},{value:Ee.INSTALLATIONS,label:"Installations"},{value:Ee.ABONNEMENTS,label:"Abonnements"},{value:Ee.PAIEMENTS,label:"Paiements"},{value:Ee.SUPPORT,label:"Support"},{value:Ee.MISSIONS,label:" Missions"},{value:Ee.ALERTES,label:"Alertes"},{value:Ee.APPLICATIONS,label:"Applications"},{value:Ee.UTILISATEURS,label:"Utilisateurs"}],c=[{value:"super_admin",label:" Super Administrateur"},{value:"admin",label:" Administrateur"},{value:"technicien",label:" Technicien"},{value:"commercial",label:" Commercial"},{value:"support",label:" Support"}];N.useEffect(()=>{if(e){const v={};Object.keys(co).forEach(m=>{v[m]={},co[m].permissions.forEach(x=>{const b=`can_${x}_${m}`;v[m][x]=e[b]||!1})}),i({nom:e.nom||"",email:e.email||"",password:"",role:e.role||"commercial",pages_visibles:e.pages_visibles||[],permissions:v})}else{const v={};Object.keys(co).forEach(m=>{v[m]={},co[m].permissions.forEach(x=>{v[m][x]=!1})}),i(m=>({...m,permissions:v}))}},[e]);const u=(v,m)=>{var x;i(b=>({...b,[v]:m})),a[v]&&o(b=>({...b,[v]:""})),v==="role"&&((x=ta[m])!=null&&x.allPages)&&i(b=>({...b,pages_visibles:[]}))},d=v=>{i(m=>{const x=[...m.pages_visibles],b=x.indexOf(v);return b>-1?x.splice(b,1):x.push(v),{...m,pages_visibles:x}})},f=(v,m)=>{i(x=>({...x,permissions:{...x.permissions,[v]:{...x.permissions[v],[m]:!x.permissions[v][m]}}}))},h=v=>{if(v.preventDefault(),!e){const x=lh.validateUser(n);if(!x.isValid){o(x.errors);return}}const m={...n};if(e&&!m.password&&delete m.password,m.permissions&&typeof m.permissions=="object"){const x={};let b=!1;Object.entries(m.permissions).forEach(([g,S])=>{Object.entries(S).forEach(([w,j])=>{(j===!0||j===!1)&&(x[`can_${w}_${g}`]=j,b=!0)})}),b&&Object.assign(m,x),delete m.permissions}t(m)},p=ta[n.role],y=n.role==="super_admin"||n.role==="admin";return s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsx(Ie,{label:"Nom Complet",value:n.nom,onChange:v=>u("nom",v.target.value),error:a.nom,required:!0}),s.jsx(Ie,{label:"Email",type:"email",value:n.email,onChange:v=>u("email",v.target.value),error:a.email,required:!0}),s.jsx(Ie,{label:e?"Nouveau Mot de Passe (laisser vide pour ne pas changer)":"Mot de Passe",type:"password",value:n.password,onChange:v=>u("password",v.target.value),error:a.password,required:!e}),s.jsx(yt,{label:"Rle",value:n.role,onChange:v=>u("role",v.target.value),options:c,required:!0}),p&&s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[s.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:" Permissions du rle:"}),s.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[p.canManageUsers&&s.jsx("li",{children:" Gestion des utilisateurs"}),p.canManageRoles&&s.jsx("li",{children:" Gestion des rles"}),p.canManageApplications&&s.jsx("li",{children:" Gestion des applications"}),p.canViewAll&&s.jsx("li",{children:" Voir toutes les donnes"}),p.canEditAll&&s.jsx("li",{children:" diter toutes les donnes"}),p.canDeleteAll&&s.jsx("li",{children:" Supprimer toutes les donnes"}),p.allPages&&s.jsx("li",{children:" Accs  toutes les pages"})]})]}),!y&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Pages Accessibles"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2 max-h-64 overflow-y-auto border border-gray-200",children:l.map(v=>s.jsxs("label",{className:"flex items-center gap-3 cursor-pointer hover:bg-gray-100 p-2 rounded transition-colors",children:[s.jsx("input",{type:"checkbox",checked:n.pages_visibles.includes(v.value),onChange:()=>d(v.value),className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"}),s.jsx("span",{className:"text-sm text-gray-700",children:v.label})]},v.value))}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Slectionnez au minimum une page pour ce rle"})]}),!y&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:" Permissions Granulaires (Crer, Modifier, Supprimer...)"}),s.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 space-y-4",children:Object.entries(co).map(([v,m])=>s.jsxs("div",{children:[s.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2",children:[m.icon," ",m.label]}),s.jsx("div",{className:"grid grid-cols-2 gap-3 ml-4",children:m.permissions.map(x=>{var b;return s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",checked:((b=n.permissions[v])==null?void 0:b[x])||!1,onChange:()=>f(v,x),className:"w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary"}),s.jsx("span",{className:"text-sm text-gray-700",children:XI[x]})]},`${v}-${x}`)})})]},v))})]}),y&&s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-xs text-amber-800",children:[" ",s.jsx("strong",{children:"Accs complet:"})," Les administrateurs ont automatiquement accs  toutes les pages et toutes les fonctionnalits."]})}),s.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[s.jsx(je,{variant:"ghost",onClick:r,children:"Annuler"}),s.jsx(je,{type:"submit",variant:"primary",children:e?"Modifier":"Crer"})]})]})},Jte=({user:e,onEdit:t,onDelete:r,canManage:n=!1})=>{const i=()=>({super_admin:"bg-red-100 text-red-800 border-red-200",admin:"bg-orange-100 text-orange-800 border-orange-200",technicien:"bg-green-100 text-green-800 border-green-200",commercial:"bg-blue-100 text-blue-800 border-blue-200",support:"bg-indigo-100 text-indigo-800 border-indigo-200"})[e.role]||"bg-gray-100 text-gray-800 border-gray-200",a=()=>{const c=ta[e.role];return(c==null?void 0:c.label)||e.role},o=()=>({super_admin:"",admin:"",technicien:"",commercial:"",support:""})[e.role]||"",l=ta[e.role];return s.jsxs("div",{className:"card hover:shadow-xl transition-shadow duration-200",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx("div",{className:"w-14 h-14 bg-primary rounded-full flex items-center justify-center text-white text-xl font-bold",children:LE(e.nom)}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-bold text-gray-800",children:e.nom}),s.jsxs("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-medium border ${i()} mt-1`,children:[o()," ",a()]})]})]}),n&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Modifier",children:s.jsx(br,{size:18})}),s.jsx("button",{onClick:()=>r(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer",children:s.jsx(rr,{size:18})})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm mb-4",children:[s.jsx(c0,{size:16}),s.jsx("span",{className:"truncate",children:e.email})]}),l&&!l.allPages&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-3",children:[s.jsx("p",{className:"text-xs text-gray-600 mb-2 font-medium",children:" Pages accessibles:"}),e.pages_visibles&&e.pages_visibles.length>0?s.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.pages_visibles.slice(0,3).map((c,u)=>s.jsx("span",{className:"text-xs bg-white px-2 py-1 rounded border border-gray-200",children:c},u)),e.pages_visibles.length>3&&s.jsxs("span",{className:"text-xs text-gray-500",children:["+",e.pages_visibles.length-3]})]}):s.jsx("p",{className:"text-xs text-gray-500",children:"Aucune page assigne"})]}),l&&s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[s.jsx("p",{className:"text-xs text-blue-600 font-medium mb-2",children:" Permissions:"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[l.allPages&&s.jsx("span",{className:"text-blue-700",children:" Toutes les pages"}),l.canManageUsers&&s.jsx("span",{className:"text-blue-700",children:" Grer utilisateurs"}),l.canViewAll&&s.jsx("span",{className:"text-blue-700",children:" Voir toutes donnes"}),l.canEditAll&&s.jsx("span",{className:"text-blue-700",children:" diter tout"}),l.canDeleteAll&&s.jsx("span",{className:"text-blue-700",children:" Supprimer tout"}),!l.allPages&&!l.canManageUsers&&!l.canViewAll&&s.jsx("span",{className:"text-gray-500",children:"Accs limit"})]})]})]})},Qte=()=>{const[e,t]=N.useState([]),[r,n]=N.useState([]),[i,a]=N.useState(!0),[o,l]=N.useState(""),[c,u]=N.useState("all"),[d,f]=N.useState(!1),[h,p]=N.useState(null),[y,v]=N.useState("create"),{addNotification:m}=cr(),{canManageUsers:x,profile:b}=dt();N.useEffect(()=>{g()},[]),N.useEffect(()=>{S()},[e,o,c]);const g=async()=>{try{a(!0);const P=await Fe.getAll();t(P)}catch{m({type:"error",message:"Erreur lors du chargement des utilisateurs"})}finally{a(!1)}},S=()=>{let P=[...e];c!=="all"&&(P=P.filter(T=>T.role===c)),o&&(P=P.filter(T=>{var M,O;return((M=T.nom)==null?void 0:M.toLowerCase().includes(o.toLowerCase()))||((O=T.email)==null?void 0:O.toLowerCase().includes(o.toLowerCase()))})),n(P)},w=()=>{if(!x()){m({type:"error",message:" Vous n'avez pas la permission de crer des utilisateurs"});return}p(null),v("create"),f(!0)},j=P=>{if(!x()){m({type:"error",message:" Vous n'avez pas la permission de modifier des utilisateurs"});return}p(P),v("edit"),f(!0)},_=async P=>{const T=(P==null?void 0:P.id)||P;if(!x()){m({type:"error",message:" Vous n'avez pas la permission de supprimer des utilisateurs"});return}const M=e.find(F=>F.id===T);if((M==null?void 0:M.role)==="super_admin"&&(b==null?void 0:b.role)!=="super_admin"){m({type:"error",message:" Seul un Super Admin peut supprimer un autre Super Admin"});return}const O=` ATTENTION 

tes-vous absolument sr de vouloir supprimer cet utilisateur ?

${M==null?void 0:M.nom}
${M==null?void 0:M.email}

Cette action est IRRVERSIBLE !`;if(!window.confirm(O))return;if(window.prompt('Pour confirmer la suppression, tapez "SUPPRIMER" en majuscules:')!=="SUPPRIMER"){m({type:"info",message:"Suppression annule"});return}try{await Fe.delete(T,b),m({type:"success",message:"Utilisateur supprim avec succs"}),g()}catch(F){F.code==="PERMISSION_DENIED"?m({type:"error",message:" "+F.message}):F.code==="USER_HAS_REFERENCES"?m({type:"error",title:" Impossible de supprimer cet utilisateur",message:F.message,duration:1e4}):m({type:"error",message:F.message||"Erreur lors de la suppression"})}},E=async P=>{var T,M;try{if(y==="create"){const O=await Fe.create(P,b);O!=null&&O._authCreationFailed?m({type:"warning",title:" Utilisateur cr partiellement",message:O._message||"Utilisateur cr en BDD mais Auth rate limite. L'utilisateur pourra se connecter normalement.",duration:8e3}):m({type:"success",message:"Utilisateur cr avec succs"})}else await Fe.update(h.id,P,b),m({type:"success",message:"Utilisateur modifi avec succs"});f(!1),g()}catch(O){O.code==="PERMISSION_DENIED"?m({type:"error",message:" "+O.message}):O.code==="DUPLICATE_EMAIL"?m({type:"error",title:" Email dj utilis",message:O.message,duration:6e3}):O.code==="INVALID_ROLE"?m({type:"error",title:" Rle invalide",message:O.message,duration:6e3}):(T=O.message)!=null&&T.includes("rate limit")?m({type:"warning",title:" Trop de requtes",message:"Supabase Auth a atteint sa limite. L'utilisateur a t cr en BDD et pourra se connecter.",duration:1e4}):(M=O.message)!=null&&M.includes("password")?m({type:"error",title:" Mot de passe trop faible",message:"Le mot de passe doit contenir au moins 6 caractres.",duration:6e3}):m({type:"error",message:O.message||"Erreur lors de l'enregistrement"})}},A={total:e.length,superAdmin:e.filter(P=>P.role==="super_admin").length,admin:e.filter(P=>P.role==="admin").length,technicien:e.filter(P=>P.role==="technicien").length,commercial:e.filter(P=>P.role==="commercial").length,support:e.filter(P=>P.role==="support").length};return i?s.jsx("div",{className:"flex items-center justify-center h-96",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Gestion des Utilisateurs"}),s.jsxs("p",{className:"text-white opacity-90",children:[e.length," utilisateur(s) enregistr(s)"]})]}),s.jsx(Rm,{size:64,className:"opacity-50"})]})}),!x()&&s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex gap-3",children:[s.jsx(xt,{className:"text-amber-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-amber-900",children:" Accs Limit"}),s.jsx("p",{className:"text-sm text-amber-800",children:"Vous n'avez pas les permissions pour grer les utilisateurs. Seuls les administrateurs peuvent crer, modifier ou supprimer des utilisateurs."})]})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[s.jsxs("div",{className:"card bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total"}),s.jsx("h3",{className:"text-3xl font-bold",children:A.total})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-red-500 to-red-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Super Admin"}),s.jsx("h3",{className:"text-3xl font-bold",children:A.superAdmin})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Admin"}),s.jsx("h3",{className:"text-3xl font-bold",children:A.admin})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-green-500 to-green-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Techniciens"}),s.jsx("h3",{className:"text-3xl font-bold",children:A.technicien})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Commerciaux"}),s.jsx("h3",{className:"text-3xl font-bold",children:A.commercial})]}),s.jsxs("div",{className:"card bg-gradient-to-br from-indigo-500 to-indigo-600 text-white",children:[s.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Support"}),s.jsx("h3",{className:"text-3xl font-bold",children:A.support})]})]}),s.jsxs("div",{className:"card",children:[s.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(gc,{value:o,onChange:l,placeholder:"Rechercher un utilisateur..."})}),s.jsx(je,{variant:"primary",icon:Un,onClick:w,disabled:!x(),title:x()?"":"Vous n'avez pas la permission de crer des utilisateurs",children:"Ajouter Utilisateur"})]}),s.jsxs("div",{className:"flex gap-2 mt-4 flex-wrap",children:[s.jsx("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="all"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Tous"}),s.jsx("button",{onClick:()=>u("super_admin"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="super_admin"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Super Admin"}),s.jsx("button",{onClick:()=>u("admin"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="admin"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Admin"}),s.jsx("button",{onClick:()=>u("technicien"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="technicien"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Technicien"}),s.jsx("button",{onClick:()=>u("commercial"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="commercial"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Commercial"}),s.jsx("button",{onClick:()=>u("support"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="support"?"bg-primary text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Support"})]})]}),r.length===0?s.jsx("div",{className:"card text-center py-12",children:s.jsx("p",{className:"text-gray-500 text-lg",children:"Aucun utilisateur trouv"})}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(P=>s.jsx(Jte,{user:P,onEdit:j,onDelete:_,canManage:x()},P.id))}),s.jsx(Wt,{isOpen:d,onClose:()=>f(!1),title:y==="create"?"Nouvel Utilisateur":"Modifier Utilisateur",children:s.jsx(Yte,{user:h,onSubmit:E,onCancel:()=>f(!1)})})]})},Zte=()=>{const[e,t]=N.useState(Ee.DASHBOARD),{hasAccess:r,profile:n}=dt(),i=oc(),a=uf();N.useEffect(()=>{const u=i.pathname.substring(1);if(u==="")return;const d=Object.values(Ee).find(f=>f===u);d&&d!==e&&(console.log(` URL dtecte : ${u} -> Mise  jour vue : ${d}`),t(d))},[i.pathname]),N.useEffect(()=>{e&&i.pathname.substring(1)!==e&&(console.log(` Changement page : ${e} -> Mise  jour URL`),a(`/${e}`))},[e]),z.useEffect(()=>{if(n){if(n.role==="admin"||n.role==="super_admin"){t(Ee.DASHBOARD),console.log(` ${n.role}  Dashboard`);return}if(n!=null&&n.pages_visibles&&n.pages_visibles.length>0){const u=n.pages_visibles[0],d=Object.values(Ee).find(f=>f.toLowerCase()===u.toLowerCase());d&&(console.log(` Redirection vers: ${d}`),t(d))}}},[n]);const l={[Ee.DASHBOARD]:{title:"Tableau de Bord",subtitle:"Vue d'ensemble de votre activit",component:mte},[Ee.PROSPECTS]:{title:"Gestion des Prospects",subtitle:"Suivi du pipeline commercial",component:wte},[Ee.CLIENTS]:{title:"Clients",subtitle:"Base de clients actifs",component:jte},[Ee.INSTALLATIONS]:{title:"Installations",subtitle:"Suivi des dploiements",component:Ate},[Ee.ABONNEMENTS]:{title:"Abonnements",subtitle:"Renouvellements et alertes",component:Pte},[Ee.PAIEMENTS]:{title:"Paiements",subtitle:"Historique des transactions",component:Ote},[Ee.SUPPORT]:{title:" Support Technique",subtitle:"Interventions et tickets",component:$te},[Ee.MISSIONS]:{title:" Tableau de Bord Missions",subtitle:"Suivi statistique et financier en temps rel",component:Hte},[Ee.ALERTES]:{title:"Alertes",subtitle:"Notifications importantes",component:Vte},[Ee.APPLICATIONS]:{title:"Applications",subtitle:"Catalogue de logiciels",component:Xte},[Ee.UTILISATEURS]:{title:"Utilisateurs",subtitle:"Gestion des comptes",component:Qte}}[e],c=l.component;return(n==null?void 0:n.role)==="admin"||(n==null?void 0:n.role)==="super_admin"?s.jsxs(s.Fragment,{children:[s.jsx(Yh,{}),s.jsxs("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(Kh,{currentPage:e,onPageChange:t}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx(Xh,{title:l.title,subtitle:l.subtitle}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:s.jsx(c,{})})]})]})]}):r(e)?s.jsxs(s.Fragment,{children:[s.jsx(Yh,{}),s.jsxs("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(Kh,{currentPage:e,onPageChange:t}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx(Xh,{title:l.title,subtitle:l.subtitle}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:s.jsx(c,{})})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Yh,{}),s.jsxs("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(Kh,{currentPage:e,onPageChange:t}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx(Xh,{title:"Accs Refus",subtitle:"Vous n'avez pas accs  cette page"}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6 flex items-center justify-center",children:s.jsxs("div",{className:"max-w-md w-full text-center bg-white rounded-lg shadow p-8",children:[s.jsx("div",{className:"text-5xl mb-4",children:""}),s.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Accs Refus"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Vous n'avez pas accs  cette page."}),s.jsx("button",{onClick:()=>{if(n!=null&&n.pages_visibles&&n.pages_visibles.length>0){const u=n.pages_visibles[0],d=Object.values(Ee).find(f=>f.toLowerCase()===u.toLowerCase());d&&t(d)}},className:"inline-block bg-primary text-white px-6 py-2 rounded-lg font-medium hover:opacity-90 transition-opacity",children:"Retour  ma page d'accueil"})]})})]})]})]})},tj={startAutoRenewal(e=36e5){console.log(" Auto-renewal service started"),this.checkAndRenew(),this.intervalId=setInterval(()=>{this.checkAndRenew()},e)},stopAutoRenewal(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null,console.log(" Auto-renewal service stopped"))},async checkAndRenew(){try{const e=await Tr.checkAndRenewAcquisitions();e.renewedCount>0&&console.log(` ${e.renewedCount} installation(s) renouvele(s) automatiquement`)}catch(e){console.error(" Erreur lors du renouvellement automatique:",e)}}},ere=()=>{const{isAuthenticated:e,loading:t,profile:r}=dt();return z.useEffect(()=>{r&&console.log(" Utilisateur connect:",{id:r.id,nom:r.nom,email:r.email,role:r.role,pages_visibles:r.pages_visibles})},[r]),z.useEffect(()=>{if(e)return tj.startAutoRenewal(144e5),()=>{tj.stopAutoRenewal()}},[e]),t?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"Chargement..."})]})}):s.jsxs(jk,{children:[s.jsx(xm,{path:"/login",element:e?s.jsx(PN,{to:"/",replace:!0}):s.jsx(vM,{})}),s.jsx(xm,{path:"/*",element:s.jsx(xM,{children:s.jsx(Zte,{})})})]})};function tre(){return s.jsx(Ek,{children:s.jsx(YI,{children:s.jsx(JI,{children:s.jsx(ere,{})})})})}Np.createRoot(document.getElementById("root")).render(s.jsx(tre,{}));
